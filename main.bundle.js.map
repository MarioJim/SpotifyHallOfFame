{"version":3,"file":"main.bundle.js","mappings":";yBACA,IAAIA,EAAsB,CCA1BA,EAAwB,SAASC,EAASC,GACzC,IAAI,IAAIC,KAAOD,EACXF,EAAoBI,EAAEF,EAAYC,KAASH,EAAoBI,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,MCJ3EH,EAAwB,SAASS,EAAKC,GAAQ,OAAOL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,ICC/FV,EAAwB,SAASC,GACX,oBAAXa,QAA0BA,OAAOC,aAC1CV,OAAOC,eAAeL,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DX,OAAOC,eAAeL,EAAS,aAAc,CAAEe,OAAO,s6DCLvD,MAAMC,EAAQ,CAEbC,SAAS,EAETC,MAAO,GAEPC,IAAK,SAAWjB,EAAKkB,IAEE,IAAjBC,KAAKJ,UAIVI,KAAKH,MAAOhB,GAAQkB,IAIrBb,IAAK,SAAWL,GAEf,IAAsB,IAAjBmB,KAAKJ,QAIV,OAAOI,KAAKH,MAAOhB,IAIpBoB,OAAQ,SAAWpB,UAEXmB,KAAKH,MAAOhB,IAIpBqB,MAAO,WAENF,KAAKH,MAAQ,KCyGTM,EAAwB,IA3I9B,MAECC,YAAaC,EAAQC,EAAYC,GAEhC,MAAMC,EAAQR,KAEd,IAGIS,EAHAC,GAAY,EACZC,EAAc,EACdC,EAAa,EAEjB,MAAMC,EAAW,GAKjBb,KAAKc,aAAUC,EACff,KAAKK,OAASA,EACdL,KAAKM,WAAaA,EAClBN,KAAKO,QAAUA,EAEfP,KAAKgB,UAAY,SAAWC,GAE3BL,KAEmB,IAAdF,QAEmBK,IAAlBP,EAAMM,SAEVN,EAAMM,QAASG,EAAKN,EAAaC,GAMnCF,GAAY,GAIbV,KAAKkB,QAAU,SAAWD,GAEzBN,SAE0BI,IAArBP,EAAMF,YAEVE,EAAMF,WAAYW,EAAKN,EAAaC,GAIhCD,IAAgBC,IAEpBF,GAAY,OAEUK,IAAjBP,EAAMH,QAEVG,EAAMH,WAQTL,KAAKmB,UAAY,SAAWF,QAEJF,IAAlBP,EAAMD,SAEVC,EAAMD,QAASU,IAMjBjB,KAAKoB,WAAa,SAAWH,GAE5B,OAAKR,EAEGA,EAAaQ,GAIdA,GAIRjB,KAAKqB,eAAiB,SAAWC,GAIhC,OAFAb,EAAca,EAEPtB,MAIRA,KAAKuB,WAAa,SAAWC,EAAOC,GAInC,OAFAZ,EAASa,KAAMF,EAAOC,GAEfzB,MAIRA,KAAK2B,cAAgB,SAAWH,GAE/B,MAAMI,EAAQf,EAASgB,QAASL,GAQhC,OANiB,IAAZI,GAEJf,EAASiB,OAAQF,EAAO,GAIlB5B,MAIRA,KAAK+B,WAAa,SAAWhC,GAE5B,IAAM,IAAIiC,EAAI,EAAGC,EAAIpB,EAASqB,OAAQF,EAAIC,EAAGD,GAAK,EAAI,CAErD,MAAMR,EAAQX,EAAUmB,GAClBP,EAASZ,EAAUmB,EAAI,GAI7B,GAFKR,EAAMW,SAASX,EAAMY,UAAY,GAEjCZ,EAAMa,KAAMtC,GAEhB,OAAO0B,EAMT,OAAO,QCjIV,MAAMa,EAELlC,YAAamC,GAEZvC,KAAKuC,aAAwBxB,IAAZwB,EAA0BA,EAAUpC,EAErDH,KAAKwC,YAAc,YACnBxC,KAAKyC,iBAAkB,EACvBzC,KAAK0C,KAAO,GACZ1C,KAAK2C,aAAe,GACpB3C,KAAK4C,cAAgB,GAItBC,QAEAC,UAAW7B,EAAKX,GAEf,MAAME,EAAQR,KAEd,OAAO,IAAI+C,SAAS,SAAWC,EAASC,GAEvCzC,EAAMqC,KAAM5B,EAAK+B,EAAS1C,EAAY2C,MAMxCC,SAEAC,eAAgBX,GAGf,OADAxC,KAAKwC,YAAcA,EACZxC,KAIRoD,mBAAoB1D,GAGnB,OADAM,KAAKyC,gBAAkB/C,EAChBM,KAIRqD,QAASX,GAGR,OADA1C,KAAK0C,KAAOA,EACL1C,KAIRsD,gBAAiBX,GAGhB,OADA3C,KAAK2C,aAAeA,EACb3C,KAIRuD,iBAAkBX,GAGjB,OADA5C,KAAK4C,cAAgBA,EACd5C,MC/CT,SAASwD,EAAUC,GAElB,GAAsB,IAAjBA,EAAMvB,OAAe,OAAO,IAEjC,IAAIwB,EAAMD,EAAO,GAEjB,IAAM,IAAIzB,EAAI,EAAGC,EAAIwB,EAAMvB,OAAQF,EAAIC,IAAMD,EAEvCyB,EAAOzB,GAAM0B,IAAMA,EAAMD,EAAOzB,IAItC,OAAO0B,EAsBR,SAASC,EAAiBC,GAEzB,OAAOC,SAASF,gBAAiB,+BAAgCC,GAkBlE,SAASE,EAAYC,EAAKC,EAAO,GAEhC,IAAIC,EAAK,WAAaD,EAAME,EAAK,WAAaF,EAE9C,IAAM,IAAWG,EAAPnC,EAAI,EAAOA,EAAI+B,EAAI7B,OAAQF,IAEpCmC,EAAKJ,EAAIK,WAAYpC,GAErBiC,EAAKI,KAAKC,KAAML,EAAKE,EAAI,YAEzBD,EAAKG,KAAKC,KAAMJ,EAAKC,EAAI,YAQ1B,OAJAF,EAAKI,KAAKC,KAAML,EAAOA,IAAO,GAAM,YAAeI,KAAKC,KAAMJ,EAAOA,IAAO,GAAM,YAElFA,EAAKG,KAAKC,KAAMJ,EAAOA,IAAO,GAAM,YAAeG,KAAKC,KAAML,EAAOA,IAAO,GAAM,YAE3E,YAAe,QAAUC,IAASD,IAAO,GAvDrCM,UACCC,WACOC,kBACPC,WACCC,YACDC,WACCC,YACCC,aACAC,aCrCf,MAAMC,UAAoB1C,EAEzBlC,YAAamC,GAEZ0C,MAAO1C,GAIRM,KAAM5B,EAAKZ,EAAQC,EAAYC,QAEXQ,IAAdf,KAAK0C,OAAqBzB,EAAMjB,KAAK0C,KAAOzB,GAEjDA,EAAMjB,KAAKuC,QAAQnB,WAAYH,GAE/B,MAAMT,EAAQR,KAERkF,EAASvF,EAAMT,IAAK+B,GAE1B,QAAgBF,IAAXmE,EAYJ,OAVA1E,EAAM+B,QAAQvB,UAAWC,GAEzBkE,YAAY,WAEN9E,GAASA,EAAQ6E,GAEtB1E,EAAM+B,QAAQrB,QAASD,KAErB,GAEIiE,EAIR,MAAME,EAAQzB,EAAiB,OAE/B,SAAS0B,IAERC,IAEA3F,EAAMG,IAAKmB,EAAKjB,MAEXK,GAASA,EAAQL,MAEtBQ,EAAM+B,QAAQrB,QAASD,GAIxB,SAASsE,EAAcC,GAEtBF,IAEK/E,GAAUA,EAASiF,GAExBhF,EAAM+B,QAAQpB,UAAWF,GACzBT,EAAM+B,QAAQrB,QAASD,GAIxB,SAASqE,IAERF,EAAMK,oBAAqB,OAAQJ,GAAa,GAChDD,EAAMK,oBAAqB,QAASF,GAAc,GAiBnD,OAbAH,EAAMM,iBAAkB,OAAQL,GAAa,GAC7CD,EAAMM,iBAAkB,QAASH,GAAc,GAEnB,UAAvBtE,EAAI0E,OAAQ,EAAG,SAEO5E,IAArBf,KAAKwC,cAA4B4C,EAAM5C,YAAcxC,KAAKwC,aAIhEhC,EAAM+B,QAAQvB,UAAWC,GAEzBmE,EAAMQ,IAAM3E,EAELmE,GC/ET,MAAMS,EAELH,iBAAkBI,EAAMC,QAEEhF,IAApBf,KAAKgG,aAA2BhG,KAAKgG,WAAa,IAEvD,MAAMC,EAAYjG,KAAKgG,gBAEIjF,IAAtBkF,EAAWH,KAEfG,EAAWH,GAAS,KAI4B,IAA5CG,EAAWH,GAAOjE,QAASkE,IAE/BE,EAAWH,GAAOpE,KAAMqE,GAM1BG,iBAAkBJ,EAAMC,GAEvB,QAAyBhF,IAApBf,KAAKgG,WAA2B,OAAO,EAE5C,MAAMC,EAAYjG,KAAKgG,WAEvB,YAA6BjF,IAAtBkF,EAAWH,KAAoE,IAA5CG,EAAWH,GAAOjE,QAASkE,GAItEN,oBAAqBK,EAAMC,GAE1B,QAAyBhF,IAApBf,KAAKgG,WAA2B,OAErC,MACMG,EADYnG,KAAKgG,WACUF,GAEjC,QAAuB/E,IAAlBoF,EAA8B,CAElC,MAAMvE,EAAQuE,EAActE,QAASkE,IAEpB,IAAZnE,GAEJuE,EAAcrE,OAAQF,EAAO,IAQhCwE,cAAeZ,GAEd,QAAyBzE,IAApBf,KAAKgG,WAA2B,OAErC,MACMG,EADYnG,KAAKgG,WACUR,EAAMM,MAEvC,QAAuB/E,IAAlBoF,EAA8B,CAElCX,EAAMa,OAASrG,KAGf,MAAMyD,EAAQ0C,EAAcG,MAAO,GAEnC,IAAM,IAAItE,EAAI,EAAGC,EAAIwB,EAAMvB,OAAQF,EAAIC,EAAGD,IAEzCyB,EAAOzB,GAAIzC,KAAMS,KAAMwF,GAIxBA,EAAMa,OAAS,OC7EX,MAsBME,EAAc,IAmCdC,EAAwB,IACxBC,EAAwB,IACxBC,EAAmC,IAEnCC,EAA0B,IAE1BC,EAAiB,IACjBC,EAAsB,KACtBC,EAAyB,KACzBC,EAAgB,KAChBC,EAA6B,KAE7BC,EAA4B,KAE5BC,EAAe,KAGfC,EAA2B,KAE3BC,EAAmB,KAGnBC,EAAoB,KAEpBC,EAAkB,KAClBC,EAAY,KACZC,EAAgB,KAIhBC,EAAqB,KAErBC,EAAY,KACZC,EAAa,KAIbC,EAAc,KACdC,EAAqB,KAmDrBC,EAAsB,KACtBC,EAAoB,KACpBC,EAAoB,KASpBC,EAAiB,IACjBC,EAAe,KACfC,EAAgB,KAChBC,EAAe,KAWfC,EAAgB,KAiBhBC,EAAkB,MAWlBC,EAAQ,SCrMfC,EAAUnE,KAAKoE,GAAK,IACpBC,EAAU,IAAMrE,KAAKoE,GAIrBE,EAAO,GAEb,IAAM,IAAI3G,EAAI,EAAGA,EAAI,IAAKA,IAEzB2G,EAAM3G,IAAQA,EAAI,GAAK,IAAM,IAAO,EAAM4G,SAAU,IAIrD,MAAMC,EAAkC,oBAAXC,QAA0B,eAAgBA,OAEvE,SAASC,IAER,GAAKF,EAEJ,OAAOC,OAAOE,aAAaC,cAO5B,MAAMC,EAAqB,WAAhB7E,KAAK8E,SAAwB,EAClCC,EAAqB,WAAhB/E,KAAK8E,SAAwB,EAClCE,EAAqB,WAAhBhF,KAAK8E,SAAwB,EAClCG,EAAqB,WAAhBjF,KAAK8E,SAAwB,EAOxC,OANaR,EAAW,IAALO,GAAcP,EAAMO,GAAM,EAAI,KAASP,EAAMO,GAAM,GAAK,KAASP,EAAMO,GAAM,GAAK,KAAS,IAC5GP,EAAW,IAALS,GAAcT,EAAMS,GAAM,EAAI,KAAS,IAAMT,EAAMS,GAAM,GAAK,GAAO,IAAST,EAAMS,GAAM,GAAK,KAAS,IAC9GT,EAAW,GAALU,EAAY,KAASV,EAAMU,GAAM,EAAI,KAAS,IAAMV,EAAMU,GAAM,GAAK,KAASV,EAAMU,GAAM,GAAK,KACrGV,EAAW,IAALW,GAAcX,EAAMW,GAAM,EAAI,KAASX,EAAMW,GAAM,GAAK,KAASX,EAAMW,GAAM,GAAK,MAG9EL,cAIb,SAASM,EAAO7J,EAAO8J,EAAK9F,GAE3B,OAAOW,KAAKX,IAAK8F,EAAKnF,KAAKmF,IAAK9F,EAAKhE,IAmCtC,SAAS+J,EAAMC,EAAGC,EAAGC,GAEpB,OAAS,EAAIA,GAAMF,EAAIE,EAAID,EA2E5B,SAASE,EAAUC,GAElB,OAAOA,EAAUtB,EAUlB,SAAS,EAAc9I,GAEtB,OAAqC,IAA5BA,EAAUA,EAAQ,IAAyB,IAAVA,EAU3C,SAASqK,EAAiBrK,GAEzB,OAAO2E,KAAK2F,IAAK,EAAG3F,KAAK4F,MAAO5F,KAAK6F,IAAKxK,GAAU2E,KAAK8F,MCtL1D,MAAMC,GAELhK,YAAasJ,EAAI,EAAGC,EAAI,GAEvB3J,KAAK0J,EAAIA,EACT1J,KAAK2J,EAAIA,EAINU,YAEH,OAAOrK,KAAK0J,EAITW,UAAO3K,GAEVM,KAAK0J,EAAIhK,EAIN4K,aAEH,OAAOtK,KAAK2J,EAITW,WAAQ5K,GAEXM,KAAK2J,EAAIjK,EAIV6K,IAAKb,EAAGC,GAKP,OAHA3J,KAAK0J,EAAIA,EACT1J,KAAK2J,EAAIA,EAEF3J,KAIRwK,UAAWC,GAKV,OAHAzK,KAAK0J,EAAIe,EACTzK,KAAK2J,EAAIc,EAEFzK,KAIR0K,KAAMhB,GAIL,OAFA1J,KAAK0J,EAAIA,EAEF1J,KAIR2K,KAAMhB,GAIL,OAFA3J,KAAK2J,EAAIA,EAEF3J,KAIR4K,aAAchJ,EAAOlC,GAEpB,OAASkC,GAER,KAAK,EAAG5B,KAAK0J,EAAIhK,EAAO,MACxB,KAAK,EAAGM,KAAK2J,EAAIjK,EAAO,MACxB,QAAS,MAAM,IAAImL,MAAO,0BAA4BjJ,GAIvD,OAAO5B,KAIR8K,aAAclJ,GAEb,OAASA,GAER,KAAK,EAAG,OAAO5B,KAAK0J,EACpB,KAAK,EAAG,OAAO1J,KAAK2J,EACpB,QAAS,MAAM,IAAIkB,MAAO,0BAA4BjJ,IAMxDmJ,QAEC,OAAO,IAAI/K,KAAKI,YAAaJ,KAAK0J,EAAG1J,KAAK2J,GAI3CqB,KAAMC,GAKL,OAHAjL,KAAK0J,EAAIuB,EAAEvB,EACX1J,KAAK2J,EAAIsB,EAAEtB,EAEJ3J,KAIRF,IAAKmL,EAAGC,GAEP,YAAWnK,IAANmK,GAEJC,QAAQC,KAAM,yFACPpL,KAAKqL,WAAYJ,EAAGC,KAI5BlL,KAAK0J,GAAKuB,EAAEvB,EACZ1J,KAAK2J,GAAKsB,EAAEtB,EAEL3J,MAIRsL,UAAWC,GAKV,OAHAvL,KAAK0J,GAAK6B,EACVvL,KAAK2J,GAAK4B,EAEHvL,KAIRqL,WAAYG,EAAGC,GAKd,OAHAzL,KAAK0J,EAAI8B,EAAE9B,EAAI+B,EAAE/B,EACjB1J,KAAK2J,EAAI6B,EAAE7B,EAAI8B,EAAE9B,EAEV3J,KAIR0L,gBAAiBT,EAAGM,GAKnB,OAHAvL,KAAK0J,GAAKuB,EAAEvB,EAAI6B,EAChBvL,KAAK2J,GAAKsB,EAAEtB,EAAI4B,EAETvL,KAIR2L,IAAKV,EAAGC,GAEP,YAAWnK,IAANmK,GAEJC,QAAQC,KAAM,yFACPpL,KAAK4L,WAAYX,EAAGC,KAI5BlL,KAAK0J,GAAKuB,EAAEvB,EACZ1J,KAAK2J,GAAKsB,EAAEtB,EAEL3J,MAIR6L,UAAWN,GAKV,OAHAvL,KAAK0J,GAAK6B,EACVvL,KAAK2J,GAAK4B,EAEHvL,KAIR4L,WAAYJ,EAAGC,GAKd,OAHAzL,KAAK0J,EAAI8B,EAAE9B,EAAI+B,EAAE/B,EACjB1J,KAAK2J,EAAI6B,EAAE7B,EAAI8B,EAAE9B,EAEV3J,KAIR8L,SAAUb,GAKT,OAHAjL,KAAK0J,GAAKuB,EAAEvB,EACZ1J,KAAK2J,GAAKsB,EAAEtB,EAEL3J,KAIR+L,eAAgBtB,GAKf,OAHAzK,KAAK0J,GAAKe,EACVzK,KAAK2J,GAAKc,EAEHzK,KAIRgM,OAAQf,GAKP,OAHAjL,KAAK0J,GAAKuB,EAAEvB,EACZ1J,KAAK2J,GAAKsB,EAAEtB,EAEL3J,KAIRiM,aAAcxB,GAEb,OAAOzK,KAAK+L,eAAgB,EAAItB,GAIjCyB,aAAcC,GAEb,MAAMzC,EAAI1J,KAAK0J,EAAGC,EAAI3J,KAAK2J,EACrByC,EAAID,EAAEE,SAKZ,OAHArM,KAAK0J,EAAI0C,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,GACtCpM,KAAK2J,EAAIyC,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,GAE/BpM,KAIRwJ,IAAKyB,GAKJ,OAHAjL,KAAK0J,EAAIrF,KAAKmF,IAAKxJ,KAAK0J,EAAGuB,EAAEvB,GAC7B1J,KAAK2J,EAAItF,KAAKmF,IAAKxJ,KAAK2J,EAAGsB,EAAEtB,GAEtB3J,KAIR0D,IAAKuH,GAKJ,OAHAjL,KAAK0J,EAAIrF,KAAKX,IAAK1D,KAAK0J,EAAGuB,EAAEvB,GAC7B1J,KAAK2J,EAAItF,KAAKX,IAAK1D,KAAK2J,EAAGsB,EAAEtB,GAEtB3J,KAIRuJ,MAAOC,EAAK9F,GAOX,OAHA1D,KAAK0J,EAAIrF,KAAKX,IAAK8F,EAAIE,EAAGrF,KAAKmF,IAAK9F,EAAIgG,EAAG1J,KAAK0J,IAChD1J,KAAK2J,EAAItF,KAAKX,IAAK8F,EAAIG,EAAGtF,KAAKmF,IAAK9F,EAAIiG,EAAG3J,KAAK2J,IAEzC3J,KAIRsM,YAAaC,EAAQC,GAKpB,OAHAxM,KAAK0J,EAAIrF,KAAKX,IAAK6I,EAAQlI,KAAKmF,IAAKgD,EAAQxM,KAAK0J,IAClD1J,KAAK2J,EAAItF,KAAKX,IAAK6I,EAAQlI,KAAKmF,IAAKgD,EAAQxM,KAAK2J,IAE3C3J,KAIRyM,YAAajD,EAAK9F,GAEjB,MAAMxB,EAASlC,KAAKkC,SAEpB,OAAOlC,KAAKiM,aAAc/J,GAAU,GAAI6J,eAAgB1H,KAAKX,IAAK8F,EAAKnF,KAAKmF,IAAK9F,EAAKxB,KAIvF+H,QAKC,OAHAjK,KAAK0J,EAAIrF,KAAK4F,MAAOjK,KAAK0J,GAC1B1J,KAAK2J,EAAItF,KAAK4F,MAAOjK,KAAK2J,GAEnB3J,KAIR0M,OAKC,OAHA1M,KAAK0J,EAAIrF,KAAKqI,KAAM1M,KAAK0J,GACzB1J,KAAK2J,EAAItF,KAAKqI,KAAM1M,KAAK2J,GAElB3J,KAIR2M,QAKC,OAHA3M,KAAK0J,EAAIrF,KAAKsI,MAAO3M,KAAK0J,GAC1B1J,KAAK2J,EAAItF,KAAKsI,MAAO3M,KAAK2J,GAEnB3J,KAIR4M,cAKC,OAHA5M,KAAK0J,EAAM1J,KAAK0J,EAAI,EAAMrF,KAAKqI,KAAM1M,KAAK0J,GAAMrF,KAAK4F,MAAOjK,KAAK0J,GACjE1J,KAAK2J,EAAM3J,KAAK2J,EAAI,EAAMtF,KAAKqI,KAAM1M,KAAK2J,GAAMtF,KAAK4F,MAAOjK,KAAK2J,GAE1D3J,KAIR6M,SAKC,OAHA7M,KAAK0J,GAAM1J,KAAK0J,EAChB1J,KAAK2J,GAAM3J,KAAK2J,EAET3J,KAIR8M,IAAK7B,GAEJ,OAAOjL,KAAK0J,EAAIuB,EAAEvB,EAAI1J,KAAK2J,EAAIsB,EAAEtB,EAIlCoD,MAAO9B,GAEN,OAAOjL,KAAK0J,EAAIuB,EAAEtB,EAAI3J,KAAK2J,EAAIsB,EAAEvB,EAIlCsD,WAEC,OAAOhN,KAAK0J,EAAI1J,KAAK0J,EAAI1J,KAAK2J,EAAI3J,KAAK2J,EAIxCzH,SAEC,OAAOmC,KAAK4I,KAAMjN,KAAK0J,EAAI1J,KAAK0J,EAAI1J,KAAK2J,EAAI3J,KAAK2J,GAInDuD,kBAEC,OAAO7I,KAAK8I,IAAKnN,KAAK0J,GAAMrF,KAAK8I,IAAKnN,KAAK2J,GAI5CyD,YAEC,OAAOpN,KAAKiM,aAAcjM,KAAKkC,UAAY,GAI5CmL,QAMC,OAFchJ,KAAKiJ,OAAStN,KAAK2J,GAAK3J,KAAK0J,GAAMrF,KAAKoE,GAMvD8E,WAAYtC,GAEX,OAAO5G,KAAK4I,KAAMjN,KAAKwN,kBAAmBvC,IAI3CuC,kBAAmBvC,GAElB,MAAMwC,EAAKzN,KAAK0J,EAAIuB,EAAEvB,EAAGgE,EAAK1N,KAAK2J,EAAIsB,EAAEtB,EACzC,OAAO8D,EAAKA,EAAKC,EAAKA,EAIvBC,oBAAqB1C,GAEpB,OAAO5G,KAAK8I,IAAKnN,KAAK0J,EAAIuB,EAAEvB,GAAMrF,KAAK8I,IAAKnN,KAAK2J,EAAIsB,EAAEtB,GAIxDiE,UAAW1L,GAEV,OAAOlC,KAAKoN,YAAYrB,eAAgB7J,GAIzCuH,KAAMwB,EAAG4C,GAKR,OAHA7N,KAAK0J,IAAOuB,EAAEvB,EAAI1J,KAAK0J,GAAMmE,EAC7B7N,KAAK2J,IAAOsB,EAAEtB,EAAI3J,KAAK2J,GAAMkE,EAEtB7N,KAIR8N,YAAaC,EAAIC,EAAIH,GAKpB,OAHA7N,KAAK0J,EAAIqE,EAAGrE,GAAMsE,EAAGtE,EAAIqE,EAAGrE,GAAMmE,EAClC7N,KAAK2J,EAAIoE,EAAGpE,GAAMqE,EAAGrE,EAAIoE,EAAGpE,GAAMkE,EAE3B7N,KAIRiO,OAAQhD,GAEP,OAAWA,EAAEvB,IAAM1J,KAAK0J,GAASuB,EAAEtB,IAAM3J,KAAK2J,EAI/CuE,UAAWzK,EAAO0K,EAAS,GAK1B,OAHAnO,KAAK0J,EAAIjG,EAAO0K,GAChBnO,KAAK2J,EAAIlG,EAAO0K,EAAS,GAElBnO,KAIRoO,QAAS3K,EAAQ,GAAI0K,EAAS,GAK7B,OAHA1K,EAAO0K,GAAWnO,KAAK0J,EACvBjG,EAAO0K,EAAS,GAAMnO,KAAK2J,EAEpBlG,EAIR4K,oBAAqBC,EAAW1M,EAAOuM,GAWtC,YATgBpN,IAAXoN,GAEJhD,QAAQC,KAAM,uEAIfpL,KAAK0J,EAAI4E,EAAUC,KAAM3M,GACzB5B,KAAK2J,EAAI2E,EAAUE,KAAM5M,GAElB5B,KAIRyO,aAAcC,EAAQrB,GAErB,MAAMsB,EAAItK,KAAKuK,IAAKvB,GAAS9B,EAAIlH,KAAKwK,IAAKxB,GAErC3D,EAAI1J,KAAK0J,EAAIgF,EAAOhF,EACpBC,EAAI3J,KAAK2J,EAAI+E,EAAO/E,EAK1B,OAHA3J,KAAK0J,EAAIA,EAAIiF,EAAIhF,EAAI4B,EAAImD,EAAOhF,EAChC1J,KAAK2J,EAAID,EAAI6B,EAAI5B,EAAIgF,EAAID,EAAO/E,EAEzB3J,KAIRmJ,SAKC,OAHAnJ,KAAK0J,EAAIrF,KAAK8E,SACdnJ,KAAK2J,EAAItF,KAAK8E,SAEPnJ,KAIR,EAAGR,OAAOsP,kBAEH9O,KAAK0J,QACL1J,KAAK2J,GAMbS,GAAQ/K,UAAU0P,WAAY,ECje9B,MAAMC,GAEL5O,cAECJ,KAAKqM,SAAW,CAEf,EAAG,EAAG,EACN,EAAG,EAAG,EACN,EAAG,EAAG,GAIF4C,UAAU/M,OAAS,GAEvBiJ,QAAQ+D,MAAO,iFAMjB3E,IAAK4E,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,GAE5C,MAAMC,EAAK5P,KAAKqM,SAMhB,OAJAuD,EAAI,GAAMT,EAAKS,EAAI,GAAMN,EAAKM,EAAI,GAAMH,EACxCG,EAAI,GAAMR,EAAKQ,EAAI,GAAML,EAAKK,EAAI,GAAMF,EACxCE,EAAI,GAAMP,EAAKO,EAAI,GAAMJ,EAAKI,EAAI,GAAMD,EAEjC3P,KAIR6P,WAUC,OARA7P,KAAKuK,IAEJ,EAAG,EAAG,EACN,EAAG,EAAG,EACN,EAAG,EAAG,GAIAvK,KAIRgL,KAAMmB,GAEL,MAAMyD,EAAK5P,KAAKqM,SACVyD,EAAK3D,EAAEE,SAMb,OAJAuD,EAAI,GAAME,EAAI,GAAKF,EAAI,GAAME,EAAI,GAAKF,EAAI,GAAME,EAAI,GACpDF,EAAI,GAAME,EAAI,GAAKF,EAAI,GAAME,EAAI,GAAKF,EAAI,GAAME,EAAI,GACpDF,EAAI,GAAME,EAAI,GAAKF,EAAI,GAAME,EAAI,GAAKF,EAAI,GAAME,EAAI,GAE7C9P,KAIR+P,aAAcC,EAAOC,EAAOC,GAM3B,OAJAF,EAAMG,qBAAsBnQ,KAAM,GAClCiQ,EAAME,qBAAsBnQ,KAAM,GAClCkQ,EAAMC,qBAAsBnQ,KAAM,GAE3BA,KAIRoQ,eAAgBjE,GAEf,MAAM2D,EAAK3D,EAAEE,SAUb,OARArM,KAAKuK,IAEJuF,EAAI,GAAKA,EAAI,GAAKA,EAAI,GACtBA,EAAI,GAAKA,EAAI,GAAKA,EAAI,GACtBA,EAAI,GAAKA,EAAI,GAAKA,EAAI,KAIhB9P,KAIR8L,SAAUK,GAET,OAAOnM,KAAKqQ,iBAAkBrQ,KAAMmM,GAIrCmE,YAAanE,GAEZ,OAAOnM,KAAKqQ,iBAAkBlE,EAAGnM,MAIlCqQ,iBAAkB7E,EAAGC,GAEpB,MAAM8E,EAAK/E,EAAEa,SACPmE,EAAK/E,EAAEY,SACPuD,EAAK5P,KAAKqM,SAEVoE,EAAMF,EAAI,GAAKG,EAAMH,EAAI,GAAKI,EAAMJ,EAAI,GACxCK,EAAML,EAAI,GAAKM,EAAMN,EAAI,GAAKO,EAAMP,EAAI,GACxCQ,EAAMR,EAAI,GAAKS,EAAMT,EAAI,GAAKU,EAAMV,EAAI,GAExCW,EAAMV,EAAI,GAAKW,EAAMX,EAAI,GAAKY,EAAMZ,EAAI,GACxCa,EAAMb,EAAI,GAAKc,EAAMd,EAAI,GAAKe,EAAMf,EAAI,GACxCgB,EAAMhB,EAAI,GAAKiB,EAAMjB,EAAI,GAAKkB,EAAMlB,EAAI,GAc9C,OAZAZ,EAAI,GAAMa,EAAMS,EAAMR,EAAMW,EAAMV,EAAMa,EACxC5B,EAAI,GAAMa,EAAMU,EAAMT,EAAMY,EAAMX,EAAMc,EACxC7B,EAAI,GAAMa,EAAMW,EAAMV,EAAMa,EAAMZ,EAAMe,EAExC9B,EAAI,GAAMgB,EAAMM,EAAML,EAAMQ,EAAMP,EAAMU,EACxC5B,EAAI,GAAMgB,EAAMO,EAAMN,EAAMS,EAAMR,EAAMW,EACxC7B,EAAI,GAAMgB,EAAMQ,EAAMP,EAAMU,EAAMT,EAAMY,EAExC9B,EAAI,GAAMmB,EAAMG,EAAMF,EAAMK,EAAMJ,EAAMO,EACxC5B,EAAI,GAAMmB,EAAMI,EAAMH,EAAMM,EAAML,EAAMQ,EACxC7B,EAAI,GAAMmB,EAAMK,EAAMJ,EAAMO,EAAMN,EAAMS,EAEjC1R,KAIR+L,eAAgBR,GAEf,MAAMqE,EAAK5P,KAAKqM,SAMhB,OAJAuD,EAAI,IAAOrE,EAAGqE,EAAI,IAAOrE,EAAGqE,EAAI,IAAOrE,EACvCqE,EAAI,IAAOrE,EAAGqE,EAAI,IAAOrE,EAAGqE,EAAI,IAAOrE,EACvCqE,EAAI,IAAOrE,EAAGqE,EAAI,IAAOrE,EAAGqE,EAAI,IAAOrE,EAEhCvL,KAIR2R,cAEC,MAAM/B,EAAK5P,KAAKqM,SAEVb,EAAIoE,EAAI,GAAKnE,EAAImE,EAAI,GAAKjB,EAAIiB,EAAI,GACvCgC,EAAIhC,EAAI,GAAKxD,EAAIwD,EAAI,GAAKiC,EAAIjC,EAAI,GAClCkC,EAAIlC,EAAI,GAAKmC,EAAInC,EAAI,GAAK5N,EAAI4N,EAAI,GAEnC,OAAOpE,EAAIY,EAAIpK,EAAIwJ,EAAIqG,EAAIE,EAAItG,EAAImG,EAAI5P,EAAIyJ,EAAIoG,EAAIC,EAAInD,EAAIiD,EAAIG,EAAIpD,EAAIvC,EAAI0F,EAI5EE,SAEC,MAAMpC,EAAK5P,KAAKqM,SAEf8C,EAAMS,EAAI,GAAKN,EAAMM,EAAI,GAAKH,EAAMG,EAAI,GACxCR,EAAMQ,EAAI,GAAKL,EAAMK,EAAI,GAAKF,EAAME,EAAI,GACxCP,EAAMO,EAAI,GAAKJ,EAAMI,EAAI,GAAKD,EAAMC,EAAI,GAExCqC,EAAMtC,EAAMJ,EAAMG,EAAMF,EACxB0C,EAAMxC,EAAML,EAAMM,EAAMP,EACxB+C,EAAM3C,EAAMJ,EAAMG,EAAMF,EAExB+C,EAAMjD,EAAM8C,EAAM3C,EAAM4C,EAAMzC,EAAM0C,EAErC,GAAa,IAARC,EAAY,OAAOpS,KAAKuK,IAAK,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAE1D,MAAM8H,EAAS,EAAID,EAcnB,OAZAxC,EAAI,GAAMqC,EAAMI,EAChBzC,EAAI,IAAQH,EAAMD,EAAMG,EAAML,GAAQ+C,EACtCzC,EAAI,IAAQF,EAAMJ,EAAMG,EAAMF,GAAQ8C,EAEtCzC,EAAI,GAAMsC,EAAMG,EAChBzC,EAAI,IAAQD,EAAMR,EAAMM,EAAMJ,GAAQgD,EACtCzC,EAAI,IAAQH,EAAML,EAAMM,EAAMP,GAAQkD,EAEtCzC,EAAI,GAAMuC,EAAME,EAChBzC,EAAI,IAAQN,EAAMD,EAAMG,EAAML,GAAQkD,EACtCzC,EAAI,IAAQL,EAAMJ,EAAMG,EAAMF,GAAQiD,EAE/BrS,KAIRsS,YAEC,IAAIC,EACJ,MAAMpG,EAAInM,KAAKqM,SAMf,OAJAkG,EAAMpG,EAAG,GAAKA,EAAG,GAAMA,EAAG,GAAKA,EAAG,GAAMoG,EACxCA,EAAMpG,EAAG,GAAKA,EAAG,GAAMA,EAAG,GAAKA,EAAG,GAAMoG,EACxCA,EAAMpG,EAAG,GAAKA,EAAG,GAAMA,EAAG,GAAKA,EAAG,GAAMoG,EAEjCvS,KAIRwS,gBAAiBC,GAEhB,OAAOzS,KAAKoQ,eAAgBqC,GAAUT,SAASM,YAIhDI,mBAAoBC,GAEnB,MAAMxG,EAAInM,KAAKqM,SAYf,OAVAsG,EAAG,GAAMxG,EAAG,GACZwG,EAAG,GAAMxG,EAAG,GACZwG,EAAG,GAAMxG,EAAG,GACZwG,EAAG,GAAMxG,EAAG,GACZwG,EAAG,GAAMxG,EAAG,GACZwG,EAAG,GAAMxG,EAAG,GACZwG,EAAG,GAAMxG,EAAG,GACZwG,EAAG,GAAMxG,EAAG,GACZwG,EAAG,GAAMxG,EAAG,GAELnM,KAIR4S,eAAgBC,EAAIC,EAAIC,EAAIC,EAAIC,EAAUC,EAAIC,GAE7C,MAAMxE,EAAItK,KAAKuK,IAAKqE,GACd1H,EAAIlH,KAAKwK,IAAKoE,GAQpB,OANAjT,KAAKuK,IACJwI,EAAKpE,EAAGoE,EAAKxH,GAAKwH,GAAOpE,EAAIuE,EAAK3H,EAAI4H,GAAOD,EAAKL,GAChDG,EAAKzH,EAAGyH,EAAKrE,GAAKqE,IAASzH,EAAI2H,EAAKvE,EAAIwE,GAAOA,EAAKL,EACtD,EAAG,EAAG,GAGA9S,KAIRoT,MAAOL,EAAIC,GAEV,MAAMpD,EAAK5P,KAAKqM,SAKhB,OAHAuD,EAAI,IAAOmD,EAAInD,EAAI,IAAOmD,EAAInD,EAAI,IAAOmD,EACzCnD,EAAI,IAAOoD,EAAIpD,EAAI,IAAOoD,EAAIpD,EAAI,IAAOoD,EAElChT,KAIRqT,OAAQC,GAEP,MAAM3E,EAAItK,KAAKuK,IAAK0E,GACd/H,EAAIlH,KAAKwK,IAAKyE,GAEd1D,EAAK5P,KAAKqM,SAEVoE,EAAMb,EAAI,GAAKc,EAAMd,EAAI,GAAKe,EAAMf,EAAI,GACxCgB,EAAMhB,EAAI,GAAKiB,EAAMjB,EAAI,GAAKkB,EAAMlB,EAAI,GAU9C,OARAA,EAAI,GAAMjB,EAAI8B,EAAMlF,EAAIqF,EACxBhB,EAAI,GAAMjB,EAAI+B,EAAMnF,EAAIsF,EACxBjB,EAAI,GAAMjB,EAAIgC,EAAMpF,EAAIuF,EAExBlB,EAAI,IAAQrE,EAAIkF,EAAM9B,EAAIiC,EAC1BhB,EAAI,IAAQrE,EAAImF,EAAM/B,EAAIkC,EAC1BjB,EAAI,IAAQrE,EAAIoF,EAAMhC,EAAImC,EAEnB9Q,KAIRuT,UAAWV,EAAIC,GAEd,MAAMlD,EAAK5P,KAAKqM,SAKhB,OAHAuD,EAAI,IAAOiD,EAAKjD,EAAI,GAAKA,EAAI,IAAOiD,EAAKjD,EAAI,GAAKA,EAAI,IAAOiD,EAAKjD,EAAI,GACtEA,EAAI,IAAOkD,EAAKlD,EAAI,GAAKA,EAAI,IAAOkD,EAAKlD,EAAI,GAAKA,EAAI,IAAOkD,EAAKlD,EAAI,GAE/D5P,KAIRiO,OAAQuF,GAEP,MAAM5D,EAAK5P,KAAKqM,SACVyD,EAAK0D,EAAOnH,SAElB,IAAM,IAAIrK,EAAI,EAAGA,EAAI,EAAGA,IAEvB,GAAK4N,EAAI5N,KAAQ8N,EAAI9N,GAAM,OAAO,EAInC,OAAO,EAIRkM,UAAWzK,EAAO0K,EAAS,GAE1B,IAAM,IAAInM,EAAI,EAAGA,EAAI,EAAGA,IAEvBhC,KAAKqM,SAAUrK,GAAMyB,EAAOzB,EAAImM,GAIjC,OAAOnO,KAIRoO,QAAS3K,EAAQ,GAAI0K,EAAS,GAE7B,MAAMyB,EAAK5P,KAAKqM,SAchB,OAZA5I,EAAO0K,GAAWyB,EAAI,GACtBnM,EAAO0K,EAAS,GAAMyB,EAAI,GAC1BnM,EAAO0K,EAAS,GAAMyB,EAAI,GAE1BnM,EAAO0K,EAAS,GAAMyB,EAAI,GAC1BnM,EAAO0K,EAAS,GAAMyB,EAAI,GAC1BnM,EAAO0K,EAAS,GAAMyB,EAAI,GAE1BnM,EAAO0K,EAAS,GAAMyB,EAAI,GAC1BnM,EAAO0K,EAAS,GAAMyB,EAAI,GAC1BnM,EAAO0K,EAAS,GAAMyB,EAAI,GAEnBnM,EAIRsH,QAEC,OAAO,IAAI/K,KAAKI,aAAc8N,UAAWlO,KAAKqM,WCxUhD,IAAIoH,GD8UJzE,GAAQ3P,UAAUqU,WAAY,EE/T9B,IAAIC,GAAY,EAEhB,MAAMC,WAAgB/N,EAErBzF,YAAagF,EAAQwO,GAAQC,cAAeC,EAAUF,GAAQG,gBAAiBC,EAAQnN,KAAqBoN,EAAQpN,KAAqBqN,EAAYhN,KAAciN,EAAYhN,KAA0BiN,EAASzM,KAAY7B,EAAOsB,KAAkBiN,EAAa,EAAGC,EAAWrM,KAEjRhD,QAEAlG,OAAOC,eAAgBgB,KAAM,KAAM,CAAEN,MAAOiU,OAE5C3T,KAAKuU,KAAO,IAEZvU,KAAK4D,KAAO,GAEZ5D,KAAKoF,MAAQA,EACbpF,KAAKwU,QAAU,GAEfxU,KAAK8T,QAAUA,EAEf9T,KAAKgU,MAAQA,EACbhU,KAAKiU,MAAQA,EAEbjU,KAAKkU,UAAYA,EACjBlU,KAAKmU,UAAYA,EAEjBnU,KAAKqU,WAAaA,EAElBrU,KAAKoU,OAASA,EACdpU,KAAKyU,eAAiB,KACtBzU,KAAK8F,KAAOA,EAEZ9F,KAAKmO,OAAS,IAAI/D,GAAS,EAAG,GAC9BpK,KAAK0U,OAAS,IAAItK,GAAS,EAAG,GAC9BpK,KAAK0O,OAAS,IAAItE,GAAS,EAAG,GAC9BpK,KAAKiT,SAAW,EAEhBjT,KAAK2U,kBAAmB,EACxB3U,KAAKwT,OAAS,IAAIxE,GAElBhP,KAAK4U,iBAAkB,EACvB5U,KAAK6U,kBAAmB,EACxB7U,KAAK8U,OAAQ,EACb9U,KAAK+U,gBAAkB,EAMvB/U,KAAKsU,SAAWA,EAEhBtU,KAAKgV,SAAW,GAEhBhV,KAAKiV,QAAU,EACfjV,KAAKkV,SAAW,KAEhBlV,KAAKmV,uBAAwB,EAI9BC,eAECpV,KAAKwT,OAAOZ,eAAgB5S,KAAKmO,OAAOzE,EAAG1J,KAAKmO,OAAOxE,EAAG3J,KAAK0U,OAAOhL,EAAG1J,KAAK0U,OAAO/K,EAAG3J,KAAKiT,SAAUjT,KAAK0O,OAAOhF,EAAG1J,KAAK0O,OAAO/E,GAInIoB,QAEC,OAAO,IAAI/K,KAAKI,aAAc4K,KAAMhL,MAIrCgL,KAAMqK,GAqCL,OAnCArV,KAAK4D,KAAOyR,EAAOzR,KAEnB5D,KAAKoF,MAAQiQ,EAAOjQ,MACpBpF,KAAKwU,QAAUa,EAAOb,QAAQlO,MAAO,GAErCtG,KAAK8T,QAAUuB,EAAOvB,QAEtB9T,KAAKgU,MAAQqB,EAAOrB,MACpBhU,KAAKiU,MAAQoB,EAAOpB,MAEpBjU,KAAKkU,UAAYmB,EAAOnB,UACxBlU,KAAKmU,UAAYkB,EAAOlB,UAExBnU,KAAKqU,WAAagB,EAAOhB,WAEzBrU,KAAKoU,OAASiB,EAAOjB,OACrBpU,KAAKyU,eAAiBY,EAAOZ,eAC7BzU,KAAK8F,KAAOuP,EAAOvP,KAEnB9F,KAAKmO,OAAOnD,KAAMqK,EAAOlH,QACzBnO,KAAK0U,OAAO1J,KAAMqK,EAAOX,QACzB1U,KAAK0O,OAAO1D,KAAMqK,EAAO3G,QACzB1O,KAAKiT,SAAWoC,EAAOpC,SAEvBjT,KAAK2U,iBAAmBU,EAAOV,iBAC/B3U,KAAKwT,OAAOxI,KAAMqK,EAAO7B,QAEzBxT,KAAK4U,gBAAkBS,EAAOT,gBAC9B5U,KAAK6U,iBAAmBQ,EAAOR,iBAC/B7U,KAAK8U,MAAQO,EAAOP,MACpB9U,KAAK+U,gBAAkBM,EAAON,gBAC9B/U,KAAKsU,SAAWe,EAAOf,SAEvBtU,KAAKgV,SAAWM,KAAKpS,MAAOoS,KAAKC,UAAWF,EAAOL,WAE5ChV,KAIRwV,OAAQC,GAEP,MAAMC,OAA0B3U,IAAT0U,GAAsC,iBAATA,EAEpD,IAAOC,QAA+C3U,IAA/B0U,EAAKE,SAAU3V,KAAKuU,MAE1C,OAAOkB,EAAKE,SAAU3V,KAAKuU,MAI5B,MAAMqB,EAAS,CAEdC,SAAU,CACTZ,QAAS,IACTnP,KAAM,UACNgQ,UAAW,kBAGZvB,KAAMvU,KAAKuU,KACX3Q,KAAM5D,KAAK4D,KAEXkQ,QAAS9T,KAAK8T,QAEdY,OAAQ,CAAE1U,KAAK0U,OAAOhL,EAAG1J,KAAK0U,OAAO/K,GACrCwE,OAAQ,CAAEnO,KAAKmO,OAAOzE,EAAG1J,KAAKmO,OAAOxE,GACrC+E,OAAQ,CAAE1O,KAAK0O,OAAOhF,EAAG1J,KAAK0O,OAAO/E,GACrCsJ,SAAUjT,KAAKiT,SAEf8C,KAAM,CAAE/V,KAAKgU,MAAOhU,KAAKiU,OAEzBG,OAAQpU,KAAKoU,OACbtO,KAAM9F,KAAK8F,KACXwO,SAAUtU,KAAKsU,SAEfH,UAAWnU,KAAKmU,UAChBD,UAAWlU,KAAKkU,UAChBG,WAAYrU,KAAKqU,WAEjBS,MAAO9U,KAAK8U,MAEZD,iBAAkB7U,KAAK6U,iBACvBE,gBAAiB/U,KAAK+U,iBAIvB,QAAoBhU,IAAff,KAAKoF,MAAsB,CAI/B,MAAMA,EAAQpF,KAAKoF,MAQnB,QANoBrE,IAAfqE,EAAMmP,OAEVnP,EAAMmP,KAAO,MAIPmB,QAA8C3U,IAA9B0U,EAAKO,OAAQ5Q,EAAMmP,MAAuB,CAEhE,IAAItT,EAEJ,GAAKgV,MAAMC,QAAS9Q,GAAU,CAI7BnE,EAAM,GAEN,IAAM,IAAIe,EAAI,EAAGC,EAAImD,EAAMlD,OAAQF,EAAIC,EAAGD,IAIpCoD,EAAOpD,GAAImU,cAEflV,EAAIS,KAAM0U,GAAgBhR,EAAOpD,GAAIoD,QAIrCnE,EAAIS,KAAM0U,GAAgBhR,EAAOpD,UAUnCf,EAAMmV,GAAgBhR,GAIvBqQ,EAAKO,OAAQ5Q,EAAMmP,MAAS,CAC3BA,KAAMnP,EAAMmP,KACZtT,IAAKA,GAKP2U,EAAOxQ,MAAQA,EAAMmP,KAYtB,MARyC,OAApCe,KAAKC,UAAWvV,KAAKgV,YAAsBY,EAAOZ,SAAWhV,KAAKgV,UAEhEU,IAEND,EAAKE,SAAU3V,KAAKuU,MAASqB,GAIvBA,EAIRS,UAECrW,KAAKoG,cAAe,CAAEN,KAAM,YAI7BwQ,YAAaC,GAEZ,GLnMuB,MKmMlBvW,KAAK8T,QAAwB,OAAOyC,EAIzC,GAFAA,EAAGrK,aAAclM,KAAKwT,QAEjB+C,EAAG7M,EAAI,GAAK6M,EAAG7M,EAAI,EAEvB,OAAS1J,KAAKgU,OAEb,KAAKpN,EAEJ2P,EAAG7M,EAAI6M,EAAG7M,EAAIrF,KAAK4F,MAAOsM,EAAG7M,GAC7B,MAED,KAAK7C,EAEJ0P,EAAG7M,EAAI6M,EAAG7M,EAAI,EAAI,EAAI,EACtB,MAED,KAAK5C,EAEwC,IAAvCzC,KAAK8I,IAAK9I,KAAK4F,MAAOsM,EAAG7M,GAAM,GAEnC6M,EAAG7M,EAAIrF,KAAKqI,KAAM6J,EAAG7M,GAAM6M,EAAG7M,EAI9B6M,EAAG7M,EAAI6M,EAAG7M,EAAIrF,KAAK4F,MAAOsM,EAAG7M,GAUjC,GAAK6M,EAAG5M,EAAI,GAAK4M,EAAG5M,EAAI,EAEvB,OAAS3J,KAAKiU,OAEb,KAAKrN,EAEJ2P,EAAG5M,EAAI4M,EAAG5M,EAAItF,KAAK4F,MAAOsM,EAAG5M,GAC7B,MAED,KAAK9C,EAEJ0P,EAAG5M,EAAI4M,EAAG5M,EAAI,EAAI,EAAI,EACtB,MAED,KAAK7C,EAEwC,IAAvCzC,KAAK8I,IAAK9I,KAAK4F,MAAOsM,EAAG5M,GAAM,GAEnC4M,EAAG5M,EAAItF,KAAKqI,KAAM6J,EAAG5M,GAAM4M,EAAG5M,EAI9B4M,EAAG5M,EAAI4M,EAAG5M,EAAItF,KAAK4F,MAAOsM,EAAG5M,GAgBjC,OANK3J,KAAK8U,QAETyB,EAAG5M,EAAI,EAAI4M,EAAG5M,GAIR4M,EAIJC,gBAAa9W,IAED,IAAVA,GAAiBM,KAAKiV,WAW7B,SAASmB,GAAgBhR,GAExB,MAAmC,oBAArBqR,kBAAoCrR,aAAiBqR,kBACnC,oBAAtBC,mBAAqCtR,aAAiBsR,mBACtC,oBAAhBC,aAA+BvR,aAAiBuR,YDtV3D,MAECC,kBAAmBxR,GAElB,GAAK,UAAU/C,KAAM+C,EAAMQ,KAE1B,OAAOR,EAAMQ,IAId,GAAiC,oBAArB8Q,kBAEX,OAAOtR,EAAMQ,IAId,IAAIiR,EAEJ,GAAKzR,aAAiBsR,kBAErBG,EAASzR,MAEH,MAEWrE,IAAZ0S,KAAwBA,GAAU9P,EAAiB,WAExD8P,GAAQpJ,MAAQjF,EAAMiF,MACtBoJ,GAAQnJ,OAASlF,EAAMkF,OAEvB,MAAMwM,EAAUrD,GAAQsD,WAAY,MAE/B3R,aAAiB4R,UAErBF,EAAQG,aAAc7R,EAAO,EAAG,GAIhC0R,EAAQI,UAAW9R,EAAO,EAAG,EAAGA,EAAMiF,MAAOjF,EAAMkF,QAIpDuM,EAASpD,GAIV,OAAKoD,EAAOxM,MAAQ,MAAQwM,EAAOvM,OAAS,MAE3Ca,QAAQC,KAAM,8EAA+EhG,GAEtFyR,EAAOM,UAAW,aAAc,KAIhCN,EAAOM,UAAW,eCqSRC,WAAYhS,GAIzBA,EAAMiS,KAIH,CACNA,KAAMpB,MAAM5W,UAAUiH,MAAM/G,KAAM6F,EAAMiS,MACxChN,MAAOjF,EAAMiF,MACbC,OAAQlF,EAAMkF,OACdxE,KAAMV,EAAMiS,KAAKjX,YAAYwD,OAK9BuH,QAAQC,KAAM,+CACP,IA/BVwI,GAAQC,mBAAgB9S,EACxB6S,GAAQG,gBL1RiB,IK4RzBH,GAAQvU,UAAUiY,WAAY,EChV9B,MAAMC,WAAsBjV,EAE3BlC,YAAamC,GAEZ0C,MAAO1C,GAIRM,KAAM5B,EAAKZ,EAAQC,EAAYC,GAE9B,MAAMiX,EAAU,IAAI5D,GAEdnS,EAAS,IAAIuD,EAAahF,KAAKuC,SAiBrC,OAhBAd,EAAO0B,eAAgBnD,KAAKwC,aAC5Bf,EAAO4B,QAASrD,KAAK0C,MAErBjB,EAAOoB,KAAM5B,GAAK,SAAWmE,GAE5BoS,EAAQpS,MAAQA,EAChBoS,EAAQhB,aAAc,OAENzV,IAAXV,GAEJA,EAAQmX,KAIPlX,EAAYC,GAERiX,GC7BT,IAAIC,GAAa,EAEjB,MAAMC,WAAiB7R,EAEtBzF,cAEC6E,QAEAlG,OAAOC,eAAgBgB,KAAM,KAAM,CAAEN,MAAO+X,OAE5CzX,KAAKuU,KAAO,IAEZvU,KAAK4D,KAAO,GACZ5D,KAAK8F,KAAO,WAEZ9F,KAAK2X,KAAM,EAEX3X,KAAK4X,SPJuB,EOK5B5X,KAAK6X,KPXkB,EOYvB7X,KAAK8X,cAAe,EAEpB9X,KAAK+X,QAAU,EACf/X,KAAKoU,OAASzM,EACd3H,KAAKgY,aAAc,EAEnBhY,KAAKiY,SPEuB,IOD5BjY,KAAKkY,SPE+B,IODpClY,KAAKmY,cAAgB5R,EACrBvG,KAAKoY,cAAgB,KACrBpY,KAAKqY,cAAgB,KACrBrY,KAAKsY,mBAAqB,KAE1BtY,KAAKuY,UPKuB,EOJ5BvY,KAAKwY,WAAY,EACjBxY,KAAKyY,YAAa,EAElBzY,KAAK0Y,iBAAmB,IACxB1Y,KAAK2Y,YPiJ0B,IOhJ/B3Y,KAAK4Y,WAAa,EAClB5Y,KAAK6Y,gBAAkB,IACvB7Y,KAAK8Y,YAAczQ,EACnBrI,KAAK+Y,aAAe1Q,EACpBrI,KAAKgZ,aAAe3Q,EACpBrI,KAAKiZ,cAAe,EAEpBjZ,KAAKkZ,eAAiB,KACtBlZ,KAAKmZ,kBAAmB,EACxBnZ,KAAKoZ,aAAc,EAEnBpZ,KAAKqZ,WAAa,KAElBrZ,KAAKsZ,YAAa,EAElBtZ,KAAKuZ,UAAY,KAEjBvZ,KAAKwZ,eAAgB,EACrBxZ,KAAKyZ,oBAAsB,EAC3BzZ,KAAK0Z,mBAAqB,EAE1B1Z,KAAK2Z,WAAY,EAEjB3Z,KAAK4Z,iBAAkB,EACvB5Z,KAAK6Z,oBAAqB,EAE1B7Z,KAAK8Z,SAAU,EAEf9Z,KAAK+Z,YAAa,EAElB/Z,KAAKgV,SAAW,GAEhBhV,KAAKiV,QAAU,EAEfjV,KAAKga,WAAa,EAIfC,gBAEH,OAAOja,KAAKga,WAITC,cAAWva,GAETM,KAAKga,WAAa,GAAMta,EAAQ,GAEpCM,KAAKiV,UAINjV,KAAKga,WAAata,EAInBwa,WAEAC,kBAEAC,mBAEAC,wBAEC,OAAOra,KAAKoa,gBAAgBxR,WAI7B0R,UAAWC,GAEV,QAAgBxZ,IAAXwZ,EAEL,IAAM,MAAM1b,KAAO0b,EAAS,CAE3B,MAAMC,EAAWD,EAAQ1b,GAEzB,QAAkBkC,IAAbyZ,EAAyB,CAE7BrP,QAAQC,KAAM,oBAAuBvM,EAAM,6BAC3C,SAKD,GAAa,YAARA,EAAoB,CAExBsM,QAAQC,KAAM,SAAWpL,KAAK8F,KAAO,sEACrC9F,KAAKya,YPnHkB,IOmHFD,EACrB,SAID,MAAME,EAAe1a,KAAMnB,QAELkC,IAAjB2Z,EAOAA,GAAgBA,EAAaC,QAEjCD,EAAanQ,IAAKiQ,GAELE,GAAgBA,EAAaE,WAAiBJ,GAAYA,EAASI,UAEhFF,EAAa1P,KAAMwP,GAInBxa,KAAMnB,GAAQ2b,EAfdrP,QAAQC,KAAM,SAAWpL,KAAK8F,KAAO,MAASjH,EAAM,0CAuBvD2W,OAAQC,GAEP,MAAMoF,OAAoB9Z,IAAT0U,GAAsC,iBAATA,EAEzCoF,IAEJpF,EAAO,CACNE,SAAU,GACVK,OAAQ,KAKV,MAAMqB,EAAO,CACZxB,SAAU,CACTZ,QAAS,IACTnP,KAAM,WACNgQ,UAAW,oBAoLb,SAASgF,EAAkBC,GAE1B,MAAMR,EAAS,GAEf,IAAM,MAAM1b,KAAOkc,EAAQ,CAE1B,MAAM1D,EAAO0D,EAAOlc,UACbwY,EAAKxB,SACZ0E,EAAO7Y,KAAM2V,GAId,OAAOkD,EAIR,GA/LAlD,EAAK9C,KAAOvU,KAAKuU,KACjB8C,EAAKvR,KAAO9F,KAAK8F,KAEE,KAAd9F,KAAK4D,OAAcyT,EAAKzT,KAAO5D,KAAK4D,MAEpC5D,KAAKgb,OAAShb,KAAKgb,MAAML,UAAUtD,EAAK2D,MAAQhb,KAAKgb,MAAMC,eAExCla,IAAnBf,KAAKkb,YAA0B7D,EAAK6D,UAAYlb,KAAKkb,gBAClCna,IAAnBf,KAAKmb,YAA0B9D,EAAK8D,UAAYnb,KAAKmb,gBAEtCpa,IAAff,KAAKob,QAAsB/D,EAAK+D,MAAQpb,KAAKob,OAC7Cpb,KAAKqb,YAAcrb,KAAKqb,WAAWV,UAAUtD,EAAKgE,WAAarb,KAAKqb,WAAWJ,eACvDla,IAAxBf,KAAKsb,iBAA+BjE,EAAKiE,eAAiBtb,KAAKsb,gBAC/Dtb,KAAKub,UAAYvb,KAAKub,SAASZ,UAAUtD,EAAKkE,SAAWvb,KAAKub,SAASN,UACvEjb,KAAKwb,mBAAgD,IAA3Bxb,KAAKwb,oBAA0BnE,EAAKmE,kBAAoBxb,KAAKwb,mBAEvFxb,KAAKyb,UAAYzb,KAAKyb,SAASd,UAAUtD,EAAKoE,SAAWzb,KAAKyb,SAASR,eAC5Cla,IAA3Bf,KAAK0b,oBAAkCrE,EAAKqE,kBAAoB1b,KAAK0b,mBACrE1b,KAAK2b,eAAiB3b,KAAK2b,cAAchB,UAAUtD,EAAKsE,cAAgB3b,KAAK2b,cAAcV,eACxEla,IAAnBf,KAAK4b,YAA0BvE,EAAKuE,UAAY5b,KAAK4b,gBAClC7a,IAAnBf,KAAK6b,YAA0BxE,EAAKwE,UAAY7b,KAAK6b,gBACzB9a,IAA5Bf,KAAK8b,qBAAmCzE,EAAKyE,mBAAqB9b,KAAK8b,oBAEvE9b,KAAK+b,cAAgB/b,KAAK+b,aAAazE,YAE3CD,EAAK0E,aAAe/b,KAAK+b,aAAavG,OAAQC,GAAOlB,MAIjDvU,KAAKgc,uBAAyBhc,KAAKgc,sBAAsB1E,YAE7DD,EAAK2E,sBAAwBhc,KAAKgc,sBAAsBxG,OAAQC,GAAOlB,MAInEvU,KAAKic,oBAAsBjc,KAAKic,mBAAmB3E,YAEvDD,EAAK4E,mBAAqBjc,KAAKic,mBAAmBzG,OAAQC,GAAOlB,KACjE8C,EAAK6E,qBAAuBlc,KAAKkc,qBAAqB9N,WAIlDpO,KAAKmc,KAAOnc,KAAKmc,IAAI7E,YAAYD,EAAK8E,IAAMnc,KAAKmc,IAAI3G,OAAQC,GAAOlB,MACpEvU,KAAKoc,QAAUpc,KAAKoc,OAAO9E,YAAYD,EAAK+E,OAASpc,KAAKoc,OAAO5G,OAAQC,GAAOlB,MAChFvU,KAAKqc,UAAYrc,KAAKqc,SAAS/E,YAAYD,EAAKgF,SAAWrc,KAAKqc,SAAS7G,OAAQC,GAAOlB,MAExFvU,KAAKsc,UAAYtc,KAAKsc,SAAShF,YAEnCD,EAAKiF,SAAWtc,KAAKsc,SAAS9G,OAAQC,GAAOlB,KAC7C8C,EAAKkF,kBAAoBvc,KAAKuc,mBAI1Bvc,KAAKwc,OAASxc,KAAKwc,MAAMlF,YAE7BD,EAAKmF,MAAQxc,KAAKwc,MAAMhH,OAAQC,GAAOlB,KACvC8C,EAAKoF,eAAiBzc,KAAKyc,gBAIvBzc,KAAK0c,SAAW1c,KAAK0c,QAAQpF,YAEjCD,EAAKqF,QAAU1c,KAAK0c,QAAQlH,OAAQC,GAAOlB,KAC3C8C,EAAKsF,UAAY3c,KAAK2c,WAIlB3c,KAAK4c,WAAa5c,KAAK4c,UAAUtF,YAErCD,EAAKuF,UAAY5c,KAAK4c,UAAUpH,OAAQC,GAAOlB,KAC/C8C,EAAKwF,cAAgB7c,KAAK6c,cAC1BxF,EAAKyF,YAAc9c,KAAK8c,YAAY1O,WAIhCpO,KAAK+c,iBAAmB/c,KAAK+c,gBAAgBzF,YAEjDD,EAAK0F,gBAAkB/c,KAAK+c,gBAAgBvH,OAAQC,GAAOlB,KAC3D8C,EAAK2F,kBAAoBhd,KAAKgd,kBAC9B3F,EAAK4F,iBAAmBjd,KAAKid,kBAIzBjd,KAAKkd,cAAgBld,KAAKkd,aAAa5F,YAAYD,EAAK6F,aAAeld,KAAKkd,aAAa1H,OAAQC,GAAOlB,MACxGvU,KAAKmd,cAAgBnd,KAAKmd,aAAa7F,YAAYD,EAAK8F,aAAend,KAAKmd,aAAa3H,OAAQC,GAAOlB,MAExGvU,KAAKod,aAAepd,KAAKod,YAAY9F,YAAYD,EAAK+F,YAAcpd,KAAKod,YAAY5H,OAAQC,GAAOlB,MACpGvU,KAAKqd,aAAerd,KAAKqd,YAAY/F,YAAYD,EAAKgG,YAAcrd,KAAKqd,YAAY7H,OAAQC,GAAOlB,MACpGvU,KAAKsd,sBAAwBtd,KAAKsd,qBAAqBhG,YAAYD,EAAKiG,qBAAuBtd,KAAKsd,qBAAqB9H,OAAQC,GAAOlB,MACxIvU,KAAKud,kBAAoBvd,KAAKud,iBAAiBjG,YAAYD,EAAKkG,iBAAmBvd,KAAKud,iBAAiB/H,OAAQC,GAAOlB,MAExHvU,KAAKwd,QAAUxd,KAAKwd,OAAOlG,YAE/BD,EAAKmG,OAASxd,KAAKwd,OAAOhI,OAAQC,GAAOlB,UAEnBxT,IAAjBf,KAAKyd,UAAwBpG,EAAKoG,QAAUzd,KAAKyd,eAIzB1c,IAAzBf,KAAK0d,kBAAgCrG,EAAKqG,gBAAkB1d,KAAK0d,sBAC3C3c,IAAtBf,KAAK2d,eAA6BtG,EAAKsG,aAAe3d,KAAK2d,mBAClC5c,IAAzBf,KAAK4d,kBAAgCvG,EAAKuG,gBAAkB5d,KAAK4d,iBAEjE5d,KAAK6d,aAAe7d,KAAK6d,YAAYvG,YAEzCD,EAAKwG,YAAc7d,KAAK6d,YAAYrI,OAAQC,GAAOlB,WAIzBxT,IAAtBf,KAAK8d,eAA6BzG,EAAKyG,aAAe9d,KAAK8d,cAC3D9d,KAAK+d,iBAAmB/d,KAAK+d,gBAAgBzG,YAAYD,EAAK0G,gBAAkB/d,KAAK+d,gBAAgBvI,OAAQC,GAAOlB,WACjGxT,IAAnBf,KAAKge,YAA0B3G,EAAK2G,UAAYhe,KAAKge,WACrDhe,KAAKie,cAAgBje,KAAKie,aAAa3G,YAAYD,EAAK4G,aAAeje,KAAKie,aAAazI,OAAQC,GAAOlB,WAC3ExT,IAA7Bf,KAAKke,sBAAoC7G,EAAK6G,oBAAsBle,KAAKke,0BAC/Cnd,IAA1Bf,KAAKme,mBAAiC9G,EAAK8G,iBAAmBne,KAAKme,iBAAiBlD,eAEtEla,IAAdf,KAAKoe,OAAqB/G,EAAK+G,KAAOpe,KAAKoe,MACvB,OAApBpe,KAAKqZ,aAAsBhC,EAAKgC,WAAarZ,KAAKqZ,iBACzBtY,IAAzBf,KAAKqe,kBAAgChH,EAAKgH,gBAAkBre,KAAKqe,iBP5R1C,IO8RvBre,KAAK4X,WAA8BP,EAAKO,SAAW5X,KAAK4X,UPpStC,IOqSlB5X,KAAK6X,OAAqBR,EAAKQ,KAAO7X,KAAK6X,MAC3C7X,KAAK8X,eAAeT,EAAKS,cAAe,GAExC9X,KAAK+X,QAAU,IAAIV,EAAKU,QAAU/X,KAAK+X,SACvC/X,KAAKoU,SAAWzM,IAAa0P,EAAKjD,OAASpU,KAAKoU,SAC3B,IAArBpU,KAAKgY,cAAuBX,EAAKW,YAAchY,KAAKgY,aAEzDX,EAAKkB,UAAYvY,KAAKuY,UACtBlB,EAAKmB,UAAYxY,KAAKwY,UACtBnB,EAAKoB,WAAazY,KAAKyY,WACvBpB,EAAKiC,WAAatZ,KAAKsZ,WAEvBjC,EAAK4B,aAAejZ,KAAKiZ,aACzB5B,EAAKqB,iBAAmB1Y,KAAK0Y,iBAC7BrB,EAAKsB,YAAc3Y,KAAK2Y,YACxBtB,EAAKuB,WAAa5Y,KAAK4Y,WACvBvB,EAAKwB,gBAAkB7Y,KAAK6Y,gBAC5BxB,EAAKyB,YAAc9Y,KAAK8Y,YACxBzB,EAAK0B,aAAe/Y,KAAK+Y,aACzB1B,EAAK2B,aAAehZ,KAAKgZ,aAGpBhZ,KAAKiT,UAA8B,IAAlBjT,KAAKiT,WAAiBoE,EAAKpE,SAAWjT,KAAKiT,WAErC,IAAvBjT,KAAKwZ,gBAAyBnC,EAAKmC,eAAgB,GACtB,IAA7BxZ,KAAKyZ,sBAA4BpC,EAAKoC,oBAAsBzZ,KAAKyZ,qBACrC,IAA5BzZ,KAAK0Z,qBAA2BrC,EAAKqC,mBAAqB1Z,KAAK0Z,oBAE/D1Z,KAAKse,WAAgC,IAAnBte,KAAKse,YAAkBjH,EAAKiH,UAAYte,KAAKse,gBAC7Cvd,IAAlBf,KAAKue,WAAyBlH,EAAKkH,SAAWve,KAAKue,eAClCxd,IAAjBf,KAAKwe,UAAwBnH,EAAKmH,QAAUxe,KAAKwe,cAClCzd,IAAff,KAAKoT,QAAsBiE,EAAKjE,MAAQpT,KAAKoT,QAE1B,IAAnBpT,KAAK2Z,YAAqBtC,EAAKsC,WAAY,GAE3C3Z,KAAKia,UAAY,IAAI5C,EAAK4C,UAAYja,KAAKia,YAClB,IAAzBja,KAAK4Z,kBAA2BvC,EAAKuC,gBAAkB5Z,KAAK4Z,kBAChC,IAA5B5Z,KAAK6Z,qBAA8BxC,EAAKwC,mBAAqB7Z,KAAK6Z,qBAE/C,IAAnB7Z,KAAKye,YAAqBpH,EAAKoH,UAAYze,KAAKye,WAChDze,KAAK0e,mBAAqB,IAAIrH,EAAKqH,mBAAqB1e,KAAK0e,oBACnC,UAA1B1e,KAAK2e,mBAA+BtH,EAAKsH,iBAAmB3e,KAAK2e,kBACtC,UAA3B3e,KAAK4e,oBAAgCvH,EAAKuH,kBAAoB5e,KAAK4e,oBAE9C,IAArB5e,KAAKya,cAAuBpD,EAAKoD,YAAcza,KAAKya,cAEnC,IAAjBza,KAAK8Z,UAAoBzC,EAAKyC,SAAU,IAEpB,IAApB9Z,KAAK+Z,aAAuB1C,EAAK0C,YAAa,GAEV,OAApCzE,KAAKC,UAAWvV,KAAKgV,YAAsBqC,EAAKrC,SAAWhV,KAAKgV,UAoBhE6F,EAAS,CAEb,MAAMlF,EAAWmF,EAAkBrF,EAAKE,UAClCK,EAAS8E,EAAkBrF,EAAKO,QAEjCL,EAASzT,OAAS,IAAImV,EAAK1B,SAAWA,GACtCK,EAAO9T,OAAS,IAAImV,EAAKrB,OAASA,GAIxC,OAAOqB,EAIRtM,QAEC,OAAO,IAAI/K,KAAKI,aAAc4K,KAAMhL,MAIrCgL,KAAMqK,GAELrV,KAAK4D,KAAOyR,EAAOzR,KAEnB5D,KAAK2X,IAAMtC,EAAOsC,IAElB3X,KAAK4X,SAAWvC,EAAOuC,SACvB5X,KAAK6X,KAAOxC,EAAOwC,KACnB7X,KAAK8X,aAAezC,EAAOyC,aAE3B9X,KAAK+X,QAAU1C,EAAO0C,QACtB/X,KAAKoU,OAASiB,EAAOjB,OACrBpU,KAAKgY,YAAc3C,EAAO2C,YAE1BhY,KAAKiY,SAAW5C,EAAO4C,SACvBjY,KAAKkY,SAAW7C,EAAO6C,SACvBlY,KAAKmY,cAAgB9C,EAAO8C,cAC5BnY,KAAKoY,cAAgB/C,EAAO+C,cAC5BpY,KAAKqY,cAAgBhD,EAAOgD,cAC5BrY,KAAKsY,mBAAqBjD,EAAOiD,mBAEjCtY,KAAKuY,UAAYlD,EAAOkD,UACxBvY,KAAKwY,UAAYnD,EAAOmD,UACxBxY,KAAKyY,WAAapD,EAAOoD,WAEzBzY,KAAK0Y,iBAAmBrD,EAAOqD,iBAC/B1Y,KAAK2Y,YAActD,EAAOsD,YAC1B3Y,KAAK4Y,WAAavD,EAAOuD,WACzB5Y,KAAK6Y,gBAAkBxD,EAAOwD,gBAC9B7Y,KAAK8Y,YAAczD,EAAOyD,YAC1B9Y,KAAK+Y,aAAe1D,EAAO0D,aAC3B/Y,KAAKgZ,aAAe3D,EAAO2D,aAC3BhZ,KAAKiZ,aAAe5D,EAAO4D,aAE3B,MAAM4F,EAAYxJ,EAAO6D,eACzB,IAAI4F,EAAY,KAEhB,GAAmB,OAAdD,EAAqB,CAEzB,MAAME,EAAIF,EAAU3c,OACpB4c,EAAY,IAAI7I,MAAO8I,GAEvB,IAAM,IAAI/c,EAAI,EAAGA,IAAM+c,IAAM/c,EAE5B8c,EAAW9c,GAAM6c,EAAW7c,GAAI+I,QAgClC,OA1BA/K,KAAKkZ,eAAiB4F,EACtB9e,KAAKmZ,iBAAmB9D,EAAO8D,iBAC/BnZ,KAAKoZ,YAAc/D,EAAO+D,YAE1BpZ,KAAKqZ,WAAahE,EAAOgE,WAEzBrZ,KAAKsZ,WAAajE,EAAOiE,WAEzBtZ,KAAKuZ,UAAYlE,EAAOkE,UAExBvZ,KAAKwZ,cAAgBnE,EAAOmE,cAC5BxZ,KAAKyZ,oBAAsBpE,EAAOoE,oBAClCzZ,KAAK0Z,mBAAqBrE,EAAOqE,mBAEjC1Z,KAAK2Z,UAAYtE,EAAOsE,UAExB3Z,KAAKia,UAAY5E,EAAO4E,UACxBja,KAAK4Z,gBAAkBvE,EAAOuE,gBAC9B5Z,KAAK6Z,mBAAqBxE,EAAOwE,mBAEjC7Z,KAAK8Z,QAAUzE,EAAOyE,QAEtB9Z,KAAK+Z,WAAa1E,EAAO0E,WAEzB/Z,KAAKgV,SAAWM,KAAKpS,MAAOoS,KAAKC,UAAWF,EAAOL,WAE5ChV,KAIRqW,UAECrW,KAAKoG,cAAe,CAAEN,KAAM,YAIzB0Q,gBAAa9W,IAED,IAAVA,GAAiBM,KAAKiV,WAM7ByC,GAASrY,UAAU2f,YAAa,ECtehC,MAAMC,GAAiB,CAAE,UAAa,SAAU,aAAgB,SAAU,KAAQ,MAAU,WAAc,QAAU,MAAS,SAC5H,MAAS,SAAU,OAAU,SAAU,MAAS,EAAU,eAAkB,SAAU,KAAQ,IAAU,WAAc,QACtH,MAAS,SAAU,UAAa,SAAU,UAAa,QAAU,WAAc,QAAU,UAAa,SAAU,MAAS,SACzH,eAAkB,QAAU,SAAY,SAAU,QAAW,SAAU,KAAQ,MAAU,SAAY,IAAU,SAAY,MAC3H,cAAiB,SAAU,SAAY,SAAU,UAAa,MAAU,SAAY,SAAU,UAAa,SAAU,YAAe,QACpI,eAAkB,QAAU,WAAc,SAAU,WAAc,SAAU,QAAW,QAAU,WAAc,SAAU,aAAgB,QACzI,cAAiB,QAAU,cAAiB,QAAU,cAAiB,QAAU,cAAiB,MAAU,WAAc,QAC1H,SAAY,SAAU,YAAe,MAAU,QAAW,QAAU,QAAW,QAAU,WAAc,QAAU,UAAa,SAC9H,YAAe,SAAU,YAAe,QAAU,QAAW,SAAU,UAAa,SAAU,WAAc,SAAU,KAAQ,SAC9H,UAAa,SAAU,KAAQ,QAAU,MAAS,MAAU,YAAe,SAAU,KAAQ,QAAU,SAAY,SAAU,QAAW,SACxI,UAAa,SAAU,OAAU,QAAU,MAAS,SAAU,MAAS,SAAU,SAAY,SAAU,cAAiB,SAAU,UAAa,QAC/I,aAAgB,SAAU,UAAa,SAAU,WAAc,SAAU,UAAa,SAAU,qBAAwB,SAAU,UAAa,SAC/I,WAAc,QAAU,UAAa,SAAU,UAAa,SAAU,YAAe,SAAU,cAAiB,QAAU,aAAgB,QAC1I,eAAkB,QAAU,eAAkB,QAAU,eAAkB,SAAU,YAAe,SAAU,KAAQ,MAAU,UAAa,QAC5I,MAAS,SAAU,QAAW,SAAU,OAAU,QAAU,iBAAoB,QAAU,WAAc,IAAU,aAAgB,SAClI,aAAgB,QAAU,eAAkB,QAAU,gBAAmB,QAAU,kBAAqB,MAAU,gBAAmB,QACrI,gBAAmB,SAAU,aAAgB,QAAU,UAAa,SAAU,UAAa,SAAU,SAAY,SAAU,YAAe,SAC1I,KAAQ,IAAU,QAAW,SAAU,MAAS,QAAU,UAAa,QAAU,OAAU,SAAU,UAAa,SAAU,OAAU,SACtI,cAAiB,SAAU,UAAa,SAAU,cAAiB,SAAU,cAAiB,SAAU,WAAc,SAAU,UAAa,SAC7I,KAAQ,SAAU,KAAQ,SAAU,KAAQ,SAAU,WAAc,SAAU,OAAU,QAAU,cAAiB,QAAU,IAAO,SAAU,UAAa,SAC3J,UAAa,QAAU,YAAe,QAAU,OAAU,SAAU,WAAc,SAAU,SAAY,QAAU,SAAY,SAC9H,OAAU,SAAU,OAAU,SAAU,QAAW,QAAU,UAAa,QAAU,UAAa,QAAU,UAAa,QAAU,KAAQ,SAC1I,YAAe,MAAU,UAAa,QAAU,IAAO,SAAU,KAAQ,MAAU,QAAW,SAAU,OAAU,SAAU,UAAa,QACzI,OAAU,SAAU,MAAS,SAAU,MAAS,SAAU,WAAc,SAAU,OAAU,SAAU,YAAe,UAEhHC,GAAQ,CAAEnN,EAAG,EAAGxG,EAAG,EAAGtJ,EAAG,GACzBkd,GAAQ,CAAEpN,EAAG,EAAGxG,EAAG,EAAGtJ,EAAG,GAE/B,SAASmd,GAASC,EAAGC,EAAG1V,GAIvB,OAFKA,EAAI,IAAIA,GAAK,GACbA,EAAI,IAAIA,GAAK,GACbA,EAAI,EAAI,EAAWyV,EAAgB,GAAVC,EAAID,GAAUzV,EACvCA,EAAI,GAAe0V,EACnB1V,EAAI,EAAI,EAAWyV,EAAgB,GAAVC,EAAID,IAAY,EAAI,EAAIzV,GAC/CyV,EAIR,SAASE,GAAc5Q,GAEtB,OAASA,EAAI,OAAgB,YAAJA,EAAmBtK,KAAK2F,IAAS,YAAJ2E,EAAmB,YAAc,KAIxF,SAAS6Q,GAAc7Q,GAEtB,OAASA,EAAI,SAAkB,MAAJA,EAAY,MAAUtK,KAAK2F,IAAK2E,EAAG,QAAc,KAI7E,MAAM8Q,GAELrf,YAAauS,EAAGb,EAAGrG,GAElB,YAAW1K,IAAN+Q,QAAyB/Q,IAAN0K,EAGhBzL,KAAKuK,IAAKoI,GAIX3S,KAAK0f,OAAQ/M,EAAGb,EAAGrG,GAI3BlB,IAAK7K,GAgBJ,OAdKA,GAASA,EAAMib,QAEnB3a,KAAKgL,KAAMtL,GAEiB,iBAAVA,EAElBM,KAAK2f,OAAQjgB,GAEe,iBAAVA,GAElBM,KAAK4f,SAAUlgB,GAITM,KAIRwK,UAAWC,GAMV,OAJAzK,KAAK2S,EAAIlI,EACTzK,KAAK8R,EAAIrH,EACTzK,KAAKyL,EAAIhB,EAEFzK,KAIR2f,OAAQE,GAQP,OANAA,EAAMxb,KAAK4F,MAAO4V,GAElB7f,KAAK2S,GAAMkN,GAAO,GAAK,KAAQ,IAC/B7f,KAAK8R,GAAM+N,GAAO,EAAI,KAAQ,IAC9B7f,KAAKyL,GAAY,IAANoU,GAAc,IAElB7f,KAIR0f,OAAQ/M,EAAGb,EAAGrG,GAMb,OAJAzL,KAAK2S,EAAIA,EACT3S,KAAK8R,EAAIA,EACT9R,KAAKyL,EAAIA,EAEFzL,KAIR8f,OAAQ/N,EAAGxG,EAAGtJ,GAOb,GAJA8P,GAA+BA,GPzEJ5F,EOyEO,GPvEdA,GAAMA,EOwE1BZ,EAAI,EAAiBA,EAAG,EAAG,GAC3BtJ,EAAI,EAAiBA,EAAG,EAAG,GAEhB,IAANsJ,EAEJvL,KAAK2S,EAAI3S,KAAK8R,EAAI9R,KAAKyL,EAAIxJ,MAErB,CAEN,MAAMod,EAAIpd,GAAK,GAAMA,GAAM,EAAIsJ,GAAMtJ,EAAIsJ,EAAMtJ,EAAIsJ,EAC7C+T,EAAM,EAAIrd,EAAMod,EAEtBrf,KAAK2S,EAAIyM,GAASE,EAAGD,EAAGtN,EAAI,EAAI,GAChC/R,KAAK8R,EAAIsN,GAASE,EAAGD,EAAGtN,GACxB/R,KAAKyL,EAAI2T,GAASE,EAAGD,EAAGtN,EAAI,EAAI,GPxFnC,IAA6B5F,EO4F3B,OAAOnM,KAIR4f,SAAUG,GAET,SAASC,EAAaC,QAELlf,IAAXkf,GAEAC,WAAYD,GAAW,GAE3B9U,QAAQC,KAAM,mCAAqC2U,EAAQ,qBAO7D,IAAI5T,EAEJ,GAAKA,EAAI,+BAA+BgU,KAAMJ,GAAU,CAIvD,IAAI/E,EACJ,MAAMpX,EAAOuI,EAAG,GACViU,EAAajU,EAAG,GAEtB,OAASvI,GAER,IAAK,MACL,IAAK,OAEJ,GAAKoX,EAAQ,+DAA+DmF,KAAMC,GASjF,OANApgB,KAAK2S,EAAItO,KAAKmF,IAAK,IAAK6W,SAAUrF,EAAO,GAAK,KAAS,IACvDhb,KAAK8R,EAAIzN,KAAKmF,IAAK,IAAK6W,SAAUrF,EAAO,GAAK,KAAS,IACvDhb,KAAKyL,EAAIpH,KAAKmF,IAAK,IAAK6W,SAAUrF,EAAO,GAAK,KAAS,IAEvDgF,EAAahF,EAAO,IAEbhb,KAIR,GAAKgb,EAAQ,qEAAqEmF,KAAMC,GASvF,OANApgB,KAAK2S,EAAItO,KAAKmF,IAAK,IAAK6W,SAAUrF,EAAO,GAAK,KAAS,IACvDhb,KAAK8R,EAAIzN,KAAKmF,IAAK,IAAK6W,SAAUrF,EAAO,GAAK,KAAS,IACvDhb,KAAKyL,EAAIpH,KAAKmF,IAAK,IAAK6W,SAAUrF,EAAO,GAAK,KAAS,IAEvDgF,EAAahF,EAAO,IAEbhb,KAIR,MAED,IAAK,MACL,IAAK,OAEJ,GAAKgb,EAAQ,yEAAyEmF,KAAMC,GAAe,CAG1G,MAAMrO,EAAImO,WAAYlF,EAAO,IAAQ,IAC/BzP,EAAI8U,SAAUrF,EAAO,GAAK,IAAO,IACjC/Y,EAAIoe,SAAUrF,EAAO,GAAK,IAAO,IAIvC,OAFAgF,EAAahF,EAAO,IAEbhb,KAAK8f,OAAQ/N,EAAGxG,EAAGtJ,UAQvB,GAAKkK,EAAI,oBAAoBgU,KAAMJ,GAAU,CAInD,MAAMF,EAAM1T,EAAG,GACTiS,EAAOyB,EAAI3d,OAEjB,GAAc,IAATkc,EAOJ,OAJApe,KAAK2S,EAAI0N,SAAUR,EAAIS,OAAQ,GAAMT,EAAIS,OAAQ,GAAK,IAAO,IAC7DtgB,KAAK8R,EAAIuO,SAAUR,EAAIS,OAAQ,GAAMT,EAAIS,OAAQ,GAAK,IAAO,IAC7DtgB,KAAKyL,EAAI4U,SAAUR,EAAIS,OAAQ,GAAMT,EAAIS,OAAQ,GAAK,IAAO,IAEtDtgB,KAED,GAAc,IAAToe,EAOX,OAJApe,KAAK2S,EAAI0N,SAAUR,EAAIS,OAAQ,GAAMT,EAAIS,OAAQ,GAAK,IAAO,IAC7DtgB,KAAK8R,EAAIuO,SAAUR,EAAIS,OAAQ,GAAMT,EAAIS,OAAQ,GAAK,IAAO,IAC7DtgB,KAAKyL,EAAI4U,SAAUR,EAAIS,OAAQ,GAAMT,EAAIS,OAAQ,GAAK,IAAO,IAEtDtgB,KAMT,OAAK+f,GAASA,EAAM7d,OAAS,EAErBlC,KAAKugB,aAAcR,GAIpB/f,KAIRugB,aAAcR,GAGb,MAAMF,EAAMZ,GAAgBc,EAAMS,eAclC,YAZazf,IAAR8e,EAGJ7f,KAAK2f,OAAQE,GAKb1U,QAAQC,KAAM,8BAAgC2U,GAIxC/f,KAIR+K,QAEC,OAAO,IAAI/K,KAAKI,YAAaJ,KAAK2S,EAAG3S,KAAK8R,EAAG9R,KAAKyL,GAInDT,KAAMgQ,GAML,OAJAhb,KAAK2S,EAAIqI,EAAMrI,EACf3S,KAAK8R,EAAIkJ,EAAMlJ,EACf9R,KAAKyL,EAAIuP,EAAMvP,EAERzL,KAIRygB,kBAAmBzF,EAAO0F,EAAc,GAMvC,OAJA1gB,KAAK2S,EAAItO,KAAK2F,IAAKgR,EAAMrI,EAAG+N,GAC5B1gB,KAAK8R,EAAIzN,KAAK2F,IAAKgR,EAAMlJ,EAAG4O,GAC5B1gB,KAAKyL,EAAIpH,KAAK2F,IAAKgR,EAAMvP,EAAGiV,GAErB1gB,KAIR2gB,kBAAmB3F,EAAO0F,EAAc,GAEvC,MAAME,EAAgBF,EAAc,EAAQ,EAAMA,EAAgB,EAMlE,OAJA1gB,KAAK2S,EAAItO,KAAK2F,IAAKgR,EAAMrI,EAAGiO,GAC5B5gB,KAAK8R,EAAIzN,KAAK2F,IAAKgR,EAAMlJ,EAAG8O,GAC5B5gB,KAAKyL,EAAIpH,KAAK2F,IAAKgR,EAAMvP,EAAGmV,GAErB5gB,KAIR6gB,qBAAsBH,GAIrB,OAFA1gB,KAAKygB,kBAAmBzgB,KAAM0gB,GAEvB1gB,KAIR8gB,qBAAsBJ,GAIrB,OAFA1gB,KAAK2gB,kBAAmB3gB,KAAM0gB,GAEvB1gB,KAIR+gB,iBAAkB/F,GAMjB,OAJAhb,KAAK2S,EAAI4M,GAAcvE,EAAMrI,GAC7B3S,KAAK8R,EAAIyN,GAAcvE,EAAMlJ,GAC7B9R,KAAKyL,EAAI8T,GAAcvE,EAAMvP,GAEtBzL,KAIRghB,iBAAkBhG,GAMjB,OAJAhb,KAAK2S,EAAI6M,GAAcxE,EAAMrI,GAC7B3S,KAAK8R,EAAI0N,GAAcxE,EAAMlJ,GAC7B9R,KAAKyL,EAAI+T,GAAcxE,EAAMvP,GAEtBzL,KAIRihB,sBAIC,OAFAjhB,KAAK+gB,iBAAkB/gB,MAEhBA,KAIRkhB,sBAIC,OAFAlhB,KAAKghB,iBAAkBhhB,MAEhBA,KAIRib,SAEC,OAAkB,IAATjb,KAAK2S,GAAa,GAAgB,IAAT3S,KAAK8R,GAAa,EAAe,IAAT9R,KAAKyL,GAAa,EAI7E0V,eAEC,OAAS,SAAWnhB,KAAKib,SAASrS,SAAU,KAAOtC,OAAS,GAI7D8a,OAAQ/a,GAIP,MAAMsM,EAAI3S,KAAK2S,EAAGb,EAAI9R,KAAK8R,EAAGrG,EAAIzL,KAAKyL,EAEjC/H,EAAMW,KAAKX,IAAKiP,EAAGb,EAAGrG,GACtBjC,EAAMnF,KAAKmF,IAAKmJ,EAAGb,EAAGrG,GAE5B,IAAI4V,EAAKC,EACT,MAAMC,GAAc/X,EAAM9F,GAAQ,EAElC,GAAK8F,IAAQ9F,EAEZ2d,EAAM,EACNC,EAAa,MAEP,CAEN,MAAME,EAAQ9d,EAAM8F,EAIpB,OAFA8X,EAAaC,GAAa,GAAMC,GAAU9d,EAAM8F,GAAQgY,GAAU,EAAI9d,EAAM8F,GAEnE9F,GAER,KAAKiP,EAAG0O,GAAQvP,EAAIrG,GAAM+V,GAAU1P,EAAIrG,EAAI,EAAI,GAAK,MACrD,KAAKqG,EAAGuP,GAAQ5V,EAAIkH,GAAM6O,EAAQ,EAAG,MACrC,KAAK/V,EAAG4V,GAAQ1O,EAAIb,GAAM0P,EAAQ,EAInCH,GAAO,EAQR,OAJAhb,EAAO0L,EAAIsP,EACXhb,EAAOkF,EAAI+V,EACXjb,EAAOpE,EAAIsf,EAEJlb,EAIRob,WAEC,MAAO,QAAsB,IAATzhB,KAAK2S,EAAY,GAAM,KAAmB,IAAT3S,KAAK8R,EAAY,GAAM,KAAmB,IAAT9R,KAAKyL,EAAY,GAAM,IAI9GiW,UAAW3P,EAAGxG,EAAGtJ,GAQhB,OANAjC,KAAKohB,OAAQlC,IAEbA,GAAMnN,GAAKA,EAAGmN,GAAM3T,GAAKA,EAAG2T,GAAMjd,GAAKA,EAEvCjC,KAAK8f,OAAQZ,GAAMnN,EAAGmN,GAAM3T,EAAG2T,GAAMjd,GAE9BjC,KAIRF,IAAKkb,GAMJ,OAJAhb,KAAK2S,GAAKqI,EAAMrI,EAChB3S,KAAK8R,GAAKkJ,EAAMlJ,EAChB9R,KAAKyL,GAAKuP,EAAMvP,EAETzL,KAIR2hB,UAAWC,EAAQC,GAMlB,OAJA7hB,KAAK2S,EAAIiP,EAAOjP,EAAIkP,EAAOlP,EAC3B3S,KAAK8R,EAAI8P,EAAO9P,EAAI+P,EAAO/P,EAC3B9R,KAAKyL,EAAImW,EAAOnW,EAAIoW,EAAOpW,EAEpBzL,KAIRsL,UAAWC,GAMV,OAJAvL,KAAK2S,GAAKpH,EACVvL,KAAK8R,GAAKvG,EACVvL,KAAKyL,GAAKF,EAEHvL,KAIR2L,IAAKqP,GAMJ,OAJAhb,KAAK2S,EAAItO,KAAKX,IAAK,EAAG1D,KAAK2S,EAAIqI,EAAMrI,GACrC3S,KAAK8R,EAAIzN,KAAKX,IAAK,EAAG1D,KAAK8R,EAAIkJ,EAAMlJ,GACrC9R,KAAKyL,EAAIpH,KAAKX,IAAK,EAAG1D,KAAKyL,EAAIuP,EAAMvP,GAE9BzL,KAIR8L,SAAUkP,GAMT,OAJAhb,KAAK2S,GAAKqI,EAAMrI,EAChB3S,KAAK8R,GAAKkJ,EAAMlJ,EAChB9R,KAAKyL,GAAKuP,EAAMvP,EAETzL,KAIR+L,eAAgBR,GAMf,OAJAvL,KAAK2S,GAAKpH,EACVvL,KAAK8R,GAAKvG,EACVvL,KAAKyL,GAAKF,EAEHvL,KAIRyJ,KAAMuR,EAAOnN,GAMZ,OAJA7N,KAAK2S,IAAOqI,EAAMrI,EAAI3S,KAAK2S,GAAM9E,EACjC7N,KAAK8R,IAAOkJ,EAAMlJ,EAAI9R,KAAK8R,GAAMjE,EACjC7N,KAAKyL,IAAOuP,EAAMvP,EAAIzL,KAAKyL,GAAMoC,EAE1B7N,KAIR8hB,WAAYF,EAAQC,EAAQhU,GAM3B,OAJA7N,KAAK2S,EAAIiP,EAAOjP,GAAMkP,EAAOlP,EAAIiP,EAAOjP,GAAM9E,EAC9C7N,KAAK8R,EAAI8P,EAAO9P,GAAM+P,EAAO/P,EAAI8P,EAAO9P,GAAMjE,EAC9C7N,KAAKyL,EAAImW,EAAOnW,GAAMoW,EAAOpW,EAAImW,EAAOnW,GAAMoC,EAEvC7N,KAIR+hB,QAAS/G,EAAOnN,GAEf7N,KAAKohB,OAAQlC,IACblE,EAAMoG,OAAQjC,IAEd,MAAMpN,EAAI,EAAgBmN,GAAMnN,EAAGoN,GAAMpN,EAAGlE,GACtCtC,EAAI,EAAgB2T,GAAM3T,EAAG4T,GAAM5T,EAAGsC,GACtC5L,EAAI,EAAgBid,GAAMjd,EAAGkd,GAAMld,EAAG4L,GAI5C,OAFA7N,KAAK8f,OAAQ/N,EAAGxG,EAAGtJ,GAEZjC,KAIRiO,OAAQU,GAEP,OAASA,EAAEgE,IAAM3S,KAAK2S,GAAShE,EAAEmD,IAAM9R,KAAK8R,GAASnD,EAAElD,IAAMzL,KAAKyL,EAInEyC,UAAWzK,EAAO0K,EAAS,GAM1B,OAJAnO,KAAK2S,EAAIlP,EAAO0K,GAChBnO,KAAK8R,EAAIrO,EAAO0K,EAAS,GACzBnO,KAAKyL,EAAIhI,EAAO0K,EAAS,GAElBnO,KAIRoO,QAAS3K,EAAQ,GAAI0K,EAAS,GAM7B,OAJA1K,EAAO0K,GAAWnO,KAAK2S,EACvBlP,EAAO0K,EAAS,GAAMnO,KAAK8R,EAC3BrO,EAAO0K,EAAS,GAAMnO,KAAKyL,EAEpBhI,EAIR4K,oBAAqBC,EAAW1M,GAgB/B,OAdA5B,KAAK2S,EAAIrE,EAAUC,KAAM3M,GACzB5B,KAAK8R,EAAIxD,EAAUE,KAAM5M,GACzB5B,KAAKyL,EAAI6C,EAAU0T,KAAMpgB,IAEK,IAAzB0M,EAAU2T,aAIdjiB,KAAK2S,GAAK,IACV3S,KAAK8R,GAAK,IACV9R,KAAKyL,GAAK,KAIJzL,KAIRwV,SAEC,OAAOxV,KAAKib,UAMdwE,GAAMyC,MAAQjD,GAEdQ,GAAMpgB,UAAUsb,SAAU,EAC1B8E,GAAMpgB,UAAUsT,EAAI,EACpB8M,GAAMpgB,UAAUyS,EAAI,EACpB2N,GAAMpgB,UAAUoM,EAAI,ECtiBpB,MAAM0W,WAA0BzK,GAE/BtX,YAAagiB,GAEZnd,QAEAjF,KAAK8F,KAAO,oBAEZ9F,KAAKgb,MAAQ,IAAIyE,GAAO,UACxBzf,KAAKyb,SAAW,IAAIgE,GAAO,SAC3Bzf,KAAK4b,UAAY,GAEjB5b,KAAKmc,IAAM,KAEXnc,KAAKsc,SAAW,KAChBtc,KAAKuc,kBAAoB,EAEzBvc,KAAKwc,MAAQ,KACbxc,KAAKyc,eAAiB,EAEtBzc,KAAKub,SAAW,IAAIkE,GAAO,GAC3Bzf,KAAKwb,kBAAoB,EACzBxb,KAAKod,YAAc,KAEnBpd,KAAK0c,QAAU,KACf1c,KAAK2c,UAAY,EAEjB3c,KAAK4c,UAAY,KACjB5c,KAAK6c,cTwF8B,ESvFnC7c,KAAK8c,YAAc,IAAI1S,GAAS,EAAG,GAEnCpK,KAAK+c,gBAAkB,KACvB/c,KAAKgd,kBAAoB,EACzBhd,KAAKid,iBAAmB,EAExBjd,KAAKqd,YAAc,KAEnBrd,KAAKqc,SAAW,KAEhBrc,KAAKwd,OAAS,KACdxd,KAAKyd,QT7C0B,ES8C/Bzd,KAAK2d,aAAe,EACpB3d,KAAK4d,gBAAkB,IAEvB5d,KAAKye,WAAY,EACjBze,KAAK0e,mBAAqB,EAC1B1e,KAAK2e,iBAAmB,QACxB3e,KAAK4e,kBAAoB,QAEzB5e,KAAKya,aAAc,EAEnBza,KAAKsa,UAAW8H,GAIjBpX,KAAMqK,GA+CL,OA7CApQ,MAAM+F,KAAMqK,GAEZrV,KAAKgb,MAAMhQ,KAAMqK,EAAO2F,OACxBhb,KAAKyb,SAASzQ,KAAMqK,EAAOoG,UAC3Bzb,KAAK4b,UAAYvG,EAAOuG,UAExB5b,KAAKmc,IAAM9G,EAAO8G,IAElBnc,KAAKsc,SAAWjH,EAAOiH,SACvBtc,KAAKuc,kBAAoBlH,EAAOkH,kBAEhCvc,KAAKwc,MAAQnH,EAAOmH,MACpBxc,KAAKyc,eAAiBpH,EAAOoH,eAE7Bzc,KAAKub,SAASvQ,KAAMqK,EAAOkG,UAC3Bvb,KAAKod,YAAc/H,EAAO+H,YAC1Bpd,KAAKwb,kBAAoBnG,EAAOmG,kBAEhCxb,KAAK0c,QAAUrH,EAAOqH,QACtB1c,KAAK2c,UAAYtH,EAAOsH,UAExB3c,KAAK4c,UAAYvH,EAAOuH,UACxB5c,KAAK6c,cAAgBxH,EAAOwH,cAC5B7c,KAAK8c,YAAY9R,KAAMqK,EAAOyH,aAE9B9c,KAAK+c,gBAAkB1H,EAAO0H,gBAC9B/c,KAAKgd,kBAAoB3H,EAAO2H,kBAChChd,KAAKid,iBAAmB5H,EAAO4H,iBAE/Bjd,KAAKqd,YAAchI,EAAOgI,YAE1Brd,KAAKqc,SAAWhH,EAAOgH,SAEvBrc,KAAKwd,OAASnI,EAAOmI,OACrBxd,KAAKyd,QAAUpI,EAAOoI,QACtBzd,KAAK2d,aAAetI,EAAOsI,aAC3B3d,KAAK4d,gBAAkBvI,EAAOuI,gBAE9B5d,KAAKye,UAAYpJ,EAAOoJ,UACxBze,KAAK0e,mBAAqBrJ,EAAOqJ,mBACjC1e,KAAK2e,iBAAmBtJ,EAAOsJ,iBAC/B3e,KAAK4e,kBAAoBvJ,EAAOuJ,kBAEhC5e,KAAKya,YAAcpF,EAAOoF,YAEnBza,MAMTmiB,GAAkB9iB,UAAUgjB,qBAAsB,6SCzJnC,MAAMC,GAInBliB,cACEJ,KAAKyB,OAAS,IAAI,GAClBzB,KAAKuiB,UAAY,GAGbC,YAAYC,6CAChB,MAAMC,EAAsD,GAmB5D,OAjBAD,EAAUE,SAAS1hB,IACZjB,KAAKuiB,UAAUthB,KAAMyhB,EAASzhB,GAAOjB,KAAKyB,OAAOqB,UAAU7B,cAMvC8B,QAAQ6f,IACjC7jB,OAAO8jB,QAAQH,GAAUvG,KAJM,EAAElb,EAAK6hB,KACtC,IAAI/f,SAAeC,GAAY,GAAD,gCAAC,OAAAA,EAAQ,CAAC/B,QAAW6hB,aAKxCH,SAAQ,EAAE1hB,EAAKuW,MAC1BxX,KAAKuiB,UAAUthB,GAAO,IAAI,GAAwB,CAChDkb,IAAK3E,EACLK,KVlBkB,OUsBf4K,EAAUtG,KAAKlb,GAAQjB,KAAKuiB,UAAUthB,8TCflC,MAAM8hB,GAInB3iB,2BACEJ,KAAKgjB,MAAQ,CAAEC,OAAQ,WACvBjjB,KAAKkjB,UAAY,OAGnBC,aAAaC,GACXpjB,KAAKkjB,UAAYE,EAGnBC,eAAeC,GACb,MAAMriB,EAAMqiB,EAAMC,YACQ,YAAtBvjB,KAAKgjB,MAAMC,OACb,GAAAjjB,KAAI,WAAO,KAAXA,KAAYiB,GACmB,YAAtBjB,KAAKgjB,MAAMC,QACpBjjB,KAAKgjB,MAAMQ,OAAOC,QACdzjB,KAAKgjB,MAAM/hB,MAAQA,EACrBjB,KAAKgjB,MAAQ,OAAH,wBAAQhjB,KAAKgjB,OAAK,CAAEC,OAAQ,WAEtC,GAAAjjB,KAAI,WAAO,KAAXA,KAAYiB,IAEiB,WAAtBjB,KAAKgjB,MAAMC,SAChBjjB,KAAKgjB,MAAM/hB,MAAQA,GACrBjB,KAAKgjB,MAAMQ,OAAOE,OAClB1jB,KAAKgjB,MAAQ,OAAH,wBAAQhjB,KAAKgjB,OAAK,CAAEC,OAAQ,aAEtC,GAAAjjB,KAAI,WAAO,KAAXA,KAAYiB,gCAKXA,GACL,MAAMuiB,EAAS,IAAIG,MAAM1iB,GACzBuiB,EAAOI,OAAS,GAChBJ,EAAOK,UAAW,EAClBL,EAAO9d,iBAAiB,SAAS,KAC/B1F,KAAKgjB,MAAQ,CAAEC,OAAQ,WACvBjjB,KAAKkjB,eAGPM,EAAOE,OAAOI,OAAO1X,IACnBjB,QAAQ+D,MAAM,wBAA0B9C,GACxCpM,KAAKkjB,eAGPljB,KAAKgjB,MAAQ,CAAEC,OAAQ,UAAWO,OAAAA,EAAQviB,IAAAA,IClE9C,MAAM8iB,GAEL3jB,YAAasJ,EAAI,EAAGC,EAAI,EAAGqa,EAAI,EAAG9Y,EAAI,GAErClL,KAAKikB,GAAKva,EACV1J,KAAKkkB,GAAKva,EACV3J,KAAKmkB,GAAKH,EACVhkB,KAAKokB,GAAKlZ,EAIX0L,aAAcyN,EAAIC,EAAIC,EAAI3a,GAGzB,OADAuB,QAAQC,KAAM,wGACPmZ,EAAGC,iBAAkBH,EAAIC,EAAI1a,GAIrCgN,iBAAkB6N,EAAKC,EAAWC,EAAMC,EAAYC,EAAMC,EAAYlb,GAIrE,IAAImb,EAAKJ,EAAMC,EAAa,GAC3BI,EAAKL,EAAMC,EAAa,GACxBK,EAAKN,EAAMC,EAAa,GACxBM,EAAKP,EAAMC,EAAa,GAEzB,MAAMO,EAAKN,EAAMC,EAAa,GAC7BM,EAAKP,EAAMC,EAAa,GACxBO,EAAKR,EAAMC,EAAa,GACxBQ,EAAKT,EAAMC,EAAa,GAEzB,GAAW,IAANlb,EAMJ,OAJA6a,EAAKC,EAAY,GAAMK,EACvBN,EAAKC,EAAY,GAAMM,EACvBP,EAAKC,EAAY,GAAMO,OACvBR,EAAKC,EAAY,GAAMQ,GAKxB,GAAW,IAANtb,EAMJ,OAJA6a,EAAKC,EAAY,GAAMS,EACvBV,EAAKC,EAAY,GAAMU,EACvBX,EAAKC,EAAY,GAAMW,OACvBZ,EAAKC,EAAY,GAAMY,GAKxB,GAAKJ,IAAOI,GAAMP,IAAOI,GAAMH,IAAOI,GAAMH,IAAOI,EAAK,CAEvD,IAAI9Z,EAAI,EAAI3B,EACZ,MAAMgF,EAAMmW,EAAKI,EAAKH,EAAKI,EAAKH,EAAKI,EAAKH,EAAKI,EAC9CC,EAAQ3W,GAAO,EAAI,GAAM,EACzB4W,EAAS,EAAI5W,EAAMA,EAGpB,GAAK4W,EAASC,OAAOC,QAAU,CAE9B,MAAM7W,EAAMxK,KAAK4I,KAAMuY,GACtBG,EAAMthB,KAAKiJ,MAAOuB,EAAKD,EAAM2W,GAE9Bha,EAAIlH,KAAKwK,IAAKtD,EAAIoa,GAAQ9W,EAC1BjF,EAAIvF,KAAKwK,IAAKjF,EAAI+b,GAAQ9W,EAI3B,MAAM+W,EAAOhc,EAAI2b,EAQjB,GANAR,EAAKA,EAAKxZ,EAAI4Z,EAAKS,EACnBZ,EAAKA,EAAKzZ,EAAI6Z,EAAKQ,EACnBX,EAAKA,EAAK1Z,EAAI8Z,EAAKO,EACnBV,EAAKA,EAAK3Z,EAAI+Z,EAAKM,EAGdra,IAAM,EAAI3B,EAAI,CAElB,MAAMiI,EAAI,EAAIxN,KAAK4I,KAAM8X,EAAKA,EAAKC,EAAKA,EAAKC,EAAKA,EAAKC,EAAKA,GAE5DH,GAAMlT,EACNmT,GAAMnT,EACNoT,GAAMpT,EACNqT,GAAMrT,GAMR4S,EAAKC,GAAcK,EACnBN,EAAKC,EAAY,GAAMM,EACvBP,EAAKC,EAAY,GAAMO,EACvBR,EAAKC,EAAY,GAAMQ,EAIxBtO,+BAAgC6N,EAAKC,EAAWC,EAAMC,EAAYC,EAAMC,GAEvE,MAAMC,EAAKJ,EAAMC,GACXI,EAAKL,EAAMC,EAAa,GACxBK,EAAKN,EAAMC,EAAa,GACxBM,EAAKP,EAAMC,EAAa,GAExBO,EAAKN,EAAMC,GACXM,EAAKP,EAAMC,EAAa,GACxBO,EAAKR,EAAMC,EAAa,GACxBQ,EAAKT,EAAMC,EAAa,GAO9B,OALAL,EAAKC,GAAcK,EAAKO,EAAKJ,EAAKC,EAAKH,EAAKK,EAAKJ,EAAKG,EACtDX,EAAKC,EAAY,GAAMM,EAAKM,EAAKJ,EAAKE,EAAKH,EAAKE,EAAKJ,EAAKM,EAC1DZ,EAAKC,EAAY,GAAMO,EAAKK,EAAKJ,EAAKG,EAAKN,EAAKK,EAAKJ,EAAKG,EAC1DV,EAAKC,EAAY,GAAMQ,EAAKI,EAAKP,EAAKI,EAAKH,EAAKI,EAAKH,EAAKI,EAEnDZ,EAIJ/a,QAEH,OAAO1J,KAAKikB,GAITva,MAAGhK,GAENM,KAAKikB,GAAKvkB,EACVM,KAAK6lB,oBAIFlc,QAEH,OAAO3J,KAAKkkB,GAITva,MAAGjK,GAENM,KAAKkkB,GAAKxkB,EACVM,KAAK6lB,oBAIF7B,QAEH,OAAOhkB,KAAKmkB,GAITH,MAAGtkB,GAENM,KAAKmkB,GAAKzkB,EACVM,KAAK6lB,oBAIF3a,QAEH,OAAOlL,KAAKokB,GAITlZ,MAAGxL,GAENM,KAAKokB,GAAK1kB,EACVM,KAAK6lB,oBAINtb,IAAKb,EAAGC,EAAGqa,EAAG9Y,GASb,OAPAlL,KAAKikB,GAAKva,EACV1J,KAAKkkB,GAAKva,EACV3J,KAAKmkB,GAAKH,EACVhkB,KAAKokB,GAAKlZ,EAEVlL,KAAK6lB,oBAEE7lB,KAIR+K,QAEC,OAAO,IAAI/K,KAAKI,YAAaJ,KAAKikB,GAAIjkB,KAAKkkB,GAAIlkB,KAAKmkB,GAAInkB,KAAKokB,IAI9DpZ,KAAM8a,GASL,OAPA9lB,KAAKikB,GAAK6B,EAAWpc,EACrB1J,KAAKkkB,GAAK4B,EAAWnc,EACrB3J,KAAKmkB,GAAK2B,EAAW9B,EACrBhkB,KAAKokB,GAAK0B,EAAW5a,EAErBlL,KAAK6lB,oBAEE7lB,KAIR+lB,aAAcC,EAAOC,GAEpB,IAASD,IAASA,EAAME,QAEvB,MAAM,IAAIrb,MAAO,oGAIlB,MAAMnB,EAAIsc,EAAM/B,GAAIta,EAAIqc,EAAM9B,GAAIF,EAAIgC,EAAM7B,GAAIgC,EAAQH,EAAMI,OAMxDxX,EAAMvK,KAAKuK,IACXC,EAAMxK,KAAKwK,IAEXwX,EAAKzX,EAAKlF,EAAI,GACd4c,EAAK1X,EAAKjF,EAAI,GACd4c,EAAK3X,EAAKoV,EAAI,GAEdwC,EAAK3X,EAAKnF,EAAI,GACd+c,EAAK5X,EAAKlF,EAAI,GACd+c,EAAK7X,EAAKmV,EAAI,GAEpB,OAASmC,GAER,IAAK,MACJnmB,KAAKikB,GAAKuC,EAAKF,EAAKC,EAAKF,EAAKI,EAAKC,EACnC1mB,KAAKkkB,GAAKmC,EAAKI,EAAKF,EAAKC,EAAKF,EAAKI,EACnC1mB,KAAKmkB,GAAKkC,EAAKC,EAAKI,EAAKF,EAAKC,EAAKF,EACnCvmB,KAAKokB,GAAKiC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EACnC,MAED,IAAK,MACJ1mB,KAAKikB,GAAKuC,EAAKF,EAAKC,EAAKF,EAAKI,EAAKC,EACnC1mB,KAAKkkB,GAAKmC,EAAKI,EAAKF,EAAKC,EAAKF,EAAKI,EACnC1mB,KAAKmkB,GAAKkC,EAAKC,EAAKI,EAAKF,EAAKC,EAAKF,EACnCvmB,KAAKokB,GAAKiC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EACnC,MAED,IAAK,MACJ1mB,KAAKikB,GAAKuC,EAAKF,EAAKC,EAAKF,EAAKI,EAAKC,EACnC1mB,KAAKkkB,GAAKmC,EAAKI,EAAKF,EAAKC,EAAKF,EAAKI,EACnC1mB,KAAKmkB,GAAKkC,EAAKC,EAAKI,EAAKF,EAAKC,EAAKF,EACnCvmB,KAAKokB,GAAKiC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EACnC,MAED,IAAK,MACJ1mB,KAAKikB,GAAKuC,EAAKF,EAAKC,EAAKF,EAAKI,EAAKC,EACnC1mB,KAAKkkB,GAAKmC,EAAKI,EAAKF,EAAKC,EAAKF,EAAKI,EACnC1mB,KAAKmkB,GAAKkC,EAAKC,EAAKI,EAAKF,EAAKC,EAAKF,EACnCvmB,KAAKokB,GAAKiC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EACnC,MAED,IAAK,MACJ1mB,KAAKikB,GAAKuC,EAAKF,EAAKC,EAAKF,EAAKI,EAAKC,EACnC1mB,KAAKkkB,GAAKmC,EAAKI,EAAKF,EAAKC,EAAKF,EAAKI,EACnC1mB,KAAKmkB,GAAKkC,EAAKC,EAAKI,EAAKF,EAAKC,EAAKF,EACnCvmB,KAAKokB,GAAKiC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EACnC,MAED,IAAK,MACJ1mB,KAAKikB,GAAKuC,EAAKF,EAAKC,EAAKF,EAAKI,EAAKC,EACnC1mB,KAAKkkB,GAAKmC,EAAKI,EAAKF,EAAKC,EAAKF,EAAKI,EACnC1mB,KAAKmkB,GAAKkC,EAAKC,EAAKI,EAAKF,EAAKC,EAAKF,EACnCvmB,KAAKokB,GAAKiC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EACnC,MAED,QACCvb,QAAQC,KAAM,mEAAqE+a,GAMrF,OAFgB,IAAXF,GAAmBjmB,KAAK6lB,oBAEtB7lB,KAIR2mB,iBAAkBC,EAAMvZ,GAMvB,MAAMwZ,EAAYxZ,EAAQ,EAAG9B,EAAIlH,KAAKwK,IAAKgY,GAS3C,OAPA7mB,KAAKikB,GAAK2C,EAAKld,EAAI6B,EACnBvL,KAAKkkB,GAAK0C,EAAKjd,EAAI4B,EACnBvL,KAAKmkB,GAAKyC,EAAK5C,EAAIzY,EACnBvL,KAAKokB,GAAK/f,KAAKuK,IAAKiY,GAEpB7mB,KAAK6lB,oBAEE7lB,KAIR8mB,sBAAuB3a,GAMtB,MAAMyD,EAAKzD,EAAEE,SAEZ0a,EAAMnX,EAAI,GAAKoX,EAAMpX,EAAI,GAAKqX,EAAMrX,EAAI,GACxCsX,EAAMtX,EAAI,GAAKuX,EAAMvX,EAAI,GAAKwX,EAAMxX,EAAI,GACxCyX,EAAMzX,EAAI,GAAK0X,EAAM1X,EAAI,GAAK2X,EAAM3X,EAAI,IAExC4X,EAAQT,EAAMI,EAAMI,EAErB,GAAKC,EAAQ,EAAI,CAEhB,MAAMjc,EAAI,GAAMlH,KAAK4I,KAAMua,EAAQ,GAEnCxnB,KAAKokB,GAAK,IAAO7Y,EACjBvL,KAAKikB,IAAOqD,EAAMF,GAAQ7b,EAC1BvL,KAAKkkB,IAAO+C,EAAMI,GAAQ9b,EAC1BvL,KAAKmkB,IAAO+C,EAAMF,GAAQzb,OAEpB,GAAKwb,EAAMI,GAAOJ,EAAMQ,EAAM,CAEpC,MAAMhc,EAAI,EAAMlH,KAAK4I,KAAM,EAAM8Z,EAAMI,EAAMI,GAE7CvnB,KAAKokB,IAAOkD,EAAMF,GAAQ7b,EAC1BvL,KAAKikB,GAAK,IAAO1Y,EACjBvL,KAAKkkB,IAAO8C,EAAME,GAAQ3b,EAC1BvL,KAAKmkB,IAAO8C,EAAMI,GAAQ9b,OAEpB,GAAK4b,EAAMI,EAAM,CAEvB,MAAMhc,EAAI,EAAMlH,KAAK4I,KAAM,EAAMka,EAAMJ,EAAMQ,GAE7CvnB,KAAKokB,IAAO6C,EAAMI,GAAQ9b,EAC1BvL,KAAKikB,IAAO+C,EAAME,GAAQ3b,EAC1BvL,KAAKkkB,GAAK,IAAO3Y,EACjBvL,KAAKmkB,IAAOiD,EAAME,GAAQ/b,MAEpB,CAEN,MAAMA,EAAI,EAAMlH,KAAK4I,KAAM,EAAMsa,EAAMR,EAAMI,GAE7CnnB,KAAKokB,IAAO8C,EAAMF,GAAQzb,EAC1BvL,KAAKikB,IAAOgD,EAAMI,GAAQ9b,EAC1BvL,KAAKkkB,IAAOkD,EAAME,GAAQ/b,EAC1BvL,KAAKmkB,GAAK,IAAO5Y,EAMlB,OAFAvL,KAAK6lB,oBAEE7lB,KAIRynB,mBAAoBC,EAAOC,GAI1B,IAAIhV,EAAI+U,EAAM5a,IAAK6a,GAAQ,EAmC3B,OAjCKhV,EAAI8S,OAAOC,SAIf/S,EAAI,EAECtO,KAAK8I,IAAKua,EAAMhe,GAAMrF,KAAK8I,IAAKua,EAAM1D,IAE1ChkB,KAAKikB,IAAOyD,EAAM/d,EAClB3J,KAAKkkB,GAAKwD,EAAMhe,EAChB1J,KAAKmkB,GAAK,EACVnkB,KAAKokB,GAAKzR,IAIV3S,KAAKikB,GAAK,EACVjkB,KAAKkkB,IAAOwD,EAAM1D,EAClBhkB,KAAKmkB,GAAKuD,EAAM/d,EAChB3J,KAAKokB,GAAKzR,KAQX3S,KAAKikB,GAAKyD,EAAM/d,EAAIge,EAAI3D,EAAI0D,EAAM1D,EAAI2D,EAAIhe,EAC1C3J,KAAKkkB,GAAKwD,EAAM1D,EAAI2D,EAAIje,EAAIge,EAAMhe,EAAIie,EAAI3D,EAC1ChkB,KAAKmkB,GAAKuD,EAAMhe,EAAIie,EAAIhe,EAAI+d,EAAM/d,EAAIge,EAAIje,EAC1C1J,KAAKokB,GAAKzR,GAIJ3S,KAAKoN,YAIbwa,QAAStI,GAER,OAAO,EAAIjb,KAAKwjB,KAAMxjB,KAAK8I,IAAK,EAAiBnN,KAAK8M,IAAKwS,IAAO,EAAG,KAItEwI,cAAexI,EAAGyI,GAEjB,MAAM1a,EAAQrN,KAAK4nB,QAAStI,GAE5B,GAAe,IAAVjS,EAAc,OAAOrN,KAE1B,MAAM4J,EAAIvF,KAAKmF,IAAK,EAAGue,EAAO1a,GAI9B,OAFArN,KAAKgoB,MAAO1I,EAAG1V,GAER5J,KAIR6P,WAEC,OAAO7P,KAAKuK,IAAK,EAAG,EAAG,EAAG,GAI3ByH,SAIC,OAAOhS,KAAKioB,YAIbA,YAQC,OANAjoB,KAAKikB,KAAQ,EACbjkB,KAAKkkB,KAAQ,EACblkB,KAAKmkB,KAAQ,EAEbnkB,KAAK6lB,oBAEE7lB,KAIR8M,IAAK7B,GAEJ,OAAOjL,KAAKikB,GAAKhZ,EAAEgZ,GAAKjkB,KAAKkkB,GAAKjZ,EAAEiZ,GAAKlkB,KAAKmkB,GAAKlZ,EAAEkZ,GAAKnkB,KAAKokB,GAAKnZ,EAAEmZ,GAIvEpX,WAEC,OAAOhN,KAAKikB,GAAKjkB,KAAKikB,GAAKjkB,KAAKkkB,GAAKlkB,KAAKkkB,GAAKlkB,KAAKmkB,GAAKnkB,KAAKmkB,GAAKnkB,KAAKokB,GAAKpkB,KAAKokB,GAInFliB,SAEC,OAAOmC,KAAK4I,KAAMjN,KAAKikB,GAAKjkB,KAAKikB,GAAKjkB,KAAKkkB,GAAKlkB,KAAKkkB,GAAKlkB,KAAKmkB,GAAKnkB,KAAKmkB,GAAKnkB,KAAKokB,GAAKpkB,KAAKokB,IAI9FhX,YAEC,IAAInL,EAAIjC,KAAKkC,SAsBb,OApBW,IAAND,GAEJjC,KAAKikB,GAAK,EACVjkB,KAAKkkB,GAAK,EACVlkB,KAAKmkB,GAAK,EACVnkB,KAAKokB,GAAK,IAIVniB,EAAI,EAAIA,EAERjC,KAAKikB,GAAKjkB,KAAKikB,GAAKhiB,EACpBjC,KAAKkkB,GAAKlkB,KAAKkkB,GAAKjiB,EACpBjC,KAAKmkB,GAAKnkB,KAAKmkB,GAAKliB,EACpBjC,KAAKokB,GAAKpkB,KAAKokB,GAAKniB,GAIrBjC,KAAK6lB,oBAEE7lB,KAIR8L,SAAUwT,EAAGD,GAEZ,YAAWte,IAANse,GAEJlU,QAAQC,KAAM,0GACPpL,KAAKkoB,oBAAqB5I,EAAGD,IAI9Brf,KAAKkoB,oBAAqBloB,KAAMsf,GAIxChP,YAAagP,GAEZ,OAAOtf,KAAKkoB,oBAAqB5I,EAAGtf,MAIrCkoB,oBAAqB1c,EAAGC,GAIvB,MAAM0c,EAAM3c,EAAEyY,GAAImE,EAAM5c,EAAE0Y,GAAImE,EAAM7c,EAAE2Y,GAAImE,EAAM9c,EAAE4Y,GAC5CmE,EAAM9c,EAAEwY,GAAIuE,EAAM/c,EAAEyY,GAAIuE,EAAMhd,EAAE0Y,GAAIuE,EAAMjd,EAAE2Y,GASlD,OAPApkB,KAAKikB,GAAKkE,EAAMO,EAAMJ,EAAMC,EAAMH,EAAMK,EAAMJ,EAAMG,EACpDxoB,KAAKkkB,GAAKkE,EAAMM,EAAMJ,EAAME,EAAMH,EAAME,EAAMJ,EAAMM,EACpDzoB,KAAKmkB,GAAKkE,EAAMK,EAAMJ,EAAMG,EAAMN,EAAMK,EAAMJ,EAAMG,EACpDvoB,KAAKokB,GAAKkE,EAAMI,EAAMP,EAAMI,EAAMH,EAAMI,EAAMH,EAAMI,EAEpDzoB,KAAK6lB,oBAEE7lB,KAIRgoB,MAAO1D,EAAI1a,GAEV,GAAW,IAANA,EAAU,OAAO5J,KACtB,GAAW,IAAN4J,EAAU,OAAO5J,KAAKgL,KAAMsZ,GAEjC,MAAM5a,EAAI1J,KAAKikB,GAAIta,EAAI3J,KAAKkkB,GAAIF,EAAIhkB,KAAKmkB,GAAIjZ,EAAIlL,KAAKokB,GAItD,IAAIuE,EAAezd,EAAIoZ,EAAGF,GAAK1a,EAAI4a,EAAGL,GAAKta,EAAI2a,EAAGJ,GAAKF,EAAIM,EAAGH,GAiB9D,GAfKwE,EAAe,GAEnB3oB,KAAKokB,IAAOE,EAAGF,GACfpkB,KAAKikB,IAAOK,EAAGL,GACfjkB,KAAKkkB,IAAOI,EAAGJ,GACflkB,KAAKmkB,IAAOG,EAAGH,GAEfwE,GAAiBA,GAIjB3oB,KAAKgL,KAAMsZ,GAIPqE,GAAgB,EAOpB,OALA3oB,KAAKokB,GAAKlZ,EACVlL,KAAKikB,GAAKva,EACV1J,KAAKkkB,GAAKva,EACV3J,KAAKmkB,GAAKH,EAEHhkB,KAIR,MAAM4oB,EAAkB,EAAMD,EAAeA,EAE7C,GAAKC,GAAmBnD,OAAOC,QAAU,CAExC,MAAMna,EAAI,EAAI3B,EASd,OARA5J,KAAKokB,GAAK7Y,EAAIL,EAAItB,EAAI5J,KAAKokB,GAC3BpkB,KAAKikB,GAAK1Y,EAAI7B,EAAIE,EAAI5J,KAAKikB,GAC3BjkB,KAAKkkB,GAAK3Y,EAAI5B,EAAIC,EAAI5J,KAAKkkB,GAC3BlkB,KAAKmkB,GAAK5Y,EAAIyY,EAAIpa,EAAI5J,KAAKmkB,GAE3BnkB,KAAKoN,YACLpN,KAAK6lB,oBAEE7lB,KAIR,MAAM6oB,EAAexkB,KAAK4I,KAAM2b,GAC1BE,EAAYzkB,KAAKiJ,MAAOub,EAAcF,GACtCI,EAAS1kB,KAAKwK,KAAO,EAAIjF,GAAMkf,GAAcD,EAClDG,EAAS3kB,KAAKwK,IAAKjF,EAAIkf,GAAcD,EAStC,OAPA7oB,KAAKokB,GAAOlZ,EAAI6d,EAAS/oB,KAAKokB,GAAK4E,EACnChpB,KAAKikB,GAAOva,EAAIqf,EAAS/oB,KAAKikB,GAAK+E,EACnChpB,KAAKkkB,GAAOva,EAAIof,EAAS/oB,KAAKkkB,GAAK8E,EACnChpB,KAAKmkB,GAAOH,EAAI+E,EAAS/oB,KAAKmkB,GAAK6E,EAEnChpB,KAAK6lB,oBAEE7lB,KAIRwkB,iBAAkBH,EAAIC,EAAI1a,GAEzB5J,KAAKgL,KAAMqZ,GAAK2D,MAAO1D,EAAI1a,GAI5BT,SAMC,MAAM8f,EAAK5kB,KAAK8E,SACV+f,EAAU7kB,KAAK4I,KAAM,EAAIgc,GACzBE,EAAS9kB,KAAK4I,KAAMgc,GAEpBG,EAAK,EAAI/kB,KAAKoE,GAAKpE,KAAK8E,SAExBkgB,EAAK,EAAIhlB,KAAKoE,GAAKpE,KAAK8E,SAE9B,OAAOnJ,KAAKuK,IACX2e,EAAU7kB,KAAKuK,IAAKwa,GACpBD,EAAS9kB,KAAKwK,IAAKwa,GACnBF,EAAS9kB,KAAKuK,IAAKya,GACnBH,EAAU7kB,KAAKwK,IAAKua,IAKtBnb,OAAQ6X,GAEP,OAASA,EAAW7B,KAAOjkB,KAAKikB,IAAU6B,EAAW5B,KAAOlkB,KAAKkkB,IAAU4B,EAAW3B,KAAOnkB,KAAKmkB,IAAU2B,EAAW1B,KAAOpkB,KAAKokB,GAIpIlW,UAAWzK,EAAO0K,EAAS,GAS1B,OAPAnO,KAAKikB,GAAKxgB,EAAO0K,GACjBnO,KAAKkkB,GAAKzgB,EAAO0K,EAAS,GAC1BnO,KAAKmkB,GAAK1gB,EAAO0K,EAAS,GAC1BnO,KAAKokB,GAAK3gB,EAAO0K,EAAS,GAE1BnO,KAAK6lB,oBAEE7lB,KAIRoO,QAAS3K,EAAQ,GAAI0K,EAAS,GAO7B,OALA1K,EAAO0K,GAAWnO,KAAKikB,GACvBxgB,EAAO0K,EAAS,GAAMnO,KAAKkkB,GAC3BzgB,EAAO0K,EAAS,GAAMnO,KAAKmkB,GAC3B1gB,EAAO0K,EAAS,GAAMnO,KAAKokB,GAEpB3gB,EAIR4K,oBAAqBC,EAAW1M,GAO/B,OALA5B,KAAKikB,GAAK3V,EAAUC,KAAM3M,GAC1B5B,KAAKkkB,GAAK5V,EAAUE,KAAM5M,GAC1B5B,KAAKmkB,GAAK7V,EAAU0T,KAAMpgB,GAC1B5B,KAAKokB,GAAK9V,EAAUgb,KAAM1nB,GAEnB5B,KAIRupB,UAAWnG,GAIV,OAFApjB,KAAK6lB,kBAAoBzC,EAElBpjB,KAIR6lB,sBAID9B,GAAW1kB,UAAUmqB,cAAe,EC3qBpC,MAAMC,GAELrpB,YAAasJ,EAAI,EAAGC,EAAI,EAAGqa,EAAI,GAE9BhkB,KAAK0J,EAAIA,EACT1J,KAAK2J,EAAIA,EACT3J,KAAKgkB,EAAIA,EAIVzZ,IAAKb,EAAGC,EAAGqa,GAQV,YANWjjB,IAANijB,IAAkBA,EAAIhkB,KAAKgkB,GAEhChkB,KAAK0J,EAAIA,EACT1J,KAAK2J,EAAIA,EACT3J,KAAKgkB,EAAIA,EAEFhkB,KAIRwK,UAAWC,GAMV,OAJAzK,KAAK0J,EAAIe,EACTzK,KAAK2J,EAAIc,EACTzK,KAAKgkB,EAAIvZ,EAEFzK,KAIR0K,KAAMhB,GAIL,OAFA1J,KAAK0J,EAAIA,EAEF1J,KAIR2K,KAAMhB,GAIL,OAFA3J,KAAK2J,EAAIA,EAEF3J,KAIR0pB,KAAM1F,GAIL,OAFAhkB,KAAKgkB,EAAIA,EAEFhkB,KAIR4K,aAAchJ,EAAOlC,GAEpB,OAASkC,GAER,KAAK,EAAG5B,KAAK0J,EAAIhK,EAAO,MACxB,KAAK,EAAGM,KAAK2J,EAAIjK,EAAO,MACxB,KAAK,EAAGM,KAAKgkB,EAAItkB,EAAO,MACxB,QAAS,MAAM,IAAImL,MAAO,0BAA4BjJ,GAIvD,OAAO5B,KAIR8K,aAAclJ,GAEb,OAASA,GAER,KAAK,EAAG,OAAO5B,KAAK0J,EACpB,KAAK,EAAG,OAAO1J,KAAK2J,EACpB,KAAK,EAAG,OAAO3J,KAAKgkB,EACpB,QAAS,MAAM,IAAInZ,MAAO,0BAA4BjJ,IAMxDmJ,QAEC,OAAO,IAAI/K,KAAKI,YAAaJ,KAAK0J,EAAG1J,KAAK2J,EAAG3J,KAAKgkB,GAInDhZ,KAAMC,GAML,OAJAjL,KAAK0J,EAAIuB,EAAEvB,EACX1J,KAAK2J,EAAIsB,EAAEtB,EACX3J,KAAKgkB,EAAI/Y,EAAE+Y,EAEJhkB,KAIRF,IAAKmL,EAAGC,GAEP,YAAWnK,IAANmK,GAEJC,QAAQC,KAAM,yFACPpL,KAAKqL,WAAYJ,EAAGC,KAI5BlL,KAAK0J,GAAKuB,EAAEvB,EACZ1J,KAAK2J,GAAKsB,EAAEtB,EACZ3J,KAAKgkB,GAAK/Y,EAAE+Y,EAELhkB,MAIRsL,UAAWC,GAMV,OAJAvL,KAAK0J,GAAK6B,EACVvL,KAAK2J,GAAK4B,EACVvL,KAAKgkB,GAAKzY,EAEHvL,KAIRqL,WAAYG,EAAGC,GAMd,OAJAzL,KAAK0J,EAAI8B,EAAE9B,EAAI+B,EAAE/B,EACjB1J,KAAK2J,EAAI6B,EAAE7B,EAAI8B,EAAE9B,EACjB3J,KAAKgkB,EAAIxY,EAAEwY,EAAIvY,EAAEuY,EAEVhkB,KAIR0L,gBAAiBT,EAAGM,GAMnB,OAJAvL,KAAK0J,GAAKuB,EAAEvB,EAAI6B,EAChBvL,KAAK2J,GAAKsB,EAAEtB,EAAI4B,EAChBvL,KAAKgkB,GAAK/Y,EAAE+Y,EAAIzY,EAETvL,KAIR2L,IAAKV,EAAGC,GAEP,YAAWnK,IAANmK,GAEJC,QAAQC,KAAM,yFACPpL,KAAK4L,WAAYX,EAAGC,KAI5BlL,KAAK0J,GAAKuB,EAAEvB,EACZ1J,KAAK2J,GAAKsB,EAAEtB,EACZ3J,KAAKgkB,GAAK/Y,EAAE+Y,EAELhkB,MAIR6L,UAAWN,GAMV,OAJAvL,KAAK0J,GAAK6B,EACVvL,KAAK2J,GAAK4B,EACVvL,KAAKgkB,GAAKzY,EAEHvL,KAIR4L,WAAYJ,EAAGC,GAMd,OAJAzL,KAAK0J,EAAI8B,EAAE9B,EAAI+B,EAAE/B,EACjB1J,KAAK2J,EAAI6B,EAAE7B,EAAI8B,EAAE9B,EACjB3J,KAAKgkB,EAAIxY,EAAEwY,EAAIvY,EAAEuY,EAEVhkB,KAIR8L,SAAUb,EAAGC,GAEZ,YAAWnK,IAANmK,GAEJC,QAAQC,KAAM,mGACPpL,KAAK2pB,gBAAiB1e,EAAGC,KAIjClL,KAAK0J,GAAKuB,EAAEvB,EACZ1J,KAAK2J,GAAKsB,EAAEtB,EACZ3J,KAAKgkB,GAAK/Y,EAAE+Y,EAELhkB,MAIR+L,eAAgBtB,GAMf,OAJAzK,KAAK0J,GAAKe,EACVzK,KAAK2J,GAAKc,EACVzK,KAAKgkB,GAAKvZ,EAEHzK,KAIR2pB,gBAAiBne,EAAGC,GAMnB,OAJAzL,KAAK0J,EAAI8B,EAAE9B,EAAI+B,EAAE/B,EACjB1J,KAAK2J,EAAI6B,EAAE7B,EAAI8B,EAAE9B,EACjB3J,KAAKgkB,EAAIxY,EAAEwY,EAAIvY,EAAEuY,EAEVhkB,KAIR4pB,WAAY5D,GAQX,OANSA,GAASA,EAAME,SAEvB/a,QAAQ+D,MAAO,+FAITlP,KAAK6pB,gBAAiBC,GAAY/D,aAAcC,IAIxD+D,eAAgBnD,EAAMvZ,GAErB,OAAOrN,KAAK6pB,gBAAiBC,GAAYnD,iBAAkBC,EAAMvZ,IAIlEnB,aAAcC,GAEb,MAAMzC,EAAI1J,KAAK0J,EAAGC,EAAI3J,KAAK2J,EAAGqa,EAAIhkB,KAAKgkB,EACjC5X,EAAID,EAAEE,SAMZ,OAJArM,KAAK0J,EAAI0C,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,GAAM4X,EAC5ChkB,KAAK2J,EAAIyC,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,GAAM4X,EAC5ChkB,KAAKgkB,EAAI5X,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,GAAM4X,EAErChkB,KAIRgqB,kBAAmB7d,GAElB,OAAOnM,KAAKkM,aAAcC,GAAIiB,YAI/B6c,aAAc9d,GAEb,MAAMzC,EAAI1J,KAAK0J,EAAGC,EAAI3J,KAAK2J,EAAGqa,EAAIhkB,KAAKgkB,EACjC5X,EAAID,EAAEE,SAENnB,EAAI,GAAMkB,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,IAAO4X,EAAI5X,EAAG,KAM3D,OAJApM,KAAK0J,GAAM0C,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,GAAM4X,EAAI5X,EAAG,KAASlB,EAC9DlL,KAAK2J,GAAMyC,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,GAAM4X,EAAI5X,EAAG,KAASlB,EAC9DlL,KAAKgkB,GAAM5X,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,IAAO4X,EAAI5X,EAAG,KAASlB,EAExDlL,KAIR6pB,gBAAiBvK,GAEhB,MAAM5V,EAAI1J,KAAK0J,EAAGC,EAAI3J,KAAK2J,EAAGqa,EAAIhkB,KAAKgkB,EACjCkG,EAAK5K,EAAE5V,EAAGygB,EAAK7K,EAAE3V,EAAGygB,EAAK9K,EAAE0E,EAAGqG,EAAK/K,EAAEpU,EAIrCof,EAAKD,EAAK3gB,EAAIygB,EAAKnG,EAAIoG,EAAKzgB,EAC5B4gB,EAAKF,EAAK1gB,EAAIygB,EAAK1gB,EAAIwgB,EAAKlG,EAC5BwG,EAAKH,EAAKrG,EAAIkG,EAAKvgB,EAAIwgB,EAAKzgB,EAC5B+gB,GAAOP,EAAKxgB,EAAIygB,EAAKxgB,EAAIygB,EAAKpG,EAQpC,OAJAhkB,KAAK0J,EAAI4gB,EAAKD,EAAKI,GAAOP,EAAKK,GAAOH,EAAKI,GAAOL,EAClDnqB,KAAK2J,EAAI4gB,EAAKF,EAAKI,GAAON,EAAKK,GAAON,EAAKI,GAAOF,EAClDpqB,KAAKgkB,EAAIwG,EAAKH,EAAKI,GAAOL,EAAKE,GAAOH,EAAKI,GAAOL,EAE3ClqB,KAIR0qB,QAASC,GAER,OAAO3qB,KAAKiqB,aAAcU,EAAOC,oBAAqBX,aAAcU,EAAOE,kBAI5EC,UAAWH,GAEV,OAAO3qB,KAAKiqB,aAAcU,EAAOI,yBAA0Bd,aAAcU,EAAOK,aAIjFC,mBAAoB9e,GAKnB,MAAMzC,EAAI1J,KAAK0J,EAAGC,EAAI3J,KAAK2J,EAAGqa,EAAIhkB,KAAKgkB,EACjC5X,EAAID,EAAEE,SAMZ,OAJArM,KAAK0J,EAAI0C,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,GAAM4X,EAC5ChkB,KAAK2J,EAAIyC,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,GAAM4X,EAC5ChkB,KAAKgkB,EAAI5X,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,IAAO4X,EAEtChkB,KAAKoN,YAIbpB,OAAQf,GAMP,OAJAjL,KAAK0J,GAAKuB,EAAEvB,EACZ1J,KAAK2J,GAAKsB,EAAEtB,EACZ3J,KAAKgkB,GAAK/Y,EAAE+Y,EAELhkB,KAIRiM,aAAcxB,GAEb,OAAOzK,KAAK+L,eAAgB,EAAItB,GAIjCjB,IAAKyB,GAMJ,OAJAjL,KAAK0J,EAAIrF,KAAKmF,IAAKxJ,KAAK0J,EAAGuB,EAAEvB,GAC7B1J,KAAK2J,EAAItF,KAAKmF,IAAKxJ,KAAK2J,EAAGsB,EAAEtB,GAC7B3J,KAAKgkB,EAAI3f,KAAKmF,IAAKxJ,KAAKgkB,EAAG/Y,EAAE+Y,GAEtBhkB,KAIR0D,IAAKuH,GAMJ,OAJAjL,KAAK0J,EAAIrF,KAAKX,IAAK1D,KAAK0J,EAAGuB,EAAEvB,GAC7B1J,KAAK2J,EAAItF,KAAKX,IAAK1D,KAAK2J,EAAGsB,EAAEtB,GAC7B3J,KAAKgkB,EAAI3f,KAAKX,IAAK1D,KAAKgkB,EAAG/Y,EAAE+Y,GAEtBhkB,KAIRuJ,MAAOC,EAAK9F,GAQX,OAJA1D,KAAK0J,EAAIrF,KAAKX,IAAK8F,EAAIE,EAAGrF,KAAKmF,IAAK9F,EAAIgG,EAAG1J,KAAK0J,IAChD1J,KAAK2J,EAAItF,KAAKX,IAAK8F,EAAIG,EAAGtF,KAAKmF,IAAK9F,EAAIiG,EAAG3J,KAAK2J,IAChD3J,KAAKgkB,EAAI3f,KAAKX,IAAK8F,EAAIwa,EAAG3f,KAAKmF,IAAK9F,EAAIsgB,EAAGhkB,KAAKgkB,IAEzChkB,KAIRsM,YAAaC,EAAQC,GAMpB,OAJAxM,KAAK0J,EAAIrF,KAAKX,IAAK6I,EAAQlI,KAAKmF,IAAKgD,EAAQxM,KAAK0J,IAClD1J,KAAK2J,EAAItF,KAAKX,IAAK6I,EAAQlI,KAAKmF,IAAKgD,EAAQxM,KAAK2J,IAClD3J,KAAKgkB,EAAI3f,KAAKX,IAAK6I,EAAQlI,KAAKmF,IAAKgD,EAAQxM,KAAKgkB,IAE3ChkB,KAIRyM,YAAajD,EAAK9F,GAEjB,MAAMxB,EAASlC,KAAKkC,SAEpB,OAAOlC,KAAKiM,aAAc/J,GAAU,GAAI6J,eAAgB1H,KAAKX,IAAK8F,EAAKnF,KAAKmF,IAAK9F,EAAKxB,KAIvF+H,QAMC,OAJAjK,KAAK0J,EAAIrF,KAAK4F,MAAOjK,KAAK0J,GAC1B1J,KAAK2J,EAAItF,KAAK4F,MAAOjK,KAAK2J,GAC1B3J,KAAKgkB,EAAI3f,KAAK4F,MAAOjK,KAAKgkB,GAEnBhkB,KAIR0M,OAMC,OAJA1M,KAAK0J,EAAIrF,KAAKqI,KAAM1M,KAAK0J,GACzB1J,KAAK2J,EAAItF,KAAKqI,KAAM1M,KAAK2J,GACzB3J,KAAKgkB,EAAI3f,KAAKqI,KAAM1M,KAAKgkB,GAElBhkB,KAIR2M,QAMC,OAJA3M,KAAK0J,EAAIrF,KAAKsI,MAAO3M,KAAK0J,GAC1B1J,KAAK2J,EAAItF,KAAKsI,MAAO3M,KAAK2J,GAC1B3J,KAAKgkB,EAAI3f,KAAKsI,MAAO3M,KAAKgkB,GAEnBhkB,KAIR4M,cAMC,OAJA5M,KAAK0J,EAAM1J,KAAK0J,EAAI,EAAMrF,KAAKqI,KAAM1M,KAAK0J,GAAMrF,KAAK4F,MAAOjK,KAAK0J,GACjE1J,KAAK2J,EAAM3J,KAAK2J,EAAI,EAAMtF,KAAKqI,KAAM1M,KAAK2J,GAAMtF,KAAK4F,MAAOjK,KAAK2J,GACjE3J,KAAKgkB,EAAMhkB,KAAKgkB,EAAI,EAAM3f,KAAKqI,KAAM1M,KAAKgkB,GAAM3f,KAAK4F,MAAOjK,KAAKgkB,GAE1DhkB,KAIR6M,SAMC,OAJA7M,KAAK0J,GAAM1J,KAAK0J,EAChB1J,KAAK2J,GAAM3J,KAAK2J,EAChB3J,KAAKgkB,GAAMhkB,KAAKgkB,EAEThkB,KAIR8M,IAAK7B,GAEJ,OAAOjL,KAAK0J,EAAIuB,EAAEvB,EAAI1J,KAAK2J,EAAIsB,EAAEtB,EAAI3J,KAAKgkB,EAAI/Y,EAAE+Y,EAMjDhX,WAEC,OAAOhN,KAAK0J,EAAI1J,KAAK0J,EAAI1J,KAAK2J,EAAI3J,KAAK2J,EAAI3J,KAAKgkB,EAAIhkB,KAAKgkB,EAI1D9hB,SAEC,OAAOmC,KAAK4I,KAAMjN,KAAK0J,EAAI1J,KAAK0J,EAAI1J,KAAK2J,EAAI3J,KAAK2J,EAAI3J,KAAKgkB,EAAIhkB,KAAKgkB,GAIrE9W,kBAEC,OAAO7I,KAAK8I,IAAKnN,KAAK0J,GAAMrF,KAAK8I,IAAKnN,KAAK2J,GAAMtF,KAAK8I,IAAKnN,KAAKgkB,GAIjE5W,YAEC,OAAOpN,KAAKiM,aAAcjM,KAAKkC,UAAY,GAI5C0L,UAAW1L,GAEV,OAAOlC,KAAKoN,YAAYrB,eAAgB7J,GAIzCuH,KAAMwB,EAAG4C,GAMR,OAJA7N,KAAK0J,IAAOuB,EAAEvB,EAAI1J,KAAK0J,GAAMmE,EAC7B7N,KAAK2J,IAAOsB,EAAEtB,EAAI3J,KAAK2J,GAAMkE,EAC7B7N,KAAKgkB,IAAO/Y,EAAE+Y,EAAIhkB,KAAKgkB,GAAMnW,EAEtB7N,KAIR8N,YAAaC,EAAIC,EAAIH,GAMpB,OAJA7N,KAAK0J,EAAIqE,EAAGrE,GAAMsE,EAAGtE,EAAIqE,EAAGrE,GAAMmE,EAClC7N,KAAK2J,EAAIoE,EAAGpE,GAAMqE,EAAGrE,EAAIoE,EAAGpE,GAAMkE,EAClC7N,KAAKgkB,EAAIjW,EAAGiW,GAAMhW,EAAGgW,EAAIjW,EAAGiW,GAAMnW,EAE3B7N,KAIR+M,MAAO9B,EAAGC,GAET,YAAWnK,IAANmK,GAEJC,QAAQC,KAAM,6FACPpL,KAAKkrB,aAAcjgB,EAAGC,IAIvBlL,KAAKkrB,aAAclrB,KAAMiL,GAIjCigB,aAAc1f,EAAGC,GAEhB,MAAM0f,EAAK3f,EAAE9B,EAAG0hB,EAAK5f,EAAE7B,EAAG0hB,EAAK7f,EAAEwY,EAC3BsH,EAAK7f,EAAE/B,EAAG6hB,EAAK9f,EAAE9B,EAAG6hB,EAAK/f,EAAEuY,EAMjC,OAJAhkB,KAAK0J,EAAI0hB,EAAKI,EAAKH,EAAKE,EACxBvrB,KAAK2J,EAAI0hB,EAAKC,EAAKH,EAAKK,EACxBxrB,KAAKgkB,EAAImH,EAAKI,EAAKH,EAAKE,EAEjBtrB,KAIRyrB,gBAAiBxgB,GAEhB,MAAMygB,EAAczgB,EAAE+B,WAEtB,GAAqB,IAAhB0e,EAAoB,OAAO1rB,KAAKuK,IAAK,EAAG,EAAG,GAEhD,MAAME,EAASQ,EAAE6B,IAAK9M,MAAS0rB,EAE/B,OAAO1rB,KAAKgL,KAAMC,GAAIc,eAAgBtB,GAIvCkhB,eAAgBC,GAIf,OAFAC,GAAQ7gB,KAAMhL,MAAOyrB,gBAAiBG,GAE/B5rB,KAAK2L,IAAKkgB,IAIlBC,QAASC,GAKR,OAAO/rB,KAAK2L,IAAKkgB,GAAQ7gB,KAAM+gB,GAAShgB,eAAgB,EAAI/L,KAAK8M,IAAKif,KAIvEnE,QAAS3c,GAER,MAAMygB,EAAcrnB,KAAK4I,KAAMjN,KAAKgN,WAAa/B,EAAE+B,YAEnD,GAAqB,IAAhB0e,EAAoB,OAAOrnB,KAAKoE,GAAK,EAE1C,MAAM6K,EAAQtT,KAAK8M,IAAK7B,GAAMygB,EAI9B,OAAOrnB,KAAKwjB,KAAM,EAAiBvU,GAAS,EAAG,IAIhD/F,WAAYtC,GAEX,OAAO5G,KAAK4I,KAAMjN,KAAKwN,kBAAmBvC,IAI3CuC,kBAAmBvC,GAElB,MAAMwC,EAAKzN,KAAK0J,EAAIuB,EAAEvB,EAAGgE,EAAK1N,KAAK2J,EAAIsB,EAAEtB,EAAGqiB,EAAKhsB,KAAKgkB,EAAI/Y,EAAE+Y,EAE5D,OAAOvW,EAAKA,EAAKC,EAAKA,EAAKse,EAAKA,EAIjCre,oBAAqB1C,GAEpB,OAAO5G,KAAK8I,IAAKnN,KAAK0J,EAAIuB,EAAEvB,GAAMrF,KAAK8I,IAAKnN,KAAK2J,EAAIsB,EAAEtB,GAAMtF,KAAK8I,IAAKnN,KAAKgkB,EAAI/Y,EAAE+Y,GAInFiI,iBAAkB1gB,GAEjB,OAAOvL,KAAKksB,uBAAwB3gB,EAAE4gB,OAAQ5gB,EAAE6gB,IAAK7gB,EAAE+H,OAIxD4Y,uBAAwBC,EAAQC,EAAK9Y,GAEpC,MAAM+Y,EAAehoB,KAAKwK,IAAKud,GAAQD,EAMvC,OAJAnsB,KAAK0J,EAAI2iB,EAAehoB,KAAKwK,IAAKyE,GAClCtT,KAAK2J,EAAItF,KAAKuK,IAAKwd,GAAQD,EAC3BnsB,KAAKgkB,EAAIqI,EAAehoB,KAAKuK,IAAK0E,GAE3BtT,KAIRssB,mBAAoB3d,GAEnB,OAAO3O,KAAKusB,yBAA0B5d,EAAEwd,OAAQxd,EAAE2E,MAAO3E,EAAEhF,GAI5D4iB,yBAA0BJ,EAAQ7Y,EAAO3J,GAMxC,OAJA3J,KAAK0J,EAAIyiB,EAAS9nB,KAAKwK,IAAKyE,GAC5BtT,KAAK2J,EAAIA,EACT3J,KAAKgkB,EAAImI,EAAS9nB,KAAKuK,IAAK0E,GAErBtT,KAIRwsB,sBAAuBrgB,GAEtB,MAAMC,EAAID,EAAEE,SAMZ,OAJArM,KAAK0J,EAAI0C,EAAG,IACZpM,KAAK2J,EAAIyC,EAAG,IACZpM,KAAKgkB,EAAI5X,EAAG,IAELpM,KAIRysB,mBAAoBtgB,GAEnB,MAAM4G,EAAK/S,KAAK0sB,oBAAqBvgB,EAAG,GAAIjK,SACtC8Q,EAAKhT,KAAK0sB,oBAAqBvgB,EAAG,GAAIjK,SACtCyqB,EAAK3sB,KAAK0sB,oBAAqBvgB,EAAG,GAAIjK,SAM5C,OAJAlC,KAAK0J,EAAIqJ,EACT/S,KAAK2J,EAAIqJ,EACThT,KAAKgkB,EAAI2I,EAEF3sB,KAIR0sB,oBAAqBvgB,EAAGvK,GAEvB,OAAO5B,KAAKkO,UAAW/B,EAAEE,SAAkB,EAARzK,GAIpCuO,qBAAsBhE,EAAGvK,GAExB,OAAO5B,KAAKkO,UAAW/B,EAAEE,SAAkB,EAARzK,GAIpCqM,OAAQhD,GAEP,OAAWA,EAAEvB,IAAM1J,KAAK0J,GAASuB,EAAEtB,IAAM3J,KAAK2J,GAASsB,EAAE+Y,IAAMhkB,KAAKgkB,EAIrE9V,UAAWzK,EAAO0K,EAAS,GAM1B,OAJAnO,KAAK0J,EAAIjG,EAAO0K,GAChBnO,KAAK2J,EAAIlG,EAAO0K,EAAS,GACzBnO,KAAKgkB,EAAIvgB,EAAO0K,EAAS,GAElBnO,KAIRoO,QAAS3K,EAAQ,GAAI0K,EAAS,GAM7B,OAJA1K,EAAO0K,GAAWnO,KAAK0J,EACvBjG,EAAO0K,EAAS,GAAMnO,KAAK2J,EAC3BlG,EAAO0K,EAAS,GAAMnO,KAAKgkB,EAEpBvgB,EAIR4K,oBAAqBC,EAAW1M,EAAOuM,GAYtC,YAVgBpN,IAAXoN,GAEJhD,QAAQC,KAAM,uEAIfpL,KAAK0J,EAAI4E,EAAUC,KAAM3M,GACzB5B,KAAK2J,EAAI2E,EAAUE,KAAM5M,GACzB5B,KAAKgkB,EAAI1V,EAAU0T,KAAMpgB,GAElB5B,KAIRmJ,SAMC,OAJAnJ,KAAK0J,EAAIrF,KAAK8E,SACdnJ,KAAK2J,EAAItF,KAAK8E,SACdnJ,KAAKgkB,EAAI3f,KAAK8E,SAEPnJ,KAIR4sB,kBAIC,MAAMC,EAA8B,GAAxBxoB,KAAK8E,SAAW,IACtBS,EAAIvF,KAAK8E,SAAW9E,KAAKoE,GAAK,EAC9BoJ,EAAIxN,KAAK4I,KAAM,EAAI4f,GAAK,GAM9B,OAJA7sB,KAAK0J,EAAImI,EAAIxN,KAAKuK,IAAKhF,GACvB5J,KAAK2J,EAAIkI,EAAIxN,KAAKwK,IAAKjF,GACvB5J,KAAKgkB,EAAI6I,EAEF7sB,KAIR,EAAGR,OAAOsP,kBAEH9O,KAAK0J,QACL1J,KAAK2J,QACL3J,KAAKgkB,GAMbyF,GAAQpqB,UAAUub,WAAY,EAE9B,MAAMiR,GAAwB,IAAIpC,GAC5BK,GAA4B,IAAI/F,GCpuBtC,MAAM+I,GAEL1sB,YAAaoJ,EAAM,IAAIigB,GAAS,IAAY,IAAY,KAAc/lB,EAAM,IAAI+lB,IAAS,KAAY,KAAY,MAEhHzpB,KAAKwJ,IAAMA,EACXxJ,KAAK0D,IAAMA,EAIZ6G,IAAKf,EAAK9F,GAKT,OAHA1D,KAAKwJ,IAAIwB,KAAMxB,GACfxJ,KAAK0D,IAAIsH,KAAMtH,GAER1D,KAIR+sB,aAActpB,GAEb,IAAIupB,EAAO,IACPC,EAAO,IACPC,EAAO,IAEPC,GAAO,IACPC,GAAO,IACPC,GAAO,IAEX,IAAM,IAAIrrB,EAAI,EAAGC,EAAIwB,EAAMvB,OAAQF,EAAIC,EAAGD,GAAK,EAAI,CAElD,MAAM0H,EAAIjG,EAAOzB,GACX2H,EAAIlG,EAAOzB,EAAI,GACfgiB,EAAIvgB,EAAOzB,EAAI,GAEhB0H,EAAIsjB,IAAOA,EAAOtjB,GAClBC,EAAIsjB,IAAOA,EAAOtjB,GAClBqa,EAAIkJ,IAAOA,EAAOlJ,GAElBta,EAAIyjB,IAAOA,EAAOzjB,GAClBC,EAAIyjB,IAAOA,EAAOzjB,GAClBqa,EAAIqJ,IAAOA,EAAOrJ,GAOxB,OAHAhkB,KAAKwJ,IAAIe,IAAKyiB,EAAMC,EAAMC,GAC1BltB,KAAK0D,IAAI6G,IAAK4iB,EAAMC,EAAMC,GAEnBrtB,KAIRstB,uBAAwBhf,GAEvB,IAAI0e,EAAO,IACPC,EAAO,IACPC,EAAO,IAEPC,GAAO,IACPC,GAAO,IACPC,GAAO,IAEX,IAAM,IAAIrrB,EAAI,EAAGC,EAAIqM,EAAUif,MAAOvrB,EAAIC,EAAGD,IAAO,CAEnD,MAAM0H,EAAI4E,EAAUC,KAAMvM,GACpB2H,EAAI2E,EAAUE,KAAMxM,GACpBgiB,EAAI1V,EAAU0T,KAAMhgB,GAErB0H,EAAIsjB,IAAOA,EAAOtjB,GAClBC,EAAIsjB,IAAOA,EAAOtjB,GAClBqa,EAAIkJ,IAAOA,EAAOlJ,GAElBta,EAAIyjB,IAAOA,EAAOzjB,GAClBC,EAAIyjB,IAAOA,EAAOzjB,GAClBqa,EAAIqJ,IAAOA,EAAOrJ,GAOxB,OAHAhkB,KAAKwJ,IAAIe,IAAKyiB,EAAMC,EAAMC,GAC1BltB,KAAK0D,IAAI6G,IAAK4iB,EAAMC,EAAMC,GAEnBrtB,KAIRwtB,cAAeC,GAEdztB,KAAK0tB,YAEL,IAAM,IAAI1rB,EAAI,EAAG2rB,EAAKF,EAAOvrB,OAAQF,EAAI2rB,EAAI3rB,IAE5ChC,KAAK4tB,cAAeH,EAAQzrB,IAI7B,OAAOhC,KAIR6tB,qBAAsBnf,EAAQ0P,GAE7B,MAAM0P,EAAW,GAAQ9iB,KAAMoT,GAAOrS,eAAgB,IAKtD,OAHA/L,KAAKwJ,IAAIwB,KAAM0D,GAAS/C,IAAKmiB,GAC7B9tB,KAAK0D,IAAIsH,KAAM0D,GAAS5O,IAAKguB,GAEtB9tB,KAIR+tB,cAAeC,GAId,OAFAhuB,KAAK0tB,YAEE1tB,KAAKiuB,eAAgBD,GAI7BjjB,QAEC,OAAO,IAAI/K,KAAKI,aAAc4K,KAAMhL,MAIrCgL,KAAMkjB,GAKL,OAHAluB,KAAKwJ,IAAIwB,KAAMkjB,EAAI1kB,KACnBxJ,KAAK0D,IAAIsH,KAAMkjB,EAAIxqB,KAEZ1D,KAIR0tB,YAKC,OAHA1tB,KAAKwJ,IAAIE,EAAI1J,KAAKwJ,IAAIG,EAAI3J,KAAKwJ,IAAIwa,EAAI,IACvChkB,KAAK0D,IAAIgG,EAAI1J,KAAK0D,IAAIiG,EAAI3J,KAAK0D,IAAIsgB,GAAI,IAEhChkB,KAIRmuB,UAIC,OAASnuB,KAAK0D,IAAIgG,EAAI1J,KAAKwJ,IAAIE,GAAS1J,KAAK0D,IAAIiG,EAAI3J,KAAKwJ,IAAIG,GAAS3J,KAAK0D,IAAIsgB,EAAIhkB,KAAKwJ,IAAIwa,EAI9FoK,UAAW/nB,GAEV,OAAOrG,KAAKmuB,UAAY9nB,EAAOkE,IAAK,EAAG,EAAG,GAAMlE,EAAOgF,WAAYrL,KAAKwJ,IAAKxJ,KAAK0D,KAAMqI,eAAgB,IAIzGsiB,QAAShoB,GAER,OAAOrG,KAAKmuB,UAAY9nB,EAAOkE,IAAK,EAAG,EAAG,GAAMlE,EAAOuF,WAAY5L,KAAK0D,IAAK1D,KAAKwJ,KAInFokB,cAAeU,GAKd,OAHAtuB,KAAKwJ,IAAIA,IAAK8kB,GACdtuB,KAAK0D,IAAIA,IAAK4qB,GAEPtuB,KAIRuuB,eAAgBC,GAKf,OAHAxuB,KAAKwJ,IAAImC,IAAK6iB,GACdxuB,KAAK0D,IAAI5D,IAAK0uB,GAEPxuB,KAIRyuB,eAAgBhkB,GAKf,OAHAzK,KAAKwJ,IAAI8B,WAAab,GACtBzK,KAAK0D,IAAI4H,UAAWb,GAEbzK,KAIRiuB,eAAgBD,GAKfA,EAAOU,mBAAmB,GAAO,GAEjC,MAAMC,EAAWX,EAAOW,cAEN5tB,IAAb4tB,IAE0B,OAAzBA,EAASC,aAEbD,EAASE,qBAIVC,GAAK9jB,KAAM2jB,EAASC,aACpBE,GAAK7E,aAAc+D,EAAOhD,aAE1BhrB,KAAK+uB,MAAOD,KAIb,MAAME,EAAWhB,EAAOgB,SAExB,IAAM,IAAIhtB,EAAI,EAAGC,EAAI+sB,EAAS9sB,OAAQF,EAAIC,EAAGD,IAE5ChC,KAAKiuB,eAAgBe,EAAUhtB,IAIhC,OAAOhC,KAIRivB,cAAeX,GAEd,QAAOA,EAAM5kB,EAAI1J,KAAKwJ,IAAIE,GAAK4kB,EAAM5kB,EAAI1J,KAAK0D,IAAIgG,GACjD4kB,EAAM3kB,EAAI3J,KAAKwJ,IAAIG,GAAK2kB,EAAM3kB,EAAI3J,KAAK0D,IAAIiG,GAC3C2kB,EAAMtK,EAAIhkB,KAAKwJ,IAAIwa,GAAKsK,EAAMtK,EAAIhkB,KAAK0D,IAAIsgB,GAI7CkL,YAAahB,GAEZ,OAAOluB,KAAKwJ,IAAIE,GAAKwkB,EAAI1kB,IAAIE,GAAKwkB,EAAIxqB,IAAIgG,GAAK1J,KAAK0D,IAAIgG,GACvD1J,KAAKwJ,IAAIG,GAAKukB,EAAI1kB,IAAIG,GAAKukB,EAAIxqB,IAAIiG,GAAK3J,KAAK0D,IAAIiG,GACjD3J,KAAKwJ,IAAIwa,GAAKkK,EAAI1kB,IAAIwa,GAAKkK,EAAIxqB,IAAIsgB,GAAKhkB,KAAK0D,IAAIsgB,EAInDmL,aAAcb,EAAOjoB,GAKpB,OAAOA,EAAOkE,KACX+jB,EAAM5kB,EAAI1J,KAAKwJ,IAAIE,IAAQ1J,KAAK0D,IAAIgG,EAAI1J,KAAKwJ,IAAIE,IACjD4kB,EAAM3kB,EAAI3J,KAAKwJ,IAAIG,IAAQ3J,KAAK0D,IAAIiG,EAAI3J,KAAKwJ,IAAIG,IACjD2kB,EAAMtK,EAAIhkB,KAAKwJ,IAAIwa,IAAQhkB,KAAK0D,IAAIsgB,EAAIhkB,KAAKwJ,IAAIwa,IAKrDoL,cAAelB,GAGd,QAAOA,EAAIxqB,IAAIgG,EAAI1J,KAAKwJ,IAAIE,GAAKwkB,EAAI1kB,IAAIE,EAAI1J,KAAK0D,IAAIgG,GACrDwkB,EAAIxqB,IAAIiG,EAAI3J,KAAKwJ,IAAIG,GAAKukB,EAAI1kB,IAAIG,EAAI3J,KAAK0D,IAAIiG,GAC/CukB,EAAIxqB,IAAIsgB,EAAIhkB,KAAKwJ,IAAIwa,GAAKkK,EAAI1kB,IAAIwa,EAAIhkB,KAAK0D,IAAIsgB,GAIjDqL,iBAAkBC,GAMjB,OAHAtvB,KAAKuvB,WAAYD,EAAO5gB,OAAQ,IAGzB,GAAQlB,kBAAmB8hB,EAAO5gB,SAAc4gB,EAAOnD,OAASmD,EAAOnD,OAI/EqD,gBAAiBC,GAKhB,IAAIjmB,EAAK9F,EAsCT,OApCK+rB,EAAM1D,OAAOriB,EAAI,GAErBF,EAAMimB,EAAM1D,OAAOriB,EAAI1J,KAAKwJ,IAAIE,EAChChG,EAAM+rB,EAAM1D,OAAOriB,EAAI1J,KAAK0D,IAAIgG,IAIhCF,EAAMimB,EAAM1D,OAAOriB,EAAI1J,KAAK0D,IAAIgG,EAChChG,EAAM+rB,EAAM1D,OAAOriB,EAAI1J,KAAKwJ,IAAIE,GAI5B+lB,EAAM1D,OAAOpiB,EAAI,GAErBH,GAAOimB,EAAM1D,OAAOpiB,EAAI3J,KAAKwJ,IAAIG,EACjCjG,GAAO+rB,EAAM1D,OAAOpiB,EAAI3J,KAAK0D,IAAIiG,IAIjCH,GAAOimB,EAAM1D,OAAOpiB,EAAI3J,KAAK0D,IAAIiG,EACjCjG,GAAO+rB,EAAM1D,OAAOpiB,EAAI3J,KAAKwJ,IAAIG,GAI7B8lB,EAAM1D,OAAO/H,EAAI,GAErBxa,GAAOimB,EAAM1D,OAAO/H,EAAIhkB,KAAKwJ,IAAIwa,EACjCtgB,GAAO+rB,EAAM1D,OAAO/H,EAAIhkB,KAAK0D,IAAIsgB,IAIjCxa,GAAOimB,EAAM1D,OAAO/H,EAAIhkB,KAAK0D,IAAIsgB,EACjCtgB,GAAO+rB,EAAM1D,OAAO/H,EAAIhkB,KAAKwJ,IAAIwa,GAIzBxa,IAASimB,EAAMC,UAAYhsB,IAAS+rB,EAAMC,SAIpDC,mBAAoBC,GAEnB,GAAK5vB,KAAKmuB,UAET,OAAO,EAKRnuB,KAAKouB,UAAWyB,IAChBC,GAASlkB,WAAY5L,KAAK0D,IAAKmsB,IAG/BE,GAAInkB,WAAYgkB,EAASpkB,EAAGqkB,IAC5BG,GAAIpkB,WAAYgkB,EAASnkB,EAAGokB,IAC5BI,GAAIrkB,WAAYgkB,EAASjhB,EAAGkhB,IAG5BK,GAAItkB,WAAYokB,GAAKD,IACrBI,GAAIvkB,WAAYqkB,GAAKD,IACrBI,GAAIxkB,WAAYmkB,GAAKE,IAKrB,IAAII,EAAO,CACV,GAAKH,GAAIlM,EAAGkM,GAAIvmB,EAAG,GAAKwmB,GAAInM,EAAGmM,GAAIxmB,EAAG,GAAKymB,GAAIpM,EAAGoM,GAAIzmB,EACtDumB,GAAIlM,EAAG,GAAKkM,GAAIxmB,EAAGymB,GAAInM,EAAG,GAAKmM,GAAIzmB,EAAG0mB,GAAIpM,EAAG,GAAKoM,GAAI1mB,GACpDwmB,GAAIvmB,EAAGumB,GAAIxmB,EAAG,GAAKymB,GAAIxmB,EAAGwmB,GAAIzmB,EAAG,GAAK0mB,GAAIzmB,EAAGymB,GAAI1mB,EAAG,GAEvD,QAAO4mB,GAAYD,EAAMN,GAAKC,GAAKC,GAAKH,MAOxCO,EAAO,CAAE,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,KAC1BC,GAAYD,EAAMN,GAAKC,GAAKC,GAAKH,MAQxCS,GAAgBrF,aAAcgF,GAAKC,IACnCE,EAAO,CAAEE,GAAgB7mB,EAAG6mB,GAAgB5mB,EAAG4mB,GAAgBvM,GAExDsM,GAAYD,EAAMN,GAAKC,GAAKC,GAAKH,MAIzCP,WAAYjB,EAAOjoB,GAElB,OAAOA,EAAO2E,KAAMsjB,GAAQ/kB,MAAOvJ,KAAKwJ,IAAKxJ,KAAK0D,KAInD8sB,gBAAiBlC,GAIhB,OAFqB,GAAQtjB,KAAMsjB,GAAQ/kB,MAAOvJ,KAAKwJ,IAAKxJ,KAAK0D,KAE7CiI,IAAK2iB,GAAQpsB,SAIlCuuB,kBAAmBpqB,GAMlB,OAJArG,KAAKouB,UAAW/nB,EAAOqI,QAEvBrI,EAAO8lB,OAA4C,GAAnCnsB,KAAKquB,QAAS,IAAUnsB,SAEjCmE,EAIRqqB,UAAWxC,GAQV,OANAluB,KAAKwJ,IAAI9F,IAAKwqB,EAAI1kB,KAClBxJ,KAAK0D,IAAI8F,IAAK0kB,EAAIxqB,KAGb1D,KAAKmuB,WAAYnuB,KAAK0tB,YAEpB1tB,KAIR+uB,MAAOb,GAKN,OAHAluB,KAAKwJ,IAAIA,IAAK0kB,EAAI1kB,KAClBxJ,KAAK0D,IAAIA,IAAKwqB,EAAIxqB,KAEX1D,KAIRiqB,aAAczW,GAGb,OAAKxT,KAAKmuB,YAGVwC,GAAS,GAAIpmB,IAAKvK,KAAKwJ,IAAIE,EAAG1J,KAAKwJ,IAAIG,EAAG3J,KAAKwJ,IAAIwa,GAAIiG,aAAczW,GACrEmd,GAAS,GAAIpmB,IAAKvK,KAAKwJ,IAAIE,EAAG1J,KAAKwJ,IAAIG,EAAG3J,KAAK0D,IAAIsgB,GAAIiG,aAAczW,GACrEmd,GAAS,GAAIpmB,IAAKvK,KAAKwJ,IAAIE,EAAG1J,KAAK0D,IAAIiG,EAAG3J,KAAKwJ,IAAIwa,GAAIiG,aAAczW,GACrEmd,GAAS,GAAIpmB,IAAKvK,KAAKwJ,IAAIE,EAAG1J,KAAK0D,IAAIiG,EAAG3J,KAAK0D,IAAIsgB,GAAIiG,aAAczW,GACrEmd,GAAS,GAAIpmB,IAAKvK,KAAK0D,IAAIgG,EAAG1J,KAAKwJ,IAAIG,EAAG3J,KAAKwJ,IAAIwa,GAAIiG,aAAczW,GACrEmd,GAAS,GAAIpmB,IAAKvK,KAAK0D,IAAIgG,EAAG1J,KAAKwJ,IAAIG,EAAG3J,KAAK0D,IAAIsgB,GAAIiG,aAAczW,GACrEmd,GAAS,GAAIpmB,IAAKvK,KAAK0D,IAAIgG,EAAG1J,KAAK0D,IAAIiG,EAAG3J,KAAKwJ,IAAIwa,GAAIiG,aAAczW,GACrEmd,GAAS,GAAIpmB,IAAKvK,KAAK0D,IAAIgG,EAAG1J,KAAK0D,IAAIiG,EAAG3J,KAAK0D,IAAIsgB,GAAIiG,aAAczW,GAErExT,KAAKwtB,cAAemD,KAZS3wB,KAkB9BuT,UAAWpF,GAKV,OAHAnO,KAAKwJ,IAAI1J,IAAKqO,GACdnO,KAAK0D,IAAI5D,IAAKqO,GAEPnO,KAIRiO,OAAQigB,GAEP,OAAOA,EAAI1kB,IAAIyE,OAAQjO,KAAKwJ,MAAS0kB,EAAIxqB,IAAIuK,OAAQjO,KAAK0D,MAM5DopB,GAAKztB,UAAUuxB,QAAS,EAExB,MAAMD,GAAU,CACD,IAAIlH,GACJ,IAAIA,GACJ,IAAIA,GACJ,IAAIA,GACJ,IAAIA,GACJ,IAAIA,GACJ,IAAIA,GACJ,IAAIA,IAGb,GAAwB,IAAIA,GAE5BqF,GAAqB,IAAIhC,GAIzBiD,GAAoB,IAAItG,GACxBuG,GAAoB,IAAIvG,GACxBwG,GAAoB,IAAIxG,GAIxByG,GAAoB,IAAIzG,GACxB0G,GAAoB,IAAI1G,GACxB2G,GAAoB,IAAI3G,GAExBoG,GAAwB,IAAIpG,GAC5BqG,GAAyB,IAAIrG,GAC7B8G,GAAgC,IAAI9G,GACpCoH,GAA0B,IAAIpH,GAEpC,SAAS6G,GAAYD,EAAMS,EAAI/iB,EAAIC,EAAI+iB,GAEtC,IAAM,IAAI/uB,EAAI,EAAGgvB,EAAIX,EAAKnuB,OAAS,EAAGF,GAAKgvB,EAAGhvB,GAAK,EAAI,CAEtD6uB,GAAU3iB,UAAWmiB,EAAMruB,GAE3B,MAAM2Q,EAAIoe,EAAQrnB,EAAIrF,KAAK8I,IAAK0jB,GAAUnnB,GAAMqnB,EAAQpnB,EAAItF,KAAK8I,IAAK0jB,GAAUlnB,GAAMonB,EAAQ/M,EAAI3f,KAAK8I,IAAK0jB,GAAU7M,GAEhHiN,EAAKH,EAAGhkB,IAAK+jB,IACbK,EAAKnjB,EAAGjB,IAAK+jB,IACbM,EAAKnjB,EAAGlB,IAAK+jB,IAEnB,GAAKxsB,KAAKX,KAAOW,KAAKX,IAAKutB,EAAIC,EAAIC,GAAM9sB,KAAKmF,IAAKynB,EAAIC,EAAIC,IAASxe,EAInE,OAAO,EAMT,OAAO,EC9fR,MAAM,GAAqB,IAAIma,GACzB,GAAoB,IAAIrD,GACxB2H,GAAiC,IAAI3H,GACrC4H,GAAyB,IAAI5H,GAEnC,MAAM6H,GAELlxB,YAAasO,EAAS,IAAI+a,GAAW0C,GAAS,GAE7CnsB,KAAK0O,OAASA,EACd1O,KAAKmsB,OAASA,EAIf5hB,IAAKmE,EAAQyd,GAKZ,OAHAnsB,KAAK0O,OAAO1D,KAAM0D,GAClB1O,KAAKmsB,OAASA,EAEPnsB,KAIRwtB,cAAeC,EAAQ8D,GAEtB,MAAM7iB,EAAS1O,KAAK0O,YAEI3N,IAAnBwwB,EAEJ7iB,EAAO1D,KAAMumB,GAIb,GAAK/D,cAAeC,GAASW,UAAW1f,GAIzC,IAAI8iB,EAAc,EAElB,IAAM,IAAIxvB,EAAI,EAAG2rB,EAAKF,EAAOvrB,OAAQF,EAAI2rB,EAAI3rB,IAE5CwvB,EAAcntB,KAAKX,IAAK8tB,EAAa9iB,EAAOlB,kBAAmBigB,EAAQzrB,KAMxE,OAFAhC,KAAKmsB,OAAS9nB,KAAK4I,KAAMukB,GAElBxxB,KAIRgL,KAAMskB,GAKL,OAHAtvB,KAAK0O,OAAO1D,KAAMskB,EAAO5gB,QACzB1O,KAAKmsB,OAASmD,EAAOnD,OAEdnsB,KAIRmuB,UAEC,OAASnuB,KAAKmsB,OAAS,EAIxBuB,YAKC,OAHA1tB,KAAK0O,OAAOnE,IAAK,EAAG,EAAG,GACvBvK,KAAKmsB,QAAW,EAETnsB,KAIRivB,cAAeX,GAEd,OAASA,EAAM9gB,kBAAmBxN,KAAK0O,SAAc1O,KAAKmsB,OAASnsB,KAAKmsB,OAIzEqE,gBAAiBlC,GAEhB,OAASA,EAAM/gB,WAAYvN,KAAK0O,QAAW1O,KAAKmsB,OAIjDkD,iBAAkBC,GAEjB,MAAMmC,EAAYzxB,KAAKmsB,OAASmD,EAAOnD,OAEvC,OAAOmD,EAAO5gB,OAAOlB,kBAAmBxN,KAAK0O,SAAc+iB,EAAYA,EAIxErC,cAAelB,GAEd,OAAOA,EAAImB,iBAAkBrvB,MAI9BwvB,gBAAiBC,GAEhB,OAAOprB,KAAK8I,IAAKsiB,EAAMe,gBAAiBxwB,KAAK0O,UAAc1O,KAAKmsB,OAIjEoD,WAAYjB,EAAOjoB,GAElB,MAAMqrB,EAAgB1xB,KAAK0O,OAAOlB,kBAAmB8gB,GAWrD,OATAjoB,EAAO2E,KAAMsjB,GAERoD,EAAkB1xB,KAAKmsB,OAASnsB,KAAKmsB,SAEzC9lB,EAAOsF,IAAK3L,KAAK0O,QAAStB,YAC1B/G,EAAO0F,eAAgB/L,KAAKmsB,QAASrsB,IAAKE,KAAK0O,SAIzCrI,EAIRsrB,eAAgBtrB,GAEf,OAAKrG,KAAKmuB,WAGT9nB,EAAOqnB,YACArnB,IAIRA,EAAOkE,IAAKvK,KAAK0O,OAAQ1O,KAAK0O,QAC9BrI,EAAOooB,eAAgBzuB,KAAKmsB,QAErB9lB,GAIR4jB,aAAczW,GAKb,OAHAxT,KAAK0O,OAAOub,aAAczW,GAC1BxT,KAAKmsB,OAASnsB,KAAKmsB,OAAS3Y,EAAOoe,oBAE5B5xB,KAIRuT,UAAWpF,GAIV,OAFAnO,KAAK0O,OAAO5O,IAAKqO,GAEVnO,KAIR4tB,cAAeU,GAId+C,GAASzlB,WAAY0iB,EAAOtuB,KAAK0O,QAEjC,MAAM1B,EAAWqkB,GAASrkB,WAE1B,GAAKA,EAAahN,KAAKmsB,OAASnsB,KAAKmsB,OAAW,CAE/C,MAAMjqB,EAASmC,KAAK4I,KAAMD,GACpB6kB,EAA+C,IAAzB3vB,EAASlC,KAAKmsB,QAM1CnsB,KAAK0O,OAAO5O,IAAKuxB,GAAStlB,eAAgB8lB,EAAoB3vB,IAC9DlC,KAAKmsB,QAAU0F,EAIhB,OAAO7xB,KAIR+uB,MAAOO,GAaN,OALA8B,GAAiBxlB,WAAY0jB,EAAO5gB,OAAQ1O,KAAK0O,QAAStB,YAAYrB,eAAgBujB,EAAOnD,QAE7FnsB,KAAK4tB,cAAe,GAAI5iB,KAAMskB,EAAO5gB,QAAS5O,IAAKsxB,KACnDpxB,KAAK4tB,cAAe,GAAI5iB,KAAMskB,EAAO5gB,QAAS/C,IAAKylB,KAE5CpxB,KAIRiO,OAAQqhB,GAEP,OAAOA,EAAO5gB,OAAOT,OAAQjO,KAAK0O,SAAc4gB,EAAOnD,SAAWnsB,KAAKmsB,OAIxEphB,QAEC,OAAO,IAAI/K,KAAKI,aAAc4K,KAAMhL,OCjNtC,MAAM8xB,GAAyB,IAAIrI,GAC7BsI,GAAyB,IAAItI,GAC7BuI,GAA8B,IAAIhjB,GAExC,MAAMijB,GAEL7xB,YAAa2rB,EAAS,IAAItC,GAAS,EAAG,EAAG,GAAKiG,EAAW,GAIxD1vB,KAAK+rB,OAASA,EACd/rB,KAAK0vB,SAAWA,EAIjBnlB,IAAKwhB,EAAQ2D,GAKZ,OAHA1vB,KAAK+rB,OAAO/gB,KAAM+gB,GAClB/rB,KAAK0vB,SAAWA,EAET1vB,KAIRkyB,cAAexoB,EAAGC,EAAGqa,EAAG9Y,GAKvB,OAHAlL,KAAK+rB,OAAOxhB,IAAKb,EAAGC,EAAGqa,GACvBhkB,KAAK0vB,SAAWxkB,EAETlL,KAIRmyB,8BAA+BpG,EAAQuC,GAKtC,OAHAtuB,KAAK+rB,OAAO/gB,KAAM+gB,GAClB/rB,KAAK0vB,UAAapB,EAAMxhB,IAAK9M,KAAK+rB,QAE3B/rB,KAIRoyB,sBAAuB5mB,EAAGC,EAAGkD,GAE5B,MAAMod,EAAS+F,GAASlmB,WAAY+C,EAAGlD,GAAIsB,MAAOglB,GAASnmB,WAAYJ,EAAGC,IAAM2B,YAMhF,OAFApN,KAAKmyB,8BAA+BpG,EAAQvgB,GAErCxL,KAIRgL,KAAMykB,GAKL,OAHAzvB,KAAK+rB,OAAO/gB,KAAMykB,EAAM1D,QACxB/rB,KAAK0vB,SAAWD,EAAMC,SAEf1vB,KAIRoN,YAIC,MAAMilB,EAAsB,EAAMryB,KAAK+rB,OAAO7pB,SAI9C,OAHAlC,KAAK+rB,OAAOhgB,eAAgBsmB,GAC5BryB,KAAK0vB,UAAY2C,EAEVryB,KAIR6M,SAKC,OAHA7M,KAAK0vB,WAAc,EACnB1vB,KAAK+rB,OAAOlf,SAEL7M,KAIRwwB,gBAAiBlC,GAEhB,OAAOtuB,KAAK+rB,OAAOjf,IAAKwhB,GAAUtuB,KAAK0vB,SAIxC4C,iBAAkBhD,GAEjB,OAAOtvB,KAAKwwB,gBAAiBlB,EAAO5gB,QAAW4gB,EAAOnD,OAIvDoG,aAAcjE,EAAOjoB,GAEpB,OAAOA,EAAO2E,KAAMhL,KAAK+rB,QAAShgB,gBAAkB/L,KAAKwwB,gBAAiBlC,IAAUxuB,IAAKwuB,GAI1FkE,cAAeC,EAAMpsB,GAEpB,MAAMqsB,EAAYD,EAAKjR,MAAOsQ,IAExBpG,EAAc1rB,KAAK+rB,OAAOjf,IAAK4lB,GAErC,GAAqB,IAAhBhH,EAGJ,OAA4C,IAAvC1rB,KAAKwwB,gBAAiBiC,EAAKE,OAExBtsB,EAAO2E,KAAMynB,EAAKE,OAKnB,KAIR,MAAM/oB,IAAQ6oB,EAAKE,MAAM7lB,IAAK9M,KAAK+rB,QAAW/rB,KAAK0vB,UAAahE,EAEhE,OAAK9hB,EAAI,GAAKA,EAAI,EAEV,KAIDvD,EAAO2E,KAAM0nB,GAAY3mB,eAAgBnC,GAAI9J,IAAK2yB,EAAKE,OAI/DC,eAAgBH,GAIf,MAAMI,EAAY7yB,KAAKwwB,gBAAiBiC,EAAKE,OACvCG,EAAU9yB,KAAKwwB,gBAAiBiC,EAAKM,KAE3C,OAASF,EAAY,GAAKC,EAAU,GAASA,EAAU,GAAKD,EAAY,EAIzEzD,cAAelB,GAEd,OAAOA,EAAIsB,gBAAiBxvB,MAI7BqvB,iBAAkBC,GAEjB,OAAOA,EAAOE,gBAAiBxvB,MAIhCgzB,cAAe3sB,GAEd,OAAOA,EAAO2E,KAAMhL,KAAK+rB,QAAShgB,gBAAkB/L,KAAK0vB,UAI1DzF,aAAczW,EAAQyf,GAErB,MAAMC,EAAeD,GAAwBjB,GAAcxf,gBAAiBgB,GAEtE2f,EAAiBnzB,KAAKgzB,cAAelB,IAAW7H,aAAczW,GAE9DuY,EAAS/rB,KAAK+rB,OAAO7f,aAAcgnB,GAAe9lB,YAIxD,OAFApN,KAAK0vB,UAAayD,EAAermB,IAAKif,GAE/B/rB,KAIRuT,UAAWpF,GAIV,OAFAnO,KAAK0vB,UAAYvhB,EAAOrB,IAAK9M,KAAK+rB,QAE3B/rB,KAIRiO,OAAQwhB,GAEP,OAAOA,EAAM1D,OAAO9d,OAAQjO,KAAK+rB,SAAc0D,EAAMC,WAAa1vB,KAAK0vB,SAIxE3kB,QAEC,OAAO,IAAI/K,KAAKI,aAAc4K,KAAMhL,OAMtCiyB,GAAM5yB,UAAU+zB,SAAU,ECtM1B,MAAMC,GAAwB,IAAI/B,GAC5B,GAAwB,IAAI7H,GAElC,MAAM6J,GAELlzB,YAAa6wB,EAAK,IAAIgB,GAASf,EAAK,IAAIe,GAASd,EAAK,IAAIc,GAASsB,EAAK,IAAItB,GAASuB,EAAK,IAAIvB,GAASwB,EAAK,IAAIxB,IAE/GjyB,KAAK0zB,OAAS,CAAEzC,EAAIC,EAAIC,EAAIoC,EAAIC,EAAIC,GAIrClpB,IAAK0mB,EAAIC,EAAIC,EAAIoC,EAAIC,EAAIC,GAExB,MAAMC,EAAS1zB,KAAK0zB,OASpB,OAPAA,EAAQ,GAAI1oB,KAAMimB,GAClByC,EAAQ,GAAI1oB,KAAMkmB,GAClBwC,EAAQ,GAAI1oB,KAAMmmB,GAClBuC,EAAQ,GAAI1oB,KAAMuoB,GAClBG,EAAQ,GAAI1oB,KAAMwoB,GAClBE,EAAQ,GAAI1oB,KAAMyoB,GAEXzzB,KAIRgL,KAAM2oB,GAEL,MAAMD,EAAS1zB,KAAK0zB,OAEpB,IAAM,IAAI1xB,EAAI,EAAGA,EAAI,EAAGA,IAEvB0xB,EAAQ1xB,GAAIgJ,KAAM2oB,EAAQD,OAAQ1xB,IAInC,OAAOhC,KAIR4zB,wBAAyBznB,GAExB,MAAMunB,EAAS1zB,KAAK0zB,OACd5jB,EAAK3D,EAAEE,SACPwnB,EAAM/jB,EAAI,GAAKgkB,EAAMhkB,EAAI,GAAKikB,EAAMjkB,EAAI,GAAKkkB,EAAMlkB,EAAI,GACvDmkB,EAAMnkB,EAAI,GAAKokB,EAAMpkB,EAAI,GAAKqkB,EAAMrkB,EAAI,GAAKskB,EAAMtkB,EAAI,GACvDukB,EAAMvkB,EAAI,GAAKwkB,EAAMxkB,EAAI,GAAKykB,EAAOzkB,EAAI,IAAM0kB,EAAO1kB,EAAI,IAC1D2kB,EAAO3kB,EAAI,IAAM4kB,EAAO5kB,EAAI,IAAM6kB,EAAO7kB,EAAI,IAAM8kB,EAAO9kB,EAAI,IASpE,OAPA4jB,EAAQ,GAAIxB,cAAe8B,EAAMH,EAAKO,EAAMH,EAAKO,EAAOH,EAAKO,EAAOH,GAAOrnB,YAC3EsmB,EAAQ,GAAIxB,cAAe8B,EAAMH,EAAKO,EAAMH,EAAKO,EAAOH,EAAKO,EAAOH,GAAOrnB,YAC3EsmB,EAAQ,GAAIxB,cAAe8B,EAAMF,EAAKM,EAAMF,EAAKM,EAAOF,EAAKM,EAAOF,GAAOtnB,YAC3EsmB,EAAQ,GAAIxB,cAAe8B,EAAMF,EAAKM,EAAMF,EAAKM,EAAOF,EAAKM,EAAOF,GAAOtnB,YAC3EsmB,EAAQ,GAAIxB,cAAe8B,EAAMD,EAAKK,EAAMD,EAAKK,EAAOD,EAAMK,EAAOD,GAAOvnB,YAC5EsmB,EAAQ,GAAIxB,cAAe8B,EAAMD,EAAKK,EAAMD,EAAKK,EAAOD,EAAMK,EAAOD,GAAOvnB,YAErEpN,KAIR60B,iBAAkB7G,GAEjB,MAAMW,EAAWX,EAAOW,SAMxB,OAJiC,OAA5BA,EAASmG,gBAA0BnG,EAASoG,wBAEjD1B,GAAQroB,KAAM2jB,EAASmG,gBAAiB7K,aAAc+D,EAAOhD,aAEtDhrB,KAAKqvB,iBAAkBgE,IAI/B2B,iBAAkBC,GAMjB,OAJA5B,GAAQ3kB,OAAOnE,IAAK,EAAG,EAAG,GAC1B8oB,GAAQlH,OAAS,kBACjBkH,GAAQpJ,aAAcgL,EAAOjK,aAEtBhrB,KAAKqvB,iBAAkBgE,IAI/BhE,iBAAkBC,GAEjB,MAAMoE,EAAS1zB,KAAK0zB,OACdhlB,EAAS4gB,EAAO5gB,OAChBwmB,GAAc5F,EAAOnD,OAE3B,IAAM,IAAInqB,EAAI,EAAGA,EAAI,EAAGA,IAIvB,GAFiB0xB,EAAQ1xB,GAAIwuB,gBAAiB9hB,GAE9BwmB,EAEf,OAAO,EAMT,OAAO,EAIR9F,cAAelB,GAEd,MAAMwF,EAAS1zB,KAAK0zB,OAEpB,IAAM,IAAI1xB,EAAI,EAAGA,EAAI,EAAGA,IAAO,CAE9B,MAAMytB,EAAQiE,EAAQ1xB,GAQtB,GAJA,GAAQ0H,EAAI+lB,EAAM1D,OAAOriB,EAAI,EAAIwkB,EAAIxqB,IAAIgG,EAAIwkB,EAAI1kB,IAAIE,EACrD,GAAQC,EAAI8lB,EAAM1D,OAAOpiB,EAAI,EAAIukB,EAAIxqB,IAAIiG,EAAIukB,EAAI1kB,IAAIG,EACrD,GAAQqa,EAAIyL,EAAM1D,OAAO/H,EAAI,EAAIkK,EAAIxqB,IAAIsgB,EAAIkK,EAAI1kB,IAAIwa,EAEhDyL,EAAMe,gBAAiB,IAAY,EAEvC,OAAO,EAMT,OAAO,EAIRvB,cAAeX,GAEd,MAAMoF,EAAS1zB,KAAK0zB,OAEpB,IAAM,IAAI1xB,EAAI,EAAGA,EAAI,EAAGA,IAEvB,GAAK0xB,EAAQ1xB,GAAIwuB,gBAAiBlC,GAAU,EAE3C,OAAO,EAMT,OAAO,EAIRvjB,QAEC,OAAO,IAAI/K,KAAKI,aAAc4K,KAAMhL,OCxJtC,MAAMm1B,GAEL/0B,cAECJ,KAAKqM,SAAW,CAEf,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,GAIL4C,UAAU/M,OAAS,GAEvBiJ,QAAQ+D,MAAO,iFAMjB3E,IAAK4E,EAAKC,EAAKC,EAAK+lB,EAAK9lB,EAAKC,EAAKC,EAAK6lB,EAAK5lB,EAAKC,EAAKC,EAAK2lB,EAAKC,EAAKC,EAAKC,EAAKC,GAE/E,MAAM9lB,EAAK5P,KAAKqM,SAOhB,OALAuD,EAAI,GAAMT,EAAKS,EAAI,GAAMR,EAAKQ,EAAI,GAAMP,EAAKO,EAAI,IAAOwlB,EACxDxlB,EAAI,GAAMN,EAAKM,EAAI,GAAML,EAAKK,EAAI,GAAMJ,EAAKI,EAAI,IAAOylB,EACxDzlB,EAAI,GAAMH,EAAKG,EAAI,GAAMF,EAAKE,EAAI,IAAOD,EAAKC,EAAI,IAAO0lB,EACzD1lB,EAAI,GAAM2lB,EAAK3lB,EAAI,GAAM4lB,EAAK5lB,EAAI,IAAO6lB,EAAK7lB,EAAI,IAAO8lB,EAElD11B,KAIR6P,WAWC,OATA7P,KAAKuK,IAEJ,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,GAIHvK,KAIR+K,QAEC,OAAO,IAAIoqB,IAAUjnB,UAAWlO,KAAKqM,UAItCrB,KAAMmB,GAEL,MAAMyD,EAAK5P,KAAKqM,SACVyD,EAAK3D,EAAEE,SAOb,OALAuD,EAAI,GAAME,EAAI,GAAKF,EAAI,GAAME,EAAI,GAAKF,EAAI,GAAME,EAAI,GAAKF,EAAI,GAAME,EAAI,GACvEF,EAAI,GAAME,EAAI,GAAKF,EAAI,GAAME,EAAI,GAAKF,EAAI,GAAME,EAAI,GAAKF,EAAI,GAAME,EAAI,GACvEF,EAAI,GAAME,EAAI,GAAKF,EAAI,GAAME,EAAI,GAAKF,EAAI,IAAOE,EAAI,IAAMF,EAAI,IAAOE,EAAI,IAC1EF,EAAI,IAAOE,EAAI,IAAMF,EAAI,IAAOE,EAAI,IAAMF,EAAI,IAAOE,EAAI,IAAMF,EAAI,IAAOE,EAAI,IAEvE9P,KAIR21B,aAAcxpB,GAEb,MAAMyD,EAAK5P,KAAKqM,SAAUyD,EAAK3D,EAAEE,SAMjC,OAJAuD,EAAI,IAAOE,EAAI,IACfF,EAAI,IAAOE,EAAI,IACfF,EAAI,IAAOE,EAAI,IAER9P,KAIR41B,eAAgBzpB,GAEf,MAAM2D,EAAK3D,EAAEE,SAWb,OATArM,KAAKuK,IAEJuF,EAAI,GAAKA,EAAI,GAAKA,EAAI,GAAK,EAC3BA,EAAI,GAAKA,EAAI,GAAKA,EAAI,GAAK,EAC3BA,EAAI,GAAKA,EAAI,GAAKA,EAAI,GAAK,EAC3B,EAAG,EAAG,EAAG,GAIH9P,KAIR+P,aAAcC,EAAOC,EAAOC,GAM3B,OAJAF,EAAM0c,oBAAqB1sB,KAAM,GACjCiQ,EAAMyc,oBAAqB1sB,KAAM,GACjCkQ,EAAMwc,oBAAqB1sB,KAAM,GAE1BA,KAIR61B,UAAW7lB,EAAOC,EAAOC,GASxB,OAPAlQ,KAAKuK,IACJyF,EAAMtG,EAAGuG,EAAMvG,EAAGwG,EAAMxG,EAAG,EAC3BsG,EAAMrG,EAAGsG,EAAMtG,EAAGuG,EAAMvG,EAAG,EAC3BqG,EAAMgU,EAAG/T,EAAM+T,EAAG9T,EAAM8T,EAAG,EAC3B,EAAG,EAAG,EAAG,GAGHhkB,KAIR81B,gBAAiB3pB,GAIhB,MAAMyD,EAAK5P,KAAKqM,SACVyD,EAAK3D,EAAEE,SAEP0pB,EAAS,EAAI,GAAIrJ,oBAAqBvgB,EAAG,GAAIjK,SAC7C8zB,EAAS,EAAI,GAAItJ,oBAAqBvgB,EAAG,GAAIjK,SAC7C+zB,EAAS,EAAI,GAAIvJ,oBAAqBvgB,EAAG,GAAIjK,SAsBnD,OApBA0N,EAAI,GAAME,EAAI,GAAMimB,EACpBnmB,EAAI,GAAME,EAAI,GAAMimB,EACpBnmB,EAAI,GAAME,EAAI,GAAMimB,EACpBnmB,EAAI,GAAM,EAEVA,EAAI,GAAME,EAAI,GAAMkmB,EACpBpmB,EAAI,GAAME,EAAI,GAAMkmB,EACpBpmB,EAAI,GAAME,EAAI,GAAMkmB,EACpBpmB,EAAI,GAAM,EAEVA,EAAI,GAAME,EAAI,GAAMmmB,EACpBrmB,EAAI,GAAME,EAAI,GAAMmmB,EACpBrmB,EAAI,IAAOE,EAAI,IAAOmmB,EACtBrmB,EAAI,IAAO,EAEXA,EAAI,IAAO,EACXA,EAAI,IAAO,EACXA,EAAI,IAAO,EACXA,EAAI,IAAO,EAEJ5P,KAIRk2B,sBAAuBlQ,GAEbA,GAASA,EAAME,SAEvB/a,QAAQ+D,MAAO,yGAIhB,MAAMU,EAAK5P,KAAKqM,SAEV3C,EAAIsc,EAAMtc,EAAGC,EAAIqc,EAAMrc,EAAGqa,EAAIgC,EAAMhC,EACpCxY,EAAInH,KAAKuK,IAAKlF,GAAK+B,EAAIpH,KAAKwK,IAAKnF,GACjCiF,EAAItK,KAAKuK,IAAKjF,GAAKiI,EAAIvN,KAAKwK,IAAKlF,GACjCyC,EAAI/H,KAAKuK,IAAKoV,GAAKnS,EAAIxN,KAAKwK,IAAKmV,GAEvC,GAAqB,QAAhBgC,EAAMG,MAAkB,CAE5B,MAAM5V,EAAK/E,EAAIY,EAAG+pB,EAAK3qB,EAAIqG,EAAGrB,EAAK/E,EAAIW,EAAGgqB,EAAK3qB,EAAIoG,EAEnDjC,EAAI,GAAMjB,EAAIvC,EACdwD,EAAI,IAAQjB,EAAIkD,EAChBjC,EAAI,GAAMgC,EAEVhC,EAAI,GAAMumB,EAAK3lB,EAAKoB,EACpBhC,EAAI,GAAMW,EAAK6lB,EAAKxkB,EACpBhC,EAAI,IAAQnE,EAAIkD,EAEhBiB,EAAI,GAAMwmB,EAAK7lB,EAAKqB,EACpBhC,EAAI,GAAMY,EAAK2lB,EAAKvkB,EACpBhC,EAAI,IAAOpE,EAAImD,OAET,GAAqB,QAAhBqX,EAAMG,MAAkB,CAEnC,MAAMkQ,EAAK1nB,EAAIvC,EAAGkqB,EAAK3nB,EAAIkD,EAAG0kB,EAAK3kB,EAAIxF,EAAGoqB,EAAK5kB,EAAIC,EAEnDjC,EAAI,GAAMymB,EAAKG,EAAK/qB,EACpBmE,EAAI,GAAM2mB,EAAK9qB,EAAI6qB,EACnB1mB,EAAI,GAAMpE,EAAIoG,EAEdhC,EAAI,GAAMpE,EAAIqG,EACdjC,EAAI,GAAMpE,EAAIY,EACdwD,EAAI,IAAQnE,EAEZmE,EAAI,GAAM0mB,EAAK7qB,EAAI8qB,EACnB3mB,EAAI,GAAM4mB,EAAKH,EAAK5qB,EACpBmE,EAAI,IAAOpE,EAAImD,OAET,GAAqB,QAAhBqX,EAAMG,MAAkB,CAEnC,MAAMkQ,EAAK1nB,EAAIvC,EAAGkqB,EAAK3nB,EAAIkD,EAAG0kB,EAAK3kB,EAAIxF,EAAGoqB,EAAK5kB,EAAIC,EAEnDjC,EAAI,GAAMymB,EAAKG,EAAK/qB,EACpBmE,EAAI,IAAQpE,EAAIqG,EAChBjC,EAAI,GAAM2mB,EAAKD,EAAK7qB,EAEpBmE,EAAI,GAAM0mB,EAAKC,EAAK9qB,EACpBmE,EAAI,GAAMpE,EAAIY,EACdwD,EAAI,GAAM4mB,EAAKH,EAAK5qB,EAEpBmE,EAAI,IAAQpE,EAAIoG,EAChBhC,EAAI,GAAMnE,EACVmE,EAAI,IAAOpE,EAAImD,OAET,GAAqB,QAAhBqX,EAAMG,MAAkB,CAEnC,MAAM5V,EAAK/E,EAAIY,EAAG+pB,EAAK3qB,EAAIqG,EAAGrB,EAAK/E,EAAIW,EAAGgqB,EAAK3qB,EAAIoG,EAEnDjC,EAAI,GAAMjB,EAAIvC,EACdwD,EAAI,GAAMY,EAAKoB,EAAIukB,EACnBvmB,EAAI,GAAMW,EAAKqB,EAAIwkB,EAEnBxmB,EAAI,GAAMjB,EAAIkD,EACdjC,EAAI,GAAMwmB,EAAKxkB,EAAIrB,EACnBX,EAAI,GAAMumB,EAAKvkB,EAAIpB,EAEnBZ,EAAI,IAAQgC,EACZhC,EAAI,GAAMnE,EAAIkD,EACdiB,EAAI,IAAOpE,EAAImD,OAET,GAAqB,QAAhBqX,EAAMG,MAAkB,CAEnC,MAAMsQ,EAAKjrB,EAAImD,EAAG+nB,EAAKlrB,EAAIoG,EAAG+kB,EAAKlrB,EAAIkD,EAAGioB,EAAKnrB,EAAImG,EAEnDhC,EAAI,GAAMjB,EAAIvC,EACdwD,EAAI,GAAMgnB,EAAKH,EAAK5kB,EACpBjC,EAAI,GAAM+mB,EAAK9kB,EAAI6kB,EAEnB9mB,EAAI,GAAMiC,EACVjC,EAAI,GAAMpE,EAAIY,EACdwD,EAAI,IAAQnE,EAAIW,EAEhBwD,EAAI,IAAQgC,EAAIxF,EAChBwD,EAAI,GAAM8mB,EAAK7kB,EAAI8kB,EACnB/mB,EAAI,IAAO6mB,EAAKG,EAAK/kB,OAEf,GAAqB,QAAhBmU,EAAMG,MAAkB,CAEnC,MAAMsQ,EAAKjrB,EAAImD,EAAG+nB,EAAKlrB,EAAIoG,EAAG+kB,EAAKlrB,EAAIkD,EAAGioB,EAAKnrB,EAAImG,EAEnDhC,EAAI,GAAMjB,EAAIvC,EACdwD,EAAI,IAAQiC,EACZjC,EAAI,GAAMgC,EAAIxF,EAEdwD,EAAI,GAAM6mB,EAAK5kB,EAAI+kB,EACnBhnB,EAAI,GAAMpE,EAAIY,EACdwD,EAAI,GAAM8mB,EAAK7kB,EAAI8kB,EAEnB/mB,EAAI,GAAM+mB,EAAK9kB,EAAI6kB,EACnB9mB,EAAI,GAAMnE,EAAIW,EACdwD,EAAI,IAAOgnB,EAAK/kB,EAAI4kB,EAerB,OAVA7mB,EAAI,GAAM,EACVA,EAAI,GAAM,EACVA,EAAI,IAAO,EAGXA,EAAI,IAAO,EACXA,EAAI,IAAO,EACXA,EAAI,IAAO,EACXA,EAAI,IAAO,EAEJ5P,KAIR62B,2BAA4BvX,GAE3B,OAAOtf,KAAK82B,QAASC,GAAOzX,EAAG0X,IAIhCC,OAAQC,EAAK7wB,EAAQ8wB,GAEpB,MAAMvnB,EAAK5P,KAAKqM,SAyChB,OAvCA8X,GAAGvY,WAAYsrB,EAAK7wB,GAEG,IAAlB8d,GAAGnX,aAIPmX,GAAGH,EAAI,GAIRG,GAAG/W,YACH6W,GAAGiH,aAAciM,EAAIhT,IAEE,IAAlBF,GAAGjX,aAImB,IAArB3I,KAAK8I,IAAKgqB,EAAGnT,GAEjBG,GAAGza,GAAK,KAIRya,GAAGH,GAAK,KAITG,GAAG/W,YACH6W,GAAGiH,aAAciM,EAAIhT,KAItBF,GAAG7W,YACH8W,GAAGgH,aAAc/G,GAAIF,IAErBrU,EAAI,GAAMqU,GAAGva,EAAGkG,EAAI,GAAMsU,GAAGxa,EAAGkG,EAAI,GAAMuU,GAAGza,EAC7CkG,EAAI,GAAMqU,GAAGta,EAAGiG,EAAI,GAAMsU,GAAGva,EAAGiG,EAAI,GAAMuU,GAAGxa,EAC7CiG,EAAI,GAAMqU,GAAGD,EAAGpU,EAAI,GAAMsU,GAAGF,EAAGpU,EAAI,IAAOuU,GAAGH,EAEvChkB,KAIR8L,SAAUK,EAAG4S,GAEZ,YAAWhe,IAANge,GAEJ5T,QAAQC,KAAM,oGACPpL,KAAKqQ,iBAAkBlE,EAAG4S,IAI3B/e,KAAKqQ,iBAAkBrQ,KAAMmM,GAIrCmE,YAAanE,GAEZ,OAAOnM,KAAKqQ,iBAAkBlE,EAAGnM,MAIlCqQ,iBAAkB7E,EAAGC,GAEpB,MAAM8E,EAAK/E,EAAEa,SACPmE,EAAK/E,EAAEY,SACPuD,EAAK5P,KAAKqM,SAEVoE,EAAMF,EAAI,GAAKG,EAAMH,EAAI,GAAKI,EAAMJ,EAAI,GAAK6mB,EAAM7mB,EAAI,IACvDK,EAAML,EAAI,GAAKM,EAAMN,EAAI,GAAKO,EAAMP,EAAI,GAAK8mB,EAAM9mB,EAAI,IACvDQ,EAAMR,EAAI,GAAKS,EAAMT,EAAI,GAAKU,EAAMV,EAAI,IAAM+mB,EAAM/mB,EAAI,IACxDgnB,EAAMhnB,EAAI,GAAKinB,EAAMjnB,EAAI,GAAKknB,EAAMlnB,EAAI,IAAMmnB,EAAMnnB,EAAI,IAExDW,EAAMV,EAAI,GAAKW,EAAMX,EAAI,GAAKY,EAAMZ,EAAI,GAAKmnB,EAAMnnB,EAAI,IACvDa,EAAMb,EAAI,GAAKc,EAAMd,EAAI,GAAKe,EAAMf,EAAI,GAAKonB,EAAMpnB,EAAI,IACvDgB,EAAMhB,EAAI,GAAKiB,EAAMjB,EAAI,GAAKkB,EAAMlB,EAAI,IAAMqnB,EAAMrnB,EAAI,IACxDsnB,EAAMtnB,EAAI,GAAKunB,EAAMvnB,EAAI,GAAKwnB,EAAMxnB,EAAI,IAAMynB,EAAMznB,EAAI,IAsB9D,OApBAZ,EAAI,GAAMa,EAAMS,EAAMR,EAAMW,EAAMV,EAAMa,EAAM4lB,EAAMU,EACpDloB,EAAI,GAAMa,EAAMU,EAAMT,EAAMY,EAAMX,EAAMc,EAAM2lB,EAAMW,EACpDnoB,EAAI,GAAMa,EAAMW,EAAMV,EAAMa,EAAMZ,EAAMe,EAAM0lB,EAAMY,EACpDpoB,EAAI,IAAOa,EAAMknB,EAAMjnB,EAAMknB,EAAMjnB,EAAMknB,EAAMT,EAAMa,EAErDroB,EAAI,GAAMgB,EAAMM,EAAML,EAAMQ,EAAMP,EAAMU,EAAM6lB,EAAMS,EACpDloB,EAAI,GAAMgB,EAAMO,EAAMN,EAAMS,EAAMR,EAAMW,EAAM4lB,EAAMU,EACpDnoB,EAAI,GAAMgB,EAAMQ,EAAMP,EAAMU,EAAMT,EAAMY,EAAM2lB,EAAMW,EACpDpoB,EAAI,IAAOgB,EAAM+mB,EAAM9mB,EAAM+mB,EAAM9mB,EAAM+mB,EAAMR,EAAMY,EAErDroB,EAAI,GAAMmB,EAAMG,EAAMF,EAAMK,EAAMJ,EAAMO,EAAM8lB,EAAMQ,EACpDloB,EAAI,GAAMmB,EAAMI,EAAMH,EAAMM,EAAML,EAAMQ,EAAM6lB,EAAMS,EACpDnoB,EAAI,IAAOmB,EAAMK,EAAMJ,EAAMO,EAAMN,EAAMS,EAAM4lB,EAAMU,EACrDpoB,EAAI,IAAOmB,EAAM4mB,EAAM3mB,EAAM4mB,EAAM3mB,EAAM4mB,EAAMP,EAAMW,EAErDroB,EAAI,GAAM2nB,EAAMrmB,EAAMsmB,EAAMnmB,EAAMomB,EAAMjmB,EAAMkmB,EAAMI,EACpDloB,EAAI,GAAM2nB,EAAMpmB,EAAMqmB,EAAMlmB,EAAMmmB,EAAMhmB,EAAMimB,EAAMK,EACpDnoB,EAAI,IAAO2nB,EAAMnmB,EAAMomB,EAAMjmB,EAAMkmB,EAAM/lB,EAAMgmB,EAAMM,EACrDpoB,EAAI,IAAO2nB,EAAMI,EAAMH,EAAMI,EAAMH,EAAMI,EAAMH,EAAMO,EAE9Cj4B,KAIR+L,eAAgBR,GAEf,MAAMqE,EAAK5P,KAAKqM,SAOhB,OALAuD,EAAI,IAAOrE,EAAGqE,EAAI,IAAOrE,EAAGqE,EAAI,IAAOrE,EAAGqE,EAAI,KAAQrE,EACtDqE,EAAI,IAAOrE,EAAGqE,EAAI,IAAOrE,EAAGqE,EAAI,IAAOrE,EAAGqE,EAAI,KAAQrE,EACtDqE,EAAI,IAAOrE,EAAGqE,EAAI,IAAOrE,EAAGqE,EAAI,KAAQrE,EAAGqE,EAAI,KAAQrE,EACvDqE,EAAI,IAAOrE,EAAGqE,EAAI,IAAOrE,EAAGqE,EAAI,KAAQrE,EAAGqE,EAAI,KAAQrE,EAEhDvL,KAIR2R,cAEC,MAAM/B,EAAK5P,KAAKqM,SAEV8C,EAAMS,EAAI,GAAKR,EAAMQ,EAAI,GAAKP,EAAMO,EAAI,GAAKwlB,EAAMxlB,EAAI,IACvDN,EAAMM,EAAI,GAAKL,EAAMK,EAAI,GAAKJ,EAAMI,EAAI,GAAKylB,EAAMzlB,EAAI,IACvDH,EAAMG,EAAI,GAAKF,EAAME,EAAI,GAAKD,EAAMC,EAAI,IAAM0lB,EAAM1lB,EAAI,IAM9D,OALYA,EAAI,KAOZwlB,EAAM5lB,EAAME,EACXL,EAAMgmB,EAAM3lB,EACZ0lB,EAAM7lB,EAAMI,EACZP,EAAMimB,EAAM1lB,EACZN,EAAME,EAAM+lB,EACZlmB,EAAMI,EAAM8lB,GAZU1lB,EAAI,KAe3BT,EAAMK,EAAM8lB,EACXnmB,EAAMkmB,EAAM1lB,EACZylB,EAAM9lB,EAAMK,EACZN,EAAMC,EAAMgmB,EACZjmB,EAAMgmB,EAAM5lB,EACZ2lB,EAAM5lB,EAAMC,GApByBG,EAAI,MAuB1CT,EAAMkmB,EAAM3lB,EACXP,EAAMI,EAAM+lB,EACZF,EAAM9lB,EAAMI,EACZN,EAAME,EAAMgmB,EACZF,EAAM7lB,EAAME,EACZL,EAAMimB,EAAM5lB,GA5ByCG,EAAI,MA+B1DP,EAAME,EAAME,EACXN,EAAMK,EAAME,EACZP,EAAMI,EAAMI,EACZN,EAAMC,EAAMI,EACZN,EAAME,EAAMK,EACZP,EAAMI,EAAMC,GAOlB6C,YAEC,MAAM1C,EAAK5P,KAAKqM,SAChB,IAAIkG,EAUJ,OARAA,EAAM3C,EAAI,GAAKA,EAAI,GAAMA,EAAI,GAAKA,EAAI,GAAM2C,EAC5CA,EAAM3C,EAAI,GAAKA,EAAI,GAAMA,EAAI,GAAKA,EAAI,GAAM2C,EAC5CA,EAAM3C,EAAI,GAAKA,EAAI,GAAMA,EAAI,GAAKA,EAAI,GAAM2C,EAE5CA,EAAM3C,EAAI,GAAKA,EAAI,GAAMA,EAAI,IAAMA,EAAI,IAAO2C,EAC9CA,EAAM3C,EAAI,GAAKA,EAAI,GAAMA,EAAI,IAAMA,EAAI,IAAO2C,EAC9CA,EAAM3C,EAAI,IAAMA,EAAI,IAAOA,EAAI,IAAMA,EAAI,IAAO2C,EAEzCvS,KAIRk4B,YAAaxuB,EAAGC,EAAGqa,GAElB,MAAMpU,EAAK5P,KAAKqM,SAgBhB,OAdK3C,EAAEkR,WAENhL,EAAI,IAAOlG,EAAEA,EACbkG,EAAI,IAAOlG,EAAEC,EACbiG,EAAI,IAAOlG,EAAEsa,IAIbpU,EAAI,IAAOlG,EACXkG,EAAI,IAAOjG,EACXiG,EAAI,IAAOoU,GAILhkB,KAIRgS,SAGC,MAAMpC,EAAK5P,KAAKqM,SAEf8C,EAAMS,EAAI,GAAKN,EAAMM,EAAI,GAAKH,EAAMG,EAAI,GAAK2lB,EAAM3lB,EAAI,GACvDR,EAAMQ,EAAI,GAAKL,EAAMK,EAAI,GAAKF,EAAME,EAAI,GAAK4lB,EAAM5lB,EAAI,GACvDP,EAAMO,EAAI,GAAKJ,EAAMI,EAAI,GAAKD,EAAMC,EAAI,IAAM6lB,EAAM7lB,EAAI,IACxDwlB,EAAMxlB,EAAI,IAAMylB,EAAMzlB,EAAI,IAAM0lB,EAAM1lB,EAAI,IAAM8lB,EAAM9lB,EAAI,IAE1DqC,EAAMzC,EAAM8lB,EAAME,EAAMH,EAAM1lB,EAAM6lB,EAAMH,EAAM3lB,EAAM+lB,EAAMlmB,EAAM+lB,EAAMG,EAAMjmB,EAAME,EAAMgmB,EAAMnmB,EAAMI,EAAM+lB,EAC5GxjB,EAAMkjB,EAAMzlB,EAAM6lB,EAAMnmB,EAAMimB,EAAME,EAAMJ,EAAM1lB,EAAM+lB,EAAMrmB,EAAMkmB,EAAMG,EAAMpmB,EAAMK,EAAMgmB,EAAMtmB,EAAMO,EAAM+lB,EAC5GvjB,EAAM9C,EAAMgmB,EAAMG,EAAMJ,EAAM5lB,EAAMgmB,EAAMJ,EAAM7lB,EAAMkmB,EAAMrmB,EAAMimB,EAAMI,EAAMpmB,EAAME,EAAMmmB,EAAMtmB,EAAMI,EAAMkmB,EAC5GyC,EAAM/C,EAAM5lB,EAAME,EAAML,EAAMgmB,EAAM3lB,EAAM0lB,EAAM7lB,EAAMI,EAAMP,EAAMimB,EAAM1lB,EAAMN,EAAME,EAAM+lB,EAAMlmB,EAAMI,EAAM8lB,EAEvGljB,EAAMjD,EAAM8C,EAAM3C,EAAM4C,EAAMzC,EAAM0C,EAAMojB,EAAM4C,EAEtD,GAAa,IAAR/lB,EAAY,OAAOpS,KAAKuK,IAAK,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAE/E,MAAM8H,EAAS,EAAID,EAsBnB,OApBAxC,EAAI,GAAMqC,EAAMI,EAChBzC,EAAI,IAAQylB,EAAM1lB,EAAM4lB,EAAM/lB,EAAM8lB,EAAMC,EAAMF,EAAM5lB,EAAMgmB,EAAMnmB,EAAMgmB,EAAMG,EAAMjmB,EAAMC,EAAMimB,EAAMpmB,EAAMK,EAAM+lB,GAAQrjB,EAC1HzC,EAAI,IAAQL,EAAM+lB,EAAMC,EAAMF,EAAM3lB,EAAM6lB,EAAMF,EAAM5lB,EAAM+lB,EAAMlmB,EAAMgmB,EAAME,EAAMjmB,EAAME,EAAMimB,EAAMpmB,EAAMI,EAAMgmB,GAAQrjB,EAC1HzC,EAAI,IAAQJ,EAAME,EAAM6lB,EAAMhmB,EAAMI,EAAM4lB,EAAM/lB,EAAMC,EAAM+lB,EAAMlmB,EAAMK,EAAM6lB,EAAMjmB,EAAME,EAAMgmB,EAAMnmB,EAAMI,EAAM+lB,GAAQpjB,EAE1HzC,EAAI,GAAMsC,EAAMG,EAChBzC,EAAI,IAAQP,EAAMimB,EAAMC,EAAMH,EAAMzlB,EAAM4lB,EAAMH,EAAM3lB,EAAMgmB,EAAMtmB,EAAMmmB,EAAMG,EAAMpmB,EAAMI,EAAMimB,EAAMvmB,EAAMQ,EAAM+lB,GAAQrjB,EAC1HzC,EAAI,IAAQwlB,EAAM1lB,EAAM6lB,EAAMnmB,EAAMkmB,EAAMC,EAAMH,EAAM3lB,EAAM+lB,EAAMrmB,EAAMmmB,EAAME,EAAMpmB,EAAMK,EAAMimB,EAAMvmB,EAAMO,EAAMgmB,GAAQrjB,EAC1HzC,EAAI,IAAQR,EAAMO,EAAM4lB,EAAMlmB,EAAMK,EAAM6lB,EAAMlmB,EAAMI,EAAM+lB,EAAMrmB,EAAMQ,EAAM6lB,EAAMpmB,EAAMK,EAAMgmB,EAAMtmB,EAAMO,EAAM+lB,GAAQpjB,EAE1HzC,EAAI,GAAMuC,EAAME,EAChBzC,EAAI,IAAQwlB,EAAM5lB,EAAM+lB,EAAMlmB,EAAMgmB,EAAME,EAAMH,EAAM9lB,EAAMmmB,EAAMtmB,EAAMkmB,EAAMI,EAAMpmB,EAAMC,EAAMomB,EAAMvmB,EAAMK,EAAMkmB,GAAQrjB,EAC1HzC,EAAI,KAASR,EAAMimB,EAAME,EAAMH,EAAM7lB,EAAMgmB,EAAMH,EAAM9lB,EAAMkmB,EAAMrmB,EAAMkmB,EAAMG,EAAMpmB,EAAME,EAAMomB,EAAMvmB,EAAMI,EAAMmmB,GAAQrjB,EAC3HzC,EAAI,KAASP,EAAME,EAAMgmB,EAAMnmB,EAAMI,EAAM+lB,EAAMlmB,EAAMC,EAAMkmB,EAAMrmB,EAAMK,EAAMgmB,EAAMpmB,EAAME,EAAMmmB,EAAMtmB,EAAMI,EAAMkmB,GAAQpjB,EAE3HzC,EAAI,IAAOuoB,EAAM9lB,EACjBzC,EAAI,KAASP,EAAMgmB,EAAM5lB,EAAM2lB,EAAM5lB,EAAMC,EAAM2lB,EAAM9lB,EAAMK,EAAMR,EAAMkmB,EAAM1lB,EAAMN,EAAMC,EAAMgmB,EAAMnmB,EAAMK,EAAM8lB,GAAQjjB,EAC3HzC,EAAI,KAASwlB,EAAM7lB,EAAME,EAAML,EAAMimB,EAAM5lB,EAAM2lB,EAAM9lB,EAAMI,EAAMP,EAAMkmB,EAAM3lB,EAAMN,EAAME,EAAMgmB,EAAMnmB,EAAMI,EAAM+lB,GAAQjjB,EAC3HzC,EAAI,KAASR,EAAMI,EAAMC,EAAMJ,EAAME,EAAME,EAAMJ,EAAMC,EAAMI,EAAMP,EAAMK,EAAME,EAAMN,EAAME,EAAMK,EAAMR,EAAMI,EAAMI,GAAQ0C,EAEpHrS,KAIRoT,MAAOnI,GAEN,MAAM2E,EAAK5P,KAAKqM,SACV3C,EAAIuB,EAAEvB,EAAGC,EAAIsB,EAAEtB,EAAGqa,EAAI/Y,EAAE+Y,EAO9B,OALApU,EAAI,IAAOlG,EAAGkG,EAAI,IAAOjG,EAAGiG,EAAI,IAAOoU,EACvCpU,EAAI,IAAOlG,EAAGkG,EAAI,IAAOjG,EAAGiG,EAAI,IAAOoU,EACvCpU,EAAI,IAAOlG,EAAGkG,EAAI,IAAOjG,EAAGiG,EAAI,KAAQoU,EACxCpU,EAAI,IAAOlG,EAAGkG,EAAI,IAAOjG,EAAGiG,EAAI,KAAQoU,EAEjChkB,KAIR4xB,oBAEC,MAAMhiB,EAAK5P,KAAKqM,SAEV+rB,EAAWxoB,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,GACjEyoB,EAAWzoB,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,GACjE0oB,EAAW1oB,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAMA,EAAI,IAAOA,EAAI,IAExE,OAAOvL,KAAK4I,KAAM5I,KAAKX,IAAK00B,EAAUC,EAAUC,IAIjDC,gBAAiB7uB,EAAGC,EAAGqa,GAWtB,OATAhkB,KAAKuK,IAEJ,EAAG,EAAG,EAAGb,EACT,EAAG,EAAG,EAAGC,EACT,EAAG,EAAG,EAAGqa,EACT,EAAG,EAAG,EAAG,GAIHhkB,KAIRw4B,cAAellB,GAEd,MAAM3E,EAAItK,KAAKuK,IAAK0E,GAAS/H,EAAIlH,KAAKwK,IAAKyE,GAW3C,OATAtT,KAAKuK,IAEJ,EAAG,EAAG,EAAG,EACT,EAAGoE,GAAKpD,EAAG,EACX,EAAGA,EAAGoD,EAAG,EACT,EAAG,EAAG,EAAG,GAIH3O,KAIRy4B,cAAenlB,GAEd,MAAM3E,EAAItK,KAAKuK,IAAK0E,GAAS/H,EAAIlH,KAAKwK,IAAKyE,GAW3C,OATAtT,KAAKuK,IAEHoE,EAAG,EAAGpD,EAAG,EACT,EAAG,EAAG,EAAG,GACRA,EAAG,EAAGoD,EAAG,EACV,EAAG,EAAG,EAAG,GAIJ3O,KAIR04B,cAAeplB,GAEd,MAAM3E,EAAItK,KAAKuK,IAAK0E,GAAS/H,EAAIlH,KAAKwK,IAAKyE,GAW3C,OATAtT,KAAKuK,IAEJoE,GAAKpD,EAAG,EAAG,EACXA,EAAGoD,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,GAIH3O,KAIR24B,iBAAkB/R,EAAMvZ,GAIvB,MAAMsB,EAAItK,KAAKuK,IAAKvB,GACd9B,EAAIlH,KAAKwK,IAAKxB,GACdzD,EAAI,EAAI+E,EACRjF,EAAIkd,EAAKld,EAAGC,EAAIid,EAAKjd,EAAGqa,EAAI4C,EAAK5C,EACjCnR,EAAKjJ,EAAIF,EAAGoJ,EAAKlJ,EAAID,EAW3B,OATA3J,KAAKuK,IAEJsI,EAAKnJ,EAAIiF,EAAGkE,EAAKlJ,EAAI4B,EAAIyY,EAAGnR,EAAKmR,EAAIzY,EAAI5B,EAAG,EAC5CkJ,EAAKlJ,EAAI4B,EAAIyY,EAAGlR,EAAKnJ,EAAIgF,EAAGmE,EAAKkR,EAAIzY,EAAI7B,EAAG,EAC5CmJ,EAAKmR,EAAIzY,EAAI5B,EAAGmJ,EAAKkR,EAAIzY,EAAI7B,EAAGE,EAAIoa,EAAIA,EAAIrV,EAAG,EAC/C,EAAG,EAAG,EAAG,GAIH3O,KAIR44B,UAAWlvB,EAAGC,EAAGqa,GAWhB,OATAhkB,KAAKuK,IAEJb,EAAG,EAAG,EAAG,EACT,EAAGC,EAAG,EAAG,EACT,EAAG,EAAGqa,EAAG,EACT,EAAG,EAAG,EAAG,GAIHhkB,KAIR64B,UAAWC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GAW9B,OATAn5B,KAAKuK,IAEJ,EAAGyuB,EAAIE,EAAI,EACXJ,EAAI,EAAGK,EAAI,EACXJ,EAAIE,EAAI,EAAG,EACX,EAAG,EAAG,EAAG,GAIHj5B,KAIR82B,QAASsC,EAAUtT,EAAY1S,GAE9B,MAAMxD,EAAK5P,KAAKqM,SAEV3C,EAAIoc,EAAW7B,GAAIta,EAAImc,EAAW5B,GAAIF,EAAI8B,EAAW3B,GAAIjZ,EAAI4a,EAAW1B,GACxEiV,EAAK3vB,EAAIA,EAAG4vB,EAAK3vB,EAAIA,EAAG4vB,EAAKvV,EAAIA,EACjCwV,EAAK9vB,EAAI2vB,EAAIP,EAAKpvB,EAAI4vB,EAAIP,EAAKrvB,EAAI6vB,EACnCE,EAAK9vB,EAAI2vB,EAAIL,EAAKtvB,EAAI4vB,EAAIG,EAAK1V,EAAIuV,EACnCI,EAAKzuB,EAAImuB,EAAIO,EAAK1uB,EAAIouB,EAAIO,EAAK3uB,EAAIquB,EAEnCxmB,EAAKK,EAAM1J,EAAGsJ,EAAKI,EAAMzJ,EAAGgjB,EAAKvZ,EAAM4Q,EAsB7C,OApBApU,EAAI,IAAQ,GAAM6pB,EAAKC,IAAS3mB,EAChCnD,EAAI,IAAQkpB,EAAKe,GAAO9mB,EACxBnD,EAAI,IAAQmpB,EAAKa,GAAO7mB,EACxBnD,EAAI,GAAM,EAEVA,EAAI,IAAQkpB,EAAKe,GAAO7mB,EACxBpD,EAAI,IAAQ,GAAM4pB,EAAKE,IAAS1mB,EAChCpD,EAAI,IAAQqpB,EAAKU,GAAO3mB,EACxBpD,EAAI,GAAM,EAEVA,EAAI,IAAQmpB,EAAKa,GAAOjN,EACxB/c,EAAI,IAAQqpB,EAAKU,GAAOhN,EACxB/c,EAAI,KAAS,GAAM4pB,EAAKC,IAAS9M,EACjC/c,EAAI,IAAO,EAEXA,EAAI,IAAOwpB,EAAS1vB,EACpBkG,EAAI,IAAOwpB,EAASzvB,EACpBiG,EAAI,IAAOwpB,EAASpV,EACpBpU,EAAI,IAAO,EAEJ5P,KAIR85B,UAAWV,EAAUtT,EAAY1S,GAEhC,MAAMxD,EAAK5P,KAAKqM,SAEhB,IAAI0G,EAAK,GAAIxI,IAAKqF,EAAI,GAAKA,EAAI,GAAKA,EAAI,IAAM1N,SAC9C,MAAM8Q,EAAK,GAAIzI,IAAKqF,EAAI,GAAKA,EAAI,GAAKA,EAAI,IAAM1N,SAC1CyqB,EAAK,GAAIpiB,IAAKqF,EAAI,GAAKA,EAAI,GAAKA,EAAI,KAAO1N,SAGrClC,KAAK2R,cACN,IAAIoB,GAAOA,GAEtBqmB,EAAS1vB,EAAIkG,EAAI,IACjBwpB,EAASzvB,EAAIiG,EAAI,IACjBwpB,EAASpV,EAAIpU,EAAI,IAGjBmqB,GAAI/uB,KAAMhL,MAEV,MAAMg6B,EAAQ,EAAIjnB,EACZknB,EAAQ,EAAIjnB,EACZknB,EAAQ,EAAIvN,EAoBlB,OAlBAoN,GAAI1tB,SAAU,IAAO2tB,EACrBD,GAAI1tB,SAAU,IAAO2tB,EACrBD,GAAI1tB,SAAU,IAAO2tB,EAErBD,GAAI1tB,SAAU,IAAO4tB,EACrBF,GAAI1tB,SAAU,IAAO4tB,EACrBF,GAAI1tB,SAAU,IAAO4tB,EAErBF,GAAI1tB,SAAU,IAAO6tB,EACrBH,GAAI1tB,SAAU,IAAO6tB,EACrBH,GAAI1tB,SAAU,KAAQ6tB,EAEtBpU,EAAWgB,sBAAuBiT,IAElC3mB,EAAM1J,EAAIqJ,EACVK,EAAMzJ,EAAIqJ,EACVI,EAAM4Q,EAAI2I,EAEH3sB,KAIRm6B,gBAAiBC,EAAMC,EAAOC,EAAKC,EAAQC,EAAMC,QAEnC15B,IAAR05B,GAEJtvB,QAAQC,KAAM,wGAIf,MAAMwE,EAAK5P,KAAKqM,SACV3C,EAAI,EAAI8wB,GAASH,EAAQD,GACzBzwB,EAAI,EAAI6wB,GAASF,EAAMC,GAEvB/uB,GAAM6uB,EAAQD,IAAWC,EAAQD,GACjC3uB,GAAM6uB,EAAMC,IAAaD,EAAMC,GAC/B5rB,IAAQ8rB,EAAMD,IAAWC,EAAMD,GAC/B5oB,GAAM,EAAI6oB,EAAMD,GAASC,EAAMD,GAOrC,OALA5qB,EAAI,GAAMlG,EAAGkG,EAAI,GAAM,EAAGA,EAAI,GAAMpE,EAAGoE,EAAI,IAAO,EAClDA,EAAI,GAAM,EAAGA,EAAI,GAAMjG,EAAGiG,EAAI,GAAMnE,EAAGmE,EAAI,IAAO,EAClDA,EAAI,GAAM,EAAGA,EAAI,GAAM,EAAGA,EAAI,IAAOjB,EAAGiB,EAAI,IAAOgC,EACnDhC,EAAI,GAAM,EAAGA,EAAI,GAAM,EAAGA,EAAI,KAAS,EAAGA,EAAI,IAAO,EAE9C5P,KAIR06B,iBAAkBN,EAAMC,EAAOC,EAAKC,EAAQC,EAAMC,GAEjD,MAAM7qB,EAAK5P,KAAKqM,SACVnB,EAAI,GAAQmvB,EAAQD,GACpBroB,EAAI,GAAQuoB,EAAMC,GAClBlb,EAAI,GAAQob,EAAMD,GAElB9wB,GAAM2wB,EAAQD,GAASlvB,EACvBvB,GAAM2wB,EAAMC,GAAWxoB,EACvBiS,GAAMyW,EAAMD,GAASnb,EAO3B,OALAzP,EAAI,GAAM,EAAI1E,EAAG0E,EAAI,GAAM,EAAGA,EAAI,GAAM,EAAGA,EAAI,KAASlG,EACxDkG,EAAI,GAAM,EAAGA,EAAI,GAAM,EAAImC,EAAGnC,EAAI,GAAM,EAAGA,EAAI,KAASjG,EACxDiG,EAAI,GAAM,EAAGA,EAAI,GAAM,EAAGA,EAAI,KAAS,EAAIyP,EAAGzP,EAAI,KAASoU,EAC3DpU,EAAI,GAAM,EAAGA,EAAI,GAAM,EAAGA,EAAI,IAAO,EAAGA,EAAI,IAAO,EAE5C5P,KAIRiO,OAAQuF,GAEP,MAAM5D,EAAK5P,KAAKqM,SACVyD,EAAK0D,EAAOnH,SAElB,IAAM,IAAIrK,EAAI,EAAGA,EAAI,GAAIA,IAExB,GAAK4N,EAAI5N,KAAQ8N,EAAI9N,GAAM,OAAO,EAInC,OAAO,EAIRkM,UAAWzK,EAAO0K,EAAS,GAE1B,IAAM,IAAInM,EAAI,EAAGA,EAAI,GAAIA,IAExBhC,KAAKqM,SAAUrK,GAAMyB,EAAOzB,EAAImM,GAIjC,OAAOnO,KAIRoO,QAAS3K,EAAQ,GAAI0K,EAAS,GAE7B,MAAMyB,EAAK5P,KAAKqM,SAsBhB,OApBA5I,EAAO0K,GAAWyB,EAAI,GACtBnM,EAAO0K,EAAS,GAAMyB,EAAI,GAC1BnM,EAAO0K,EAAS,GAAMyB,EAAI,GAC1BnM,EAAO0K,EAAS,GAAMyB,EAAI,GAE1BnM,EAAO0K,EAAS,GAAMyB,EAAI,GAC1BnM,EAAO0K,EAAS,GAAMyB,EAAI,GAC1BnM,EAAO0K,EAAS,GAAMyB,EAAI,GAC1BnM,EAAO0K,EAAS,GAAMyB,EAAI,GAE1BnM,EAAO0K,EAAS,GAAMyB,EAAI,GAC1BnM,EAAO0K,EAAS,GAAMyB,EAAI,GAC1BnM,EAAO0K,EAAS,IAAOyB,EAAI,IAC3BnM,EAAO0K,EAAS,IAAOyB,EAAI,IAE3BnM,EAAO0K,EAAS,IAAOyB,EAAI,IAC3BnM,EAAO0K,EAAS,IAAOyB,EAAI,IAC3BnM,EAAO0K,EAAS,IAAOyB,EAAI,IAC3BnM,EAAO0K,EAAS,IAAOyB,EAAI,IAEpBnM,GAMT0xB,GAAQ91B,UAAUs7B,WAAY,EAE9B,MAAM,GAAoB,IAAIlR,GACxBsQ,GAAoB,IAAI5E,GACxB4B,GAAsB,IAAItN,GAAS,EAAG,EAAG,GACzCuN,GAAqB,IAAIvN,GAAS,EAAG,EAAG,GACxCxF,GAAmB,IAAIwF,GACvBvF,GAAmB,IAAIuF,GACvBtF,GAAmB,IAAIsF,GCl3B7B,MAAM,GAELrpB,YAAasJ,EAAI,EAAGC,EAAI,EAAGqa,EAAI,EAAG9Y,EAAI,GAErClL,KAAK0J,EAAIA,EACT1J,KAAK2J,EAAIA,EACT3J,KAAKgkB,EAAIA,EACThkB,KAAKkL,EAAIA,EAINb,YAEH,OAAOrK,KAAKgkB,EAIT3Z,UAAO3K,GAEVM,KAAKgkB,EAAItkB,EAIN4K,aAEH,OAAOtK,KAAKkL,EAITZ,WAAQ5K,GAEXM,KAAKkL,EAAIxL,EAIV6K,IAAKb,EAAGC,EAAGqa,EAAG9Y,GAOb,OALAlL,KAAK0J,EAAIA,EACT1J,KAAK2J,EAAIA,EACT3J,KAAKgkB,EAAIA,EACThkB,KAAKkL,EAAIA,EAEFlL,KAIRwK,UAAWC,GAOV,OALAzK,KAAK0J,EAAIe,EACTzK,KAAK2J,EAAIc,EACTzK,KAAKgkB,EAAIvZ,EACTzK,KAAKkL,EAAIT,EAEFzK,KAIR0K,KAAMhB,GAIL,OAFA1J,KAAK0J,EAAIA,EAEF1J,KAIR2K,KAAMhB,GAIL,OAFA3J,KAAK2J,EAAIA,EAEF3J,KAIR0pB,KAAM1F,GAIL,OAFAhkB,KAAKgkB,EAAIA,EAEFhkB,KAIR46B,KAAM1vB,GAIL,OAFAlL,KAAKkL,EAAIA,EAEFlL,KAIR4K,aAAchJ,EAAOlC,GAEpB,OAASkC,GAER,KAAK,EAAG5B,KAAK0J,EAAIhK,EAAO,MACxB,KAAK,EAAGM,KAAK2J,EAAIjK,EAAO,MACxB,KAAK,EAAGM,KAAKgkB,EAAItkB,EAAO,MACxB,KAAK,EAAGM,KAAKkL,EAAIxL,EAAO,MACxB,QAAS,MAAM,IAAImL,MAAO,0BAA4BjJ,GAIvD,OAAO5B,KAIR8K,aAAclJ,GAEb,OAASA,GAER,KAAK,EAAG,OAAO5B,KAAK0J,EACpB,KAAK,EAAG,OAAO1J,KAAK2J,EACpB,KAAK,EAAG,OAAO3J,KAAKgkB,EACpB,KAAK,EAAG,OAAOhkB,KAAKkL,EACpB,QAAS,MAAM,IAAIL,MAAO,0BAA4BjJ,IAMxDmJ,QAEC,OAAO,IAAI/K,KAAKI,YAAaJ,KAAK0J,EAAG1J,KAAK2J,EAAG3J,KAAKgkB,EAAGhkB,KAAKkL,GAI3DF,KAAMC,GAOL,OALAjL,KAAK0J,EAAIuB,EAAEvB,EACX1J,KAAK2J,EAAIsB,EAAEtB,EACX3J,KAAKgkB,EAAI/Y,EAAE+Y,EACXhkB,KAAKkL,OAAcnK,IAARkK,EAAEC,EAAoBD,EAAEC,EAAI,EAEhClL,KAIRF,IAAKmL,EAAGC,GAEP,YAAWnK,IAANmK,GAEJC,QAAQC,KAAM,yFACPpL,KAAKqL,WAAYJ,EAAGC,KAI5BlL,KAAK0J,GAAKuB,EAAEvB,EACZ1J,KAAK2J,GAAKsB,EAAEtB,EACZ3J,KAAKgkB,GAAK/Y,EAAE+Y,EACZhkB,KAAKkL,GAAKD,EAAEC,EAELlL,MAIRsL,UAAWC,GAOV,OALAvL,KAAK0J,GAAK6B,EACVvL,KAAK2J,GAAK4B,EACVvL,KAAKgkB,GAAKzY,EACVvL,KAAKkL,GAAKK,EAEHvL,KAIRqL,WAAYG,EAAGC,GAOd,OALAzL,KAAK0J,EAAI8B,EAAE9B,EAAI+B,EAAE/B,EACjB1J,KAAK2J,EAAI6B,EAAE7B,EAAI8B,EAAE9B,EACjB3J,KAAKgkB,EAAIxY,EAAEwY,EAAIvY,EAAEuY,EACjBhkB,KAAKkL,EAAIM,EAAEN,EAAIO,EAAEP,EAEVlL,KAIR0L,gBAAiBT,EAAGM,GAOnB,OALAvL,KAAK0J,GAAKuB,EAAEvB,EAAI6B,EAChBvL,KAAK2J,GAAKsB,EAAEtB,EAAI4B,EAChBvL,KAAKgkB,GAAK/Y,EAAE+Y,EAAIzY,EAChBvL,KAAKkL,GAAKD,EAAEC,EAAIK,EAETvL,KAIR2L,IAAKV,EAAGC,GAEP,YAAWnK,IAANmK,GAEJC,QAAQC,KAAM,yFACPpL,KAAK4L,WAAYX,EAAGC,KAI5BlL,KAAK0J,GAAKuB,EAAEvB,EACZ1J,KAAK2J,GAAKsB,EAAEtB,EACZ3J,KAAKgkB,GAAK/Y,EAAE+Y,EACZhkB,KAAKkL,GAAKD,EAAEC,EAELlL,MAIR6L,UAAWN,GAOV,OALAvL,KAAK0J,GAAK6B,EACVvL,KAAK2J,GAAK4B,EACVvL,KAAKgkB,GAAKzY,EACVvL,KAAKkL,GAAKK,EAEHvL,KAIR4L,WAAYJ,EAAGC,GAOd,OALAzL,KAAK0J,EAAI8B,EAAE9B,EAAI+B,EAAE/B,EACjB1J,KAAK2J,EAAI6B,EAAE7B,EAAI8B,EAAE9B,EACjB3J,KAAKgkB,EAAIxY,EAAEwY,EAAIvY,EAAEuY,EACjBhkB,KAAKkL,EAAIM,EAAEN,EAAIO,EAAEP,EAEVlL,KAIR8L,SAAUb,GAOT,OALAjL,KAAK0J,GAAKuB,EAAEvB,EACZ1J,KAAK2J,GAAKsB,EAAEtB,EACZ3J,KAAKgkB,GAAK/Y,EAAE+Y,EACZhkB,KAAKkL,GAAKD,EAAEC,EAELlL,KAIR+L,eAAgBtB,GAOf,OALAzK,KAAK0J,GAAKe,EACVzK,KAAK2J,GAAKc,EACVzK,KAAKgkB,GAAKvZ,EACVzK,KAAKkL,GAAKT,EAEHzK,KAIRiqB,aAAc9d,GAEb,MAAMzC,EAAI1J,KAAK0J,EAAGC,EAAI3J,KAAK2J,EAAGqa,EAAIhkB,KAAKgkB,EAAG9Y,EAAIlL,KAAKkL,EAC7CkB,EAAID,EAAEE,SAOZ,OALArM,KAAK0J,EAAI0C,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,GAAM4X,EAAI5X,EAAG,IAAOlB,EAC1DlL,KAAK2J,EAAIyC,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,GAAM4X,EAAI5X,EAAG,IAAOlB,EAC1DlL,KAAKgkB,EAAI5X,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,IAAO4X,EAAI5X,EAAG,IAAOlB,EAC3DlL,KAAKkL,EAAIkB,EAAG,GAAM1C,EAAI0C,EAAG,GAAMzC,EAAIyC,EAAG,IAAO4X,EAAI5X,EAAG,IAAOlB,EAEpDlL,KAIRiM,aAAcxB,GAEb,OAAOzK,KAAK+L,eAAgB,EAAItB,GAIjCowB,2BAA4Bvb,GAM3Btf,KAAKkL,EAAI,EAAI7G,KAAKwjB,KAAMvI,EAAEpU,GAE1B,MAAMK,EAAIlH,KAAK4I,KAAM,EAAIqS,EAAEpU,EAAIoU,EAAEpU,GAgBjC,OAdKK,EAAI,MAERvL,KAAK0J,EAAI,EACT1J,KAAK2J,EAAI,EACT3J,KAAKgkB,EAAI,IAIThkB,KAAK0J,EAAI4V,EAAE5V,EAAI6B,EACfvL,KAAK2J,EAAI2V,EAAE3V,EAAI4B,EACfvL,KAAKgkB,EAAI1E,EAAE0E,EAAIzY,GAITvL,KAIR86B,+BAAgC3uB,GAM/B,IAAIkB,EAAO3D,EAAGC,EAAGqa,EACjB,MAAM+W,EAAU,IACfC,EAAW,GAEXprB,EAAKzD,EAAEE,SAEP0a,EAAMnX,EAAI,GAAKoX,EAAMpX,EAAI,GAAKqX,EAAMrX,EAAI,GACxCsX,EAAMtX,EAAI,GAAKuX,EAAMvX,EAAI,GAAKwX,EAAMxX,EAAI,GACxCyX,EAAMzX,EAAI,GAAK0X,EAAM1X,EAAI,GAAK2X,EAAM3X,EAAI,IAEzC,GAAOvL,KAAK8I,IAAK6Z,EAAME,GAAQ6T,GACxB12B,KAAK8I,IAAK8Z,EAAMI,GAAQ0T,GACxB12B,KAAK8I,IAAKia,EAAME,GAAQyT,EAAY,CAM1C,GAAO12B,KAAK8I,IAAK6Z,EAAME,GAAQ8T,GACxB32B,KAAK8I,IAAK8Z,EAAMI,GAAQ2T,GACxB32B,KAAK8I,IAAKia,EAAME,GAAQ0T,GACxB32B,KAAK8I,IAAK4Z,EAAMI,EAAMI,EAAM,GAAMyT,EAMxC,OAFAh7B,KAAKuK,IAAK,EAAG,EAAG,EAAG,GAEZvK,KAMRqN,EAAQhJ,KAAKoE,GAEb,MAAM+wB,GAAOzS,EAAM,GAAM,EACnB0S,GAAOtS,EAAM,GAAM,EACnBuS,GAAOnS,EAAM,GAAM,EACnBuR,GAAO9R,EAAME,GAAQ,EACrB6R,GAAO9R,EAAMI,GAAQ,EACrB4R,GAAO7R,EAAME,GAAQ,EA4D3B,OA1DOkS,EAAKC,GAAUD,EAAKE,EAIrBF,EAAKuB,GAETrxB,EAAI,EACJC,EAAI,WACJqa,EAAI,aAIJta,EAAIrF,KAAK4I,KAAMusB,GACf7vB,EAAImvB,EAAKpvB,EACTsa,EAAI+U,EAAKrvB,GAIC+vB,EAAKC,EAIXD,EAAKsB,GAETrxB,EAAI,WACJC,EAAI,EACJqa,EAAI,aAIJra,EAAItF,KAAK4I,KAAMwsB,GACf/vB,EAAIovB,EAAKnvB,EACTqa,EAAIiV,EAAKtvB,GAQL+vB,EAAKqB,GAETrxB,EAAI,WACJC,EAAI,WACJqa,EAAI,IAIJA,EAAI3f,KAAK4I,KAAMysB,GACfhwB,EAAIqvB,EAAK/U,EACTra,EAAIsvB,EAAKjV,GAMXhkB,KAAKuK,IAAKb,EAAGC,EAAGqa,EAAG3W,GAEZrN,KAMR,IAAIuL,EAAIlH,KAAK4I,MAAQqa,EAAMF,IAAUE,EAAMF,IACxCH,EAAMI,IAAUJ,EAAMI,IACtBH,EAAMF,IAAUE,EAAMF,IAYzB,OAVK3iB,KAAK8I,IAAK5B,GAAM,OAAQA,EAAI,GAKjCvL,KAAK0J,GAAM4d,EAAMF,GAAQ7b,EACzBvL,KAAK2J,GAAMsd,EAAMI,GAAQ9b,EACzBvL,KAAKgkB,GAAMkD,EAAMF,GAAQzb,EACzBvL,KAAKkL,EAAI7G,KAAKwjB,MAAQd,EAAMI,EAAMI,EAAM,GAAM,GAEvCvnB,KAIRwJ,IAAKyB,GAOJ,OALAjL,KAAK0J,EAAIrF,KAAKmF,IAAKxJ,KAAK0J,EAAGuB,EAAEvB,GAC7B1J,KAAK2J,EAAItF,KAAKmF,IAAKxJ,KAAK2J,EAAGsB,EAAEtB,GAC7B3J,KAAKgkB,EAAI3f,KAAKmF,IAAKxJ,KAAKgkB,EAAG/Y,EAAE+Y,GAC7BhkB,KAAKkL,EAAI7G,KAAKmF,IAAKxJ,KAAKkL,EAAGD,EAAEC,GAEtBlL,KAIR0D,IAAKuH,GAOJ,OALAjL,KAAK0J,EAAIrF,KAAKX,IAAK1D,KAAK0J,EAAGuB,EAAEvB,GAC7B1J,KAAK2J,EAAItF,KAAKX,IAAK1D,KAAK2J,EAAGsB,EAAEtB,GAC7B3J,KAAKgkB,EAAI3f,KAAKX,IAAK1D,KAAKgkB,EAAG/Y,EAAE+Y,GAC7BhkB,KAAKkL,EAAI7G,KAAKX,IAAK1D,KAAKkL,EAAGD,EAAEC,GAEtBlL,KAIRuJ,MAAOC,EAAK9F,GASX,OALA1D,KAAK0J,EAAIrF,KAAKX,IAAK8F,EAAIE,EAAGrF,KAAKmF,IAAK9F,EAAIgG,EAAG1J,KAAK0J,IAChD1J,KAAK2J,EAAItF,KAAKX,IAAK8F,EAAIG,EAAGtF,KAAKmF,IAAK9F,EAAIiG,EAAG3J,KAAK2J,IAChD3J,KAAKgkB,EAAI3f,KAAKX,IAAK8F,EAAIwa,EAAG3f,KAAKmF,IAAK9F,EAAIsgB,EAAGhkB,KAAKgkB,IAChDhkB,KAAKkL,EAAI7G,KAAKX,IAAK8F,EAAI0B,EAAG7G,KAAKmF,IAAK9F,EAAIwH,EAAGlL,KAAKkL,IAEzClL,KAIRsM,YAAaC,EAAQC,GAOpB,OALAxM,KAAK0J,EAAIrF,KAAKX,IAAK6I,EAAQlI,KAAKmF,IAAKgD,EAAQxM,KAAK0J,IAClD1J,KAAK2J,EAAItF,KAAKX,IAAK6I,EAAQlI,KAAKmF,IAAKgD,EAAQxM,KAAK2J,IAClD3J,KAAKgkB,EAAI3f,KAAKX,IAAK6I,EAAQlI,KAAKmF,IAAKgD,EAAQxM,KAAKgkB,IAClDhkB,KAAKkL,EAAI7G,KAAKX,IAAK6I,EAAQlI,KAAKmF,IAAKgD,EAAQxM,KAAKkL,IAE3ClL,KAIRyM,YAAajD,EAAK9F,GAEjB,MAAMxB,EAASlC,KAAKkC,SAEpB,OAAOlC,KAAKiM,aAAc/J,GAAU,GAAI6J,eAAgB1H,KAAKX,IAAK8F,EAAKnF,KAAKmF,IAAK9F,EAAKxB,KAIvF+H,QAOC,OALAjK,KAAK0J,EAAIrF,KAAK4F,MAAOjK,KAAK0J,GAC1B1J,KAAK2J,EAAItF,KAAK4F,MAAOjK,KAAK2J,GAC1B3J,KAAKgkB,EAAI3f,KAAK4F,MAAOjK,KAAKgkB,GAC1BhkB,KAAKkL,EAAI7G,KAAK4F,MAAOjK,KAAKkL,GAEnBlL,KAIR0M,OAOC,OALA1M,KAAK0J,EAAIrF,KAAKqI,KAAM1M,KAAK0J,GACzB1J,KAAK2J,EAAItF,KAAKqI,KAAM1M,KAAK2J,GACzB3J,KAAKgkB,EAAI3f,KAAKqI,KAAM1M,KAAKgkB,GACzBhkB,KAAKkL,EAAI7G,KAAKqI,KAAM1M,KAAKkL,GAElBlL,KAIR2M,QAOC,OALA3M,KAAK0J,EAAIrF,KAAKsI,MAAO3M,KAAK0J,GAC1B1J,KAAK2J,EAAItF,KAAKsI,MAAO3M,KAAK2J,GAC1B3J,KAAKgkB,EAAI3f,KAAKsI,MAAO3M,KAAKgkB,GAC1BhkB,KAAKkL,EAAI7G,KAAKsI,MAAO3M,KAAKkL,GAEnBlL,KAIR4M,cAOC,OALA5M,KAAK0J,EAAM1J,KAAK0J,EAAI,EAAMrF,KAAKqI,KAAM1M,KAAK0J,GAAMrF,KAAK4F,MAAOjK,KAAK0J,GACjE1J,KAAK2J,EAAM3J,KAAK2J,EAAI,EAAMtF,KAAKqI,KAAM1M,KAAK2J,GAAMtF,KAAK4F,MAAOjK,KAAK2J,GACjE3J,KAAKgkB,EAAMhkB,KAAKgkB,EAAI,EAAM3f,KAAKqI,KAAM1M,KAAKgkB,GAAM3f,KAAK4F,MAAOjK,KAAKgkB,GACjEhkB,KAAKkL,EAAMlL,KAAKkL,EAAI,EAAM7G,KAAKqI,KAAM1M,KAAKkL,GAAM7G,KAAK4F,MAAOjK,KAAKkL,GAE1DlL,KAIR6M,SAOC,OALA7M,KAAK0J,GAAM1J,KAAK0J,EAChB1J,KAAK2J,GAAM3J,KAAK2J,EAChB3J,KAAKgkB,GAAMhkB,KAAKgkB,EAChBhkB,KAAKkL,GAAMlL,KAAKkL,EAETlL,KAIR8M,IAAK7B,GAEJ,OAAOjL,KAAK0J,EAAIuB,EAAEvB,EAAI1J,KAAK2J,EAAIsB,EAAEtB,EAAI3J,KAAKgkB,EAAI/Y,EAAE+Y,EAAIhkB,KAAKkL,EAAID,EAAEC,EAIhE8B,WAEC,OAAOhN,KAAK0J,EAAI1J,KAAK0J,EAAI1J,KAAK2J,EAAI3J,KAAK2J,EAAI3J,KAAKgkB,EAAIhkB,KAAKgkB,EAAIhkB,KAAKkL,EAAIlL,KAAKkL,EAI5EhJ,SAEC,OAAOmC,KAAK4I,KAAMjN,KAAK0J,EAAI1J,KAAK0J,EAAI1J,KAAK2J,EAAI3J,KAAK2J,EAAI3J,KAAKgkB,EAAIhkB,KAAKgkB,EAAIhkB,KAAKkL,EAAIlL,KAAKkL,GAIvFgC,kBAEC,OAAO7I,KAAK8I,IAAKnN,KAAK0J,GAAMrF,KAAK8I,IAAKnN,KAAK2J,GAAMtF,KAAK8I,IAAKnN,KAAKgkB,GAAM3f,KAAK8I,IAAKnN,KAAKkL,GAItFkC,YAEC,OAAOpN,KAAKiM,aAAcjM,KAAKkC,UAAY,GAI5C0L,UAAW1L,GAEV,OAAOlC,KAAKoN,YAAYrB,eAAgB7J,GAIzCuH,KAAMwB,EAAG4C,GAOR,OALA7N,KAAK0J,IAAOuB,EAAEvB,EAAI1J,KAAK0J,GAAMmE,EAC7B7N,KAAK2J,IAAOsB,EAAEtB,EAAI3J,KAAK2J,GAAMkE,EAC7B7N,KAAKgkB,IAAO/Y,EAAE+Y,EAAIhkB,KAAKgkB,GAAMnW,EAC7B7N,KAAKkL,IAAOD,EAAEC,EAAIlL,KAAKkL,GAAM2C,EAEtB7N,KAIR8N,YAAaC,EAAIC,EAAIH,GAOpB,OALA7N,KAAK0J,EAAIqE,EAAGrE,GAAMsE,EAAGtE,EAAIqE,EAAGrE,GAAMmE,EAClC7N,KAAK2J,EAAIoE,EAAGpE,GAAMqE,EAAGrE,EAAIoE,EAAGpE,GAAMkE,EAClC7N,KAAKgkB,EAAIjW,EAAGiW,GAAMhW,EAAGgW,EAAIjW,EAAGiW,GAAMnW,EAClC7N,KAAKkL,EAAI6C,EAAG7C,GAAM8C,EAAG9C,EAAI6C,EAAG7C,GAAM2C,EAE3B7N,KAIRiO,OAAQhD,GAEP,OAAWA,EAAEvB,IAAM1J,KAAK0J,GAASuB,EAAEtB,IAAM3J,KAAK2J,GAASsB,EAAE+Y,IAAMhkB,KAAKgkB,GAAS/Y,EAAEC,IAAMlL,KAAKkL,EAI3FgD,UAAWzK,EAAO0K,EAAS,GAO1B,OALAnO,KAAK0J,EAAIjG,EAAO0K,GAChBnO,KAAK2J,EAAIlG,EAAO0K,EAAS,GACzBnO,KAAKgkB,EAAIvgB,EAAO0K,EAAS,GACzBnO,KAAKkL,EAAIzH,EAAO0K,EAAS,GAElBnO,KAIRoO,QAAS3K,EAAQ,GAAI0K,EAAS,GAO7B,OALA1K,EAAO0K,GAAWnO,KAAK0J,EACvBjG,EAAO0K,EAAS,GAAMnO,KAAK2J,EAC3BlG,EAAO0K,EAAS,GAAMnO,KAAKgkB,EAC3BvgB,EAAO0K,EAAS,GAAMnO,KAAKkL,EAEpBzH,EAIR4K,oBAAqBC,EAAW1M,EAAOuM,GAatC,YAXgBpN,IAAXoN,GAEJhD,QAAQC,KAAM,uEAIfpL,KAAK0J,EAAI4E,EAAUC,KAAM3M,GACzB5B,KAAK2J,EAAI2E,EAAUE,KAAM5M,GACzB5B,KAAKgkB,EAAI1V,EAAU0T,KAAMpgB,GACzB5B,KAAKkL,EAAIoD,EAAUgb,KAAM1nB,GAElB5B,KAIRmJ,SAOC,OALAnJ,KAAK0J,EAAIrF,KAAK8E,SACdnJ,KAAK2J,EAAItF,KAAK8E,SACdnJ,KAAKgkB,EAAI3f,KAAK8E,SACdnJ,KAAKkL,EAAI7G,KAAK8E,SAEPnJ,KAIR,EAAGR,OAAOsP,kBAEH9O,KAAK0J,QACL1J,KAAK2J,QACL3J,KAAKgkB,QACLhkB,KAAKkL,GC/oBb,SAAS+vB,KAER,IAAInkB,EAAU,KACVokB,GAAc,EACdC,EAAgB,KAChBC,EAAY,KAEhB,SAASC,EAAkBC,EAAMC,GAEhCJ,EAAeG,EAAMC,GAErBH,EAAYtkB,EAAQ0kB,sBAAuBH,GAI5C,MAAO,CAEN1I,MAAO,YAEe,IAAhBuI,GACkB,OAAlBC,IAELC,EAAYtkB,EAAQ0kB,sBAAuBH,GAE3CH,GAAc,IAIfO,KAAM,WAEL3kB,EAAQ4kB,qBAAsBN,GAE9BF,GAAc,GAIfS,iBAAkB,SAAWvY,GAE5B+X,EAAgB/X,GAIjBwY,WAAY,SAAWl8B,GAEtBoX,EAAUpX,IC5Cb,SAASm8B,GAAiBC,EAAIC,GAE7B,MAAMC,EAAWD,EAAaC,SAExBC,EAAU,IAAIC,QAiLpB,MAAO,CAENh9B,IAjED,SAAcoP,GAIb,OAFKA,EAAU6tB,+BAA+B7tB,EAAYA,EAAU+I,MAE7D4kB,EAAQ/8B,IAAKoP,IA8DpBrO,OA1DD,SAAiBqO,GAEXA,EAAU6tB,+BAA+B7tB,EAAYA,EAAU+I,MAEpE,MAAMA,EAAO4kB,EAAQ/8B,IAAKoP,GAErB+I,IAEJykB,EAAGM,aAAc/kB,EAAKglB,QAEtBJ,EAAQK,OAAQhuB,KAiDjB2X,OA3CD,SAAiB3X,EAAWiuB,GAE3B,GAAKjuB,EAAUkuB,oBAAsB,CAEpC,MAAMt3B,EAAS+2B,EAAQ/8B,IAAKoP,GAa5B,cAXOpJ,GAAUA,EAAO+P,QAAU3G,EAAU2G,UAE3CgnB,EAAQ1xB,IAAK+D,EAAW,CACvB+tB,OAAQ/tB,EAAU+tB,OAClBv2B,KAAMwI,EAAUxI,KAChB22B,gBAAiBnuB,EAAUouB,YAC3BznB,QAAS3G,EAAU2G,WASjB3G,EAAU6tB,+BAA+B7tB,EAAYA,EAAU+I,MAEpE,MAAMA,EAAO4kB,EAAQ/8B,IAAKoP,QAEZvN,IAATsW,EAEJ4kB,EAAQ1xB,IAAK+D,EAnKf,SAAuBA,EAAWiuB,GAEjC,MAAM94B,EAAQ6K,EAAU7K,MAClBk5B,EAAQruB,EAAUquB,MAElBN,EAASP,EAAGc,eAElBd,EAAGe,WAAYN,EAAYF,GAC3BP,EAAGgB,WAAYP,EAAY94B,EAAOk5B,GAElCruB,EAAUyuB,mBAEV,IAAIj3B,EAAOg2B,EAAGkB,MAwDd,OAtDKv5B,aAAiBqB,aAErBgB,EAAOg2B,EAAGkB,MAECv5B,aAAiBsB,aAE5BoG,QAAQC,KAAM,wEAEH3H,aAAiBkB,YAEvB2J,EAAU2uB,yBAETjB,EAEJl2B,EAAOg2B,EAAGoB,WAIV/xB,QAAQC,KAAM,2EAMftF,EAAOg2B,EAAGqB,eAIA15B,aAAiBiB,WAE5BoB,EAAOg2B,EAAGsB,MAEC35B,aAAiBoB,YAE5BiB,EAAOg2B,EAAGuB,aAEC55B,aAAiBmB,WAE5BkB,EAAOg2B,EAAGwB,IAEC75B,aAAiBc,UAE5BuB,EAAOg2B,EAAGyB,MAEC95B,aAAiBe,YAIjBf,aAAiBgB,qBAF5BqB,EAAOg2B,EAAG0B,eAQJ,CACNnB,OAAQA,EACRv2B,KAAMA,EACN22B,gBAAiBh5B,EAAMg6B,kBACvBxoB,QAAS3G,EAAU2G,SA2FK2nB,CAActuB,EAAWiuB,IAEtCllB,EAAKpC,QAAU3G,EAAU2G,UAxFtC,SAAuBonB,EAAQ/tB,EAAWiuB,GAEzC,MAAM94B,EAAQ6K,EAAU7K,MAClBi6B,EAAcpvB,EAAUovB,YAE9B5B,EAAGe,WAAYN,EAAYF,IAEE,IAAxBqB,EAAYnQ,MAIhBuO,EAAG6B,cAAepB,EAAY,EAAG94B,IAI5Bu4B,EAEJF,EAAG6B,cAAepB,EAAYmB,EAAYvvB,OAAS1K,EAAMg6B,kBACxDh6B,EAAOi6B,EAAYvvB,OAAQuvB,EAAYnQ,OAIxCuO,EAAG6B,cAAepB,EAAYmB,EAAYvvB,OAAS1K,EAAMg6B,kBACxDh6B,EAAMm6B,SAAUF,EAAYvvB,OAAQuvB,EAAYvvB,OAASuvB,EAAYnQ,QAIvEmQ,EAAYnQ,OAAU,GA+DtBsQ,CAAcxmB,EAAKglB,OAAQ/tB,EAAWiuB,GAEtCllB,EAAKpC,QAAU3G,EAAU2G,WFse5B,GAAQ5V,UAAUy+B,WAAY,EG/oB9B,MAAM,GAAwB,IAAIrU,GAC5B,GAAyB,IAAIrf,GAEnC,MAAM2zB,GAEL39B,YAAaqD,EAAOu6B,EAAU/b,GAE7B,GAAKhM,MAAMC,QAASzS,GAEnB,MAAM,IAAIw6B,UAAW,yDAItBj+B,KAAK4D,KAAO,GAEZ5D,KAAKyD,MAAQA,EACbzD,KAAKg+B,SAAWA,EAChBh+B,KAAKutB,WAAkBxsB,IAAV0C,EAAsBA,EAAMvB,OAAS87B,EAAW,EAC7Dh+B,KAAKiiB,YAA4B,IAAfA,EAElBjiB,KAAK28B,MAAQr0B,EACbtI,KAAK09B,YAAc,CAAEvvB,OAAQ,EAAGof,OAAS,GAEzCvtB,KAAKiV,QAAU,EAIhB8nB,oBAEIvmB,gBAAa9W,IAED,IAAVA,GAAiBM,KAAKiV,UAI5BipB,SAAUx+B,GAIT,OAFAM,KAAK28B,MAAQj9B,EAENM,KAIRgL,KAAMqK,GAUL,OARArV,KAAK4D,KAAOyR,EAAOzR,KACnB5D,KAAKyD,MAAQ,IAAI4R,EAAO5R,MAAMrD,YAAaiV,EAAO5R,OAClDzD,KAAKg+B,SAAW3oB,EAAO2oB,SACvBh+B,KAAKutB,MAAQlY,EAAOkY,MACpBvtB,KAAKiiB,WAAa5M,EAAO4M,WAEzBjiB,KAAK28B,MAAQtnB,EAAOsnB,MAEb38B,KAIRm+B,OAAQC,EAAQ9vB,EAAW+vB,GAE1BD,GAAUp+B,KAAKg+B,SACfK,GAAU/vB,EAAU0vB,SAEpB,IAAM,IAAIh8B,EAAI,EAAGC,EAAIjC,KAAKg+B,SAAUh8B,EAAIC,EAAGD,IAE1ChC,KAAKyD,MAAO26B,EAASp8B,GAAMsM,EAAU7K,MAAO46B,EAASr8B,GAItD,OAAOhC,KAIRs+B,UAAW76B,GAIV,OAFAzD,KAAKyD,MAAM8G,IAAK9G,GAETzD,KAIRu+B,gBAAiBC,GAEhB,MAAM/6B,EAAQzD,KAAKyD,MACnB,IAAI0K,EAAS,EAEb,IAAM,IAAInM,EAAI,EAAGC,EAAIu8B,EAAOt8B,OAAQF,EAAIC,EAAGD,IAAO,CAEjD,IAAIgZ,EAAQwjB,EAAQx8B,QAELjB,IAAVia,IAEJ7P,QAAQC,KAAM,8DAA+DpJ,GAC7EgZ,EAAQ,IAAIyE,IAIbhc,EAAO0K,KAAc6M,EAAMrI,EAC3BlP,EAAO0K,KAAc6M,EAAMlJ,EAC3BrO,EAAO0K,KAAc6M,EAAMvP,EAI5B,OAAOzL,KAIRy+B,kBAAmBC,GAElB,MAAMj7B,EAAQzD,KAAKyD,MACnB,IAAI0K,EAAS,EAEb,IAAM,IAAInM,EAAI,EAAGC,EAAIy8B,EAAQx8B,OAAQF,EAAIC,EAAGD,IAAO,CAElD,IAAIwsB,EAASkQ,EAAS18B,QAENjB,IAAXytB,IAEJrjB,QAAQC,KAAM,iEAAkEpJ,GAChFwsB,EAAS,IAAIpkB,IAId3G,EAAO0K,KAAcqgB,EAAO9kB,EAC5BjG,EAAO0K,KAAcqgB,EAAO7kB,EAI7B,OAAO3J,KAIR2+B,kBAAmBD,GAElB,MAAMj7B,EAAQzD,KAAKyD,MACnB,IAAI0K,EAAS,EAEb,IAAM,IAAInM,EAAI,EAAGC,EAAIy8B,EAAQx8B,OAAQF,EAAIC,EAAGD,IAAO,CAElD,IAAIwsB,EAASkQ,EAAS18B,QAENjB,IAAXytB,IAEJrjB,QAAQC,KAAM,iEAAkEpJ,GAChFwsB,EAAS,IAAI/E,IAIdhmB,EAAO0K,KAAcqgB,EAAO9kB,EAC5BjG,EAAO0K,KAAcqgB,EAAO7kB,EAC5BlG,EAAO0K,KAAcqgB,EAAOxK,EAI7B,OAAOhkB,KAIR4+B,kBAAmBF,GAElB,MAAMj7B,EAAQzD,KAAKyD,MACnB,IAAI0K,EAAS,EAEb,IAAM,IAAInM,EAAI,EAAGC,EAAIy8B,EAAQx8B,OAAQF,EAAIC,EAAGD,IAAO,CAElD,IAAIwsB,EAASkQ,EAAS18B,QAENjB,IAAXytB,IAEJrjB,QAAQC,KAAM,iEAAkEpJ,GAChFwsB,EAAS,IAAI,IAId/qB,EAAO0K,KAAcqgB,EAAO9kB,EAC5BjG,EAAO0K,KAAcqgB,EAAO7kB,EAC5BlG,EAAO0K,KAAcqgB,EAAOxK,EAC5BvgB,EAAO0K,KAAcqgB,EAAOtjB,EAI7B,OAAOlL,KAIRkM,aAAcC,GAEb,GAAuB,IAAlBnM,KAAKg+B,SAET,IAAM,IAAIh8B,EAAI,EAAGC,EAAIjC,KAAKutB,MAAOvrB,EAAIC,EAAGD,IAEvC,GAASqM,oBAAqBrO,KAAMgC,GACpC,GAASkK,aAAcC,GAEvBnM,KAAK6+B,MAAO78B,EAAG,GAAS0H,EAAG,GAASC,QAI/B,GAAuB,IAAlB3J,KAAKg+B,SAEhB,IAAM,IAAIh8B,EAAI,EAAGC,EAAIjC,KAAKutB,MAAOvrB,EAAIC,EAAGD,IAEvC,GAAQqM,oBAAqBrO,KAAMgC,GACnC,GAAQkK,aAAcC,GAEtBnM,KAAK8+B,OAAQ98B,EAAG,GAAQ0H,EAAG,GAAQC,EAAG,GAAQqa,GAMhD,OAAOhkB,KAIRiqB,aAAc9d,GAEb,IAAM,IAAInK,EAAI,EAAGC,EAAIjC,KAAKutB,MAAOvrB,EAAIC,EAAGD,IAEvC,GAAQ0H,EAAI1J,KAAKuO,KAAMvM,GACvB,GAAQ2H,EAAI3J,KAAKwO,KAAMxM,GACvB,GAAQgiB,EAAIhkB,KAAKgiB,KAAMhgB,GAEvB,GAAQioB,aAAc9d,GAEtBnM,KAAK8+B,OAAQ98B,EAAG,GAAQ0H,EAAG,GAAQC,EAAG,GAAQqa,GAI/C,OAAOhkB,KAIRgqB,kBAAmB7d,GAElB,IAAM,IAAInK,EAAI,EAAGC,EAAIjC,KAAKutB,MAAOvrB,EAAIC,EAAGD,IAEvC,GAAQ0H,EAAI1J,KAAKuO,KAAMvM,GACvB,GAAQ2H,EAAI3J,KAAKwO,KAAMxM,GACvB,GAAQgiB,EAAIhkB,KAAKgiB,KAAMhgB,GAEvB,GAAQgoB,kBAAmB7d,GAE3BnM,KAAK8+B,OAAQ98B,EAAG,GAAQ0H,EAAG,GAAQC,EAAG,GAAQqa,GAI/C,OAAOhkB,KAIRirB,mBAAoB9e,GAEnB,IAAM,IAAInK,EAAI,EAAGC,EAAIjC,KAAKutB,MAAOvrB,EAAIC,EAAGD,IAEvC,GAAQ0H,EAAI1J,KAAKuO,KAAMvM,GACvB,GAAQ2H,EAAI3J,KAAKwO,KAAMxM,GACvB,GAAQgiB,EAAIhkB,KAAKgiB,KAAMhgB,GAEvB,GAAQipB,mBAAoB9e,GAE5BnM,KAAK8+B,OAAQ98B,EAAG,GAAQ0H,EAAG,GAAQC,EAAG,GAAQqa,GAI/C,OAAOhkB,KAIRuK,IAAK7K,EAAOyO,EAAS,GAIpB,OAFAnO,KAAKyD,MAAM8G,IAAK7K,EAAOyO,GAEhBnO,KAIRuO,KAAM3M,GAEL,OAAO5B,KAAKyD,MAAO7B,EAAQ5B,KAAKg+B,UAIjCtzB,KAAM9I,EAAO8H,GAIZ,OAFA1J,KAAKyD,MAAO7B,EAAQ5B,KAAKg+B,UAAat0B,EAE/B1J,KAIRwO,KAAM5M,GAEL,OAAO5B,KAAKyD,MAAO7B,EAAQ5B,KAAKg+B,SAAW,GAI5CrzB,KAAM/I,EAAO+H,GAIZ,OAFA3J,KAAKyD,MAAO7B,EAAQ5B,KAAKg+B,SAAW,GAAMr0B,EAEnC3J,KAIRgiB,KAAMpgB,GAEL,OAAO5B,KAAKyD,MAAO7B,EAAQ5B,KAAKg+B,SAAW,GAI5CtU,KAAM9nB,EAAOoiB,GAIZ,OAFAhkB,KAAKyD,MAAO7B,EAAQ5B,KAAKg+B,SAAW,GAAMha,EAEnChkB,KAIRspB,KAAM1nB,GAEL,OAAO5B,KAAKyD,MAAO7B,EAAQ5B,KAAKg+B,SAAW,GAI5CpD,KAAMh5B,EAAOsJ,GAIZ,OAFAlL,KAAKyD,MAAO7B,EAAQ5B,KAAKg+B,SAAW,GAAM9yB,EAEnClL,KAIR6+B,MAAOj9B,EAAO8H,EAAGC,GAOhB,OALA/H,GAAS5B,KAAKg+B,SAEdh+B,KAAKyD,MAAO7B,EAAQ,GAAM8H,EAC1B1J,KAAKyD,MAAO7B,EAAQ,GAAM+H,EAEnB3J,KAIR8+B,OAAQl9B,EAAO8H,EAAGC,EAAGqa,GAQpB,OANApiB,GAAS5B,KAAKg+B,SAEdh+B,KAAKyD,MAAO7B,EAAQ,GAAM8H,EAC1B1J,KAAKyD,MAAO7B,EAAQ,GAAM+H,EAC1B3J,KAAKyD,MAAO7B,EAAQ,GAAMoiB,EAEnBhkB,KAIR++B,QAASn9B,EAAO8H,EAAGC,EAAGqa,EAAG9Y,GASxB,OAPAtJ,GAAS5B,KAAKg+B,SAEdh+B,KAAKyD,MAAO7B,EAAQ,GAAM8H,EAC1B1J,KAAKyD,MAAO7B,EAAQ,GAAM+H,EAC1B3J,KAAKyD,MAAO7B,EAAQ,GAAMoiB,EAC1BhkB,KAAKyD,MAAO7B,EAAQ,GAAMsJ,EAEnBlL,KAIRg/B,SAAU5b,GAIT,OAFApjB,KAAK+8B,iBAAmB3Z,EAEjBpjB,KAIR+K,QAEC,OAAO,IAAI/K,KAAKI,YAAaJ,KAAKyD,MAAOzD,KAAKg+B,UAAWhzB,KAAMhL,MAIhEwV,SAEC,MAAM6B,EAAO,CACZ2mB,SAAUh+B,KAAKg+B,SACfl4B,KAAM9F,KAAKyD,MAAMrD,YAAYwD,KAC7BH,MAAOwS,MAAM5W,UAAUiH,MAAM/G,KAAMS,KAAKyD,OACxCwe,WAAYjiB,KAAKiiB,YAOlB,MAJmB,KAAdjiB,KAAK4D,OAAcyT,EAAKzT,KAAO5D,KAAK4D,MACpC5D,KAAK28B,QAAUr0B,IAAkB+O,EAAKslB,MAAQ38B,KAAK28B,OACvB,IAA5B38B,KAAK09B,YAAYvvB,SAA6C,IAA7BnO,KAAK09B,YAAYnQ,QAAgBlW,EAAKqmB,YAAc19B,KAAK09B,aAExFrmB,GAMT0mB,GAAgB1+B,UAAU4/B,mBAAoB,EA4C9C,MAAMC,WAA8BnB,GAEnC39B,YAAaqD,EAAOu6B,EAAU/b,GAE7Bhd,MAAO,IAAIN,YAAalB,GAASu6B,EAAU/b,IAgB7C,MAAMkd,WAA8BpB,GAEnC39B,YAAaqD,EAAOu6B,EAAU/b,GAE7Bhd,MAAO,IAAIJ,YAAapB,GAASu6B,EAAU/b,KAM7C,cAAqC8b,GAEpC39B,YAAaqD,EAAOu6B,EAAU/b,GAE7Bhd,MAAO,IAAIN,YAAalB,GAASu6B,EAAU/b,MAMtB5iB,UAAU49B,0BAA2B,EAE5D,MAAMmC,WAA+BrB,GAEpC39B,YAAaqD,EAAOu6B,EAAU/b,GAE7Bhd,MAAO,IAAIH,aAAcrB,GAASu6B,EAAU/b,IC5e9C,MAAMod,GAAwB,IAAIlK,GAC5B,GAA4B,IAAIpR,GAEtC,MAAMub,GAELl/B,YAAasJ,EAAI,EAAGC,EAAI,EAAGqa,EAAI,EAAGmC,EAAQmZ,GAAMC,cAE/Cv/B,KAAKikB,GAAKva,EACV1J,KAAKkkB,GAAKva,EACV3J,KAAKmkB,GAAKH,EACVhkB,KAAKomB,OAASD,EAIXzc,QAEH,OAAO1J,KAAKikB,GAITva,MAAGhK,GAENM,KAAKikB,GAAKvkB,EACVM,KAAK6lB,oBAIFlc,QAEH,OAAO3J,KAAKkkB,GAITva,MAAGjK,GAENM,KAAKkkB,GAAKxkB,EACVM,KAAK6lB,oBAIF7B,QAEH,OAAOhkB,KAAKmkB,GAITH,MAAGtkB,GAENM,KAAKmkB,GAAKzkB,EACVM,KAAK6lB,oBAIFM,YAEH,OAAOnmB,KAAKomB,OAITD,UAAOzmB,GAEVM,KAAKomB,OAAS1mB,EACdM,KAAK6lB,oBAINtb,IAAKb,EAAGC,EAAGqa,EAAGmC,EAAQnmB,KAAKomB,QAS1B,OAPApmB,KAAKikB,GAAKva,EACV1J,KAAKkkB,GAAKva,EACV3J,KAAKmkB,GAAKH,EACVhkB,KAAKomB,OAASD,EAEdnmB,KAAK6lB,oBAEE7lB,KAIR+K,QAEC,OAAO,IAAI/K,KAAKI,YAAaJ,KAAKikB,GAAIjkB,KAAKkkB,GAAIlkB,KAAKmkB,GAAInkB,KAAKomB,QAI9Dpb,KAAMgb,GASL,OAPAhmB,KAAKikB,GAAK+B,EAAM/B,GAChBjkB,KAAKkkB,GAAK8B,EAAM9B,GAChBlkB,KAAKmkB,GAAK6B,EAAM7B,GAChBnkB,KAAKomB,OAASJ,EAAMI,OAEpBpmB,KAAK6lB,oBAEE7lB,KAIR8mB,sBAAuB3a,EAAGga,EAAQnmB,KAAKomB,OAAQH,GAAS,GAIvD,MAAMrW,EAAKzD,EAAEE,SACP0a,EAAMnX,EAAI,GAAKoX,EAAMpX,EAAI,GAAKqX,EAAMrX,EAAI,GACxCsX,EAAMtX,EAAI,GAAKuX,EAAMvX,EAAI,GAAKwX,EAAMxX,EAAI,GACxCyX,EAAMzX,EAAI,GAAK0X,EAAM1X,EAAI,GAAK2X,EAAM3X,EAAI,IAE9C,OAASuW,GAER,IAAK,MAEJnmB,KAAKkkB,GAAK7f,KAAKm7B,KAAMj2B,EAAO0d,GAAO,EAAG,IAEjC5iB,KAAK8I,IAAK8Z,GAAQ,UAEtBjnB,KAAKikB,GAAK5f,KAAKiJ,OAAS8Z,EAAKG,GAC7BvnB,KAAKmkB,GAAK9f,KAAKiJ,OAAS0Z,EAAKD,KAI7B/mB,KAAKikB,GAAK5f,KAAKiJ,MAAOga,EAAKH,GAC3BnnB,KAAKmkB,GAAK,GAIX,MAED,IAAK,MAEJnkB,KAAKikB,GAAK5f,KAAKm7B,MAAQj2B,EAAO6d,GAAO,EAAG,IAEnC/iB,KAAK8I,IAAKia,GAAQ,UAEtBpnB,KAAKkkB,GAAK7f,KAAKiJ,MAAO2Z,EAAKM,GAC3BvnB,KAAKmkB,GAAK9f,KAAKiJ,MAAO4Z,EAAKC,KAI3BnnB,KAAKkkB,GAAK7f,KAAKiJ,OAAS+Z,EAAKN,GAC7B/mB,KAAKmkB,GAAK,GAIX,MAED,IAAK,MAEJnkB,KAAKikB,GAAK5f,KAAKm7B,KAAMj2B,EAAO+d,GAAO,EAAG,IAEjCjjB,KAAK8I,IAAKma,GAAQ,UAEtBtnB,KAAKkkB,GAAK7f,KAAKiJ,OAAS+Z,EAAKE,GAC7BvnB,KAAKmkB,GAAK9f,KAAKiJ,OAAS0Z,EAAKG,KAI7BnnB,KAAKkkB,GAAK,EACVlkB,KAAKmkB,GAAK9f,KAAKiJ,MAAO4Z,EAAKH,IAI5B,MAED,IAAK,MAEJ/mB,KAAKkkB,GAAK7f,KAAKm7B,MAAQj2B,EAAO8d,GAAO,EAAG,IAEnChjB,KAAK8I,IAAKka,GAAQ,UAEtBrnB,KAAKikB,GAAK5f,KAAKiJ,MAAOga,EAAKC,GAC3BvnB,KAAKmkB,GAAK9f,KAAKiJ,MAAO4Z,EAAKH,KAI3B/mB,KAAKikB,GAAK,EACVjkB,KAAKmkB,GAAK9f,KAAKiJ,OAAS0Z,EAAKG,IAI9B,MAED,IAAK,MAEJnnB,KAAKmkB,GAAK9f,KAAKm7B,KAAMj2B,EAAO2d,GAAO,EAAG,IAEjC7iB,KAAK8I,IAAK+Z,GAAQ,UAEtBlnB,KAAKikB,GAAK5f,KAAKiJ,OAAS8Z,EAAKD,GAC7BnnB,KAAKkkB,GAAK7f,KAAKiJ,OAAS+Z,EAAKN,KAI7B/mB,KAAKikB,GAAK,EACVjkB,KAAKkkB,GAAK7f,KAAKiJ,MAAO2Z,EAAKM,IAI5B,MAED,IAAK,MAEJvnB,KAAKmkB,GAAK9f,KAAKm7B,MAAQj2B,EAAOyd,GAAO,EAAG,IAEnC3iB,KAAK8I,IAAK6Z,GAAQ,UAEtBhnB,KAAKikB,GAAK5f,KAAKiJ,MAAOga,EAAKH,GAC3BnnB,KAAKkkB,GAAK7f,KAAKiJ,MAAO2Z,EAAKF,KAI3B/mB,KAAKikB,GAAK5f,KAAKiJ,OAAS8Z,EAAKG,GAC7BvnB,KAAKkkB,GAAK,GAIX,MAED,QAEC/Y,QAAQC,KAAM,uEAAyE+a,GAQzF,OAJAnmB,KAAKomB,OAASD,GAEE,IAAXF,GAAkBjmB,KAAK6lB,oBAErB7lB,KAIRy/B,kBAAmBngB,EAAG6G,EAAOF,GAI5B,OAFAoZ,GAAQxI,2BAA4BvX,GAE7Btf,KAAK8mB,sBAAuBuY,GAASlZ,EAAOF,GAIpDyZ,eAAgBz0B,EAAGkb,EAAQnmB,KAAKomB,QAE/B,OAAOpmB,KAAKuK,IAAKU,EAAEvB,EAAGuB,EAAEtB,EAAGsB,EAAE+Y,EAAGmC,GAIjCwZ,QAASC,GAMR,OAFA,GAAY7Z,aAAc/lB,MAEnBA,KAAKy/B,kBAAmB,GAAaG,GAI7C3xB,OAAQ+X,GAEP,OAASA,EAAM/B,KAAOjkB,KAAKikB,IAAU+B,EAAM9B,KAAOlkB,KAAKkkB,IAAU8B,EAAM7B,KAAOnkB,KAAKmkB,IAAU6B,EAAMI,SAAWpmB,KAAKomB,OAIpHlY,UAAWzK,GASV,OAPAzD,KAAKikB,GAAKxgB,EAAO,GACjBzD,KAAKkkB,GAAKzgB,EAAO,GACjBzD,KAAKmkB,GAAK1gB,EAAO,QACG1C,IAAf0C,EAAO,KAAoBzD,KAAKomB,OAAS3iB,EAAO,IAErDzD,KAAK6lB,oBAEE7lB,KAIRoO,QAAS3K,EAAQ,GAAI0K,EAAS,GAO7B,OALA1K,EAAO0K,GAAWnO,KAAKikB,GACvBxgB,EAAO0K,EAAS,GAAMnO,KAAKkkB,GAC3BzgB,EAAO0K,EAAS,GAAMnO,KAAKmkB,GAC3B1gB,EAAO0K,EAAS,GAAMnO,KAAKomB,OAEpB3iB,EAIRo8B,UAAWC,GAEV,OAAKA,EAEGA,EAAev1B,IAAKvK,KAAKikB,GAAIjkB,KAAKkkB,GAAIlkB,KAAKmkB,IAI3C,IAAIsF,GAASzpB,KAAKikB,GAAIjkB,KAAKkkB,GAAIlkB,KAAKmkB,IAM7CoF,UAAWnG,GAIV,OAFApjB,KAAK6lB,kBAAoBzC,EAElBpjB,KAIR6lB,sBAIDyZ,GAAMjgC,UAAU6mB,SAAU,EAE1BoZ,GAAMC,aAAe,MACrBD,GAAMS,eAAiB,CAAE,MAAO,MAAO,MAAO,MAAO,MAAO,OC/T5D,MAAMC,GAEL5/B,cAECJ,KAAKigC,KAAO,EAIb11B,IAAK21B,GAEJlgC,KAAKigC,KAAO,GAAKC,EAAU,EAI5BC,OAAQD,GAEPlgC,KAAKigC,MAAQ,GAAKC,EAAU,EAI7BE,YAECpgC,KAAKigC,MAAO,EAIbI,OAAQH,GAEPlgC,KAAKigC,MAAQ,GAAKC,EAAU,EAI7BI,QAASJ,GAERlgC,KAAKigC,QAAY,GAAKC,EAAU,GAIjCK,aAECvgC,KAAKigC,KAAO,EAIb59B,KAAMm+B,GAEL,OAAuC,IAA9BxgC,KAAKigC,KAAOO,EAAOP,OCrC9B,IAAIQ,GAAc,EAElB,MAAM,GAAoB,IAAIhX,GACxBiX,GAAoB,IAAI3c,GACxB,GAAoB,IAAIoR,GACxBwL,GAAwB,IAAIlX,GAE5BmX,GAA0B,IAAInX,GAC9BoX,GAAuB,IAAIpX,GAC3B,GAA4B,IAAI1F,GAEhC+c,GAAuB,IAAIrX,GAAS,EAAG,EAAG,GAC1CsX,GAAuB,IAAItX,GAAS,EAAG,EAAG,GAC1CuX,GAAuB,IAAIvX,GAAS,EAAG,EAAG,GAE1CwX,GAAc,CAAEn7B,KAAM,SACtBo7B,GAAgB,CAAEp7B,KAAM,WAE9B,MAAMq7B,WAAiBt7B,EAEtBzF,cAEC6E,QAEAlG,OAAOC,eAAgBgB,KAAM,KAAM,CAAEN,MAAO+gC,OAE5CzgC,KAAKuU,KAAO,IAEZvU,KAAK4D,KAAO,GACZ5D,KAAK8F,KAAO,WAEZ9F,KAAKohC,OAAS,KACdphC,KAAKgvB,SAAW,GAEhBhvB,KAAKm3B,GAAKgK,GAASE,UAAUt2B,QAE7B,MAAMquB,EAAW,IAAI3P,GACfxW,EAAW,IAAIqsB,GACfxZ,EAAa,IAAI/B,GACjB3Q,EAAQ,IAAIqW,GAAS,EAAG,EAAG,GAcjCxW,EAASsW,WAZT,WAECzD,EAAWC,aAAc9S,GAAU,MAWpC6S,EAAWyD,WAPX,WAECtW,EAASwsB,kBAAmB3Z,OAAY/kB,GAAW,MAOpDhC,OAAOuiC,iBAAkBthC,KAAM,CAC9Bo5B,SAAU,CACTmI,cAAc,EACdtiC,YAAY,EACZS,MAAO05B,GAERnmB,SAAU,CACTsuB,cAAc,EACdtiC,YAAY,EACZS,MAAOuT,GAER6S,WAAY,CACXyb,cAAc,EACdtiC,YAAY,EACZS,MAAOomB,GAER1S,MAAO,CACNmuB,cAAc,EACdtiC,YAAY,EACZS,MAAO0T,GAERouB,gBAAiB,CAChB9hC,MAAO,IAAIy1B,IAEZjC,aAAc,CACbxzB,MAAO,IAAIsP,MAIbhP,KAAKwT,OAAS,IAAI2hB,GAClBn1B,KAAKgrB,YAAc,IAAImK,GAEvBn1B,KAAK2U,iBAAmBwsB,GAASM,wBACjCzhC,KAAK0hC,wBAAyB,EAE9B1hC,KAAKwgC,OAAS,IAAIR,GAClBhgC,KAAK8Z,SAAU,EAEf9Z,KAAK2hC,YAAa,EAClB3hC,KAAK4hC,eAAgB,EAErB5hC,KAAK6hC,eAAgB,EACrB7hC,KAAK8hC,YAAc,EAEnB9hC,KAAK+hC,WAAa,GAElB/hC,KAAKgV,SAAW,GAIjBmF,kBAEA6nB,iBAEA/X,aAAczW,GAERxT,KAAK2U,kBAAmB3U,KAAKoV,eAElCpV,KAAKwT,OAAOlD,YAAakD,GAEzBxT,KAAKwT,OAAOsmB,UAAW95B,KAAKo5B,SAAUp5B,KAAK8lB,WAAY9lB,KAAKoT,OAI7DyW,gBAAiBvK,GAIhB,OAFAtf,KAAK8lB,WAAWxV,YAAagP,GAEtBtf,KAIRiiC,yBAA0Brb,EAAMvZ,GAI/BrN,KAAK8lB,WAAWa,iBAAkBC,EAAMvZ,GAIzC60B,qBAAsBlc,GAErBhmB,KAAK8lB,WAAWC,aAAcC,GAAO,GAItCmc,sBAAuBh2B,GAItBnM,KAAK8lB,WAAWgB,sBAAuB3a,GAIxCi2B,0BAA2B9iB,GAI1Btf,KAAK8lB,WAAW9a,KAAMsU,GAIvB+iB,aAAczb,EAAMvZ,GASnB,OAJAqzB,GAAI/Z,iBAAkBC,EAAMvZ,GAE5BrN,KAAK8lB,WAAWha,SAAU40B,IAEnB1gC,KAIRsiC,kBAAmB1b,EAAMvZ,GAUxB,OAJAqzB,GAAI/Z,iBAAkBC,EAAMvZ,GAE5BrN,KAAK8lB,WAAWxV,YAAaowB,IAEtB1gC,KAIRuiC,QAASl1B,GAER,OAAOrN,KAAKqiC,aAAcvB,GAAQzzB,GAInCm1B,QAASn1B,GAER,OAAOrN,KAAKqiC,aAActB,GAAQ1zB,GAInCo1B,QAASp1B,GAER,OAAOrN,KAAKqiC,aAAcrB,GAAQ3zB,GAInCq1B,gBAAiB9b,EAAM+b,GAStB,OAJA,GAAI33B,KAAM4b,GAAOiD,gBAAiB7pB,KAAK8lB,YAEvC9lB,KAAKo5B,SAASt5B,IAAK,GAAIiM,eAAgB42B,IAEhC3iC,KAIR4iC,WAAYD,GAEX,OAAO3iC,KAAK0iC,gBAAiB5B,GAAQ6B,GAItCE,WAAYF,GAEX,OAAO3iC,KAAK0iC,gBAAiB3B,GAAQ4B,GAItCG,WAAYH,GAEX,OAAO3iC,KAAK0iC,gBAAiB1B,GAAQ2B,GAItCI,aAAcvU,GAEb,OAAOA,EAAOvE,aAAcjqB,KAAKgrB,aAIlCgY,aAAcxU,GAEb,OAAOA,EAAOvE,aAAc,GAAIjf,KAAMhL,KAAKgrB,aAAchZ,UAI1DilB,OAAQvtB,EAAGC,EAAGqa,GAIRta,EAAEkR,UAEN+lB,GAAQ31B,KAAMtB,GAIdi3B,GAAQp2B,IAAKb,EAAGC,EAAGqa,GAIpB,MAAMod,EAASphC,KAAKohC,OAEpBphC,KAAK0uB,mBAAmB,GAAM,GAE9BkS,GAAUpU,sBAAuBxsB,KAAKgrB,aAEjChrB,KAAKijC,UAAYjjC,KAAKkjC,QAE1B,GAAIjM,OAAQ2J,GAAWD,GAAS3gC,KAAKm3B,IAIrC,GAAIF,OAAQ0J,GAASC,GAAW5gC,KAAKm3B,IAItCn3B,KAAK8lB,WAAWgB,sBAAuB,IAElCsa,IAEJ,GAAItL,gBAAiBsL,EAAOpW,aAC5B0V,GAAI5Z,sBAAuB,IAC3B9mB,KAAK8lB,WAAWxV,YAAaowB,GAAI1uB,WAMnClS,IAAKkuB,GAEJ,GAAK/e,UAAU/M,OAAS,EAAI,CAE3B,IAAM,IAAIF,EAAI,EAAGA,EAAIiN,UAAU/M,OAAQF,IAEtChC,KAAKF,IAAKmP,UAAWjN,IAItB,OAAOhC,KAIR,OAAKguB,IAAWhuB,MAEfmL,QAAQ+D,MAAO,kEAAoE8e,GAC5EhuB,OAIHguB,GAAUA,EAAOmV,YAEE,OAAlBnV,EAAOoT,QAEXpT,EAAOoT,OAAOnhC,OAAQ+tB,GAIvBA,EAAOoT,OAASphC,KAChBA,KAAKgvB,SAASttB,KAAMssB,GAEpBA,EAAO5nB,cAAe66B,KAItB91B,QAAQ+D,MAAO,gEAAiE8e,GAI1EhuB,MAIRC,OAAQ+tB,GAEP,GAAK/e,UAAU/M,OAAS,EAAI,CAE3B,IAAM,IAAIF,EAAI,EAAGA,EAAIiN,UAAU/M,OAAQF,IAEtChC,KAAKC,OAAQgP,UAAWjN,IAIzB,OAAOhC,KAIR,MAAM4B,EAAQ5B,KAAKgvB,SAASntB,QAASmsB,GAWrC,OATiB,IAAZpsB,IAEJosB,EAAOoT,OAAS,KAChBphC,KAAKgvB,SAASltB,OAAQF,EAAO,GAE7BosB,EAAO5nB,cAAe86B,KAIhBlhC,KAIRojC,mBAEC,MAAMhC,EAASphC,KAAKohC,OAQpB,OANgB,OAAXA,GAEJA,EAAOnhC,OAAQD,MAITA,KAIRE,QAEC,IAAM,IAAI8B,EAAI,EAAGA,EAAIhC,KAAKgvB,SAAS9sB,OAAQF,IAAO,CAEjD,MAAMgsB,EAAShuB,KAAKgvB,SAAUhtB,GAE9BgsB,EAAOoT,OAAS,KAEhBpT,EAAO5nB,cAAe86B,IAMvB,OAFAlhC,KAAKgvB,SAAS9sB,OAAS,EAEhBlC,KAKRqjC,OAAQrV,GAsBP,OAlBAhuB,KAAK0uB,mBAAmB,GAAM,GAE9B,GAAI1jB,KAAMhL,KAAKgrB,aAAchZ,SAEN,OAAlBgc,EAAOoT,SAEXpT,EAAOoT,OAAO1S,mBAAmB,GAAM,GAEvC,GAAI5iB,SAAUkiB,EAAOoT,OAAOpW,cAI7BgD,EAAO/D,aAAc,IAErBjqB,KAAKF,IAAKkuB,GAEVA,EAAOU,mBAAmB,GAAO,GAE1B1uB,KAIRsjC,cAAeC,GAEd,OAAOvjC,KAAKwjC,oBAAqB,KAAMD,GAIxCE,gBAAiB7/B,GAEhB,OAAO5D,KAAKwjC,oBAAqB,OAAQ5/B,GAI1C4/B,oBAAqB5/B,EAAMlE,GAE1B,GAAKM,KAAM4D,KAAWlE,EAAQ,OAAOM,KAErC,IAAM,IAAIgC,EAAI,EAAGC,EAAIjC,KAAKgvB,SAAS9sB,OAAQF,EAAIC,EAAGD,IAAO,CAExD,MACMgsB,EADQhuB,KAAKgvB,SAAUhtB,GACRwhC,oBAAqB5/B,EAAMlE,GAEhD,QAAgBqB,IAAXitB,EAEJ,OAAOA,GAUV0V,iBAAkBr9B,GAIjB,OAFArG,KAAK0uB,mBAAmB,GAAM,GAEvBroB,EAAOmmB,sBAAuBxsB,KAAKgrB,aAI3C2Y,mBAAoBt9B,GAMnB,OAJArG,KAAK0uB,mBAAmB,GAAM,GAE9B1uB,KAAKgrB,YAAY8O,UAAW8G,GAAWv6B,EAAQw6B,IAExCx6B,EAIRu9B,cAAev9B,GAMd,OAJArG,KAAK0uB,mBAAmB,GAAM,GAE9B1uB,KAAKgrB,YAAY8O,UAAW8G,GAAW,GAAav6B,GAE7CA,EAIRw9B,kBAAmBx9B,GAElBrG,KAAK0uB,mBAAmB,GAAM,GAE9B,MAAMtiB,EAAIpM,KAAKgrB,YAAY3e,SAE3B,OAAOhG,EAAOkE,IAAK6B,EAAG,GAAKA,EAAG,GAAKA,EAAG,KAAOgB,YAI9C02B,WAEAC,SAAU3gB,GAETA,EAAUpjB,MAEV,MAAMgvB,EAAWhvB,KAAKgvB,SAEtB,IAAM,IAAIhtB,EAAI,EAAGC,EAAI+sB,EAAS9sB,OAAQF,EAAIC,EAAGD,IAE5CgtB,EAAUhtB,GAAI+hC,SAAU3gB,GAM1B4gB,gBAAiB5gB,GAEhB,IAAsB,IAAjBpjB,KAAK8Z,QAAoB,OAE9BsJ,EAAUpjB,MAEV,MAAMgvB,EAAWhvB,KAAKgvB,SAEtB,IAAM,IAAIhtB,EAAI,EAAGC,EAAI+sB,EAAS9sB,OAAQF,EAAIC,EAAGD,IAE5CgtB,EAAUhtB,GAAIgiC,gBAAiB5gB,GAMjC6gB,kBAAmB7gB,GAElB,MAAMge,EAASphC,KAAKohC,OAEJ,OAAXA,IAEJhe,EAAUge,GAEVA,EAAO6C,kBAAmB7gB,IAM5BhO,eAECpV,KAAKwT,OAAOsjB,QAAS92B,KAAKo5B,SAAUp5B,KAAK8lB,WAAY9lB,KAAKoT,OAE1DpT,KAAK0hC,wBAAyB,EAI/BwC,kBAAmBC,GAEbnkC,KAAK2U,kBAAmB3U,KAAKoV,gBAE7BpV,KAAK0hC,wBAA0ByC,KAEd,OAAhBnkC,KAAKohC,OAETphC,KAAKgrB,YAAYhgB,KAAMhL,KAAKwT,QAI5BxT,KAAKgrB,YAAY3a,iBAAkBrQ,KAAKohC,OAAOpW,YAAahrB,KAAKwT,QAIlExT,KAAK0hC,wBAAyB,EAE9ByC,GAAQ,GAMT,MAAMnV,EAAWhvB,KAAKgvB,SAEtB,IAAM,IAAIhtB,EAAI,EAAGC,EAAI+sB,EAAS9sB,OAAQF,EAAIC,EAAGD,IAE5CgtB,EAAUhtB,GAAIkiC,kBAAmBC,GAMnCzV,kBAAmB0V,EAAeC,GAEjC,MAAMjD,EAASphC,KAAKohC,OAsBpB,IApBuB,IAAlBgD,GAAqC,OAAXhD,GAE9BA,EAAO1S,mBAAmB,GAAM,GAI5B1uB,KAAK2U,kBAAmB3U,KAAKoV,eAEb,OAAhBpV,KAAKohC,OAETphC,KAAKgrB,YAAYhgB,KAAMhL,KAAKwT,QAI5BxT,KAAKgrB,YAAY3a,iBAAkBrQ,KAAKohC,OAAOpW,YAAahrB,KAAKwT,SAM1C,IAAnB6wB,EAA0B,CAE9B,MAAMrV,EAAWhvB,KAAKgvB,SAEtB,IAAM,IAAIhtB,EAAI,EAAGC,EAAI+sB,EAAS9sB,OAAQF,EAAIC,EAAGD,IAE5CgtB,EAAUhtB,GAAI0sB,mBAAmB,GAAO,IAQ3ClZ,OAAQC,GAGP,MAAMC,OAA0B3U,IAAT0U,GAAsC,iBAATA,EAE9CG,EAAS,GAKVF,IAGJD,EAAO,CACN6uB,WAAY,GACZ/hB,UAAW,GACX5M,SAAU,GACVK,OAAQ,GACRuuB,OAAQ,GACRC,UAAW,GACXzC,WAAY,IAGbnsB,EAAOC,SAAW,CACjBZ,QAAS,IACTnP,KAAM,SACNgQ,UAAW,oBAOb,MAAMkY,EAAS,GA+Bf,SAASyW,EAAWC,EAASC,GAQ5B,YANiC5jC,IAA5B2jC,EAASC,EAAQpwB,QAErBmwB,EAASC,EAAQpwB,MAASowB,EAAQnvB,OAAQC,IAIpCkvB,EAAQpwB,KAIhB,GAzCAyZ,EAAOzZ,KAAOvU,KAAKuU,KACnByZ,EAAOloB,KAAO9F,KAAK8F,KAEA,KAAd9F,KAAK4D,OAAcoqB,EAAOpqB,KAAO5D,KAAK4D,OAClB,IAApB5D,KAAK2hC,aAAsB3T,EAAO2T,YAAa,IACxB,IAAvB3hC,KAAK4hC,gBAAyB5T,EAAO4T,eAAgB,IACpC,IAAjB5hC,KAAK8Z,UAAoBkU,EAAOlU,SAAU,IACnB,IAAvB9Z,KAAK6hC,gBAA0B7T,EAAO6T,eAAgB,GACjC,IAArB7hC,KAAK8hC,cAAoB9T,EAAO8T,YAAc9hC,KAAK8hC,aACf,OAApCxsB,KAAKC,UAAWvV,KAAKgV,YAAsBgZ,EAAOhZ,SAAWhV,KAAKgV,UAEvEgZ,EAAOwS,OAASxgC,KAAKwgC,OAAOP,KAC5BjS,EAAOxa,OAASxT,KAAKwT,OAAOpF,WAEG,IAA1BpO,KAAK2U,mBAA6BqZ,EAAOrZ,kBAAmB,GAI5D3U,KAAK4kC,kBAET5W,EAAOloB,KAAO,gBACdkoB,EAAOT,MAAQvtB,KAAKutB,MACpBS,EAAO6W,eAAiB7kC,KAAK6kC,eAAervB,SAChB,OAAvBxV,KAAK8kC,gBAAyB9W,EAAO8W,cAAgB9kC,KAAK8kC,cAActvB,WAkBzExV,KAAK+kC,QAEJ/kC,KAAKglC,aAEJhlC,KAAKglC,WAAWrqB,QAEpBqT,EAAOgX,WAAahlC,KAAKglC,WAAWxvB,SAEzBxV,KAAKglC,WAAW1tB,YAE3B0W,EAAOgX,WAAahlC,KAAKglC,WAAWxvB,OAAQC,GAAOlB,OAMhDvU,KAAKilC,aAAejlC,KAAKilC,YAAY3tB,YAEzC0W,EAAOiX,YAAcjlC,KAAKilC,YAAYzvB,OAAQC,GAAOlB,WAIhD,GAAKvU,KAAKklC,QAAUllC,KAAKmlC,QAAUnlC,KAAKolC,SAAW,CAEzDpX,EAAOW,SAAW8V,EAAWhvB,EAAK6uB,WAAYtkC,KAAK2uB,UAEnD,MAAMvM,EAAapiB,KAAK2uB,SAASvM,WAEjC,QAAoBrhB,IAAfqhB,QAAkDrhB,IAAtBqhB,EAAWmiB,OAAuB,CAElE,MAAMA,EAASniB,EAAWmiB,OAE1B,GAAKtuB,MAAMC,QAASquB,GAEnB,IAAM,IAAIviC,EAAI,EAAGC,EAAIsiC,EAAOriC,OAAQF,EAAIC,EAAGD,IAAO,CAEjD,MAAMqjC,EAAQd,EAAQviC,GAEtByiC,EAAWhvB,EAAK8uB,OAAQc,QAMzBZ,EAAWhvB,EAAK8uB,OAAQA,IAuB3B,GAfKvkC,KAAKslC,gBAETtX,EAAOuX,SAAWvlC,KAAKulC,SACvBvX,EAAOwX,WAAaxlC,KAAKwlC,WAAWp3B,eAEbrN,IAAlBf,KAAKylC,WAEThB,EAAWhvB,EAAK+uB,UAAWxkC,KAAKylC,UAEhCzX,EAAOyX,SAAWzlC,KAAKylC,SAASlxB,YAMXxT,IAAlBf,KAAK0lC,SAET,GAAKzvB,MAAMC,QAASlW,KAAK0lC,UAAa,CAErC,MAAMC,EAAQ,GAEd,IAAM,IAAI3jC,EAAI,EAAGC,EAAIjC,KAAK0lC,SAASxjC,OAAQF,EAAIC,EAAGD,IAEjD2jC,EAAMjkC,KAAM+iC,EAAWhvB,EAAK8M,UAAWviB,KAAK0lC,SAAU1jC,KAIvDgsB,EAAO0X,SAAWC,OAIlB3X,EAAO0X,SAAWjB,EAAWhvB,EAAK8M,UAAWviB,KAAK0lC,UAQpD,GAAK1lC,KAAKgvB,SAAS9sB,OAAS,EAAI,CAE/B8rB,EAAOgB,SAAW,GAElB,IAAM,IAAIhtB,EAAI,EAAGA,EAAIhC,KAAKgvB,SAAS9sB,OAAQF,IAE1CgsB,EAAOgB,SAASttB,KAAM1B,KAAKgvB,SAAUhtB,GAAIwT,OAAQC,GAAOuY,QAQ1D,GAAKhuB,KAAK+hC,WAAW7/B,OAAS,EAAI,CAEjC8rB,EAAO+T,WAAa,GAEpB,IAAM,IAAI//B,EAAI,EAAGA,EAAIhC,KAAK+hC,WAAW7/B,OAAQF,IAAO,CAEnD,MAAM4jC,EAAY5lC,KAAK+hC,WAAY//B,GAEnCgsB,EAAO+T,WAAWrgC,KAAM+iC,EAAWhvB,EAAKssB,WAAY6D,KAMtD,GAAKlwB,EAAe,CAEnB,MAAM4uB,EAAaxpB,EAAkBrF,EAAK6uB,YACpC/hB,EAAYzH,EAAkBrF,EAAK8M,WACnC5M,EAAWmF,EAAkBrF,EAAKE,UAClCK,EAAS8E,EAAkBrF,EAAKO,QAChCuuB,EAASzpB,EAAkBrF,EAAK8uB,QAChCC,EAAY1pB,EAAkBrF,EAAK+uB,WACnCzC,EAAajnB,EAAkBrF,EAAKssB,YAErCuC,EAAWpiC,OAAS,IAAI0T,EAAO0uB,WAAaA,GAC5C/hB,EAAUrgB,OAAS,IAAI0T,EAAO2M,UAAYA,GAC1C5M,EAASzT,OAAS,IAAI0T,EAAOD,SAAWA,GACxCK,EAAO9T,OAAS,IAAI0T,EAAOI,OAASA,GACpCuuB,EAAOriC,OAAS,IAAI0T,EAAO2uB,OAASA,GACpCC,EAAUtiC,OAAS,IAAI0T,EAAO4uB,UAAYA,GAC1CzC,EAAW7/B,OAAS,IAAI0T,EAAOmsB,WAAaA,GAMlD,OAFAnsB,EAAOoY,OAASA,EAETpY,EAKP,SAASkF,EAAkBC,GAE1B,MAAMR,EAAS,GACf,IAAM,MAAM1b,KAAOkc,EAAQ,CAE1B,MAAM1D,EAAO0D,EAAOlc,UACbwY,EAAKxB,SACZ0E,EAAO7Y,KAAM2V,GAId,OAAOkD,GAMTxP,MAAO86B,GAEN,OAAO,IAAI7lC,KAAKI,aAAc4K,KAAMhL,KAAM6lC,GAI3C76B,KAAMqK,EAAQwwB,GAAY,GA4BzB,GA1BA7lC,KAAK4D,KAAOyR,EAAOzR,KAEnB5D,KAAKm3B,GAAGnsB,KAAMqK,EAAO8hB,IAErBn3B,KAAKo5B,SAASpuB,KAAMqK,EAAO+jB,UAC3Bp5B,KAAKiT,SAASkT,MAAQ9Q,EAAOpC,SAASkT,MACtCnmB,KAAK8lB,WAAW9a,KAAMqK,EAAOyQ,YAC7B9lB,KAAKoT,MAAMpI,KAAMqK,EAAOjC,OAExBpT,KAAKwT,OAAOxI,KAAMqK,EAAO7B,QACzBxT,KAAKgrB,YAAYhgB,KAAMqK,EAAO2V,aAE9BhrB,KAAK2U,iBAAmBU,EAAOV,iBAC/B3U,KAAK0hC,uBAAyBrsB,EAAOqsB,uBAErC1hC,KAAKwgC,OAAOP,KAAO5qB,EAAOmrB,OAAOP,KACjCjgC,KAAK8Z,QAAUzE,EAAOyE,QAEtB9Z,KAAK2hC,WAAatsB,EAAOssB,WACzB3hC,KAAK4hC,cAAgBvsB,EAAOusB,cAE5B5hC,KAAK6hC,cAAgBxsB,EAAOwsB,cAC5B7hC,KAAK8hC,YAAczsB,EAAOysB,YAE1B9hC,KAAKgV,SAAWM,KAAKpS,MAAOoS,KAAKC,UAAWF,EAAOL,YAEhC,IAAd6wB,EAEJ,IAAM,IAAI7jC,EAAI,EAAGA,EAAIqT,EAAO2Z,SAAS9sB,OAAQF,IAAO,CAEnD,MAAM8jC,EAAQzwB,EAAO2Z,SAAUhtB,GAC/BhC,KAAKF,IAAKgmC,EAAM/6B,SAMlB,OAAO/K,MAMTmhC,GAASE,UAAY,IAAI5X,GAAS,EAAG,EAAG,GACxC0X,GAASM,yBAA0B,EAEnCN,GAAS9hC,UAAU8jC,YAAa,EC34BhC,IAAI4C,GAAM,EAEV,MAAM,GAAoB,IAAI5Q,GACxB6Q,GAAqB,IAAI7E,GACzB8E,GAAwB,IAAIxc,GAC5B,GAAqB,IAAIqD,GACzBoZ,GAAiC,IAAIpZ,GACrC,GAAwB,IAAIrD,GAElC,MAAM0c,WAAuBtgC,EAE5BzF,cAEC6E,QAEAlG,OAAOC,eAAgBgB,KAAM,KAAM,CAAEN,MAAOqmC,OAE5C/lC,KAAKuU,KAAO,IAEZvU,KAAK4D,KAAO,GACZ5D,KAAK8F,KAAO,iBAEZ9F,KAAK4B,MAAQ,KACb5B,KAAKomC,WAAa,GAElBpmC,KAAKqmC,gBAAkB,GACvBrmC,KAAKsmC,sBAAuB,EAE5BtmC,KAAKumC,OAAS,GAEdvmC,KAAK4uB,YAAc,KACnB5uB,KAAK80B,eAAiB,KAEtB90B,KAAKwmC,UAAY,CAAE7T,MAAO,EAAGpF,MAAOkZ,EAAAA,GAEpCzmC,KAAKgV,SAAW,GAIjB0xB,WAEC,OAAO1mC,KAAK4B,MAIb+kC,SAAU/kC,GAYT,OAVKqU,MAAMC,QAAStU,GAEnB5B,KAAK4B,MAAQ,IAAM4B,EAAU5B,GAAU,MAAQu9B,GAAwBD,IAAyBt9B,EAAO,GAIvG5B,KAAK4B,MAAQA,EAIP5B,KAIR4mC,aAAchjC,GAEb,OAAO5D,KAAKomC,WAAYxiC,GAIzBijC,aAAcjjC,EAAM0K,GAInB,OAFAtO,KAAKomC,WAAYxiC,GAAS0K,EAEnBtO,KAIR8mC,gBAAiBljC,GAIhB,cAFO5D,KAAKomC,WAAYxiC,GAEjB5D,KAIR+mC,aAAcnjC,GAEb,YAAmC7C,IAA5Bf,KAAKomC,WAAYxiC,GAIzBojC,SAAUrU,EAAOpF,EAAO0Z,EAAgB,GAEvCjnC,KAAKumC,OAAO7kC,KAAM,CAEjBixB,MAAOA,EACPpF,MAAOA,EACP0Z,cAAeA,IAMjBC,cAEClnC,KAAKumC,OAAS,GAIfY,aAAcxU,EAAOpF,GAEpBvtB,KAAKwmC,UAAU7T,MAAQA,EACvB3yB,KAAKwmC,UAAUjZ,MAAQA,EAIxBtD,aAAczW,GAEb,MAAM4lB,EAAWp5B,KAAKomC,WAAWhN,cAEfr4B,IAAbq4B,IAEJA,EAASnP,aAAczW,GAEvB4lB,EAAS5iB,aAAc,GAIxB,MAAMuV,EAAS/rB,KAAKomC,WAAWra,OAE/B,QAAgBhrB,IAAXgrB,EAAuB,CAE3B,MAAMmH,GAAe,IAAIlkB,IAAUwD,gBAAiBgB,GAEpDuY,EAAO/B,kBAAmBkJ,GAE1BnH,EAAOvV,aAAc,EAItB,MAAM4wB,EAAUpnC,KAAKomC,WAAWgB,QAsBhC,YApBiBrmC,IAAZqmC,IAEJA,EAAQnc,mBAAoBzX,GAE5B4zB,EAAQ5wB,aAAc,GAIG,OAArBxW,KAAK4uB,aAET5uB,KAAK6uB,qBAIuB,OAAxB7uB,KAAK80B,gBAET90B,KAAK+0B,wBAIC/0B,KAIR6pB,gBAAiBvK,GAMhB,OAJA,GAAIuX,2BAA4BvX,GAEhCtf,KAAKiqB,aAAc,IAEZjqB,KAIRuiC,QAASl1B,GAQR,OAJA,GAAImrB,cAAenrB,GAEnBrN,KAAKiqB,aAAc,IAEZjqB,KAIRwiC,QAASn1B,GAQR,OAJA,GAAIorB,cAAeprB,GAEnBrN,KAAKiqB,aAAc,IAEZjqB,KAIRyiC,QAASp1B,GAQR,OAJA,GAAIqrB,cAAerrB,GAEnBrN,KAAKiqB,aAAc,IAEZjqB,KAIRuT,UAAW7J,EAAGC,EAAGqa,GAQhB,OAJA,GAAIuU,gBAAiB7uB,EAAGC,EAAGqa,GAE3BhkB,KAAKiqB,aAAc,IAEZjqB,KAIRoT,MAAO1J,EAAGC,EAAGqa,GAQZ,OAJA,GAAI4U,UAAWlvB,EAAGC,EAAGqa,GAErBhkB,KAAKiqB,aAAc,IAEZjqB,KAIRi3B,OAAQzI,GAQP,OANAwX,GAAK/O,OAAQzI,GAEbwX,GAAK5wB,eAELpV,KAAKiqB,aAAc+b,GAAKxyB,QAEjBxT,KAIR0O,SAQC,OANA1O,KAAK6uB,qBAEL7uB,KAAK4uB,YAAYR,UAAW6X,IAAUp5B,SAEtC7M,KAAKuT,UAAW0yB,GAAQv8B,EAAGu8B,GAAQt8B,EAAGs8B,GAAQjiB,GAEvChkB,KAIRwtB,cAAeC,GAEd,MAAM2L,EAAW,GAEjB,IAAM,IAAIp3B,EAAI,EAAGC,EAAIwrB,EAAOvrB,OAAQF,EAAIC,EAAGD,IAAO,CAEjD,MAAMssB,EAAQb,EAAQzrB,GACtBo3B,EAAS13B,KAAM4sB,EAAM5kB,EAAG4kB,EAAM3kB,EAAG2kB,EAAMtK,GAAK,GAM7C,OAFAhkB,KAAK6mC,aAAc,WAAY,IAAIzH,GAAwBhG,EAAU,IAE9Dp5B,KAIR6uB,qBAE2B,OAArB7uB,KAAK4uB,cAET5uB,KAAK4uB,YAAc,IAAI9B,IAIxB,MAAMsM,EAAWp5B,KAAKomC,WAAWhN,SAC3BiO,EAA0BrnC,KAAKqmC,gBAAgBjN,SAErD,GAAKA,GAAYA,EAASoD,oBASzB,OAPArxB,QAAQ+D,MAAO,kJAAmJlP,WAElKA,KAAK4uB,YAAYrkB,IAChB,IAAIkf,IAAS,KAAY,KAAY,KACrC,IAAIA,GAAS,IAAY,IAAY,MAOvC,QAAkB1oB,IAAbq4B,GAMJ,GAJAp5B,KAAK4uB,YAAYtB,uBAAwB8L,GAIpCiO,EAEJ,IAAM,IAAIrlC,EAAI,EAAG2rB,EAAK0Z,EAAwBnlC,OAAQF,EAAI2rB,EAAI3rB,IAAO,CAEpE,MAAMslC,EAAiBD,EAAyBrlC,GAChD,GAAKsrB,uBAAwBga,GAExBtnC,KAAKsmC,sBAET,GAAQj7B,WAAYrL,KAAK4uB,YAAYplB,IAAK,GAAKA,KAC/CxJ,KAAK4uB,YAAYhB,cAAe,IAEhC,GAAQviB,WAAYrL,KAAK4uB,YAAYlrB,IAAK,GAAKA,KAC/C1D,KAAK4uB,YAAYhB,cAAe,MAIhC5tB,KAAK4uB,YAAYhB,cAAe,GAAKpkB,KACrCxJ,KAAK4uB,YAAYhB,cAAe,GAAKlqB,YAUxC1D,KAAK4uB,YAAYlB,aAIb6Z,MAAOvnC,KAAK4uB,YAAYplB,IAAIE,IAAO69B,MAAOvnC,KAAK4uB,YAAYplB,IAAIG,IAAO49B,MAAOvnC,KAAK4uB,YAAYplB,IAAIwa,KAEtG7Y,QAAQ+D,MAAO,sIAAuIlP,MAMxJ+0B,wBAE8B,OAAxB/0B,KAAK80B,iBAET90B,KAAK80B,eAAiB,IAAIxD,IAI3B,MAAM8H,EAAWp5B,KAAKomC,WAAWhN,SAC3BiO,EAA0BrnC,KAAKqmC,gBAAgBjN,SAErD,GAAKA,GAAYA,EAASoD,oBAMzB,OAJArxB,QAAQ+D,MAAO,wJAAyJlP,WAExKA,KAAK80B,eAAevqB,IAAK,IAAIkf,GAAWgd,EAAAA,GAMzC,GAAKrN,EAAW,CAIf,MAAM1qB,EAAS1O,KAAK80B,eAAepmB,OAMnC,GAJA,GAAK4e,uBAAwB8L,GAIxBiO,EAEJ,IAAM,IAAIrlC,EAAI,EAAG2rB,EAAK0Z,EAAwBnlC,OAAQF,EAAI2rB,EAAI3rB,IAAO,CAEpE,MAAMslC,EAAiBD,EAAyBrlC,GAChDkkC,GAAiB5Y,uBAAwBga,GAEpCtnC,KAAKsmC,sBAET,GAAQj7B,WAAY,GAAK7B,IAAK08B,GAAiB18B,KAC/C,GAAKokB,cAAe,IAEpB,GAAQviB,WAAY,GAAK3H,IAAKwiC,GAAiBxiC,KAC/C,GAAKkqB,cAAe,MAIpB,GAAKA,cAAesY,GAAiB18B,KACrC,GAAKokB,cAAesY,GAAiBxiC,MAQxC,GAAK0qB,UAAW1f,GAKhB,IAAI8iB,EAAc,EAElB,IAAM,IAAIxvB,EAAI,EAAG2rB,EAAKyL,EAAS7L,MAAOvrB,EAAI2rB,EAAI3rB,IAE7C,GAAQqM,oBAAqB+qB,EAAUp3B,GAEvCwvB,EAAcntB,KAAKX,IAAK8tB,EAAa9iB,EAAOlB,kBAAmB,KAMhE,GAAK65B,EAEJ,IAAM,IAAIrlC,EAAI,EAAG2rB,EAAK0Z,EAAwBnlC,OAAQF,EAAI2rB,EAAI3rB,IAAO,CAEpE,MAAMslC,EAAiBD,EAAyBrlC,GAC1CskC,EAAuBtmC,KAAKsmC,qBAElC,IAAM,IAAItV,EAAI,EAAGwW,EAAKF,EAAe/Z,MAAOyD,EAAIwW,EAAIxW,IAEnD,GAAQ3iB,oBAAqBi5B,EAAgBtW,GAExCsV,IAEJL,GAAQ53B,oBAAqB+qB,EAAUpI,GACvC,GAAQlxB,IAAKmmC,KAIdzU,EAAcntB,KAAKX,IAAK8tB,EAAa9iB,EAAOlB,kBAAmB,KAQlExN,KAAK80B,eAAe3I,OAAS9nB,KAAK4I,KAAMukB,GAEnC+V,MAAOvnC,KAAK80B,eAAe3I,SAE/BhhB,QAAQ+D,MAAO,+HAAgIlP,OAQlJynC,kBAEC,MAAM7lC,EAAQ5B,KAAK4B,MACbwkC,EAAapmC,KAAKomC,WAKxB,GAAe,OAAVxkC,QACqBb,IAAxBqlC,EAAWhN,eACWr4B,IAAtBqlC,EAAWra,aACOhrB,IAAlBqlC,EAAW7vB,GAGZ,YADApL,QAAQ+D,MAAO,gHAKhB,MAAMw4B,EAAU9lC,EAAM6B,MAChBkkC,EAAYvB,EAAWhN,SAAS31B,MAChCmkC,EAAUxB,EAAWra,OAAOtoB,MAC5BokC,EAAMzB,EAAW7vB,GAAG9S,MAEpBqkC,EAAYH,EAAUzlC,OAAS,OAETnB,IAAvBqlC,EAAWgB,SAEfpnC,KAAK6mC,aAAc,UAAW,IAAI9I,GAAiB,IAAIj5B,aAAc,EAAIgjC,GAAa,IAIvF,MAAMC,EAAW3B,EAAWgB,QAAQ3jC,MAE9BukC,EAAO,GAAIC,EAAO,GAExB,IAAM,IAAIjmC,EAAI,EAAGA,EAAI8lC,EAAW9lC,IAE/BgmC,EAAMhmC,GAAM,IAAIynB,GAChBwe,EAAMjmC,GAAM,IAAIynB,GAIjB,MAAMye,EAAK,IAAIze,GACd0e,EAAK,IAAI1e,GACT2e,EAAK,IAAI3e,GAET4e,EAAM,IAAIj+B,GACVk+B,EAAM,IAAIl+B,GACVm+B,EAAM,IAAIn+B,GAEVo+B,EAAO,IAAI/e,GACXgf,EAAO,IAAIhf,GAEZ,SAASif,EAAgBl9B,EAAGC,EAAGkD,GAE9Bu5B,EAAGh6B,UAAWy5B,EAAe,EAAJn8B,GACzB28B,EAAGj6B,UAAWy5B,EAAe,EAAJl8B,GACzB28B,EAAGl6B,UAAWy5B,EAAe,EAAJh5B,GAEzB05B,EAAIn6B,UAAW25B,EAAS,EAAJr8B,GACpB88B,EAAIp6B,UAAW25B,EAAS,EAAJp8B,GACpB88B,EAAIr6B,UAAW25B,EAAS,EAAJl5B,GAEpBw5B,EAAGx8B,IAAKu8B,GACRE,EAAGz8B,IAAKu8B,GAERI,EAAI38B,IAAK08B,GACTE,EAAI58B,IAAK08B,GAET,MAAM11B,EAAI,GAAQ21B,EAAI5+B,EAAI6+B,EAAI5+B,EAAI4+B,EAAI7+B,EAAI4+B,EAAI3+B,GAIvCg/B,SAAUh2B,KAEjB61B,EAAKx9B,KAAMm9B,GAAKp8B,eAAgBw8B,EAAI5+B,GAAI+B,gBAAiB08B,GAAME,EAAI3+B,GAAIoC,eAAgB4G,GACvF81B,EAAKz9B,KAAMo9B,GAAKr8B,eAAgBu8B,EAAI5+B,GAAIgC,gBAAiBy8B,GAAMI,EAAI7+B,GAAIqC,eAAgB4G,GAEvFq1B,EAAMx8B,GAAI1L,IAAK0oC,GACfR,EAAMv8B,GAAI3L,IAAK0oC,GACfR,EAAMr5B,GAAI7O,IAAK0oC,GAEfP,EAAMz8B,GAAI1L,IAAK2oC,GACfR,EAAMx8B,GAAI3L,IAAK2oC,GACfR,EAAMt5B,GAAI7O,IAAK2oC,IAIhB,IAAIlC,EAASvmC,KAAKumC,OAEK,IAAlBA,EAAOrkC,SAEXqkC,EAAS,CAAE,CACV5T,MAAO,EACPpF,MAAOma,EAAQxlC,UAKjB,IAAM,IAAIF,EAAI,EAAG2rB,EAAK4Y,EAAOrkC,OAAQF,EAAI2rB,IAAO3rB,EAAI,CAEnD,MAAM4mC,EAAQrC,EAAQvkC,GAEhB2wB,EAAQiW,EAAMjW,MAGpB,IAAM,IAAI3B,EAAI2B,EAAO6U,EAAK7U,EAFZiW,EAAMrb,MAEqByD,EAAIwW,EAAIxW,GAAK,EAErD0X,EACChB,EAAS1W,EAAI,GACb0W,EAAS1W,EAAI,GACb0W,EAAS1W,EAAI,IAOhB,MAAMze,EAAM,IAAIkX,GAAWof,EAAO,IAAIpf,GAChC1K,EAAI,IAAI0K,GAAWqf,EAAK,IAAIrf,GAElC,SAASsf,EAAc99B,GAEtB8T,EAAE7Q,UAAW05B,EAAa,EAAJ38B,GACtB69B,EAAG99B,KAAM+T,GAET,MAAMnV,EAAIo+B,EAAM/8B,GAIhBsH,EAAIvH,KAAMpB,GACV2I,EAAI5G,IAAKoT,EAAEhT,eAAgBgT,EAAEjS,IAAKlD,KAAQwD,YAI1Cy7B,EAAK3d,aAAc4d,EAAIl/B,GACvB,MACMsB,EADO29B,EAAK/7B,IAAKm7B,EAAMh9B,IACV,GAAU,EAAM,EAEnC88B,EAAc,EAAJ98B,GAAUsH,EAAI7I,EACxBq+B,EAAc,EAAJ98B,EAAQ,GAAMsH,EAAI5I,EAC5Bo+B,EAAc,EAAJ98B,EAAQ,GAAMsH,EAAIyR,EAC5B+jB,EAAc,EAAJ98B,EAAQ,GAAMC,EAIzB,IAAM,IAAIlJ,EAAI,EAAG2rB,EAAK4Y,EAAOrkC,OAAQF,EAAI2rB,IAAO3rB,EAAI,CAEnD,MAAM4mC,EAAQrC,EAAQvkC,GAEhB2wB,EAAQiW,EAAMjW,MAGpB,IAAM,IAAI3B,EAAI2B,EAAO6U,EAAK7U,EAFZiW,EAAMrb,MAEqByD,EAAIwW,EAAIxW,GAAK,EAErD+X,EAAcrB,EAAS1W,EAAI,IAC3B+X,EAAcrB,EAAS1W,EAAI,IAC3B+X,EAAcrB,EAAS1W,EAAI,KAQ9BgY,uBAEC,MAAMpnC,EAAQ5B,KAAK4B,MACbqnC,EAAoBjpC,KAAK4mC,aAAc,YAE7C,QAA2B7lC,IAAtBkoC,EAAkC,CAEtC,IAAIC,EAAkBlpC,KAAK4mC,aAAc,UAEzC,QAAyB7lC,IAApBmoC,EAEJA,EAAkB,IAAInL,GAAiB,IAAIj5B,aAAwC,EAA1BmkC,EAAkB1b,OAAa,GACxFvtB,KAAK6mC,aAAc,SAAUqC,QAM7B,IAAM,IAAIlnC,EAAI,EAAG2rB,EAAKub,EAAgB3b,MAAOvrB,EAAI2rB,EAAI3rB,IAEpDknC,EAAgBpK,OAAQ98B,EAAG,EAAG,EAAG,GAMnC,MAAMmnC,EAAK,IAAI1f,GAAW2f,EAAK,IAAI3f,GAAW4f,EAAK,IAAI5f,GACjD6f,EAAK,IAAI7f,GAAW8f,EAAK,IAAI9f,GAAW+f,EAAK,IAAI/f,GACjDggB,EAAK,IAAIhgB,GAAWigB,EAAK,IAAIjgB,GAInC,GAAK7nB,EAEJ,IAAM,IAAII,EAAI,EAAG2rB,EAAK/rB,EAAM2rB,MAAOvrB,EAAI2rB,EAAI3rB,GAAK,EAAI,CAEnD,MAAMkmC,EAAKtmC,EAAM2M,KAAMvM,EAAI,GACrBmmC,EAAKvmC,EAAM2M,KAAMvM,EAAI,GACrBomC,EAAKxmC,EAAM2M,KAAMvM,EAAI,GAE3BmnC,EAAG96B,oBAAqB46B,EAAmBf,GAC3CkB,EAAG/6B,oBAAqB46B,EAAmBd,GAC3CkB,EAAGh7B,oBAAqB46B,EAAmBb,GAE3CqB,EAAG79B,WAAYy9B,EAAID,GACnBM,EAAG99B,WAAYu9B,EAAIC,GACnBK,EAAG18B,MAAO28B,GAEVJ,EAAGj7B,oBAAqB66B,EAAiBhB,GACzCqB,EAAGl7B,oBAAqB66B,EAAiBf,GACzCqB,EAAGn7B,oBAAqB66B,EAAiBd,GAEzCkB,EAAGxpC,IAAK2pC,GACRF,EAAGzpC,IAAK2pC,GACRD,EAAG1pC,IAAK2pC,GAERP,EAAgBpK,OAAQoJ,EAAIoB,EAAG5/B,EAAG4/B,EAAG3/B,EAAG2/B,EAAGtlB,GAC3CklB,EAAgBpK,OAAQqJ,EAAIoB,EAAG7/B,EAAG6/B,EAAG5/B,EAAG4/B,EAAGvlB,GAC3CklB,EAAgBpK,OAAQsJ,EAAIoB,EAAG9/B,EAAG8/B,EAAG7/B,EAAG6/B,EAAGxlB,QAQ5C,IAAM,IAAIhiB,EAAI,EAAG2rB,EAAKsb,EAAkB1b,MAAOvrB,EAAI2rB,EAAI3rB,GAAK,EAE3DmnC,EAAG96B,oBAAqB46B,EAAmBjnC,EAAI,GAC/ConC,EAAG/6B,oBAAqB46B,EAAmBjnC,EAAI,GAC/CqnC,EAAGh7B,oBAAqB46B,EAAmBjnC,EAAI,GAE/CynC,EAAG79B,WAAYy9B,EAAID,GACnBM,EAAG99B,WAAYu9B,EAAIC,GACnBK,EAAG18B,MAAO28B,GAEVR,EAAgBpK,OAAQ98B,EAAI,EAAGynC,EAAG//B,EAAG+/B,EAAG9/B,EAAG8/B,EAAGzlB,GAC9CklB,EAAgBpK,OAAQ98B,EAAI,EAAGynC,EAAG//B,EAAG+/B,EAAG9/B,EAAG8/B,EAAGzlB,GAC9CklB,EAAgBpK,OAAQ98B,EAAI,EAAGynC,EAAG//B,EAAG+/B,EAAG9/B,EAAG8/B,EAAGzlB,GAMhDhkB,KAAK2pC,mBAELT,EAAgB1yB,aAAc,GAMhCozB,MAAOjb,EAAUxgB,GAEhB,IAASwgB,IAAYA,EAASkb,iBAG7B,YADA1+B,QAAQ+D,MAAO,kFAAmFyf,QAKnF5tB,IAAXoN,IAEJA,EAAS,EAEThD,QAAQC,KACP,2JAMF,MAAMg7B,EAAapmC,KAAKomC,WAExB,IAAM,MAAMvnC,KAAOunC,EAAa,CAE/B,QAAoCrlC,IAA/B4tB,EAASyX,WAAYvnC,GAAsB,SAEhD,MACMirC,EADa1D,EAAYvnC,GACI4E,MAE7BsmC,EAAapb,EAASyX,WAAYvnC,GAClCmrC,EAAkBD,EAAWtmC,MAE7BwmC,EAAkBF,EAAW/L,SAAW7vB,EACxCjM,EAASmC,KAAKmF,IAAKwgC,EAAgB9nC,OAAQ4nC,EAAgB5nC,OAAS+nC,GAE1E,IAAM,IAAIjoC,EAAI,EAAGgvB,EAAIiZ,EAAiBjoC,EAAIE,EAAQF,IAAMgvB,IAEvD8Y,EAAiB9Y,GAAMgZ,EAAiBhoC,GAM1C,OAAOhC,KAIR2pC,mBAEC,MAAM/B,EAAU5nC,KAAKomC,WAAWra,OAEhC,IAAM,IAAI/pB,EAAI,EAAG2rB,EAAKia,EAAQra,MAAOvrB,EAAI2rB,EAAI3rB,IAE5C,GAAQqM,oBAAqBu5B,EAAS5lC,GAEtC,GAAQoL,YAERw6B,EAAQ9I,OAAQ98B,EAAG,GAAQ0H,EAAG,GAAQC,EAAG,GAAQqa,GAMnDkmB,eAEC,SAASC,EAAwB77B,EAAWo5B,GAE3C,MAAMjkC,EAAQ6K,EAAU7K,MAClBu6B,EAAW1vB,EAAU0vB,SACrB/b,EAAa3T,EAAU2T,WAEvBmoB,EAAS,IAAI3mC,EAAMrD,YAAasnC,EAAQxlC,OAAS87B,GAEvD,IAAIp8B,EAAQ,EAAGy8B,EAAS,EAExB,IAAM,IAAIr8B,EAAI,EAAGC,EAAIylC,EAAQxlC,OAAQF,EAAIC,EAAGD,IAAO,CAIjDJ,EAFI0M,EAAU6tB,6BAENuL,EAAS1lC,GAAMsM,EAAU+I,KAAKgzB,OAAS/7B,EAAUH,OAIjDu5B,EAAS1lC,GAAMg8B,EAIxB,IAAM,IAAIhN,EAAI,EAAGA,EAAIgN,EAAUhN,IAE9BoZ,EAAQ/L,KAAc56B,EAAO7B,KAM/B,OAAO,IAAIm8B,GAAiBqM,EAAQpM,EAAU/b,GAM/C,GAAoB,OAAfjiB,KAAK4B,MAGT,OADAuJ,QAAQC,KAAM,+EACPpL,KAIR,MAAMsqC,EAAY,IAAInE,GAEhBuB,EAAU1nC,KAAK4B,MAAM6B,MACrB2iC,EAAapmC,KAAKomC,WAIxB,IAAM,MAAMxiC,KAAQwiC,EAAa,CAEhC,MAEMmE,EAAeJ,EAFH/D,EAAYxiC,GAE0B8jC,GAExD4C,EAAUzD,aAAcjjC,EAAM2mC,GAM/B,MAAMlE,EAAkBrmC,KAAKqmC,gBAE7B,IAAM,MAAMziC,KAAQyiC,EAAkB,CAErC,MAAMmE,EAAa,GACblD,EAAiBjB,EAAiBziC,GAExC,IAAM,IAAI5B,EAAI,EAAG2rB,EAAK2Z,EAAeplC,OAAQF,EAAI2rB,EAAI3rB,IAAO,CAE3D,MAEMuoC,EAAeJ,EAFH7C,EAAgBtlC,GAEsB0lC,GAExD8C,EAAW9oC,KAAM6oC,GAIlBD,EAAUjE,gBAAiBziC,GAAS4mC,EAIrCF,EAAUhE,qBAAuBtmC,KAAKsmC,qBAItC,MAAMC,EAASvmC,KAAKumC,OAEpB,IAAM,IAAIvkC,EAAI,EAAGC,EAAIskC,EAAOrkC,OAAQF,EAAIC,EAAGD,IAAO,CAEjD,MAAM4mC,EAAQrC,EAAQvkC,GACtBsoC,EAAUtD,SAAU4B,EAAMjW,MAAOiW,EAAMrb,MAAOqb,EAAM3B,eAIrD,OAAOqD,EAIR90B,SAEC,MAAM6B,EAAO,CACZxB,SAAU,CACTZ,QAAS,IACTnP,KAAM,iBACNgQ,UAAW,0BAWb,GALAuB,EAAK9C,KAAOvU,KAAKuU,KACjB8C,EAAKvR,KAAO9F,KAAK8F,KACE,KAAd9F,KAAK4D,OAAcyT,EAAKzT,KAAO5D,KAAK4D,MACpC7E,OAAO0rC,KAAMzqC,KAAKgV,UAAW9S,OAAS,IAAImV,EAAKrC,SAAWhV,KAAKgV,eAE3CjU,IAApBf,KAAKoiB,WAA2B,CAEpC,MAAMA,EAAapiB,KAAKoiB,WAExB,IAAM,MAAMvjB,KAAOujB,OAESrhB,IAAtBqhB,EAAYvjB,KAAsBwY,EAAMxY,GAAQujB,EAAYvjB,IAIlE,OAAOwY,EAMRA,EAAKA,KAAO,CAAE+uB,WAAY,IAE1B,MAAMxkC,EAAQ5B,KAAK4B,MAEJ,OAAVA,IAEJyV,EAAKA,KAAKzV,MAAQ,CACjBkE,KAAMlE,EAAM6B,MAAMrD,YAAYwD,KAC9BH,MAAOwS,MAAM5W,UAAUiH,MAAM/G,KAAMqC,EAAM6B,SAK3C,MAAM2iC,EAAapmC,KAAKomC,WAExB,IAAM,MAAMvnC,KAAOunC,EAAa,CAE/B,MAAM93B,EAAY83B,EAAYvnC,GAE9BwY,EAAKA,KAAK+uB,WAAYvnC,GAAQyP,EAAUkH,OAAQ6B,EAAKA,MAItD,MAAMgvB,EAAkB,GACxB,IAAIqE,GAAqB,EAEzB,IAAM,MAAM7rC,KAAOmB,KAAKqmC,gBAAkB,CAEzC,MAAMsE,EAAiB3qC,KAAKqmC,gBAAiBxnC,GAEvC4E,EAAQ,GAEd,IAAM,IAAIzB,EAAI,EAAG2rB,EAAKgd,EAAezoC,OAAQF,EAAI2rB,EAAI3rB,IAAO,CAE3D,MAAMsM,EAAYq8B,EAAgB3oC,GAElCyB,EAAM/B,KAAM4M,EAAUkH,OAAQ6B,EAAKA,OAI/B5T,EAAMvB,OAAS,IAEnBmkC,EAAiBxnC,GAAQ4E,EAEzBinC,GAAqB,GAMlBA,IAEJrzB,EAAKA,KAAKgvB,gBAAkBA,EAC5BhvB,EAAKA,KAAKivB,qBAAuBtmC,KAAKsmC,sBAIvC,MAAMC,EAASvmC,KAAKumC,OAEfA,EAAOrkC,OAAS,IAEpBmV,EAAKA,KAAKkvB,OAASjxB,KAAKpS,MAAOoS,KAAKC,UAAWgxB,KAIhD,MAAMzR,EAAiB90B,KAAK80B,eAW5B,OATwB,OAAnBA,IAEJzd,EAAKA,KAAKyd,eAAiB,CAC1BpmB,OAAQomB,EAAepmB,OAAON,UAC9B+d,OAAQ2I,EAAe3I,SAKlB9U,EAIRtM,QAEE,OAAO,IAAI/K,KAAKI,aAAc4K,KAAMhL,MAItCgL,KAAMqK,GAILrV,KAAK4B,MAAQ,KACb5B,KAAKomC,WAAa,GAClBpmC,KAAKqmC,gBAAkB,GACvBrmC,KAAKumC,OAAS,GACdvmC,KAAK4uB,YAAc,KACnB5uB,KAAK80B,eAAiB,KAItB,MAAMzd,EAAO,GAIbrX,KAAK4D,KAAOyR,EAAOzR,KAInB,MAAMhC,EAAQyT,EAAOzT,MAEN,OAAVA,GAEJ5B,KAAK2mC,SAAU/kC,EAAMmJ,MAAOsM,IAM7B,MAAM+uB,EAAa/wB,EAAO+wB,WAE1B,IAAM,MAAMxiC,KAAQwiC,EAAa,CAEhC,MAAM93B,EAAY83B,EAAYxiC,GAC9B5D,KAAK6mC,aAAcjjC,EAAM0K,EAAUvD,MAAOsM,IAM3C,MAAMgvB,EAAkBhxB,EAAOgxB,gBAE/B,IAAM,MAAMziC,KAAQyiC,EAAkB,CAErC,MAAM5iC,EAAQ,GACR6jC,EAAiBjB,EAAiBziC,GAExC,IAAM,IAAI5B,EAAI,EAAGC,EAAIqlC,EAAeplC,OAAQF,EAAIC,EAAGD,IAElDyB,EAAM/B,KAAM4lC,EAAgBtlC,GAAI+I,MAAOsM,IAIxCrX,KAAKqmC,gBAAiBziC,GAASH,EAIhCzD,KAAKsmC,qBAAuBjxB,EAAOixB,qBAInC,MAAMC,EAASlxB,EAAOkxB,OAEtB,IAAM,IAAIvkC,EAAI,EAAGC,EAAIskC,EAAOrkC,OAAQF,EAAIC,EAAGD,IAAO,CAEjD,MAAM4mC,EAAQrC,EAAQvkC,GACtBhC,KAAKgnC,SAAU4B,EAAMjW,MAAOiW,EAAMrb,MAAOqb,EAAM3B,eAMhD,MAAMrY,EAAcvZ,EAAOuZ,YAEN,OAAhBA,IAEJ5uB,KAAK4uB,YAAcA,EAAY7jB,SAMhC,MAAM+pB,EAAiBzf,EAAOyf,eAqB9B,OAnBwB,OAAnBA,IAEJ90B,KAAK80B,eAAiBA,EAAe/pB,SAMtC/K,KAAKwmC,UAAU7T,MAAQtd,EAAOmxB,UAAU7T,MACxC3yB,KAAKwmC,UAAUjZ,MAAQlY,EAAOmxB,UAAUjZ,MAIxCvtB,KAAKgV,SAAWK,EAAOL,cAIIjU,IAAtBsU,EAAO+M,aAA2BpiB,KAAKoiB,WAAarjB,OAAO6rC,OAAQ,GAAIv1B,EAAO+M,aAE5EpiB,KAIRqW,UAECrW,KAAKoG,cAAe,CAAEN,KAAM,aAM9BqgC,GAAe9mC,UAAUwqC,kBAAmB,ECnmC5C,MAAMgB,WAAoB1E,GAEzB/lC,YAAaiK,EAAQ,EAAGC,EAAS,EAAGwgC,EAAQ,EAAGC,EAAgB,EAAGC,EAAiB,EAAGC,EAAgB,GAErGhmC,QAEAjF,KAAK8F,KAAO,cAEZ9F,KAAKoiB,WAAa,CACjB/X,MAAOA,EACPC,OAAQA,EACRwgC,MAAOA,EACPC,cAAeA,EACfC,eAAgBA,EAChBC,cAAeA,GAGhB,MAAMzqC,EAAQR,KAId+qC,EAAgB1mC,KAAK4F,MAAO8gC,GAC5BC,EAAiB3mC,KAAK4F,MAAO+gC,GAC7BC,EAAgB5mC,KAAK4F,MAAOghC,GAI5B,MAAMvD,EAAU,GACVwD,EAAW,GACXtD,EAAU,GACVC,EAAM,GAIZ,IAAIsD,EAAmB,EACnBC,EAAa,EAkBjB,SAASC,EAAYxe,EAAG5hB,EAAGC,EAAGogC,EAAMC,EAAMlhC,EAAOC,EAAQwgC,EAAOU,EAAOC,EAAOxE,GAE7E,MAAMyE,EAAerhC,EAAQmhC,EACvBG,EAAgBrhC,EAASmhC,EAEzBG,EAAYvhC,EAAQ,EACpBwhC,EAAavhC,EAAS,EACtBwhC,EAAYhB,EAAQ,EAEpBiB,EAASP,EAAQ,EACjBQ,EAASP,EAAQ,EAEvB,IAAIQ,EAAgB,EAChBC,EAAa,EAEjB,MAAM1d,EAAS,IAAI/E,GAInB,IAAM,IAAIc,EAAK,EAAGA,EAAKyhB,EAAQzhB,IAAQ,CAEtC,MAAM5gB,EAAI4gB,EAAKohB,EAAgBE,EAE/B,IAAM,IAAIvhB,EAAK,EAAGA,EAAKyhB,EAAQzhB,IAAQ,CAEtC,MAAM5gB,EAAI4gB,EAAKohB,EAAeE,EAI9Bpd,EAAQ3B,GAAMnjB,EAAI4hC,EAClB9c,EAAQvjB,GAAMtB,EAAI4hC,EAClB/c,EAAQtjB,GAAM4gC,EAIdZ,EAASxpC,KAAM8sB,EAAO9kB,EAAG8kB,EAAO7kB,EAAG6kB,EAAOxK,GAI1CwK,EAAQ3B,GAAM,EACd2B,EAAQvjB,GAAM,EACdujB,EAAQtjB,GAAM4/B,EAAQ,EAAI,GAAM,EAIhClD,EAAQlmC,KAAM8sB,EAAO9kB,EAAG8kB,EAAO7kB,EAAG6kB,EAAOxK,GAIzC6jB,EAAInmC,KAAM4oB,EAAKkhB,GACf3D,EAAInmC,KAAM,EAAM6oB,EAAKkhB,GAIrBQ,GAAiB,GAYnB,IAAM,IAAI1hB,EAAK,EAAGA,EAAKkhB,EAAOlhB,IAE7B,IAAM,IAAID,EAAK,EAAGA,EAAKkhB,EAAOlhB,IAAQ,CAErC,MAAM9e,EAAI2/B,EAAmB7gB,EAAKyhB,EAASxhB,EACrC9e,EAAI0/B,EAAmB7gB,EAAKyhB,GAAWxhB,EAAK,GAC5C5b,EAAIw8B,GAAqB7gB,EAAK,GAAMyhB,GAAWxhB,EAAK,GACpD3Y,EAAIu5B,GAAqB7gB,EAAK,GAAMyhB,EAASxhB,EAInDmd,EAAQhmC,KAAM8J,EAAGC,EAAGmG,GACpB81B,EAAQhmC,KAAM+J,EAAGkD,EAAGiD,GAIpBs6B,GAAc,EAQhB1rC,EAAMwmC,SAAUoE,EAAYc,EAAYjF,GAIxCmE,GAAcc,EAIdf,GAAoBc,EAhHrBZ,EAAY,IAAK,IAAK,KAAO,GAAK,EAAGP,EAAOxgC,EAAQD,EAAO4gC,EAAeD,EAAgB,GAC1FK,EAAY,IAAK,IAAK,IAAK,GAAK,EAAGP,EAAOxgC,GAAUD,EAAO4gC,EAAeD,EAAgB,GAC1FK,EAAY,IAAK,IAAK,IAAK,EAAG,EAAGhhC,EAAOygC,EAAOxgC,EAAQygC,EAAeE,EAAe,GACrFI,EAAY,IAAK,IAAK,IAAK,GAAK,EAAGhhC,EAAOygC,GAASxgC,EAAQygC,EAAeE,EAAe,GACzFI,EAAY,IAAK,IAAK,IAAK,GAAK,EAAGhhC,EAAOC,EAAQwgC,EAAOC,EAAeC,EAAgB,GACxFK,EAAY,IAAK,IAAK,KAAO,GAAK,EAAGhhC,EAAOC,GAAUwgC,EAAOC,EAAeC,EAAgB,GAI5FhrC,KAAK2mC,SAAUe,GACf1nC,KAAK6mC,aAAc,WAAY,IAAIzH,GAAwB8L,EAAU,IACrElrC,KAAK6mC,aAAc,SAAU,IAAIzH,GAAwBwI,EAAS,IAClE5nC,KAAK6mC,aAAc,KAAM,IAAIzH,GAAwByI,EAAK,IA0G3DjxB,gBAAiBS,GAEhB,OAAO,IAAIwzB,GAAaxzB,EAAKhN,MAAOgN,EAAK/M,OAAQ+M,EAAKyzB,MAAOzzB,EAAK0zB,cAAe1zB,EAAK2zB,eAAgB3zB,EAAK4zB,gBChK7G,MAAMkB,WAAsBhG,GAE3B/lC,YAAaiK,EAAQ,EAAGC,EAAS,EAAGygC,EAAgB,EAAGC,EAAiB,GAEvE/lC,QACAjF,KAAK8F,KAAO,gBAEZ9F,KAAKoiB,WAAa,CACjB/X,MAAOA,EACPC,OAAQA,EACRygC,cAAeA,EACfC,eAAgBA,GAGjB,MAAMoB,EAAa/hC,EAAQ,EACrBgiC,EAAc/hC,EAAS,EAEvBkhC,EAAQnnC,KAAK4F,MAAO8gC,GACpBU,EAAQpnC,KAAK4F,MAAO+gC,GAEpBe,EAASP,EAAQ,EACjBQ,EAASP,EAAQ,EAEjBa,EAAgBjiC,EAAQmhC,EACxBe,EAAiBjiC,EAASmhC,EAI1B/D,EAAU,GACVwD,EAAW,GACXtD,EAAU,GACVC,EAAM,GAEZ,IAAM,IAAItd,EAAK,EAAGA,EAAKyhB,EAAQzhB,IAAQ,CAEtC,MAAM5gB,EAAI4gB,EAAKgiB,EAAiBF,EAEhC,IAAM,IAAI/hB,EAAK,EAAGA,EAAKyhB,EAAQzhB,IAAQ,CAEtC,MAAM5gB,EAAI4gB,EAAKgiB,EAAgBF,EAE/BlB,EAASxpC,KAAMgI,GAAKC,EAAG,GAEvBi+B,EAAQlmC,KAAM,EAAG,EAAG,GAEpBmmC,EAAInmC,KAAM4oB,EAAKkhB,GACf3D,EAAInmC,KAAM,EAAM6oB,EAAKkhB,IAMvB,IAAM,IAAIlhB,EAAK,EAAGA,EAAKkhB,EAAOlhB,IAE7B,IAAM,IAAID,EAAK,EAAGA,EAAKkhB,EAAOlhB,IAAQ,CAErC,MAAM9e,EAAI8e,EAAKyhB,EAASxhB,EAClB9e,EAAI6e,EAAKyhB,GAAWxhB,EAAK,GACzB5b,EAAM2b,EAAK,EAAMyhB,GAAWxhB,EAAK,GACjC3Y,EAAM0Y,EAAK,EAAMyhB,EAASxhB,EAEhCmd,EAAQhmC,KAAM8J,EAAGC,EAAGmG,GACpB81B,EAAQhmC,KAAM+J,EAAGkD,EAAGiD,GAMtB5R,KAAK2mC,SAAUe,GACf1nC,KAAK6mC,aAAc,WAAY,IAAIzH,GAAwB8L,EAAU,IACrElrC,KAAK6mC,aAAc,SAAU,IAAIzH,GAAwBwI,EAAS,IAClE5nC,KAAK6mC,aAAc,KAAM,IAAIzH,GAAwByI,EAAK,IAI3DjxB,gBAAiBS,GAEhB,OAAO,IAAI80B,GAAe90B,EAAKhN,MAAOgN,EAAK/M,OAAQ+M,EAAK0zB,cAAe1zB,EAAK2zB,iBC5EvE,SAASwB,GAAe5mC,GAE9B,MAAM6e,EAAM,GAEZ,IAAM,MAAMoI,KAAKjnB,EAAM,CAEtB6e,EAAKoI,GAAM,GAEX,IAAM,MAAMxN,KAAKzZ,EAAKinB,GAAM,CAE3B,MAAM4f,EAAW7mC,EAAKinB,GAAKxN,GAEtBotB,IAAcA,EAAS9xB,SAC3B8xB,EAAS/4B,WAAa+4B,EAAS9R,WAC/B8R,EAAS19B,WAAa09B,EAAS7xB,WAAa6xB,EAAS3O,WACrD2O,EAASn1B,WAAam1B,EAASjjB,cAE/B/E,EAAKoI,GAAKxN,GAAMotB,EAAS1hC,QAEdkL,MAAMC,QAASu2B,GAE1BhoB,EAAKoI,GAAKxN,GAAMotB,EAASnmC,QAIzBme,EAAKoI,GAAKxN,GAAMotB,GAQnB,OAAOhoB,EAID,SAASioB,GAAeC,GAE9B,MAAMC,EAAS,GAEf,IAAM,IAAI/f,EAAI,EAAGA,EAAI8f,EAASzqC,OAAQ2qB,IAAO,CAE5C,MAAMta,EAAMi6B,GAAeG,EAAU9f,IAErC,IAAM,MAAMxN,KAAK9M,EAEhBq6B,EAAQvtB,GAAM9M,EAAK8M,GAMrB,OAAOutB,EAMR,MAAMC,GAAgB,CAAE9hC,MAAOyhC,GAAe5C,MAAO8C,IC1CrD,MAAMI,WAAuBp1B,GAE5BtX,YAAagiB,GAEZnd,QAEAjF,KAAK8F,KAAO,iBAEZ9F,KAAK+sC,QAAU,GACf/sC,KAAK2sC,SAAW,GAEhB3sC,KAAKgtC,aChCkB,oGDiCvBhtC,KAAKitC,eEjCkB,qEFmCvBjtC,KAAKse,UAAY,EAEjBte,KAAKye,WAAY,EACjBze,KAAK0e,mBAAqB,EAE1B1e,KAAK2X,KAAM,EACX3X,KAAKktC,QAAS,EACdltC,KAAKmtC,UAAW,EAEhBntC,KAAKotC,WAAa,CACjBC,aAAa,EACbC,WAAW,EACXC,aAAa,EACbC,kBAAkB,GAKnBxtC,KAAKytC,uBAAyB,CAC7B,MAAS,CAAE,EAAG,EAAG,GACjB,GAAM,CAAE,EAAG,GACX,IAAO,CAAE,EAAG,IAGbztC,KAAK0tC,yBAAsB3sC,EAC3Bf,KAAK2tC,oBAAqB,EAE1B3tC,KAAK4tC,YAAc,UAEC7sC,IAAfqhB,SAE2BrhB,IAA1BqhB,EAAWgkB,YAEfj7B,QAAQ+D,MAAO,2FAIhBlP,KAAKsa,UAAW8H,IAMlBpX,KAAMqK,GAqBL,OAnBApQ,MAAM+F,KAAMqK,GAEZrV,KAAKitC,eAAiB53B,EAAO43B,eAC7BjtC,KAAKgtC,aAAe33B,EAAO23B,aAE3BhtC,KAAK2sC,SAAWH,GAAen3B,EAAOs3B,UAEtC3sC,KAAK+sC,QAAUhuC,OAAO6rC,OAAQ,GAAIv1B,EAAO03B,SAEzC/sC,KAAKye,UAAYpJ,EAAOoJ,UACxBze,KAAK0e,mBAAqBrJ,EAAOqJ,mBAEjC1e,KAAKktC,OAAS73B,EAAO63B,OACrBltC,KAAKmtC,SAAW93B,EAAO83B,SAEvBntC,KAAKotC,WAAaruC,OAAO6rC,OAAQ,GAAIv1B,EAAO+3B,YAE5CptC,KAAK4tC,YAAcv4B,EAAOu4B,YAEnB5tC,KAIRwV,OAAQC,GAEP,MAAM4B,EAAOpS,MAAMuQ,OAAQC,GAE3B4B,EAAKu2B,YAAc5tC,KAAK4tC,YACxBv2B,EAAKs1B,SAAW,GAEhB,IAAM,MAAM/oC,KAAQ5D,KAAK2sC,SAAW,CAEnC,MACMjtC,EADUM,KAAK2sC,SAAU/oC,GACTlE,MAEjBA,GAASA,EAAM4X,UAEnBD,EAAKs1B,SAAU/oC,GAAS,CACvBkC,KAAM,IACNpG,MAAOA,EAAM8V,OAAQC,GAAOlB,MAGlB7U,GAASA,EAAMib,QAE1BtD,EAAKs1B,SAAU/oC,GAAS,CACvBkC,KAAM,IACNpG,MAAOA,EAAMub,UAGHvb,GAASA,EAAMqP,UAE1BsI,EAAKs1B,SAAU/oC,GAAS,CACvBkC,KAAM,KACNpG,MAAOA,EAAM0O,WAGH1O,GAASA,EAAMkb,UAE1BvD,EAAKs1B,SAAU/oC,GAAS,CACvBkC,KAAM,KACNpG,MAAOA,EAAM0O,WAGH1O,GAASA,EAAMo+B,UAE1BzmB,EAAKs1B,SAAU/oC,GAAS,CACvBkC,KAAM,KACNpG,MAAOA,EAAM0O,WAGH1O,GAASA,EAAMgU,UAE1B2D,EAAKs1B,SAAU/oC,GAAS,CACvBkC,KAAM,KACNpG,MAAOA,EAAM0O,WAGH1O,GAASA,EAAMi7B,UAE1BtjB,EAAKs1B,SAAU/oC,GAAS,CACvBkC,KAAM,KACNpG,MAAOA,EAAM0O,WAKdiJ,EAAKs1B,SAAU/oC,GAAS,CACvBlE,MAAOA,GASLX,OAAO0rC,KAAMzqC,KAAK+sC,SAAU7qC,OAAS,IAAImV,EAAK01B,QAAU/sC,KAAK+sC,SAElE11B,EAAK21B,aAAehtC,KAAKgtC,aACzB31B,EAAK41B,eAAiBjtC,KAAKitC,eAE3B,MAAMG,EAAa,GAEnB,IAAM,MAAMvuC,KAAOmB,KAAKotC,YAES,IAA3BptC,KAAKotC,WAAYvuC,KAAiBuuC,EAAYvuC,IAAQ,GAM5D,OAFKE,OAAO0rC,KAAM2C,GAAalrC,OAAS,IAAImV,EAAK+1B,WAAaA,GAEvD/1B,GAMTy1B,GAAeztC,UAAUwuC,kBAAmB,EGnM5C,MAAM,GAAwB,IAAIpkB,GAC5BqkB,GAA2B,IAAIrkB,GAC/BskB,GAAwB,IAAItkB,GAC5BukB,GAAsB,IAAIvkB,GAE1BwkB,GAAuB,IAAIxkB,GAC3BykB,GAAuB,IAAIzkB,GAC3B0kB,GAAwB,IAAI1kB,GAElC,MAAM2kB,GAELhuC,YAAaiuC,EAAS,IAAI5kB,GAAWiJ,EAAY,IAAIjJ,GAAS,EAAG,GAAK,IAErEzpB,KAAKquC,OAASA,EACdruC,KAAK0yB,UAAYA,EAIlBnoB,IAAK8jC,EAAQ3b,GAKZ,OAHA1yB,KAAKquC,OAAOrjC,KAAMqjC,GAClBruC,KAAK0yB,UAAU1nB,KAAM0nB,GAEd1yB,KAIRgL,KAAMsjC,GAKL,OAHAtuC,KAAKquC,OAAOrjC,KAAMsjC,EAAID,QACtBruC,KAAK0yB,UAAU1nB,KAAMsjC,EAAI5b,WAElB1yB,KAIRuuC,GAAI3kC,EAAGvD,GAEN,OAAOA,EAAO2E,KAAMhL,KAAK0yB,WAAY3mB,eAAgBnC,GAAI9J,IAAKE,KAAKquC,QAIpEpX,OAAQhsB,GAIP,OAFAjL,KAAK0yB,UAAU1nB,KAAMC,GAAIU,IAAK3L,KAAKquC,QAASjhC,YAErCpN,KAIRwuC,OAAQ5kC,GAIP,OAFA5J,KAAKquC,OAAOrjC,KAAMhL,KAAKuuC,GAAI3kC,EAAG,KAEvB5J,KAIRyuC,oBAAqBngB,EAAOjoB,GAE3BA,EAAOuF,WAAY0iB,EAAOtuB,KAAKquC,QAE/B,MAAMK,EAAoBroC,EAAOyG,IAAK9M,KAAK0yB,WAE3C,OAAKgc,EAAoB,EAEjBroC,EAAO2E,KAAMhL,KAAKquC,QAInBhoC,EAAO2E,KAAMhL,KAAK0yB,WAAY3mB,eAAgB2iC,GAAoB5uC,IAAKE,KAAKquC,QAIpF7d,gBAAiBlC,GAEhB,OAAOjqB,KAAK4I,KAAMjN,KAAK2uC,kBAAmBrgB,IAI3CqgB,kBAAmBrgB,GAElB,MAAMogB,EAAoB,GAAQ9iC,WAAY0iB,EAAOtuB,KAAKquC,QAASvhC,IAAK9M,KAAK0yB,WAI7E,OAAKgc,EAAoB,EAEjB1uC,KAAKquC,OAAO7gC,kBAAmB8gB,IAIvC,GAAQtjB,KAAMhL,KAAK0yB,WAAY3mB,eAAgB2iC,GAAoB5uC,IAAKE,KAAKquC,QAEtE,GAAQ7gC,kBAAmB8gB,IAInCsgB,oBAAqB9d,EAAI/iB,EAAI8gC,EAAoBC,GAShDhB,GAAW9iC,KAAM8lB,GAAKhxB,IAAKiO,GAAKhC,eAAgB,IAChDgiC,GAAQ/iC,KAAM+C,GAAKpC,IAAKmlB,GAAK1jB,YAC7B4gC,GAAMhjC,KAAMhL,KAAKquC,QAAS1iC,IAAKmiC,IAE/B,MAAMiB,EAAkC,GAAtBje,EAAGvjB,WAAYQ,GAC3BihC,GAAQhvC,KAAK0yB,UAAU5lB,IAAKihC,IAC5BkB,EAAKjB,GAAMlhC,IAAK9M,KAAK0yB,WACrBwc,GAAOlB,GAAMlhC,IAAKihC,IAClBp/B,EAAIq/B,GAAMhhC,WACVoF,EAAM/N,KAAK8I,IAAK,EAAI6hC,EAAMA,GAChC,IAAIG,EAAI3oB,EAAI4oB,EAASC,EAErB,GAAKj9B,EAAM,EAQV,GAJA+8B,EAAKH,EAAME,EAAKD,EAChBzoB,EAAKwoB,EAAMC,EAAKC,EAChBG,EAASN,EAAY38B,EAEhB+8B,GAAM,EAEV,GAAK3oB,IAAQ6oB,EAEZ,GAAK7oB,GAAM6oB,EAAS,CAKnB,MAAMC,EAAS,EAAIl9B,EACnB+8B,GAAMG,EACN9oB,GAAM8oB,EACNF,EAAUD,GAAOA,EAAKH,EAAMxoB,EAAK,EAAIyoB,GAAOzoB,GAAOwoB,EAAMG,EAAK3oB,EAAK,EAAI0oB,GAAOvgC,OAM9E6X,EAAKuoB,EACLI,EAAK9qC,KAAKX,IAAK,IAAOsrC,EAAMxoB,EAAKyoB,IACjCG,GAAYD,EAAKA,EAAK3oB,GAAOA,EAAK,EAAI0oB,GAAOvgC,OAQ9C6X,GAAOuoB,EACPI,EAAK9qC,KAAKX,IAAK,IAAOsrC,EAAMxoB,EAAKyoB,IACjCG,GAAYD,EAAKA,EAAK3oB,GAAOA,EAAK,EAAI0oB,GAAOvgC,OAMzC6X,IAAQ6oB,GAIZF,EAAK9qC,KAAKX,IAAK,KAASsrC,EAAMD,EAAYE,IAC1CzoB,EAAO2oB,EAAK,GAAQJ,EAAY1qC,KAAKmF,IAAKnF,KAAKX,KAAOqrC,GAAaG,GAAMH,GACzEK,GAAYD,EAAKA,EAAK3oB,GAAOA,EAAK,EAAI0oB,GAAOvgC,GAElC6X,GAAM6oB,GAIjBF,EAAK,EACL3oB,EAAKniB,KAAKmF,IAAKnF,KAAKX,KAAOqrC,GAAaG,GAAMH,GAC9CK,EAAU5oB,GAAOA,EAAK,EAAI0oB,GAAOvgC,IAMjCwgC,EAAK9qC,KAAKX,IAAK,IAAOsrC,EAAMD,EAAYE,IACxCzoB,EAAO2oB,EAAK,EAAMJ,EAAY1qC,KAAKmF,IAAKnF,KAAKX,KAAOqrC,GAAaG,GAAMH,GACvEK,GAAYD,EAAKA,EAAK3oB,GAAOA,EAAK,EAAI0oB,GAAOvgC,QAU/C6X,EAAOwoB,EAAM,GAAQD,EAAYA,EACjCI,EAAK9qC,KAAKX,IAAK,IAAOsrC,EAAMxoB,EAAKyoB,IACjCG,GAAYD,EAAKA,EAAK3oB,GAAOA,EAAK,EAAI0oB,GAAOvgC,EAgB9C,OAZKkgC,GAEJA,EAAmB7jC,KAAMhL,KAAK0yB,WAAY3mB,eAAgBojC,GAAKrvC,IAAKE,KAAKquC,QAIrES,GAEJA,EAAuB9jC,KAAM+iC,IAAUhiC,eAAgBya,GAAK1mB,IAAKguC,IAI3DsB,EAIRG,gBAAiBjgB,EAAQjpB,GAExB,GAAQuF,WAAY0jB,EAAO5gB,OAAQ1O,KAAKquC,QACxC,MAAMmB,EAAM,GAAQ1iC,IAAK9M,KAAK0yB,WACxBrpB,EAAK,GAAQyD,IAAK,IAAY0iC,EAAMA,EACpCC,EAAUngB,EAAOnD,OAASmD,EAAOnD,OAEvC,GAAK9iB,EAAKomC,EAAU,OAAO,KAE3B,MAAMC,EAAMrrC,KAAK4I,KAAMwiC,EAAUpmC,GAG3BsmC,EAAKH,EAAME,EAGXE,EAAKJ,EAAME,EAGjB,OAAKC,EAAK,GAAKC,EAAK,EAAW,KAK1BD,EAAK,EAAW3vC,KAAKuuC,GAAIqB,EAAIvpC,GAG3BrG,KAAKuuC,GAAIoB,EAAItpC,GAIrBgpB,iBAAkBC,GAEjB,OAAOtvB,KAAK2uC,kBAAmBrf,EAAO5gB,SAAc4gB,EAAOnD,OAASmD,EAAOnD,OAI5E0jB,gBAAiBpgB,GAEhB,MAAM/D,EAAc+D,EAAM1D,OAAOjf,IAAK9M,KAAK0yB,WAE3C,GAAqB,IAAhBhH,EAGJ,OAA8C,IAAzC+D,EAAMe,gBAAiBxwB,KAAKquC,QAEzB,EAMD,KAIR,MAAMzkC,IAAQ5J,KAAKquC,OAAOvhC,IAAK2iB,EAAM1D,QAAW0D,EAAMC,UAAahE,EAInE,OAAO9hB,GAAK,EAAIA,EAAI,KAIrBkmC,eAAgBrgB,EAAOppB,GAEtB,MAAMuD,EAAI5J,KAAK6vC,gBAAiBpgB,GAEhC,OAAW,OAAN7lB,EAEG,KAID5J,KAAKuuC,GAAI3kC,EAAGvD,GAIpBmpB,gBAAiBC,GAIhB,MAAMsgB,EAActgB,EAAMe,gBAAiBxwB,KAAKquC,QAEhD,OAAqB,IAAhB0B,GAMetgB,EAAM1D,OAAOjf,IAAK9M,KAAK0yB,WAExBqd,EAAc,EAYlCC,aAAc9hB,EAAK7nB,GAElB,IAAI4pC,EAAMC,EAAMC,EAAOC,EAAOC,EAAOC,EAErC,MAAMC,EAAU,EAAIvwC,KAAK0yB,UAAUhpB,EAClC8mC,EAAU,EAAIxwC,KAAK0yB,UAAU/oB,EAC7B8mC,EAAU,EAAIzwC,KAAK0yB,UAAU1O,EAExBqqB,EAASruC,KAAKquC,OA0BpB,OAxBKkC,GAAW,GAEfN,GAAS/hB,EAAI1kB,IAAIE,EAAI2kC,EAAO3kC,GAAM6mC,EAClCL,GAAShiB,EAAIxqB,IAAIgG,EAAI2kC,EAAO3kC,GAAM6mC,IAIlCN,GAAS/hB,EAAIxqB,IAAIgG,EAAI2kC,EAAO3kC,GAAM6mC,EAClCL,GAAShiB,EAAI1kB,IAAIE,EAAI2kC,EAAO3kC,GAAM6mC,GAI9BC,GAAW,GAEfL,GAAUjiB,EAAI1kB,IAAIG,EAAI0kC,EAAO1kC,GAAM6mC,EACnCJ,GAAUliB,EAAIxqB,IAAIiG,EAAI0kC,EAAO1kC,GAAM6mC,IAInCL,GAAUjiB,EAAIxqB,IAAIiG,EAAI0kC,EAAO1kC,GAAM6mC,EACnCJ,GAAUliB,EAAI1kB,IAAIG,EAAI0kC,EAAO1kC,GAAM6mC,GAI7BP,EAAOG,GAAaD,EAAQD,EAAgB,OAK9CC,EAAQF,GAAQA,GAASA,KAAOA,EAAOE,IAEvCC,EAAQF,GAAQA,GAASA,KAAOA,EAAOE,GAEvCK,GAAW,GAEfJ,GAAUniB,EAAI1kB,IAAIwa,EAAIqqB,EAAOrqB,GAAMysB,EACnCH,GAAUpiB,EAAIxqB,IAAIsgB,EAAIqqB,EAAOrqB,GAAMysB,IAInCJ,GAAUniB,EAAIxqB,IAAIsgB,EAAIqqB,EAAOrqB,GAAMysB,EACnCH,GAAUpiB,EAAI1kB,IAAIwa,EAAIqqB,EAAOrqB,GAAMysB,GAI7BR,EAAOK,GAAaD,EAAQH,EAAgB,OAE9CG,EAAQJ,GAAQA,GAASA,KAAOA,EAAOI,IAEvCC,EAAQJ,GAAQA,GAASA,KAAOA,EAAOI,GAIvCJ,EAAO,EAAW,KAEhBlwC,KAAKuuC,GAAI0B,GAAQ,EAAIA,EAAOC,EAAM7pC,KAI1C+oB,cAAelB,GAEd,OAA6C,OAAtCluB,KAAKgwC,aAAc9hB,EAAK,IAIhCwiB,kBAAmBllC,EAAGC,EAAGkD,EAAGgiC,EAAiBtqC,GAM5C4nC,GAAOriC,WAAYH,EAAGD,GACtB0iC,GAAOtiC,WAAY+C,EAAGnD,GACtB2iC,GAAQjjB,aAAc+iB,GAAQC,IAO9B,IACI0C,EADAC,EAAM7wC,KAAK0yB,UAAU5lB,IAAKqhC,IAG9B,GAAK0C,EAAM,EAAI,CAEd,GAAKF,EAAkB,OAAO,KAC9BC,EAAO,MAED,MAAKC,EAAM,GAOjB,OAAO,KALPD,GAAS,EACTC,GAAQA,EAQT7C,GAAMpiC,WAAY5L,KAAKquC,OAAQ7iC,GAC/B,MAAMslC,EAASF,EAAO5wC,KAAK0yB,UAAU5lB,IAAKohC,GAAOhjB,aAAc8iB,GAAOE,KAGtE,GAAK4C,EAAS,EAEb,OAAO,KAIR,MAAMC,EAASH,EAAO5wC,KAAK0yB,UAAU5lB,IAAKmhC,GAAOlhC,MAAOihC,KAGxD,GAAK+C,EAAS,EAEb,OAAO,KAKR,GAAKD,EAASC,EAASF,EAEtB,OAAO,KAKR,MAAMG,GAAQJ,EAAO5C,GAAMlhC,IAAKqhC,IAGhC,OAAK6C,EAAM,EAEH,KAKDhxC,KAAKuuC,GAAIyC,EAAMH,EAAKxqC,GAI5B4jB,aAAcxX,GAKb,OAHAzS,KAAKquC,OAAOpkB,aAAcxX,GAC1BzS,KAAK0yB,UAAUzH,mBAAoBxY,GAE5BzS,KAIRiO,OAAQqgC,GAEP,OAAOA,EAAID,OAAOpgC,OAAQjO,KAAKquC,SAAYC,EAAI5b,UAAUzkB,OAAQjO,KAAK0yB,WAIvE3nB,QAEC,OAAO,IAAI/K,KAAKI,aAAc4K,KAAMhL,OCvetC,MAAM,GAAoB,IAAIypB,GACxB,GAAoB,IAAIA,GACxB,GAAoB,IAAIA,GACxBwnB,GAAoB,IAAIxnB,GAExBynB,GAAqB,IAAIznB,GACzB0nB,GAAqB,IAAI1nB,GACzB2nB,GAAqB,IAAI3nB,GACzB4nB,GAAqB,IAAI5nB,GACzB6nB,GAAqB,IAAI7nB,GACzB8nB,GAAqB,IAAI9nB,GAE/B,MAAM+nB,GAELpxC,YAAaoL,EAAI,IAAIie,GAAWhe,EAAI,IAAIge,GAAW9a,EAAI,IAAI8a,IAE1DzpB,KAAKwL,EAAIA,EACTxL,KAAKyL,EAAIA,EACTzL,KAAK2O,EAAIA,EAIViI,iBAAkBpL,EAAGC,EAAGkD,EAAGtI,GAE1BA,EAAOuF,WAAY+C,EAAGlD,GACtB,GAAIG,WAAYJ,EAAGC,GACnBpF,EAAO0G,MAAO,IAEd,MAAM0kC,EAAiBprC,EAAO2G,WAC9B,OAAKykC,EAAiB,EAEdprC,EAAO0F,eAAgB,EAAI1H,KAAK4I,KAAMwkC,IAIvCprC,EAAOkE,IAAK,EAAG,EAAG,GAM1BqM,oBAAqB0X,EAAO9iB,EAAGC,EAAGkD,EAAGtI,GAEpC,GAAIuF,WAAY+C,EAAGnD,GACnB,GAAII,WAAYH,EAAGD,GACnB,GAAII,WAAY0iB,EAAO9iB,GAEvB,MAAMkmC,EAAQ,GAAI5kC,IAAK,IACjB6kC,EAAQ,GAAI7kC,IAAK,IACjB8kC,EAAQ,GAAI9kC,IAAK,IACjB+kC,EAAQ,GAAI/kC,IAAK,IACjBglC,EAAQ,GAAIhlC,IAAK,IAEjBilC,EAAUL,EAAQG,EAAQF,EAAQA,EAGxC,GAAe,IAAVI,EAIJ,OAAO1rC,EAAOkE,KAAO,GAAK,GAAK,GAIhC,MAAMynC,EAAW,EAAID,EACfllB,GAAMglB,EAAQD,EAAQD,EAAQG,GAAUE,EACxC/mC,GAAMymC,EAAQI,EAAQH,EAAQC,GAAUI,EAG9C,OAAO3rC,EAAOkE,IAAK,EAAIsiB,EAAI5hB,EAAGA,EAAG4hB,GAIlCjW,qBAAsB0X,EAAO9iB,EAAGC,EAAGkD,GAIlC,OAFA3O,KAAKiyC,aAAc3jB,EAAO9iB,EAAGC,EAAGkD,EAAGsiC,IAE1BA,GAAIvnC,GAAK,GAASunC,GAAItnC,GAAK,GAAWsnC,GAAIvnC,EAAIunC,GAAItnC,GAAO,EAInEiN,aAAc0X,EAAO4C,EAAIC,EAAIoC,EAAI2e,EAAKC,EAAKC,EAAK/rC,GAS/C,OAPArG,KAAKiyC,aAAc3jB,EAAO4C,EAAIC,EAAIoC,EAAI0d,IAEtC5qC,EAAOkE,IAAK,EAAG,GACflE,EAAOqF,gBAAiBwmC,EAAKjB,GAAIvnC,GACjCrD,EAAOqF,gBAAiBymC,EAAKlB,GAAItnC,GACjCtD,EAAOqF,gBAAiB0mC,EAAKnB,GAAIjtB,GAE1B3d,EAIRuQ,qBAAsBpL,EAAGC,EAAGkD,EAAG+jB,GAM9B,OAJA,GAAI9mB,WAAY+C,EAAGlD,GACnB,GAAIG,WAAYJ,EAAGC,GAGV,GAAIsB,MAAO,IAAMD,IAAK4lB,GAAc,EAI9CnoB,IAAKiB,EAAGC,EAAGkD,GAMV,OAJA3O,KAAKwL,EAAER,KAAMQ,GACbxL,KAAKyL,EAAET,KAAMS,GACbzL,KAAK2O,EAAE3D,KAAM2D,GAEN3O,KAIRqyC,wBAAyB5kB,EAAQ6kB,EAAIC,EAAIC,GAMxC,OAJAxyC,KAAKwL,EAAER,KAAMyiB,EAAQ6kB,IACrBtyC,KAAKyL,EAAET,KAAMyiB,EAAQ8kB,IACrBvyC,KAAK2O,EAAE3D,KAAMyiB,EAAQ+kB,IAEdxyC,KAIRyyC,2BAA4BnkC,EAAWgkC,EAAIC,EAAIC,GAM9C,OAJAxyC,KAAKwL,EAAE6C,oBAAqBC,EAAWgkC,GACvCtyC,KAAKyL,EAAE4C,oBAAqBC,EAAWikC,GACvCvyC,KAAK2O,EAAEN,oBAAqBC,EAAWkkC,GAEhCxyC,KAIR+K,QAEC,OAAO,IAAI/K,KAAKI,aAAc4K,KAAMhL,MAIrCgL,KAAM4kB,GAML,OAJA5vB,KAAKwL,EAAER,KAAM4kB,EAASpkB,GACtBxL,KAAKyL,EAAET,KAAM4kB,EAASnkB,GACtBzL,KAAK2O,EAAE3D,KAAM4kB,EAASjhB,GAEf3O,KAIR0yC,UAKC,OAHA,GAAI9mC,WAAY5L,KAAK2O,EAAG3O,KAAKyL,GAC7B,GAAIG,WAAY5L,KAAKwL,EAAGxL,KAAKyL,GAEM,GAA5B,GAAIsB,MAAO,IAAM7K,SAIzBywC,YAAatsC,GAEZ,OAAOA,EAAOgF,WAAYrL,KAAKwL,EAAGxL,KAAKyL,GAAI3L,IAAKE,KAAK2O,GAAI5C,eAAgB,EAAI,GAI9E6mC,UAAWvsC,GAEV,OAAOmrC,GAASoB,UAAW5yC,KAAKwL,EAAGxL,KAAKyL,EAAGzL,KAAK2O,EAAGtI,GAIpDwsC,SAAUxsC,GAET,OAAOA,EAAO+rB,sBAAuBpyB,KAAKwL,EAAGxL,KAAKyL,EAAGzL,KAAK2O,GAI3DsjC,aAAc3jB,EAAOjoB,GAEpB,OAAOmrC,GAASS,aAAc3jB,EAAOtuB,KAAKwL,EAAGxL,KAAKyL,EAAGzL,KAAK2O,EAAGtI,GAI9DysC,MAAOxkB,EAAO4jB,EAAKC,EAAKC,EAAK/rC,GAE5B,OAAOmrC,GAASsB,MAAOxkB,EAAOtuB,KAAKwL,EAAGxL,KAAKyL,EAAGzL,KAAK2O,EAAGujC,EAAKC,EAAKC,EAAK/rC,GAItE4oB,cAAeX,GAEd,OAAOkjB,GAASviB,cAAeX,EAAOtuB,KAAKwL,EAAGxL,KAAKyL,EAAGzL,KAAK2O,GAI5DokC,cAAergB,GAEd,OAAO8e,GAASuB,cAAe/yC,KAAKwL,EAAGxL,KAAKyL,EAAGzL,KAAK2O,EAAG+jB,GAIxDtD,cAAelB,GAEd,OAAOA,EAAIyB,mBAAoB3vB,MAIhCyuC,oBAAqBpvB,EAAGhZ,GAEvB,MAAMmF,EAAIxL,KAAKwL,EAAGC,EAAIzL,KAAKyL,EAAGkD,EAAI3O,KAAK2O,EACvC,IAAI1D,EAAGC,EAQPgmC,GAAKtlC,WAAYH,EAAGD,GACpB2lC,GAAKvlC,WAAY+C,EAAGnD,GACpB6lC,GAAKzlC,WAAYyT,EAAG7T,GACpB,MAAMpC,EAAK8nC,GAAKpkC,IAAKukC,IACfhoC,EAAK8nC,GAAKrkC,IAAKukC,IACrB,GAAKjoC,GAAM,GAAKC,GAAM,EAGrB,OAAOhD,EAAO2E,KAAMQ,GAIrB8lC,GAAK1lC,WAAYyT,EAAG5T,GACpB,MAAMnC,EAAK4nC,GAAKpkC,IAAKwkC,IACf0B,EAAK7B,GAAKrkC,IAAKwkC,IACrB,GAAKhoC,GAAM,GAAK0pC,GAAM1pC,EAGrB,OAAOjD,EAAO2E,KAAMS,GAIrB,MAAMwnC,EAAK7pC,EAAK4pC,EAAK1pC,EAAKD,EAC1B,GAAK4pC,GAAM,GAAK7pC,GAAM,GAAKE,GAAM,EAIhC,OAFA2B,EAAI7B,GAAOA,EAAKE,GAETjD,EAAO2E,KAAMQ,GAAIE,gBAAiBwlC,GAAMjmC,GAIhDsmC,GAAK3lC,WAAYyT,EAAG1Q,GACpB,MAAMukC,EAAKhC,GAAKpkC,IAAKykC,IACf4B,EAAKhC,GAAKrkC,IAAKykC,IACrB,GAAK4B,GAAM,GAAKD,GAAMC,EAGrB,OAAO9sC,EAAO2E,KAAM2D,GAIrB,MAAMykC,EAAKF,EAAK7pC,EAAKD,EAAK+pC,EAC1B,GAAKC,GAAM,GAAK/pC,GAAM,GAAK8pC,GAAM,EAIhC,OAFAjoC,EAAI7B,GAAOA,EAAK8pC,GAET9sC,EAAO2E,KAAMQ,GAAIE,gBAAiBylC,GAAMjmC,GAIhD,MAAMmoC,EAAK/pC,EAAK6pC,EAAKD,EAAKF,EAC1B,GAAKK,GAAM,GAAOL,EAAK1pC,GAAQ,GAAO4pC,EAAKC,GAAQ,EAKlD,OAHA/B,GAAKxlC,WAAY+C,EAAGlD,GACpBP,GAAM8nC,EAAK1pC,IAAW0pC,EAAK1pC,GAAS4pC,EAAKC,IAElC9sC,EAAO2E,KAAMS,GAAIC,gBAAiB0lC,GAAMlmC,GAKhD,MAAM6mC,EAAQ,GAAMsB,EAAKD,EAAKH,GAK9B,OAHAhoC,EAAImoC,EAAKrB,EACT7mC,EAAI+nC,EAAKlB,EAEF1rC,EAAO2E,KAAMQ,GAAIE,gBAAiBwlC,GAAMjmC,GAAIS,gBAAiBylC,GAAMjmC,GAI3E+C,OAAQ2hB,GAEP,OAAOA,EAASpkB,EAAEyC,OAAQjO,KAAKwL,IAAOokB,EAASnkB,EAAEwC,OAAQjO,KAAKyL,IAAOmkB,EAASjhB,EAAEV,OAAQjO,KAAK2O,ICnQ/F,MAAM2kC,WAA0B57B,GAE/BtX,YAAagiB,GAEZnd,QAEAjF,KAAK8F,KAAO,oBAEZ9F,KAAKgb,MAAQ,IAAIyE,GAAO,UAExBzf,KAAKmc,IAAM,KAEXnc,KAAKsc,SAAW,KAChBtc,KAAKuc,kBAAoB,EAEzBvc,KAAKwc,MAAQ,KACbxc,KAAKyc,eAAiB,EAEtBzc,KAAKqd,YAAc,KAEnBrd,KAAKqc,SAAW,KAEhBrc,KAAKwd,OAAS,KACdxd,KAAKyd,QnCV0B,EmCW/Bzd,KAAK2d,aAAe,EACpB3d,KAAK4d,gBAAkB,IAEvB5d,KAAKye,WAAY,EACjBze,KAAK0e,mBAAqB,EAC1B1e,KAAK2e,iBAAmB,QACxB3e,KAAK4e,kBAAoB,QAEzB5e,KAAKsa,UAAW8H,GAIjBpX,KAAMqK,GA4BL,OA1BApQ,MAAM+F,KAAMqK,GAEZrV,KAAKgb,MAAMhQ,KAAMqK,EAAO2F,OAExBhb,KAAKmc,IAAM9G,EAAO8G,IAElBnc,KAAKsc,SAAWjH,EAAOiH,SACvBtc,KAAKuc,kBAAoBlH,EAAOkH,kBAEhCvc,KAAKwc,MAAQnH,EAAOmH,MACpBxc,KAAKyc,eAAiBpH,EAAOoH,eAE7Bzc,KAAKqd,YAAchI,EAAOgI,YAE1Brd,KAAKqc,SAAWhH,EAAOgH,SAEvBrc,KAAKwd,OAASnI,EAAOmI,OACrBxd,KAAKyd,QAAUpI,EAAOoI,QACtBzd,KAAK2d,aAAetI,EAAOsI,aAC3B3d,KAAK4d,gBAAkBvI,EAAOuI,gBAE9B5d,KAAKye,UAAYpJ,EAAOoJ,UACxBze,KAAK0e,mBAAqBrJ,EAAOqJ,mBACjC1e,KAAK2e,iBAAmBtJ,EAAOsJ,iBAC/B3e,KAAK4e,kBAAoBvJ,EAAOuJ,kBAEzB5e,MAMTszC,GAAkBj0C,UAAUk0C,qBAAsB,EC5FlD,MAAMC,GAA+B,IAAIre,GACnCse,GAAqB,IAAIrF,GACzB,GAAwB,IAAI9c,GAE5BoiB,GAAoB,IAAIjqB,GACxBkqB,GAAoB,IAAIlqB,GACxBmqB,GAAoB,IAAInqB,GAExBoqB,GAAuB,IAAIpqB,GAC3BqqB,GAAuB,IAAIrqB,GAC3BsqB,GAAuB,IAAItqB,GAE3BuqB,GAAwB,IAAIvqB,GAC5BwqB,GAAwB,IAAIxqB,GAC5ByqB,GAAwB,IAAIzqB,GAE5B0qB,GAAqB,IAAI/pC,GACzBgqC,GAAqB,IAAIhqC,GACzBiqC,GAAqB,IAAIjqC,GAEzBkqC,GAAmC,IAAI7qB,GACvC8qB,GAAwC,IAAI9qB,GAElD,MAAM+qB,WAAarT,GAElB/gC,YAAauuB,EAAW,IAAIwX,GAAkBT,EAAW,IAAI4N,IAE5DruC,QAEAjF,KAAK8F,KAAO,OAEZ9F,KAAK2uB,SAAWA,EAChB3uB,KAAK0lC,SAAWA,EAEhB1lC,KAAKy0C,qBAINzpC,KAAMqK,GAmBL,OAjBApQ,MAAM+F,KAAMqK,QAE0BtU,IAAjCsU,EAAOq/B,wBAEX10C,KAAK00C,sBAAwBr/B,EAAOq/B,sBAAsBpuC,cAIrBvF,IAAjCsU,EAAOs/B,wBAEX30C,KAAK20C,sBAAwB51C,OAAO6rC,OAAQ,GAAIv1B,EAAOs/B,wBAIxD30C,KAAK0lC,SAAWrwB,EAAOqwB,SACvB1lC,KAAK2uB,SAAWtZ,EAAOsZ,SAEhB3uB,KAIRy0C,qBAEC,MAAM9lB,EAAW3uB,KAAK2uB,SAEtB,GAAKA,EAASkb,iBAAmB,CAEhC,MAAMxD,EAAkB1X,EAAS0X,gBAC3BoE,EAAO1rC,OAAO0rC,KAAMpE,GAE1B,GAAKoE,EAAKvoC,OAAS,EAAI,CAEtB,MAAMolC,EAAiBjB,EAAiBoE,EAAM,IAE9C,QAAwB1pC,IAAnBumC,EAA+B,CAEnCtnC,KAAK00C,sBAAwB,GAC7B10C,KAAK20C,sBAAwB,GAE7B,IAAM,IAAIxoC,EAAI,EAAGyoC,EAAKtN,EAAeplC,OAAQiK,EAAIyoC,EAAIzoC,IAAO,CAE3D,MAAMvI,EAAO0jC,EAAgBn7B,GAAIvI,MAAQixC,OAAQ1oC,GAEjDnM,KAAK00C,sBAAsBhzC,KAAM,GACjC1B,KAAK20C,sBAAuB/wC,GAASuI,SAQlC,CAEN,MAAM2oC,EAAenmB,EAASmmB,kBAER/zC,IAAjB+zC,GAA8BA,EAAa5yC,OAAS,GAExDiJ,QAAQ+D,MAAO,yGAQlB40B,QAASiR,EAAWC,GAEnB,MAAMrmB,EAAW3uB,KAAK2uB,SAChB+W,EAAW1lC,KAAK0lC,SAChB1a,EAAchrB,KAAKgrB,YAEzB,QAAkBjqB,IAAb2kC,EAAyB,OAS9B,GALiC,OAA5B/W,EAASmG,gBAA0BnG,EAASoG,wBAEjD,GAAQ/pB,KAAM2jB,EAASmG,gBACvB,GAAQ7K,aAAce,IAE6B,IAA9C+pB,EAAUzG,IAAIjf,iBAAkB,IAAsB,OAS3D,GALAmkB,GAAexoC,KAAMggB,GAAchZ,SACnCyhC,GAAKzoC,KAAM+pC,EAAUzG,KAAMrkB,aAAcupB,IAIX,OAAzB7kB,EAASC,cAEuC,IAA/C6kB,GAAKrkB,cAAeT,EAASC,aAA0B,OAI7D,IAAIqmB,EAEJ,GAAKtmB,EAASkb,iBAAmB,CAEhC,MAAMjoC,EAAQ+sB,EAAS/sB,MACjBw3B,EAAWzK,EAASyX,WAAWhN,SAC/B8b,EAAgBvmB,EAAS0X,gBAAgBjN,SACzCkN,EAAuB3X,EAAS2X,qBAChC/vB,EAAKoY,EAASyX,WAAW7vB,GACzB47B,EAAMxjB,EAASyX,WAAW+L,IAC1B5L,EAAS5X,EAAS4X,OAClBC,EAAY7X,EAAS6X,UAE3B,GAAe,OAAV5kC,EAIJ,GAAKqU,MAAMC,QAASwvB,GAEnB,IAAM,IAAI1jC,EAAI,EAAG2rB,EAAK4Y,EAAOrkC,OAAQF,EAAI2rB,EAAI3rB,IAAO,CAEnD,MAAM4mC,EAAQrC,EAAQvkC,GAChBmzC,EAAgBzP,EAAUkD,EAAM3B,eAKtC,IAAM,IAAIjW,EAHI3sB,KAAKX,IAAKklC,EAAMjW,MAAO6T,EAAU7T,OAG1B6U,EAFTnjC,KAAKmF,IAAK5H,EAAM2rB,MAAOlpB,KAAKmF,IAAOo/B,EAAMjW,MAAQiW,EAAMrb,MAAWiZ,EAAU7T,MAAQ6T,EAAUjZ,QAE3EyD,EAAIwW,EAAIxW,GAAK,EAAI,CAE/C,MAAMxlB,EAAI5J,EAAM2M,KAAMyiB,GAChBvlB,EAAI7J,EAAM2M,KAAMyiB,EAAI,GACpBriB,EAAI/M,EAAM2M,KAAMyiB,EAAI,GAE1BikB,EAAeG,GAAiCp1C,KAAMm1C,EAAeJ,EAAWtB,GAAMra,EAAU8b,EAAe5O,EAAsB/vB,EAAI47B,EAAK3mC,EAAGC,EAAGkD,GAE/IsmC,IAEJA,EAAaI,UAAYhxC,KAAK4F,MAAO+mB,EAAI,GACzCikB,EAAaK,KAAKrO,cAAgB2B,EAAM3B,cACxC+N,EAAWtzC,KAAMuzC,UAapB,IAAM,IAAIjzC,EAHIqC,KAAKX,IAAK,EAAG8iC,EAAU7T,OAGhBhF,EAFTtpB,KAAKmF,IAAK5H,EAAM2rB,MAASiZ,EAAU7T,MAAQ6T,EAAUjZ,OAElCvrB,EAAI2rB,EAAI3rB,GAAK,EAAI,CAE/C,MAAMwJ,EAAI5J,EAAM2M,KAAMvM,GAChByJ,EAAI7J,EAAM2M,KAAMvM,EAAI,GACpB2M,EAAI/M,EAAM2M,KAAMvM,EAAI,GAE1BizC,EAAeG,GAAiCp1C,KAAM0lC,EAAUqP,EAAWtB,GAAMra,EAAU8b,EAAe5O,EAAsB/vB,EAAI47B,EAAK3mC,EAAGC,EAAGkD,GAE1IsmC,IAEJA,EAAaI,UAAYhxC,KAAK4F,MAAOjI,EAAI,GACzCgzC,EAAWtzC,KAAMuzC,SAQd,QAAkBl0C,IAAbq4B,EAIX,GAAKnjB,MAAMC,QAASwvB,GAEnB,IAAM,IAAI1jC,EAAI,EAAG2rB,EAAK4Y,EAAOrkC,OAAQF,EAAI2rB,EAAI3rB,IAAO,CAEnD,MAAM4mC,EAAQrC,EAAQvkC,GAChBmzC,EAAgBzP,EAAUkD,EAAM3B,eAKtC,IAAM,IAAIjW,EAHI3sB,KAAKX,IAAKklC,EAAMjW,MAAO6T,EAAU7T,OAG1B6U,EAFTnjC,KAAKmF,IAAK4vB,EAAS7L,MAAOlpB,KAAKmF,IAAOo/B,EAAMjW,MAAQiW,EAAMrb,MAAWiZ,EAAU7T,MAAQ6T,EAAUjZ,QAE9EyD,EAAIwW,EAAIxW,GAAK,EAM3CikB,EAAeG,GAAiCp1C,KAAMm1C,EAAeJ,EAAWtB,GAAMra,EAAU8b,EAAe5O,EAAsB/vB,EAAI47B,EAJ/HnhB,EACAA,EAAI,EACJA,EAAI,GAITikB,IAEJA,EAAaI,UAAYhxC,KAAK4F,MAAO+mB,EAAI,GACzCikB,EAAaK,KAAKrO,cAAgB2B,EAAM3B,cACxC+N,EAAWtzC,KAAMuzC,SAapB,IAAM,IAAIjzC,EAHIqC,KAAKX,IAAK,EAAG8iC,EAAU7T,OAGhBhF,EAFTtpB,KAAKmF,IAAK4vB,EAAS7L,MAASiZ,EAAU7T,MAAQ6T,EAAUjZ,OAErCvrB,EAAI2rB,EAAI3rB,GAAK,EAM3CizC,EAAeG,GAAiCp1C,KAAM0lC,EAAUqP,EAAWtB,GAAMra,EAAU8b,EAAe5O,EAAsB/vB,EAAI47B,EAJ1HnwC,EACAA,EAAI,EACJA,EAAI,GAITizC,IAEJA,EAAaI,UAAYhxC,KAAK4F,MAAOjI,EAAI,GACzCgzC,EAAWtzC,KAAMuzC,SAUVtmB,EAAS4mB,YAEpBpqC,QAAQ+D,MAAO,8FAyClB,SAASkmC,GAAiCpnB,EAAQ0X,EAAUqP,EAAWzG,EAAKlV,EAAU8b,EAAe5O,EAAsB/vB,EAAI47B,EAAK3mC,EAAGC,EAAGkD,GAEzI+kC,GAAIrlC,oBAAqB+qB,EAAU5tB,GACnCmoC,GAAItlC,oBAAqB+qB,EAAU3tB,GACnCmoC,GAAIvlC,oBAAqB+qB,EAAUzqB,GAEnC,MAAM6mC,EAAkBxnB,EAAO0mB,sBAE/B,GAAKQ,GAAiBM,EAAkB,CAEvCxB,GAAQzpC,IAAK,EAAG,EAAG,GACnB0pC,GAAQ1pC,IAAK,EAAG,EAAG,GACnB2pC,GAAQ3pC,IAAK,EAAG,EAAG,GAEnB,IAAM,IAAIvI,EAAI,EAAG2rB,EAAKunB,EAAchzC,OAAQF,EAAI2rB,EAAI3rB,IAAO,CAE1D,MAAMyzC,EAAYD,EAAiBxzC,GAC7BslC,EAAiB4N,EAAelzC,GAEnB,IAAdyzC,IAEL5B,GAAOxlC,oBAAqBi5B,EAAgB97B,GAC5CsoC,GAAOzlC,oBAAqBi5B,EAAgB77B,GAC5CsoC,GAAO1lC,oBAAqBi5B,EAAgB34B,GAEvC23B,GAEJ0N,GAAQtoC,gBAAiBmoC,GAAQ4B,GACjCxB,GAAQvoC,gBAAiBooC,GAAQ2B,GACjCvB,GAAQxoC,gBAAiBqoC,GAAQ0B,KAIjCzB,GAAQtoC,gBAAiBmoC,GAAOloC,IAAK+nC,IAAO+B,GAC5CxB,GAAQvoC,gBAAiBooC,GAAOnoC,IAAKgoC,IAAO8B,GAC5CvB,GAAQxoC,gBAAiBqoC,GAAOpoC,IAAKioC,IAAO6B,KAM9C/B,GAAI5zC,IAAKk0C,IACTL,GAAI7zC,IAAKm0C,IACTL,GAAI9zC,IAAKo0C,IAILlmB,EAAOsX,gBAEXtX,EAAO0nB,cAAelqC,EAAGkoC,IACzB1lB,EAAO0nB,cAAejqC,EAAGkoC,IACzB3lB,EAAO0nB,cAAe/mC,EAAGilC,KAI1B,MAAMqB,EAtFP,SAA4BjnB,EAAQ0X,EAAUqP,EAAWzG,EAAKnF,EAAIC,EAAIC,EAAI/a,GAEzE,IAAIoC,EAYJ,GARCA,EpC5RsB,IoC0RlBgV,EAAS7tB,KAEDy2B,EAAIoC,kBAAmBrH,EAAID,EAAID,GAAI,EAAM7a,GAIzCggB,EAAIoC,kBAAmBvH,EAAIC,EAAIC,EpC/RnB,IoC+RuB3D,EAAS7tB,KAAqByW,GAI3D,OAAdoC,EAAqB,OAAO,KAEjC6jB,GAAwBvpC,KAAMsjB,GAC9BimB,GAAwBtqB,aAAc+D,EAAOhD,aAE7C,MAAM2X,EAAWoS,EAAUzG,IAAID,OAAO9gC,WAAYgnC,IAElD,OAAK5R,EAAWoS,EAAUva,MAAQmI,EAAWoS,EAAUta,IAAa,KAE7D,CACNkI,SAAUA,EACVrU,MAAOimB,GAAwBxpC,QAC/BijB,OAAQA,GA4DY2nB,CAAmB3nB,EAAQ0X,EAAUqP,EAAWzG,EAAKoF,GAAKC,GAAKC,GAAKU,IAEzF,GAAKW,EAAe,CAEd1+B,IAEJ49B,GAAK9lC,oBAAqBkI,EAAI/K,GAC9B4oC,GAAK/lC,oBAAqBkI,EAAI9K,GAC9B4oC,GAAKhmC,oBAAqBkI,EAAI5H,GAE9BsmC,EAAa1+B,GAAKi7B,GAASsB,MAAOwB,GAAoBZ,GAAKC,GAAKC,GAAKO,GAAMC,GAAMC,GAAM,IAAIjqC,KAIvF+nC,IAEJgC,GAAK9lC,oBAAqB8jC,EAAK3mC,GAC/B4oC,GAAK/lC,oBAAqB8jC,EAAK1mC,GAC/B4oC,GAAKhmC,oBAAqB8jC,EAAKxjC,GAE/BsmC,EAAa9C,IAAMX,GAASsB,MAAOwB,GAAoBZ,GAAKC,GAAKC,GAAKO,GAAMC,GAAMC,GAAM,IAAIjqC,KAI7F,MAAMkrC,EAAO,CACZ9pC,EAAGA,EACHC,EAAGA,EACHkD,EAAGA,EACHod,OAAQ,IAAItC,GACZwd,cAAe,GAGhBuK,GAASoB,UAAWc,GAAKC,GAAKC,GAAK0B,EAAKvpB,QAExCkpB,EAAaK,KAAOA,EAIrB,OAAOL,EA9HRT,GAAKn1C,UAAU6lC,QAAS,EChSjB,MCwHM0Q,GAAc,CAC1BC,kBCzHwB,yFD0HxBC,uBE1HwB,qEF2HxBC,mBG3HwB,qFH4HxBC,wBI5HwB,+DJ6HxBC,eK7HwB,ghBL8HxBC,oBM9HwB,gGN+HxBC,aO/HwB,2CPgIxBC,mBQhIwB,yHRiIxBC,MSjIwB,k7PTkIxBC,sBUlIwB,22CVmIxBC,yBWnIwB,ypBXoIxBC,8BYpIwB,sIZqIxBC,4BarIwB,6EbsIxBC,uBctIwB,mFduIxBC,eevIwB,2IfwIxBC,oBgBxIwB,iIhByIxBC,kBiBzIwB,oKjB0IxBC,akB1IwB,ySlB2IxBC,OmB3IwB,w1FnB4IxBC,4BoB5IwB,y7IpB6IxBC,qBqB7IwB,qtBrB8IxBC,4BsB9IwB,0JtB+IxBC,uBuB/IwB,2KvBgJxBC,qBwBhJwB,yNxBiJxBC,0ByBjJwB,2EzBkJxBC,mB0BlJwB,0D1BmJxBC,wB2BnJwB,0jH3BoJxBC,gB4BpJwB,+8C5BqJxBC,4B6BrJwB,iP7BsJxBC,qB8BtJwB,2U9BuJxBC,mB+BvJwB,mT/BwJxBC,8BgCxJwB,o0ChCyJxBC,ciCzJwB,krBjC0JxBC,WkC1JwB,gElC2JxBC,gBmC3JwB,6DnC4JxBC,aoC5JwB,6SpC6JxBC,kBqC7JwB,6NrC8JxBC,0BsC9JwB,gctC+JxBC,kBuC/JwB,uUvCgKxBC,uBwChKwB,yGxCiKxBC,sByCjKwB,s1FzCkKxBC,kB0ClKwB,2tL1CmKxBC,qB2CnKwB,wE3CoKxBC,0B4CpKwB,u2B5CqKxBC,sB6CrKwB,0M7CsKxBC,2B8CtKwB,isC9CuKxBC,yB+CvKwB,2+E/CwKxBC,8BgDxKwB,y2NhDyKxBC,sBiDzKwB,+iJjD0KxBC,qBkD1KwB,m1BlD2KxBC,oBmD3KwB,yRnD4KxBC,qBoD5KwB,4SpD6KxBC,0BqD7KwB,iLrD8KxBC,wBsD9KwB,sMtD+KxBC,mBuD/KwB,qZvDgLxBC,awDhLwB,8JxDiLxBC,kByDjLwB,2DzDkLxBC,sB0DlLwB,sW1DmLxBC,2B2DnLwB,2N3DoLxBC,sB4DpLwB,8Q5DqLxBC,2B6DrLwB,6E7DsLxBC,mB8DtLwB,47B9DuLxBC,wB+DvLwB,y8B/DwLxBC,mBgExLwB,g7ChEyLxBC,sBiEzLwB,4gCjE0LxBC,qBkE1LwB,iwBlE2LxBC,qBmE3LwB,+JnE4LxBC,mBoE5LwB,+JpE6LxBC,cqE7LwB,ySrE8LxBC,wBsE9LwB,ksCtE+LxBC,gCuE/LwB,iFvEgMxBC,+BwEhMwB,qYxEiMxBC,wByEjMwB,ySzEkMxBC,gB0ElMwB,6O1EmMxBC,Q2EnMwB,k0D3EoMxBC,6B4EpMwB,8M5EqMxBC,e6ErMwB,kO7EsMxBC,mB8EtMwB,wF9EuMxBC,wB+EvMwB,2mB/EwMxBC,sBgFxMwB,8QhFyMxBC,2BiFzMwB,6EjF0MxBC,wBkF1MwB,yqVlF2MxBC,sBmF3MwB,86CnF4MxBC,iBoF5MwB,slDpF6MxBC,yBqF7MwB,wjDrF8MxBC,gBsF9MwB,0OtF+MxBC,qBuF/MwB,wjCvFgNxBC,gBwFhNwB,2YxFiNxBC,kByFjNwB,qezFkNxBC,qB0FlNwB,wM1FmNxBC,0B2FnNwB,2E3FoNxBC,qB4FpNwB,qG5FqNxBC,0B6FrNwB,8hE7FsNxBC,sB8FtNwB,06B9FuNxBC,2B+FvNwB,6vH/FwNxBC,iBgGxNwB,iGhGyNxBC,eiGzNwB,0JjG0NxBC,UkG1NwB,6ElG2NxBC,kBmG3NwB,4FnG4NxBC,gBoG5NwB,mJpG6NxBC,WqG7NwB,sHrG8NxBC,gBsG9NwB,kUtGgOxBC,gBDhO+B,0KCiO/BC,gBDpNiC,4OCqNjCC,UuGlO+B,wQvGmO/BC,UuGlNiC,4WvGmNjCC,WwGpO+B,qjCxGqO/BC,WwG5LiC,0hCxG6LjCC,kByGtO+B,4uBzGuO/BC,kByGhMiC,4wBzGiMjCC,c0GxO+B,6M1GyO/BC,c0G1NiC,gY1G2NjCC,gB2G1O+B,+iB3G2O/BC,gB2G/MiC,uzB3GgNjCC,e4G5O+B,w6B5G6O/BC,e4GnMiC,oxD5GoMjCC,iB6G9O+B,ipC7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7D,GAFAqlC,EAAYtX,EAAWluC,IAAK,iCAET,OAAdwlD,EASJ,OAAO,KAPP,GrMuCgC,QqMvC3BrlC,EAA6B,OAAOqlC,EAAU0jC,6BACnD,GrMuCiC,QqMvC5B/oE,EAA8B,OAAOqlC,EAAU2jC,8BACpD,GrMuCiC,QqMvC5BhpE,EAA8B,OAAOqlC,EAAU4jC,8BACpD,GrMuCiC,QqMvC5BjpE,EAA8B,OAAOqlC,EAAU6jC,8BAUtD,GrM8BqC,QqM9BhClpE,GrM+BgC,QqM/BCA,GrMgCA,QqM/BrCA,GrMgCqC,QqMhCHA,EAAiC,CAInE,GAFAqlC,EAAYtX,EAAWluC,IAAK,kCAET,OAAdwlD,EASJ,OAAO,KAPP,GrMuBmC,QqMvB9BrlC,EAAgC,OAAOqlC,EAAU8jC,gCACtD,GrMuBmC,QqMvB9BnpE,EAAgC,OAAOqlC,EAAU+jC,gCACtD,GrMuBoC,QqMvB/BppE,EAAiC,OAAOqlC,EAAUgkC,iCACvD,GrMuBoC,QqMvB/BrpE,EAAiC,OAAOqlC,EAAUikC,iCAUzD,GrMc6B,QqMdxBtpE,EAIJ,OAFAqlC,EAAYtX,EAAWluC,IAAK,iCAET,OAAdwlD,EAEGA,EAAUkkC,0BAIV,KAMT,IrMD6B,QqMCxBvpE,GrMA6B,QqMAJA,KAE7BqlC,EAAYtX,EAAWluC,IAAK,gCAET,OAAdwlD,GAAqB,CAEzB,GrMP2B,QqMOtBrlC,EAAwB,OAAOqlC,EAAUmkC,qBAC9C,GrMPgC,QqMO3BxpE,EAA6B,OAAOqlC,EAAUokC,0BAMrD,OrMZkC,QqMY7BzpE,GrMX6B,QqMWCA,GrMVD,QqMU+BA,GrMT/B,QqMUjCA,GrMTiC,QqMSHA,GrMRG,QqMQ2BA,GrMP3B,QqMQjCA,GrMPiC,QqMOHA,GrMNI,QqMM0BA,GrML1B,QqMMlCA,GrMLkC,QqMKHA,GrMJI,QqMI2BA,GrMH3B,QqMInCA,GrMHmC,QqMGHA,GrMDS,QqMEzCA,GrMDyC,QqMCHA,GrMAG,QqMAmCA,GrMCnC,QqMAzCA,GrMCyC,QqMDHA,GrMEG,QqMFmCA,GrMGnC,QqMFzCA,GrMGyC,QqMHHA,GrMII,QqMJkCA,GrMKlC,QqMJ1CA,GrMK0C,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","sources":["webpack://spotify-hall-of-fame/webpack/bootstrap","webpack://spotify-hall-of-fame/webpack/runtime/define property getters","webpack://spotify-hall-of-fame/webpack/runtime/hasOwnProperty shorthand","webpack://spotify-hall-of-fame/webpack/runtime/make namespace object","webpack://spotify-hall-of-fame/./node_modules/three/src/loaders/Cache.js","webpack://spotify-hall-of-fame/./node_modules/three/src/loaders/LoadingManager.js","webpack://spotify-hall-of-fame/./node_modules/three/src/loaders/Loader.js","webpack://spotify-hall-of-fame/./node_modules/three/src/utils.js","webpack://spotify-hall-of-fame/./node_modules/three/src/loaders/ImageLoader.js","webpack://spotify-hall-of-fame/./node_modules/three/src/core/EventDispatcher.js","webpack://spotify-hall-of-fame/./node_modules/three/src/constants.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/MathUtils.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/Vector2.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/Matrix3.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/ImageUtils.js","webpack://spotify-hall-of-fame/./node_modules/three/src/textures/Texture.js","webpack://spotify-hall-of-fame/./node_modules/three/src/loaders/TextureLoader.js","webpack://spotify-hall-of-fame/./node_modules/three/src/materials/Material.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/Color.js","webpack://spotify-hall-of-fame/./node_modules/three/src/materials/MeshPhongMaterial.js","webpack://spotify-hall-of-fame/./src/albumcovers.ts","webpack://spotify-hall-of-fame/./src/audio.ts","webpack://spotify-hall-of-fame/./node_modules/three/src/math/Quaternion.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/Vector3.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/Box3.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/Sphere.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/Plane.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/Frustum.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/Matrix4.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/Vector4.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLAnimation.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLAttributes.js","webpack://spotify-hall-of-fame/./node_modules/three/src/core/BufferAttribute.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/Euler.js","webpack://spotify-hall-of-fame/./node_modules/three/src/core/Layers.js","webpack://spotify-hall-of-fame/./node_modules/three/src/core/Object3D.js","webpack://spotify-hall-of-fame/./node_modules/three/src/core/BufferGeometry.js","webpack://spotify-hall-of-fame/./node_modules/three/src/geometries/BoxGeometry.js","webpack://spotify-hall-of-fame/./node_modules/three/src/geometries/PlaneGeometry.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/UniformsUtils.js","webpack://spotify-hall-of-fame/./node_modules/three/src/materials/ShaderMaterial.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/default_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/default_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/Ray.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/Triangle.js","webpack://spotify-hall-of-fame/./node_modules/three/src/materials/MeshBasicMaterial.js","webpack://spotify-hall-of-fame/./node_modules/three/src/objects/Mesh.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/background.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/alphamap_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/alphamap_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/alphatest_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/alphatest_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/aomap_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/aomap_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/begin_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/beginnormal_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/bsdfs.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/bumpmap_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/clipping_planes_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/clipping_planes_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/clipping_planes_pars_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/clipping_planes_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/color_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/color_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/color_pars_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/color_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/common.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/cube_uv_reflection_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/defaultnormal_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/displacementmap_pars_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/displacementmap_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/emissivemap_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/emissivemap_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/encodings_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/encodings_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/envmap_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/envmap_common_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/envmap_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/envmap_pars_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/envmap_physical_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/envmap_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/fog_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/fog_pars_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/fog_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/fog_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/gradientmap_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/lightmap_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/lightmap_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/lights_lambert_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/lights_pars_begin.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/lights_toon_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/lights_toon_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/lights_phong_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/lights_phong_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/lights_physical_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/lights_physical_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/lights_fragment_begin.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/lights_fragment_maps.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/lights_fragment_end.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/logdepthbuf_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/logdepthbuf_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/logdepthbuf_pars_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/logdepthbuf_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/map_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/map_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/map_particle_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/map_particle_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/metalnessmap_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/metalnessmap_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/morphnormal_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/morphtarget_pars_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/morphtarget_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/normal_fragment_begin.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/normal_fragment_maps.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/normal_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/normal_pars_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/normal_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/clearcoat_normal_fragment_begin.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/clearcoat_normal_fragment_maps.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/clearcoat_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/output_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/packing.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/premultiplied_alpha_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/project_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/dithering_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/dithering_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/roughnessmap_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/roughnessmap_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/shadowmap_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/shadowmap_pars_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/shadowmap_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/shadowmask_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/skinbase_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/skinning_pars_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/skinning_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/skinnormal_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/specularmap_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/specularmap_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/tonemapping_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/tonemapping_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/transmission_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/transmission_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/uv_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/uv_pars_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/uv_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/uv2_pars_fragment.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/uv2_pars_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/uv2_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderChunk/worldpos_vertex.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/cube.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/depth.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/distanceRGBA.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/equirect.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/linedashed.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/meshbasic.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/meshlambert.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/meshmatcap.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/meshnormal.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/meshphong.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/meshphysical.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/meshtoon.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/points.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/shadow.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/sprite.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/UniformsLib.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLBackground.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLBindingStates.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLBufferRenderer.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLCapabilities.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLClipping.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/WebGLRenderTarget.js","webpack://spotify-hall-of-fame/./node_modules/three/src/cameras/Camera.js","webpack://spotify-hall-of-fame/./node_modules/three/src/cameras/PerspectiveCamera.js","webpack://spotify-hall-of-fame/./node_modules/three/src/cameras/CubeCamera.js","webpack://spotify-hall-of-fame/./node_modules/three/src/textures/CubeTexture.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/WebGLCubeRenderTarget.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLCubeMaps.js","webpack://spotify-hall-of-fame/./node_modules/three/src/cameras/OrthographicCamera.js","webpack://spotify-hall-of-fame/./node_modules/three/src/materials/RawShaderMaterial.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/PMREMGenerator.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLCubeUVMaps.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLExtensions.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLGeometries.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLIndexedBufferRenderer.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLInfo.js","webpack://spotify-hall-of-fame/./node_modules/three/src/textures/DataTexture2DArray.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLMorphtargets.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/WebGLMultisampleRenderTarget.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLObjects.js","webpack://spotify-hall-of-fame/./node_modules/three/src/textures/DataTexture3D.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLUniforms.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLShader.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLProgram.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLPrograms.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLProperties.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLRenderLists.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLLights.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLRenderStates.js","webpack://spotify-hall-of-fame/./node_modules/three/src/materials/MeshDepthMaterial.js","webpack://spotify-hall-of-fame/./node_modules/three/src/materials/MeshDistanceMaterial.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLShadowMap.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/shaders/ShaderLib/vsm.glsl.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLState.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLTextures.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLUtils.js","webpack://spotify-hall-of-fame/./node_modules/three/src/cameras/ArrayCamera.js","webpack://spotify-hall-of-fame/./node_modules/three/src/objects/Group.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webxr/WebXRController.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webxr/WebXRManager.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/webgl/WebGLMaterials.js","webpack://spotify-hall-of-fame/./node_modules/three/src/renderers/WebGLRenderer.js","webpack://spotify-hall-of-fame/./node_modules/three/src/scenes/Scene.js","webpack://spotify-hall-of-fame/./node_modules/three/src/lights/Light.js","webpack://spotify-hall-of-fame/./node_modules/three/src/lights/AmbientLight.js","webpack://spotify-hall-of-fame/./src/environment.ts","webpack://spotify-hall-of-fame/./node_modules/three/src/materials/MeshNormalMaterial.js","webpack://spotify-hall-of-fame/./node_modules/three/src/lights/LightShadow.js","webpack://spotify-hall-of-fame/./node_modules/three/src/lights/SpotLightShadow.js","webpack://spotify-hall-of-fame/./node_modules/three/src/lights/SpotLight.js","webpack://spotify-hall-of-fame/./src/hall.ts","webpack://spotify-hall-of-fame/./node_modules/three/src/geometries/SphereGeometry.js","webpack://spotify-hall-of-fame/./node_modules/three/src/core/Raycaster.js","webpack://spotify-hall-of-fame/./node_modules/three/examples/jsm/controls/PointerLockControls.js","webpack://spotify-hall-of-fame/./src/movement.ts","webpack://spotify-hall-of-fame/./src/pointer.ts","webpack://spotify-hall-of-fame/./node_modules/three/src/geometries/RingGeometry.js","webpack://spotify-hall-of-fame/./node_modules/three/src/loaders/LoaderUtils.js","webpack://spotify-hall-of-fame/./node_modules/three/src/loaders/FileLoader.js","webpack://spotify-hall-of-fame/./node_modules/three/src/lights/DirectionalLightShadow.js","webpack://spotify-hall-of-fame/./node_modules/three/src/lights/DirectionalLight.js","webpack://spotify-hall-of-fame/./node_modules/three/src/lights/PointLightShadow.js","webpack://spotify-hall-of-fame/./node_modules/three/src/lights/PointLight.js","webpack://spotify-hall-of-fame/./node_modules/three/src/materials/MeshStandardMaterial.js","webpack://spotify-hall-of-fame/./node_modules/three/src/materials/MeshPhysicalMaterial.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/Interpolant.js","webpack://spotify-hall-of-fame/./node_modules/three/src/loaders/ImageBitmapLoader.js","webpack://spotify-hall-of-fame/./node_modules/three/src/core/InterleavedBuffer.js","webpack://spotify-hall-of-fame/./node_modules/three/src/core/InterleavedBufferAttribute.js","webpack://spotify-hall-of-fame/./node_modules/three/src/materials/PointsMaterial.js","webpack://spotify-hall-of-fame/./node_modules/three/src/materials/LineBasicMaterial.js","webpack://spotify-hall-of-fame/./node_modules/three/src/animation/PropertyBinding.js","webpack://spotify-hall-of-fame/./node_modules/three/src/objects/SkinnedMesh.js","webpack://spotify-hall-of-fame/./node_modules/three/src/objects/Line.js","webpack://spotify-hall-of-fame/./node_modules/three/src/objects/LineSegments.js","webpack://spotify-hall-of-fame/./node_modules/three/src/objects/LineLoop.js","webpack://spotify-hall-of-fame/./node_modules/three/src/objects/Points.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/interpolants/CubicInterpolant.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/interpolants/LinearInterpolant.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/interpolants/DiscreteInterpolant.js","webpack://spotify-hall-of-fame/./node_modules/three/src/animation/AnimationUtils.js","webpack://spotify-hall-of-fame/./node_modules/three/src/animation/KeyframeTrack.js","webpack://spotify-hall-of-fame/./node_modules/three/src/animation/tracks/NumberKeyframeTrack.js","webpack://spotify-hall-of-fame/./node_modules/three/src/math/interpolants/QuaternionLinearInterpolant.js","webpack://spotify-hall-of-fame/./node_modules/three/src/animation/tracks/QuaternionKeyframeTrack.js","webpack://spotify-hall-of-fame/./node_modules/three/src/animation/tracks/VectorKeyframeTrack.js","webpack://spotify-hall-of-fame/./node_modules/three/src/animation/tracks/BooleanKeyframeTrack.js","webpack://spotify-hall-of-fame/./node_modules/three/src/animation/tracks/ColorKeyframeTrack.js","webpack://spotify-hall-of-fame/./node_modules/three/src/animation/tracks/StringKeyframeTrack.js","webpack://spotify-hall-of-fame/./node_modules/three/src/animation/AnimationClip.js","webpack://spotify-hall-of-fame/./node_modules/three/src/objects/Bone.js","webpack://spotify-hall-of-fame/./node_modules/three/src/textures/DataTexture.js","webpack://spotify-hall-of-fame/./node_modules/three/src/objects/Skeleton.js","webpack://spotify-hall-of-fame/./node_modules/three/examples/jsm/loaders/GLTFLoader.js","webpack://spotify-hall-of-fame/./node_modules/three/src/materials/MeshLambertMaterial.js","webpack://spotify-hall-of-fame/./node_modules/three/examples/jsm/libs/fflate.module.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/core/Curve.js","webpack://spotify-hall-of-fame/./node_modules/three/examples/jsm/curves/NURBSUtils.js","webpack://spotify-hall-of-fame/./node_modules/three/examples/jsm/curves/NURBSCurve.js","webpack://spotify-hall-of-fame/./node_modules/three/examples/jsm/loaders/FBXLoader.js","webpack://spotify-hall-of-fame/./src/particles.ts","webpack://spotify-hall-of-fame/./src/recordplayer.ts","webpack://spotify-hall-of-fame/./src/spotify.ts","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/curves/EllipseCurve.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/curves/ArcCurve.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/curves/CatmullRomCurve3.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/core/Interpolations.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/curves/CubicBezierCurve.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/curves/CubicBezierCurve3.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/curves/LineCurve.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/curves/LineCurve3.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/curves/QuadraticBezierCurve.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/curves/QuadraticBezierCurve3.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/curves/SplineCurve.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/core/CurvePath.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/core/Path.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/core/Shape.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/Earcut.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/ShapeUtils.js","webpack://spotify-hall-of-fame/./node_modules/three/src/extras/core/ShapePath.js","webpack://spotify-hall-of-fame/./node_modules/three/examples/jsm/loaders/FontLoader.js","webpack://spotify-hall-of-fame/./node_modules/three/src/geometries/ExtrudeGeometry.js","webpack://spotify-hall-of-fame/./node_modules/three/examples/jsm/geometries/TextGeometry.js","webpack://spotify-hall-of-fame/./src/text.ts","webpack://spotify-hall-of-fame/./src/wallpaper.ts","webpack://spotify-hall-of-fame/./src/main.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const Cache = {\n\n\tenabled: false,\n\n\tfiles: {},\n\n\tadd: function ( key, file ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\n\n\t\tthis.files[ key ] = file;\n\n\t},\n\n\tget: function ( key ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\n\n\t\treturn this.files[ key ];\n\n\t},\n\n\tremove: function ( key ) {\n\n\t\tdelete this.files[ key ];\n\n\t},\n\n\tclear: function () {\n\n\t\tthis.files = {};\n\n\t}\n\n};\n\n\nexport { Cache };\n","class LoadingManager {\n\n\tconstructor( onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tlet isLoading = false;\n\t\tlet itemsLoaded = 0;\n\t\tlet itemsTotal = 0;\n\t\tlet urlModifier = undefined;\n\t\tconst handlers = [];\n\n\t\t// Refer to #5689 for the reason why we don't set .onStart\n\t\t// in the constructor\n\n\t\tthis.onStart = undefined;\n\t\tthis.onLoad = onLoad;\n\t\tthis.onProgress = onProgress;\n\t\tthis.onError = onError;\n\n\t\tthis.itemStart = function ( url ) {\n\n\t\t\titemsTotal ++;\n\n\t\t\tif ( isLoading === false ) {\n\n\t\t\t\tif ( scope.onStart !== undefined ) {\n\n\t\t\t\t\tscope.onStart( url, itemsLoaded, itemsTotal );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tisLoading = true;\n\n\t\t};\n\n\t\tthis.itemEnd = function ( url ) {\n\n\t\t\titemsLoaded ++;\n\n\t\t\tif ( scope.onProgress !== undefined ) {\n\n\t\t\t\tscope.onProgress( url, itemsLoaded, itemsTotal );\n\n\t\t\t}\n\n\t\t\tif ( itemsLoaded === itemsTotal ) {\n\n\t\t\t\tisLoading = false;\n\n\t\t\t\tif ( scope.onLoad !== undefined ) {\n\n\t\t\t\t\tscope.onLoad();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.itemError = function ( url ) {\n\n\t\t\tif ( scope.onError !== undefined ) {\n\n\t\t\t\tscope.onError( url );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.resolveURL = function ( url ) {\n\n\t\t\tif ( urlModifier ) {\n\n\t\t\t\treturn urlModifier( url );\n\n\t\t\t}\n\n\t\t\treturn url;\n\n\t\t};\n\n\t\tthis.setURLModifier = function ( transform ) {\n\n\t\t\turlModifier = transform;\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.addHandler = function ( regex, loader ) {\n\n\t\t\thandlers.push( regex, loader );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.removeHandler = function ( regex ) {\n\n\t\t\tconst index = handlers.indexOf( regex );\n\n\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\thandlers.splice( index, 2 );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.getHandler = function ( file ) {\n\n\t\t\tfor ( let i = 0, l = handlers.length; i < l; i += 2 ) {\n\n\t\t\t\tconst regex = handlers[ i ];\n\t\t\t\tconst loader = handlers[ i + 1 ];\n\n\t\t\t\tif ( regex.global ) regex.lastIndex = 0; // see #17920\n\n\t\t\t\tif ( regex.test( file ) ) {\n\n\t\t\t\t\treturn loader;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn null;\n\n\t\t};\n\n\t}\n\n}\n\nconst DefaultLoadingManager = new LoadingManager();\n\nexport { DefaultLoadingManager, LoadingManager };\n","import { DefaultLoadingManager } from './LoadingManager.js';\n\nclass Loader {\n\n\tconstructor( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t\tthis.crossOrigin = 'anonymous';\n\t\tthis.withCredentials = false;\n\t\tthis.path = '';\n\t\tthis.resourcePath = '';\n\t\tthis.requestHeader = {};\n\n\t}\n\n\tload( /* url, onLoad, onProgress, onError */ ) {}\n\n\tloadAsync( url, onProgress ) {\n\n\t\tconst scope = this;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tscope.load( url, resolve, onProgress, reject );\n\n\t\t} );\n\n\t}\n\n\tparse( /* data */ ) {}\n\n\tsetCrossOrigin( crossOrigin ) {\n\n\t\tthis.crossOrigin = crossOrigin;\n\t\treturn this;\n\n\t}\n\n\tsetWithCredentials( value ) {\n\n\t\tthis.withCredentials = value;\n\t\treturn this;\n\n\t}\n\n\tsetPath( path ) {\n\n\t\tthis.path = path;\n\t\treturn this;\n\n\t}\n\n\tsetResourcePath( resourcePath ) {\n\n\t\tthis.resourcePath = resourcePath;\n\t\treturn this;\n\n\t}\n\n\tsetRequestHeader( requestHeader ) {\n\n\t\tthis.requestHeader = requestHeader;\n\t\treturn this;\n\n\t}\n\n}\n\nexport { Loader };\n","function arrayMin( array ) {\n\n\tif ( array.length === 0 ) return Infinity;\n\n\tlet min = array[ 0 ];\n\n\tfor ( let i = 1, l = array.length; i < l; ++ i ) {\n\n\t\tif ( array[ i ] < min ) min = array[ i ];\n\n\t}\n\n\treturn min;\n\n}\n\nfunction arrayMax( array ) {\n\n\tif ( array.length === 0 ) return - Infinity;\n\n\tlet max = array[ 0 ];\n\n\tfor ( let i = 1, l = array.length; i < l; ++ i ) {\n\n\t\tif ( array[ i ] > max ) max = array[ i ];\n\n\t}\n\n\treturn max;\n\n}\n\nconst TYPED_ARRAYS = {\n\tInt8Array: Int8Array,\n\tUint8Array: Uint8Array,\n\tUint8ClampedArray: Uint8ClampedArray,\n\tInt16Array: Int16Array,\n\tUint16Array: Uint16Array,\n\tInt32Array: Int32Array,\n\tUint32Array: Uint32Array,\n\tFloat32Array: Float32Array,\n\tFloat64Array: Float64Array\n};\n\nfunction getTypedArray( type, buffer ) {\n\n\treturn new TYPED_ARRAYS[ type ]( buffer );\n\n}\n\nfunction createElementNS( name ) {\n\n\treturn document.createElementNS( 'http://www.w3.org/1999/xhtml', name );\n\n}\n\n/**\n  * cyrb53 hash for string from: https://stackoverflow.com/a/52171480\n  *\n  * Public Domain, @bryc - https://stackoverflow.com/users/815680/bryc\n  *\n  * It is roughly similar to the well-known MurmurHash/xxHash algorithms. It uses a combination\n  * of multiplication and Xorshift to generate the hash, but not as thorough. As a result it's\n  * faster than either would be in JavaScript and significantly simpler to implement. Keep in\n  * mind this is not a secure algorithm, if privacy/security is a concern, this is not for you.\n  *\n  * @param {string} str\n  * @param {number} seed, default 0\n  * @returns number\n  */\nfunction hashString( str, seed = 0 ) {\n\n\tlet h1 = 0xdeadbeef ^ seed, h2 = 0x41c6ce57 ^ seed;\n\n\tfor ( let i = 0, ch; i < str.length; i ++ ) {\n\n\t\tch = str.charCodeAt( i );\n\n\t\th1 = Math.imul( h1 ^ ch, 2654435761 );\n\n\t\th2 = Math.imul( h2 ^ ch, 1597334677 );\n\n\t}\n\n\th1 = Math.imul( h1 ^ ( h1 >>> 16 ), 2246822507 ) ^ Math.imul( h2 ^ ( h2 >>> 13 ), 3266489909 );\n\n\th2 = Math.imul( h2 ^ ( h2 >>> 16 ), 2246822507 ) ^ Math.imul( h1 ^ ( h1 >>> 13 ), 3266489909 );\n\n\treturn 4294967296 * ( 2097151 & h2 ) + ( h1 >>> 0 );\n\n}\n\nexport { arrayMin, arrayMax, getTypedArray, createElementNS, hashString };\n","import { Cache } from './Cache.js';\nimport { Loader } from './Loader.js';\nimport { createElementNS } from '../utils.js';\n\nclass ImageLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst scope = this;\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tconst image = createElementNS( 'img' );\n\n\t\tfunction onImageLoad() {\n\n\t\t\tremoveEventListeners();\n\n\t\t\tCache.add( url, this );\n\n\t\t\tif ( onLoad ) onLoad( this );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}\n\n\t\tfunction onImageError( event ) {\n\n\t\t\tremoveEventListeners();\n\n\t\t\tif ( onError ) onError( event );\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}\n\n\t\tfunction removeEventListeners() {\n\n\t\t\timage.removeEventListener( 'load', onImageLoad, false );\n\t\t\timage.removeEventListener( 'error', onImageError, false );\n\n\t\t}\n\n\t\timage.addEventListener( 'load', onImageLoad, false );\n\t\timage.addEventListener( 'error', onImageError, false );\n\n\t\tif ( url.substr( 0, 5 ) !== 'data:' ) {\n\n\t\t\tif ( this.crossOrigin !== undefined ) image.crossOrigin = this.crossOrigin;\n\n\t\t}\n\n\t\tscope.manager.itemStart( url );\n\n\t\timage.src = url;\n\n\t\treturn image;\n\n\t}\n\n}\n\n\nexport { ImageLoader };\n","/**\n * https://github.com/mrdoob/eventdispatcher.js/\n */\n\nclass EventDispatcher {\n\n\taddEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) this._listeners = {};\n\n\t\tconst listeners = this._listeners;\n\n\t\tif ( listeners[ type ] === undefined ) {\n\n\t\t\tlisteners[ type ] = [];\n\n\t\t}\n\n\t\tif ( listeners[ type ].indexOf( listener ) === - 1 ) {\n\n\t\t\tlisteners[ type ].push( listener );\n\n\t\t}\n\n\t}\n\n\thasEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) return false;\n\n\t\tconst listeners = this._listeners;\n\n\t\treturn listeners[ type ] !== undefined && listeners[ type ].indexOf( listener ) !== - 1;\n\n\t}\n\n\tremoveEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) return;\n\n\t\tconst listeners = this._listeners;\n\t\tconst listenerArray = listeners[ type ];\n\n\t\tif ( listenerArray !== undefined ) {\n\n\t\t\tconst index = listenerArray.indexOf( listener );\n\n\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\tlistenerArray.splice( index, 1 );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tdispatchEvent( event ) {\n\n\t\tif ( this._listeners === undefined ) return;\n\n\t\tconst listeners = this._listeners;\n\t\tconst listenerArray = listeners[ event.type ];\n\n\t\tif ( listenerArray !== undefined ) {\n\n\t\t\tevent.target = this;\n\n\t\t\t// Make a copy, in case listeners are removed while iterating.\n\t\t\tconst array = listenerArray.slice( 0 );\n\n\t\t\tfor ( let i = 0, l = array.length; i < l; i ++ ) {\n\n\t\t\t\tarray[ i ].call( this, event );\n\n\t\t\t}\n\n\t\t\tevent.target = null;\n\n\t\t}\n\n\t}\n\n}\n\n\nexport { EventDispatcher };\n","export const REVISION = '134';\nexport const MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2, ROTATE: 0, DOLLY: 1, PAN: 2 };\nexport const TOUCH = { ROTATE: 0, PAN: 1, DOLLY_PAN: 2, DOLLY_ROTATE: 3 };\nexport const CullFaceNone = 0;\nexport const CullFaceBack = 1;\nexport const CullFaceFront = 2;\nexport const CullFaceFrontBack = 3;\nexport const BasicShadowMap = 0;\nexport const PCFShadowMap = 1;\nexport const PCFSoftShadowMap = 2;\nexport const VSMShadowMap = 3;\nexport const FrontSide = 0;\nexport const BackSide = 1;\nexport const DoubleSide = 2;\nexport const FlatShading = 1;\nexport const SmoothShading = 2;\nexport const NoBlending = 0;\nexport const NormalBlending = 1;\nexport const AdditiveBlending = 2;\nexport const SubtractiveBlending = 3;\nexport const MultiplyBlending = 4;\nexport const CustomBlending = 5;\nexport const AddEquation = 100;\nexport const SubtractEquation = 101;\nexport const ReverseSubtractEquation = 102;\nexport const MinEquation = 103;\nexport const MaxEquation = 104;\nexport const ZeroFactor = 200;\nexport const OneFactor = 201;\nexport const SrcColorFactor = 202;\nexport const OneMinusSrcColorFactor = 203;\nexport const SrcAlphaFactor = 204;\nexport const OneMinusSrcAlphaFactor = 205;\nexport const DstAlphaFactor = 206;\nexport const OneMinusDstAlphaFactor = 207;\nexport const DstColorFactor = 208;\nexport const OneMinusDstColorFactor = 209;\nexport const SrcAlphaSaturateFactor = 210;\nexport const NeverDepth = 0;\nexport const AlwaysDepth = 1;\nexport const LessDepth = 2;\nexport const LessEqualDepth = 3;\nexport const EqualDepth = 4;\nexport const GreaterEqualDepth = 5;\nexport const GreaterDepth = 6;\nexport const NotEqualDepth = 7;\nexport const MultiplyOperation = 0;\nexport const MixOperation = 1;\nexport const AddOperation = 2;\nexport const NoToneMapping = 0;\nexport const LinearToneMapping = 1;\nexport const ReinhardToneMapping = 2;\nexport const CineonToneMapping = 3;\nexport const ACESFilmicToneMapping = 4;\nexport const CustomToneMapping = 5;\n\nexport const UVMapping = 300;\nexport const CubeReflectionMapping = 301;\nexport const CubeRefractionMapping = 302;\nexport const EquirectangularReflectionMapping = 303;\nexport const EquirectangularRefractionMapping = 304;\nexport const CubeUVReflectionMapping = 306;\nexport const CubeUVRefractionMapping = 307;\nexport const RepeatWrapping = 1000;\nexport const ClampToEdgeWrapping = 1001;\nexport const MirroredRepeatWrapping = 1002;\nexport const NearestFilter = 1003;\nexport const NearestMipmapNearestFilter = 1004;\nexport const NearestMipMapNearestFilter = 1004;\nexport const NearestMipmapLinearFilter = 1005;\nexport const NearestMipMapLinearFilter = 1005;\nexport const LinearFilter = 1006;\nexport const LinearMipmapNearestFilter = 1007;\nexport const LinearMipMapNearestFilter = 1007;\nexport const LinearMipmapLinearFilter = 1008;\nexport const LinearMipMapLinearFilter = 1008;\nexport const UnsignedByteType = 1009;\nexport const ByteType = 1010;\nexport const ShortType = 1011;\nexport const UnsignedShortType = 1012;\nexport const IntType = 1013;\nexport const UnsignedIntType = 1014;\nexport const FloatType = 1015;\nexport const HalfFloatType = 1016;\nexport const UnsignedShort4444Type = 1017;\nexport const UnsignedShort5551Type = 1018;\nexport const UnsignedShort565Type = 1019;\nexport const UnsignedInt248Type = 1020;\nexport const AlphaFormat = 1021;\nexport const RGBFormat = 1022;\nexport const RGBAFormat = 1023;\nexport const LuminanceFormat = 1024;\nexport const LuminanceAlphaFormat = 1025;\nexport const RGBEFormat = RGBAFormat;\nexport const DepthFormat = 1026;\nexport const DepthStencilFormat = 1027;\nexport const RedFormat = 1028;\nexport const RedIntegerFormat = 1029;\nexport const RGFormat = 1030;\nexport const RGIntegerFormat = 1031;\nexport const RGBIntegerFormat = 1032;\nexport const RGBAIntegerFormat = 1033;\n\nexport const RGB_S3TC_DXT1_Format = 33776;\nexport const RGBA_S3TC_DXT1_Format = 33777;\nexport const RGBA_S3TC_DXT3_Format = 33778;\nexport const RGBA_S3TC_DXT5_Format = 33779;\nexport const RGB_PVRTC_4BPPV1_Format = 35840;\nexport const RGB_PVRTC_2BPPV1_Format = 35841;\nexport const RGBA_PVRTC_4BPPV1_Format = 35842;\nexport const RGBA_PVRTC_2BPPV1_Format = 35843;\nexport const RGB_ETC1_Format = 36196;\nexport const RGB_ETC2_Format = 37492;\nexport const RGBA_ETC2_EAC_Format = 37496;\nexport const RGBA_ASTC_4x4_Format = 37808;\nexport const RGBA_ASTC_5x4_Format = 37809;\nexport const RGBA_ASTC_5x5_Format = 37810;\nexport const RGBA_ASTC_6x5_Format = 37811;\nexport const RGBA_ASTC_6x6_Format = 37812;\nexport const RGBA_ASTC_8x5_Format = 37813;\nexport const RGBA_ASTC_8x6_Format = 37814;\nexport const RGBA_ASTC_8x8_Format = 37815;\nexport const RGBA_ASTC_10x5_Format = 37816;\nexport const RGBA_ASTC_10x6_Format = 37817;\nexport const RGBA_ASTC_10x8_Format = 37818;\nexport const RGBA_ASTC_10x10_Format = 37819;\nexport const RGBA_ASTC_12x10_Format = 37820;\nexport const RGBA_ASTC_12x12_Format = 37821;\nexport const RGBA_BPTC_Format = 36492;\nexport const SRGB8_ALPHA8_ASTC_4x4_Format = 37840;\nexport const SRGB8_ALPHA8_ASTC_5x4_Format = 37841;\nexport const SRGB8_ALPHA8_ASTC_5x5_Format = 37842;\nexport const SRGB8_ALPHA8_ASTC_6x5_Format = 37843;\nexport const SRGB8_ALPHA8_ASTC_6x6_Format = 37844;\nexport const SRGB8_ALPHA8_ASTC_8x5_Format = 37845;\nexport const SRGB8_ALPHA8_ASTC_8x6_Format = 37846;\nexport const SRGB8_ALPHA8_ASTC_8x8_Format = 37847;\nexport const SRGB8_ALPHA8_ASTC_10x5_Format = 37848;\nexport const SRGB8_ALPHA8_ASTC_10x6_Format = 37849;\nexport const SRGB8_ALPHA8_ASTC_10x8_Format = 37850;\nexport const SRGB8_ALPHA8_ASTC_10x10_Format = 37851;\nexport const SRGB8_ALPHA8_ASTC_12x10_Format = 37852;\nexport const SRGB8_ALPHA8_ASTC_12x12_Format = 37853;\nexport const LoopOnce = 2200;\nexport const LoopRepeat = 2201;\nexport const LoopPingPong = 2202;\nexport const InterpolateDiscrete = 2300;\nexport const InterpolateLinear = 2301;\nexport const InterpolateSmooth = 2302;\nexport const ZeroCurvatureEnding = 2400;\nexport const ZeroSlopeEnding = 2401;\nexport const WrapAroundEnding = 2402;\nexport const NormalAnimationBlendMode = 2500;\nexport const AdditiveAnimationBlendMode = 2501;\nexport const TrianglesDrawMode = 0;\nexport const TriangleStripDrawMode = 1;\nexport const TriangleFanDrawMode = 2;\nexport const LinearEncoding = 3000;\nexport const sRGBEncoding = 3001;\nexport const GammaEncoding = 3007;\nexport const RGBEEncoding = 3002;\nexport const LogLuvEncoding = 3003;\nexport const RGBM7Encoding = 3004;\nexport const RGBM16Encoding = 3005;\nexport const RGBDEncoding = 3006;\nexport const BasicDepthPacking = 3200;\nexport const RGBADepthPacking = 3201;\nexport const TangentSpaceNormalMap = 0;\nexport const ObjectSpaceNormalMap = 1;\n\nexport const ZeroStencilOp = 0;\nexport const KeepStencilOp = 7680;\nexport const ReplaceStencilOp = 7681;\nexport const IncrementStencilOp = 7682;\nexport const DecrementStencilOp = 7683;\nexport const IncrementWrapStencilOp = 34055;\nexport const DecrementWrapStencilOp = 34056;\nexport const InvertStencilOp = 5386;\n\nexport const NeverStencilFunc = 512;\nexport const LessStencilFunc = 513;\nexport const EqualStencilFunc = 514;\nexport const LessEqualStencilFunc = 515;\nexport const GreaterStencilFunc = 516;\nexport const NotEqualStencilFunc = 517;\nexport const GreaterEqualStencilFunc = 518;\nexport const AlwaysStencilFunc = 519;\n\nexport const StaticDrawUsage = 35044;\nexport const DynamicDrawUsage = 35048;\nexport const StreamDrawUsage = 35040;\nexport const StaticReadUsage = 35045;\nexport const DynamicReadUsage = 35049;\nexport const StreamReadUsage = 35041;\nexport const StaticCopyUsage = 35046;\nexport const DynamicCopyUsage = 35050;\nexport const StreamCopyUsage = 35042;\n\nexport const GLSL1 = '100';\nexport const GLSL3 = '300 es';\n","let _seed = 1234567;\n\nconst DEG2RAD = Math.PI / 180;\nconst RAD2DEG = 180 / Math.PI;\n\n//\n\nconst _lut = [];\n\nfor ( let i = 0; i < 256; i ++ ) {\n\n\t_lut[ i ] = ( i < 16 ? '0' : '' ) + ( i ).toString( 16 );\n\n}\n\nconst hasRandomUUID = typeof crypto !== 'undefined' && 'randomUUID' in crypto;\n\nfunction generateUUID() {\n\n\tif ( hasRandomUUID ) {\n\n\t\treturn crypto.randomUUID().toUpperCase();\n\n\t}\n\n\t// TODO Remove this code when crypto.randomUUID() is available everywhere\n\t// http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\n\n\tconst d0 = Math.random() * 0xffffffff | 0;\n\tconst d1 = Math.random() * 0xffffffff | 0;\n\tconst d2 = Math.random() * 0xffffffff | 0;\n\tconst d3 = Math.random() * 0xffffffff | 0;\n\tconst uuid = _lut[ d0 & 0xff ] + _lut[ d0 >> 8 & 0xff ] + _lut[ d0 >> 16 & 0xff ] + _lut[ d0 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d1 & 0xff ] + _lut[ d1 >> 8 & 0xff ] + '-' + _lut[ d1 >> 16 & 0x0f | 0x40 ] + _lut[ d1 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d2 & 0x3f | 0x80 ] + _lut[ d2 >> 8 & 0xff ] + '-' + _lut[ d2 >> 16 & 0xff ] + _lut[ d2 >> 24 & 0xff ] +\n\t\t\t_lut[ d3 & 0xff ] + _lut[ d3 >> 8 & 0xff ] + _lut[ d3 >> 16 & 0xff ] + _lut[ d3 >> 24 & 0xff ];\n\n\t// .toUpperCase() here flattens concatenated strings to save heap memory space.\n\treturn uuid.toUpperCase();\n\n}\n\nfunction clamp( value, min, max ) {\n\n\treturn Math.max( min, Math.min( max, value ) );\n\n}\n\n// compute euclidian modulo of m % n\n// https://en.wikipedia.org/wiki/Modulo_operation\nfunction euclideanModulo( n, m ) {\n\n\treturn ( ( n % m ) + m ) % m;\n\n}\n\n// Linear mapping from range <a1, a2> to range <b1, b2>\nfunction mapLinear( x, a1, a2, b1, b2 ) {\n\n\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\n\n}\n\n// https://www.gamedev.net/tutorials/programming/general-and-gameplay-programming/inverse-lerp-a-super-useful-yet-often-overlooked-function-r5230/\nfunction inverseLerp( x, y, value ) {\n\n\tif ( x !== y ) {\n\n\t\treturn ( value - x ) / ( y - x );\n\n\t} else {\n\n\t\treturn 0;\n\n\t}\n\n}\n\n// https://en.wikipedia.org/wiki/Linear_interpolation\nfunction lerp( x, y, t ) {\n\n\treturn ( 1 - t ) * x + t * y;\n\n}\n\n// http://www.rorydriscoll.com/2016/03/07/frame-rate-independent-damping-using-lerp/\nfunction damp( x, y, lambda, dt ) {\n\n\treturn lerp( x, y, 1 - Math.exp( - lambda * dt ) );\n\n}\n\n// https://www.desmos.com/calculator/vcsjnyz7x4\nfunction pingpong( x, length = 1 ) {\n\n\treturn length - Math.abs( euclideanModulo( x, length * 2 ) - length );\n\n}\n\n// http://en.wikipedia.org/wiki/Smoothstep\nfunction smoothstep( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * ( 3 - 2 * x );\n\n}\n\nfunction smootherstep( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\n\n}\n\n// Random integer from <low, high> interval\nfunction randInt( low, high ) {\n\n\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\n\n}\n\n// Random float from <low, high> interval\nfunction randFloat( low, high ) {\n\n\treturn low + Math.random() * ( high - low );\n\n}\n\n// Random float from <-range/2, range/2> interval\nfunction randFloatSpread( range ) {\n\n\treturn range * ( 0.5 - Math.random() );\n\n}\n\n// Deterministic pseudo-random float in the interval [ 0, 1 ]\nfunction seededRandom( s ) {\n\n\tif ( s !== undefined ) _seed = s % 2147483647;\n\n\t// Park-Miller algorithm\n\n\t_seed = _seed * 16807 % 2147483647;\n\n\treturn ( _seed - 1 ) / 2147483646;\n\n}\n\nfunction degToRad( degrees ) {\n\n\treturn degrees * DEG2RAD;\n\n}\n\nfunction radToDeg( radians ) {\n\n\treturn radians * RAD2DEG;\n\n}\n\nfunction isPowerOfTwo( value ) {\n\n\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\n\n}\n\nfunction ceilPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.ceil( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction floorPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.floor( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction setQuaternionFromProperEuler( q, a, b, c, order ) {\n\n\t// Intrinsic Proper Euler Angles - see https://en.wikipedia.org/wiki/Euler_angles\n\n\t// rotations are applied to the axes in the order specified by 'order'\n\t// rotation by angle 'a' is applied first, then by angle 'b', then by angle 'c'\n\t// angles are in radians\n\n\tconst cos = Math.cos;\n\tconst sin = Math.sin;\n\n\tconst c2 = cos( b / 2 );\n\tconst s2 = sin( b / 2 );\n\n\tconst c13 = cos( ( a + c ) / 2 );\n\tconst s13 = sin( ( a + c ) / 2 );\n\n\tconst c1_3 = cos( ( a - c ) / 2 );\n\tconst s1_3 = sin( ( a - c ) / 2 );\n\n\tconst c3_1 = cos( ( c - a ) / 2 );\n\tconst s3_1 = sin( ( c - a ) / 2 );\n\n\tswitch ( order ) {\n\n\t\tcase 'XYX':\n\t\t\tq.set( c2 * s13, s2 * c1_3, s2 * s1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YZY':\n\t\t\tq.set( s2 * s1_3, c2 * s13, s2 * c1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZXZ':\n\t\t\tq.set( s2 * c1_3, s2 * s1_3, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'XZX':\n\t\t\tq.set( c2 * s13, s2 * s3_1, s2 * c3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YXY':\n\t\t\tq.set( s2 * c3_1, c2 * s13, s2 * s3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZYZ':\n\t\t\tq.set( s2 * s3_1, s2 * c3_1, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tconsole.warn( 'THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: ' + order );\n\n\t}\n\n}\n\n\n\n\nexport {\n\tDEG2RAD,\n\tRAD2DEG,\n\tgenerateUUID,\n\tclamp,\n\teuclideanModulo,\n\tmapLinear,\n\tinverseLerp,\n\tlerp,\n\tdamp,\n\tpingpong,\n\tsmoothstep,\n\tsmootherstep,\n\trandInt,\n\trandFloat,\n\trandFloatSpread,\n\tseededRandom,\n\tdegToRad,\n\tradToDeg,\n\tisPowerOfTwo,\n\tceilPowerOfTwo,\n\tfloorPowerOfTwo,\n\tsetQuaternionFromProperEuler,\n};\n","class Vector2 {\n\n\tconstructor( x = 0, y = 0 ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\n\t}\n\n\tget width() {\n\n\t\treturn this.x;\n\n\t}\n\n\tset width( value ) {\n\n\t\tthis.x = value;\n\n\t}\n\n\tget height() {\n\n\t\treturn this.y;\n\n\t}\n\n\tset height( value ) {\n\n\t\tthis.y = value;\n\n\t}\n\n\tset( x, y ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\n\t\t\treturn this.addVectors( v, w );\n\n\t\t}\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\n\t\t\treturn this.subVectors( v, w );\n\n\t\t}\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tdivide( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tconst x = this.x, y = this.y;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ];\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ];\n\n\t\treturn this;\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\n\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y;\n\n\t}\n\n\tcross( v ) {\n\n\t\treturn this.x * v.y - this.y * v.x;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tangle() {\n\n\t\t// computes the angle in radians with respect to the positive x-axis\n\n\t\tconst angle = Math.atan2( - this.y, - this.x ) + Math.PI;\n\n\t\treturn angle;\n\n\t}\n\n\tdistanceTo( v ) {\n\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t}\n\n\tdistanceToSquared( v ) {\n\n\t\tconst dx = this.x - v.x, dy = this.y - v.y;\n\t\treturn dx * dx + dy * dy;\n\n\t}\n\n\tmanhattanDistanceTo( v ) {\n\n\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index, offset ) {\n\n\t\tif ( offset !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector2: offset has been removed from .fromBufferAttribute().' );\n\n\t\t}\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\n\t\treturn this;\n\n\t}\n\n\trotateAround( center, angle ) {\n\n\t\tconst c = Math.cos( angle ), s = Math.sin( angle );\n\n\t\tconst x = this.x - center.x;\n\t\tconst y = this.y - center.y;\n\n\t\tthis.x = x * c - y * s + center.x;\n\t\tthis.y = x * s + y * c + center.y;\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\n\t}\n\n}\n\nVector2.prototype.isVector2 = true;\n\nexport { Vector2 };\n","class Matrix3 {\n\n\tconstructor() {\n\n\t\tthis.elements = [\n\n\t\t\t1, 0, 0,\n\t\t\t0, 1, 0,\n\t\t\t0, 0, 1\n\n\t\t];\n\n\t\tif ( arguments.length > 0 ) {\n\n\t\t\tconsole.error( 'THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.' );\n\n\t\t}\n\n\t}\n\n\tset( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 1 ] = n21; te[ 2 ] = n31;\n\t\tte[ 3 ] = n12; te[ 4 ] = n22; te[ 5 ] = n32;\n\t\tte[ 6 ] = n13; te[ 7 ] = n23; te[ 8 ] = n33;\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0,\n\t\t\t0, 1, 0,\n\t\t\t0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tcopy( m ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ];\n\t\tte[ 3 ] = me[ 3 ]; te[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ];\n\t\tte[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ]; te[ 8 ] = me[ 8 ];\n\n\t\treturn this;\n\n\t}\n\n\textractBasis( xAxis, yAxis, zAxis ) {\n\n\t\txAxis.setFromMatrix3Column( this, 0 );\n\t\tyAxis.setFromMatrix3Column( this, 1 );\n\t\tzAxis.setFromMatrix3Column( this, 2 );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrix4( m ) {\n\n\t\tconst me = m.elements;\n\n\t\tthis.set(\n\n\t\t\tme[ 0 ], me[ 4 ], me[ 8 ],\n\t\t\tme[ 1 ], me[ 5 ], me[ 9 ],\n\t\t\tme[ 2 ], me[ 6 ], me[ 10 ]\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( m ) {\n\n\t\treturn this.multiplyMatrices( this, m );\n\n\t}\n\n\tpremultiply( m ) {\n\n\t\treturn this.multiplyMatrices( m, this );\n\n\t}\n\n\tmultiplyMatrices( a, b ) {\n\n\t\tconst ae = a.elements;\n\t\tconst be = b.elements;\n\t\tconst te = this.elements;\n\n\t\tconst a11 = ae[ 0 ], a12 = ae[ 3 ], a13 = ae[ 6 ];\n\t\tconst a21 = ae[ 1 ], a22 = ae[ 4 ], a23 = ae[ 7 ];\n\t\tconst a31 = ae[ 2 ], a32 = ae[ 5 ], a33 = ae[ 8 ];\n\n\t\tconst b11 = be[ 0 ], b12 = be[ 3 ], b13 = be[ 6 ];\n\t\tconst b21 = be[ 1 ], b22 = be[ 4 ], b23 = be[ 7 ];\n\t\tconst b31 = be[ 2 ], b32 = be[ 5 ], b33 = be[ 8 ];\n\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31;\n\t\tte[ 3 ] = a11 * b12 + a12 * b22 + a13 * b32;\n\t\tte[ 6 ] = a11 * b13 + a12 * b23 + a13 * b33;\n\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31;\n\t\tte[ 4 ] = a21 * b12 + a22 * b22 + a23 * b32;\n\t\tte[ 7 ] = a21 * b13 + a22 * b23 + a23 * b33;\n\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31;\n\t\tte[ 5 ] = a31 * b12 + a32 * b22 + a33 * b32;\n\t\tte[ 8 ] = a31 * b13 + a32 * b23 + a33 * b33;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] *= s; te[ 3 ] *= s; te[ 6 ] *= s;\n\t\tte[ 1 ] *= s; te[ 4 ] *= s; te[ 7 ] *= s;\n\t\tte[ 2 ] *= s; te[ 5 ] *= s; te[ 8 ] *= s;\n\n\t\treturn this;\n\n\t}\n\n\tdeterminant() {\n\n\t\tconst te = this.elements;\n\n\t\tconst a = te[ 0 ], b = te[ 1 ], c = te[ 2 ],\n\t\t\td = te[ 3 ], e = te[ 4 ], f = te[ 5 ],\n\t\t\tg = te[ 6 ], h = te[ 7 ], i = te[ 8 ];\n\n\t\treturn a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\n\n\t}\n\n\tinvert() {\n\n\t\tconst te = this.elements,\n\n\t\t\tn11 = te[ 0 ], n21 = te[ 1 ], n31 = te[ 2 ],\n\t\t\tn12 = te[ 3 ], n22 = te[ 4 ], n32 = te[ 5 ],\n\t\t\tn13 = te[ 6 ], n23 = te[ 7 ], n33 = te[ 8 ],\n\n\t\t\tt11 = n33 * n22 - n32 * n23,\n\t\t\tt12 = n32 * n13 - n33 * n12,\n\t\t\tt13 = n23 * n12 - n22 * n13,\n\n\t\t\tdet = n11 * t11 + n21 * t12 + n31 * t13;\n\n\t\tif ( det === 0 ) return this.set( 0, 0, 0, 0, 0, 0, 0, 0, 0 );\n\n\t\tconst detInv = 1 / det;\n\n\t\tte[ 0 ] = t11 * detInv;\n\t\tte[ 1 ] = ( n31 * n23 - n33 * n21 ) * detInv;\n\t\tte[ 2 ] = ( n32 * n21 - n31 * n22 ) * detInv;\n\n\t\tte[ 3 ] = t12 * detInv;\n\t\tte[ 4 ] = ( n33 * n11 - n31 * n13 ) * detInv;\n\t\tte[ 5 ] = ( n31 * n12 - n32 * n11 ) * detInv;\n\n\t\tte[ 6 ] = t13 * detInv;\n\t\tte[ 7 ] = ( n21 * n13 - n23 * n11 ) * detInv;\n\t\tte[ 8 ] = ( n22 * n11 - n21 * n12 ) * detInv;\n\n\t\treturn this;\n\n\t}\n\n\ttranspose() {\n\n\t\tlet tmp;\n\t\tconst m = this.elements;\n\n\t\ttmp = m[ 1 ]; m[ 1 ] = m[ 3 ]; m[ 3 ] = tmp;\n\t\ttmp = m[ 2 ]; m[ 2 ] = m[ 6 ]; m[ 6 ] = tmp;\n\t\ttmp = m[ 5 ]; m[ 5 ] = m[ 7 ]; m[ 7 ] = tmp;\n\n\t\treturn this;\n\n\t}\n\n\tgetNormalMatrix( matrix4 ) {\n\n\t\treturn this.setFromMatrix4( matrix4 ).invert().transpose();\n\n\t}\n\n\ttransposeIntoArray( r ) {\n\n\t\tconst m = this.elements;\n\n\t\tr[ 0 ] = m[ 0 ];\n\t\tr[ 1 ] = m[ 3 ];\n\t\tr[ 2 ] = m[ 6 ];\n\t\tr[ 3 ] = m[ 1 ];\n\t\tr[ 4 ] = m[ 4 ];\n\t\tr[ 5 ] = m[ 7 ];\n\t\tr[ 6 ] = m[ 2 ];\n\t\tr[ 7 ] = m[ 5 ];\n\t\tr[ 8 ] = m[ 8 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetUvTransform( tx, ty, sx, sy, rotation, cx, cy ) {\n\n\t\tconst c = Math.cos( rotation );\n\t\tconst s = Math.sin( rotation );\n\n\t\tthis.set(\n\t\t\tsx * c, sx * s, - sx * ( c * cx + s * cy ) + cx + tx,\n\t\t\t- sy * s, sy * c, - sy * ( - s * cx + c * cy ) + cy + ty,\n\t\t\t0, 0, 1\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tscale( sx, sy ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] *= sx; te[ 3 ] *= sx; te[ 6 ] *= sx;\n\t\tte[ 1 ] *= sy; te[ 4 ] *= sy; te[ 7 ] *= sy;\n\n\t\treturn this;\n\n\t}\n\n\trotate( theta ) {\n\n\t\tconst c = Math.cos( theta );\n\t\tconst s = Math.sin( theta );\n\n\t\tconst te = this.elements;\n\n\t\tconst a11 = te[ 0 ], a12 = te[ 3 ], a13 = te[ 6 ];\n\t\tconst a21 = te[ 1 ], a22 = te[ 4 ], a23 = te[ 7 ];\n\n\t\tte[ 0 ] = c * a11 + s * a21;\n\t\tte[ 3 ] = c * a12 + s * a22;\n\t\tte[ 6 ] = c * a13 + s * a23;\n\n\t\tte[ 1 ] = - s * a11 + c * a21;\n\t\tte[ 4 ] = - s * a12 + c * a22;\n\t\tte[ 7 ] = - s * a13 + c * a23;\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( tx, ty ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] += tx * te[ 2 ]; te[ 3 ] += tx * te[ 5 ]; te[ 6 ] += tx * te[ 8 ];\n\t\tte[ 1 ] += ty * te[ 2 ]; te[ 4 ] += ty * te[ 5 ]; te[ 7 ] += ty * te[ 8 ];\n\n\t\treturn this;\n\n\t}\n\n\tequals( matrix ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = matrix.elements;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst te = this.elements;\n\n\t\tarray[ offset ] = te[ 0 ];\n\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\tarray[ offset + 2 ] = te[ 2 ];\n\n\t\tarray[ offset + 3 ] = te[ 3 ];\n\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\tarray[ offset + 5 ] = te[ 5 ];\n\n\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\tarray[ offset + 7 ] = te[ 7 ];\n\t\tarray[ offset + 8 ] = te[ 8 ];\n\n\t\treturn array;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().fromArray( this.elements );\n\n\t}\n\n}\n\nMatrix3.prototype.isMatrix3 = true;\n\nexport { Matrix3 };\n","import { createElementNS } from '../utils.js';\n\nlet _canvas;\n\nclass ImageUtils {\n\n\tstatic getDataURL( image ) {\n\n\t\tif ( /^data:/i.test( image.src ) ) {\n\n\t\t\treturn image.src;\n\n\t\t}\n\n\t\tif ( typeof HTMLCanvasElement == 'undefined' ) {\n\n\t\t\treturn image.src;\n\n\t\t}\n\n\t\tlet canvas;\n\n\t\tif ( image instanceof HTMLCanvasElement ) {\n\n\t\t\tcanvas = image;\n\n\t\t} else {\n\n\t\t\tif ( _canvas === undefined ) _canvas = createElementNS( 'canvas' );\n\n\t\t\t_canvas.width = image.width;\n\t\t\t_canvas.height = image.height;\n\n\t\t\tconst context = _canvas.getContext( '2d' );\n\n\t\t\tif ( image instanceof ImageData ) {\n\n\t\t\t\tcontext.putImageData( image, 0, 0 );\n\n\t\t\t} else {\n\n\t\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height );\n\n\t\t\t}\n\n\t\t\tcanvas = _canvas;\n\n\t\t}\n\n\t\tif ( canvas.width > 2048 || canvas.height > 2048 ) {\n\n\t\t\tconsole.warn( 'THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons', image );\n\n\t\t\treturn canvas.toDataURL( 'image/jpeg', 0.6 );\n\n\t\t} else {\n\n\t\t\treturn canvas.toDataURL( 'image/png' );\n\n\t\t}\n\n\t}\n\n}\n\nexport { ImageUtils };\n","import { EventDispatcher } from '../core/EventDispatcher.js';\nimport {\n\tMirroredRepeatWrapping,\n\tClampToEdgeWrapping,\n\tRepeatWrapping,\n\tLinearEncoding,\n\tUnsignedByteType,\n\tRGBAFormat,\n\tLinearMipmapLinearFilter,\n\tLinearFilter,\n\tUVMapping\n} from '../constants.js';\nimport * as MathUtils from '../math/MathUtils.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Matrix3 } from '../math/Matrix3.js';\nimport { ImageUtils } from '../extras/ImageUtils.js';\n\nlet textureId = 0;\n\nclass Texture extends EventDispatcher {\n\n\tconstructor( image = Texture.DEFAULT_IMAGE, mapping = Texture.DEFAULT_MAPPING, wrapS = ClampToEdgeWrapping, wrapT = ClampToEdgeWrapping, magFilter = LinearFilter, minFilter = LinearMipmapLinearFilter, format = RGBAFormat, type = UnsignedByteType, anisotropy = 1, encoding = LinearEncoding ) {\n\n\t\tsuper();\n\n\t\tObject.defineProperty( this, 'id', { value: textureId ++ } );\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.name = '';\n\n\t\tthis.image = image;\n\t\tthis.mipmaps = [];\n\n\t\tthis.mapping = mapping;\n\n\t\tthis.wrapS = wrapS;\n\t\tthis.wrapT = wrapT;\n\n\t\tthis.magFilter = magFilter;\n\t\tthis.minFilter = minFilter;\n\n\t\tthis.anisotropy = anisotropy;\n\n\t\tthis.format = format;\n\t\tthis.internalFormat = null;\n\t\tthis.type = type;\n\n\t\tthis.offset = new Vector2( 0, 0 );\n\t\tthis.repeat = new Vector2( 1, 1 );\n\t\tthis.center = new Vector2( 0, 0 );\n\t\tthis.rotation = 0;\n\n\t\tthis.matrixAutoUpdate = true;\n\t\tthis.matrix = new Matrix3();\n\n\t\tthis.generateMipmaps = true;\n\t\tthis.premultiplyAlpha = false;\n\t\tthis.flipY = true;\n\t\tthis.unpackAlignment = 4;\t// valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\n\n\t\t// Values of encoding !== THREE.LinearEncoding only supported on map, envMap and emissiveMap.\n\t\t//\n\t\t// Also changing the encoding after already used by a Material will not automatically make the Material\n\t\t// update. You need to explicitly call Material.needsUpdate to trigger it to recompile.\n\t\tthis.encoding = encoding;\n\n\t\tthis.userData = {};\n\n\t\tthis.version = 0;\n\t\tthis.onUpdate = null;\n\n\t\tthis.isRenderTargetTexture = false;\n\n\t}\n\n\tupdateMatrix() {\n\n\t\tthis.matrix.setUvTransform( this.offset.x, this.offset.y, this.repeat.x, this.repeat.y, this.rotation, this.center.x, this.center.y );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.image = source.image;\n\t\tthis.mipmaps = source.mipmaps.slice( 0 );\n\n\t\tthis.mapping = source.mapping;\n\n\t\tthis.wrapS = source.wrapS;\n\t\tthis.wrapT = source.wrapT;\n\n\t\tthis.magFilter = source.magFilter;\n\t\tthis.minFilter = source.minFilter;\n\n\t\tthis.anisotropy = source.anisotropy;\n\n\t\tthis.format = source.format;\n\t\tthis.internalFormat = source.internalFormat;\n\t\tthis.type = source.type;\n\n\t\tthis.offset.copy( source.offset );\n\t\tthis.repeat.copy( source.repeat );\n\t\tthis.center.copy( source.center );\n\t\tthis.rotation = source.rotation;\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\t\tthis.matrix.copy( source.matrix );\n\n\t\tthis.generateMipmaps = source.generateMipmaps;\n\t\tthis.premultiplyAlpha = source.premultiplyAlpha;\n\t\tthis.flipY = source.flipY;\n\t\tthis.unpackAlignment = source.unpackAlignment;\n\t\tthis.encoding = source.encoding;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( ! isRootObject && meta.textures[ this.uuid ] !== undefined ) {\n\n\t\t\treturn meta.textures[ this.uuid ];\n\n\t\t}\n\n\t\tconst output = {\n\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Texture',\n\t\t\t\tgenerator: 'Texture.toJSON'\n\t\t\t},\n\n\t\t\tuuid: this.uuid,\n\t\t\tname: this.name,\n\n\t\t\tmapping: this.mapping,\n\n\t\t\trepeat: [ this.repeat.x, this.repeat.y ],\n\t\t\toffset: [ this.offset.x, this.offset.y ],\n\t\t\tcenter: [ this.center.x, this.center.y ],\n\t\t\trotation: this.rotation,\n\n\t\t\twrap: [ this.wrapS, this.wrapT ],\n\n\t\t\tformat: this.format,\n\t\t\ttype: this.type,\n\t\t\tencoding: this.encoding,\n\n\t\t\tminFilter: this.minFilter,\n\t\t\tmagFilter: this.magFilter,\n\t\t\tanisotropy: this.anisotropy,\n\n\t\t\tflipY: this.flipY,\n\n\t\t\tpremultiplyAlpha: this.premultiplyAlpha,\n\t\t\tunpackAlignment: this.unpackAlignment\n\n\t\t};\n\n\t\tif ( this.image !== undefined ) {\n\n\t\t\t// TODO: Move to THREE.Image\n\n\t\t\tconst image = this.image;\n\n\t\t\tif ( image.uuid === undefined ) {\n\n\t\t\t\timage.uuid = MathUtils.generateUUID(); // UGH\n\n\t\t\t}\n\n\t\t\tif ( ! isRootObject && meta.images[ image.uuid ] === undefined ) {\n\n\t\t\t\tlet url;\n\n\t\t\t\tif ( Array.isArray( image ) ) {\n\n\t\t\t\t\t// process array of images e.g. CubeTexture\n\n\t\t\t\t\turl = [];\n\n\t\t\t\t\tfor ( let i = 0, l = image.length; i < l; i ++ ) {\n\n\t\t\t\t\t\t// check cube texture with data textures\n\n\t\t\t\t\t\tif ( image[ i ].isDataTexture ) {\n\n\t\t\t\t\t\t\turl.push( serializeImage( image[ i ].image ) );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\turl.push( serializeImage( image[ i ] ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// process single image\n\n\t\t\t\t\turl = serializeImage( image );\n\n\t\t\t\t}\n\n\t\t\t\tmeta.images[ image.uuid ] = {\n\t\t\t\t\tuuid: image.uuid,\n\t\t\t\t\turl: url\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\toutput.image = image.uuid;\n\n\t\t}\n\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) output.userData = this.userData;\n\n\t\tif ( ! isRootObject ) {\n\n\t\t\tmeta.textures[ this.uuid ] = output;\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\ttransformUv( uv ) {\n\n\t\tif ( this.mapping !== UVMapping ) return uv;\n\n\t\tuv.applyMatrix3( this.matrix );\n\n\t\tif ( uv.x < 0 || uv.x > 1 ) {\n\n\t\t\tswitch ( this.wrapS ) {\n\n\t\t\t\tcase RepeatWrapping:\n\n\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ClampToEdgeWrapping:\n\n\t\t\t\t\tuv.x = uv.x < 0 ? 0 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MirroredRepeatWrapping:\n\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.x ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\tuv.x = Math.ceil( uv.x ) - uv.x;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( uv.y < 0 || uv.y > 1 ) {\n\n\t\t\tswitch ( this.wrapT ) {\n\n\t\t\t\tcase RepeatWrapping:\n\n\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ClampToEdgeWrapping:\n\n\t\t\t\t\tuv.y = uv.y < 0 ? 0 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MirroredRepeatWrapping:\n\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.y ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\tuv.y = Math.ceil( uv.y ) - uv.y;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.flipY ) {\n\n\t\t\tuv.y = 1 - uv.y;\n\n\t\t}\n\n\t\treturn uv;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n}\n\nTexture.DEFAULT_IMAGE = undefined;\nTexture.DEFAULT_MAPPING = UVMapping;\n\nTexture.prototype.isTexture = true;\n\nfunction serializeImage( image ) {\n\n\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\t// default images\n\n\t\treturn ImageUtils.getDataURL( image );\n\n\t} else {\n\n\t\tif ( image.data ) {\n\n\t\t\t// images of DataTexture\n\n\t\t\treturn {\n\t\t\t\tdata: Array.prototype.slice.call( image.data ),\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height,\n\t\t\t\ttype: image.data.constructor.name\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.Texture: Unable to serialize Texture.' );\n\t\t\treturn {};\n\n\t\t}\n\n\t}\n\n}\n\nexport { Texture };\n","import { ImageLoader } from './ImageLoader.js';\nimport { Texture } from '../textures/Texture.js';\nimport { Loader } from './Loader.js';\n\nclass TextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst texture = new Texture();\n\n\t\tconst loader = new ImageLoader( this.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.setPath( this.path );\n\n\t\tloader.load( url, function ( image ) {\n\n\t\t\ttexture.image = image;\n\t\t\ttexture.needsUpdate = true;\n\n\t\t\tif ( onLoad !== undefined ) {\n\n\t\t\t\tonLoad( texture );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t\treturn texture;\n\n\t}\n\n}\n\n\nexport { TextureLoader };\n","import { EventDispatcher } from '../core/EventDispatcher.js';\nimport { FrontSide, FlatShading, NormalBlending, LessEqualDepth, AddEquation, OneMinusSrcAlphaFactor, SrcAlphaFactor, AlwaysStencilFunc, KeepStencilOp, RGBAFormat } from '../constants.js';\nimport * as MathUtils from '../math/MathUtils.js';\n\nlet materialId = 0;\n\nclass Material extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tObject.defineProperty( this, 'id', { value: materialId ++ } );\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'Material';\n\n\t\tthis.fog = true;\n\n\t\tthis.blending = NormalBlending;\n\t\tthis.side = FrontSide;\n\t\tthis.vertexColors = false;\n\n\t\tthis.opacity = 1;\n\t\tthis.format = RGBAFormat;\n\t\tthis.transparent = false;\n\n\t\tthis.blendSrc = SrcAlphaFactor;\n\t\tthis.blendDst = OneMinusSrcAlphaFactor;\n\t\tthis.blendEquation = AddEquation;\n\t\tthis.blendSrcAlpha = null;\n\t\tthis.blendDstAlpha = null;\n\t\tthis.blendEquationAlpha = null;\n\n\t\tthis.depthFunc = LessEqualDepth;\n\t\tthis.depthTest = true;\n\t\tthis.depthWrite = true;\n\n\t\tthis.stencilWriteMask = 0xff;\n\t\tthis.stencilFunc = AlwaysStencilFunc;\n\t\tthis.stencilRef = 0;\n\t\tthis.stencilFuncMask = 0xff;\n\t\tthis.stencilFail = KeepStencilOp;\n\t\tthis.stencilZFail = KeepStencilOp;\n\t\tthis.stencilZPass = KeepStencilOp;\n\t\tthis.stencilWrite = false;\n\n\t\tthis.clippingPlanes = null;\n\t\tthis.clipIntersection = false;\n\t\tthis.clipShadows = false;\n\n\t\tthis.shadowSide = null;\n\n\t\tthis.colorWrite = true;\n\n\t\tthis.precision = null; // override the renderer's default precision for this material\n\n\t\tthis.polygonOffset = false;\n\t\tthis.polygonOffsetFactor = 0;\n\t\tthis.polygonOffsetUnits = 0;\n\n\t\tthis.dithering = false;\n\n\t\tthis.alphaToCoverage = false;\n\t\tthis.premultipliedAlpha = false;\n\n\t\tthis.visible = true;\n\n\t\tthis.toneMapped = true;\n\n\t\tthis.userData = {};\n\n\t\tthis.version = 0;\n\n\t\tthis._alphaTest = 0;\n\n\t}\n\n\tget alphaTest() {\n\n\t\treturn this._alphaTest;\n\n\t}\n\n\tset alphaTest( value ) {\n\n\t\tif ( this._alphaTest > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._alphaTest = value;\n\n\t}\n\n\tonBuild( /* shaderobject, renderer */ ) {}\n\n\tonBeforeRender( /* renderer, scene, camera, geometry, object, group */ ) {}\n\n\tonBeforeCompile( /* shaderobject, renderer */ ) {}\n\n\tcustomProgramCacheKey() {\n\n\t\treturn this.onBeforeCompile.toString();\n\n\t}\n\n\tsetValues( values ) {\n\n\t\tif ( values === undefined ) return;\n\n\t\tfor ( const key in values ) {\n\n\t\t\tconst newValue = values[ key ];\n\n\t\t\tif ( newValue === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Material: \\'' + key + '\\' parameter is undefined.' );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\t// for backward compatability if shading is set in the constructor\n\t\t\tif ( key === 'shading' ) {\n\n\t\t\t\tconsole.warn( 'THREE.' + this.type + ': .shading has been removed. Use the boolean .flatShading instead.' );\n\t\t\t\tthis.flatShading = ( newValue === FlatShading ) ? true : false;\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tconst currentValue = this[ key ];\n\n\t\t\tif ( currentValue === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.' + this.type + ': \\'' + key + '\\' is not a property of this material.' );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tif ( currentValue && currentValue.isColor ) {\n\n\t\t\t\tcurrentValue.set( newValue );\n\n\t\t\t} else if ( ( currentValue && currentValue.isVector3 ) && ( newValue && newValue.isVector3 ) ) {\n\n\t\t\t\tcurrentValue.copy( newValue );\n\n\t\t\t} else {\n\n\t\t\t\tthis[ key ] = newValue;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRoot = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( isRoot ) {\n\n\t\t\tmeta = {\n\t\t\t\ttextures: {},\n\t\t\t\timages: {}\n\t\t\t};\n\n\t\t}\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Material',\n\t\t\t\tgenerator: 'Material.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard Material serialization\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\n\t\tif ( this.name !== '' ) data.name = this.name;\n\n\t\tif ( this.color && this.color.isColor ) data.color = this.color.getHex();\n\n\t\tif ( this.roughness !== undefined ) data.roughness = this.roughness;\n\t\tif ( this.metalness !== undefined ) data.metalness = this.metalness;\n\n\t\tif ( this.sheen !== undefined ) data.sheen = this.sheen;\n\t\tif ( this.sheenColor && this.sheenColor.isColor ) data.sheenColor = this.sheenColor.getHex();\n\t\tif ( this.sheenRoughness !== undefined ) data.sheenRoughness = this.sheenRoughness;\n\t\tif ( this.emissive && this.emissive.isColor ) data.emissive = this.emissive.getHex();\n\t\tif ( this.emissiveIntensity && this.emissiveIntensity !== 1 ) data.emissiveIntensity = this.emissiveIntensity;\n\n\t\tif ( this.specular && this.specular.isColor ) data.specular = this.specular.getHex();\n\t\tif ( this.specularIntensity !== undefined ) data.specularIntensity = this.specularIntensity;\n\t\tif ( this.specularColor && this.specularColor.isColor ) data.specularColor = this.specularColor.getHex();\n\t\tif ( this.shininess !== undefined ) data.shininess = this.shininess;\n\t\tif ( this.clearcoat !== undefined ) data.clearcoat = this.clearcoat;\n\t\tif ( this.clearcoatRoughness !== undefined ) data.clearcoatRoughness = this.clearcoatRoughness;\n\n\t\tif ( this.clearcoatMap && this.clearcoatMap.isTexture ) {\n\n\t\t\tdata.clearcoatMap = this.clearcoatMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.clearcoatRoughnessMap && this.clearcoatRoughnessMap.isTexture ) {\n\n\t\t\tdata.clearcoatRoughnessMap = this.clearcoatRoughnessMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.clearcoatNormalMap && this.clearcoatNormalMap.isTexture ) {\n\n\t\t\tdata.clearcoatNormalMap = this.clearcoatNormalMap.toJSON( meta ).uuid;\n\t\t\tdata.clearcoatNormalScale = this.clearcoatNormalScale.toArray();\n\n\t\t}\n\n\t\tif ( this.map && this.map.isTexture ) data.map = this.map.toJSON( meta ).uuid;\n\t\tif ( this.matcap && this.matcap.isTexture ) data.matcap = this.matcap.toJSON( meta ).uuid;\n\t\tif ( this.alphaMap && this.alphaMap.isTexture ) data.alphaMap = this.alphaMap.toJSON( meta ).uuid;\n\n\t\tif ( this.lightMap && this.lightMap.isTexture ) {\n\n\t\t\tdata.lightMap = this.lightMap.toJSON( meta ).uuid;\n\t\t\tdata.lightMapIntensity = this.lightMapIntensity;\n\n\t\t}\n\n\t\tif ( this.aoMap && this.aoMap.isTexture ) {\n\n\t\t\tdata.aoMap = this.aoMap.toJSON( meta ).uuid;\n\t\t\tdata.aoMapIntensity = this.aoMapIntensity;\n\n\t\t}\n\n\t\tif ( this.bumpMap && this.bumpMap.isTexture ) {\n\n\t\t\tdata.bumpMap = this.bumpMap.toJSON( meta ).uuid;\n\t\t\tdata.bumpScale = this.bumpScale;\n\n\t\t}\n\n\t\tif ( this.normalMap && this.normalMap.isTexture ) {\n\n\t\t\tdata.normalMap = this.normalMap.toJSON( meta ).uuid;\n\t\t\tdata.normalMapType = this.normalMapType;\n\t\t\tdata.normalScale = this.normalScale.toArray();\n\n\t\t}\n\n\t\tif ( this.displacementMap && this.displacementMap.isTexture ) {\n\n\t\t\tdata.displacementMap = this.displacementMap.toJSON( meta ).uuid;\n\t\t\tdata.displacementScale = this.displacementScale;\n\t\t\tdata.displacementBias = this.displacementBias;\n\n\t\t}\n\n\t\tif ( this.roughnessMap && this.roughnessMap.isTexture ) data.roughnessMap = this.roughnessMap.toJSON( meta ).uuid;\n\t\tif ( this.metalnessMap && this.metalnessMap.isTexture ) data.metalnessMap = this.metalnessMap.toJSON( meta ).uuid;\n\n\t\tif ( this.emissiveMap && this.emissiveMap.isTexture ) data.emissiveMap = this.emissiveMap.toJSON( meta ).uuid;\n\t\tif ( this.specularMap && this.specularMap.isTexture ) data.specularMap = this.specularMap.toJSON( meta ).uuid;\n\t\tif ( this.specularIntensityMap && this.specularIntensityMap.isTexture ) data.specularIntensityMap = this.specularIntensityMap.toJSON( meta ).uuid;\n\t\tif ( this.specularColorMap && this.specularColorMap.isTexture ) data.specularColorMap = this.specularColorMap.toJSON( meta ).uuid;\n\n\t\tif ( this.envMap && this.envMap.isTexture ) {\n\n\t\t\tdata.envMap = this.envMap.toJSON( meta ).uuid;\n\n\t\t\tif ( this.combine !== undefined ) data.combine = this.combine;\n\n\t\t}\n\n\t\tif ( this.envMapIntensity !== undefined ) data.envMapIntensity = this.envMapIntensity;\n\t\tif ( this.reflectivity !== undefined ) data.reflectivity = this.reflectivity;\n\t\tif ( this.refractionRatio !== undefined ) data.refractionRatio = this.refractionRatio;\n\n\t\tif ( this.gradientMap && this.gradientMap.isTexture ) {\n\n\t\t\tdata.gradientMap = this.gradientMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.transmission !== undefined ) data.transmission = this.transmission;\n\t\tif ( this.transmissionMap && this.transmissionMap.isTexture ) data.transmissionMap = this.transmissionMap.toJSON( meta ).uuid;\n\t\tif ( this.thickness !== undefined ) data.thickness = this.thickness;\n\t\tif ( this.thicknessMap && this.thicknessMap.isTexture ) data.thicknessMap = this.thicknessMap.toJSON( meta ).uuid;\n\t\tif ( this.attenuationDistance !== undefined ) data.attenuationDistance = this.attenuationDistance;\n\t\tif ( this.attenuationColor !== undefined ) data.attenuationColor = this.attenuationColor.getHex();\n\n\t\tif ( this.size !== undefined ) data.size = this.size;\n\t\tif ( this.shadowSide !== null ) data.shadowSide = this.shadowSide;\n\t\tif ( this.sizeAttenuation !== undefined ) data.sizeAttenuation = this.sizeAttenuation;\n\n\t\tif ( this.blending !== NormalBlending ) data.blending = this.blending;\n\t\tif ( this.side !== FrontSide ) data.side = this.side;\n\t\tif ( this.vertexColors ) data.vertexColors = true;\n\n\t\tif ( this.opacity < 1 ) data.opacity = this.opacity;\n\t\tif ( this.format !== RGBAFormat ) data.format = this.format;\n\t\tif ( this.transparent === true ) data.transparent = this.transparent;\n\n\t\tdata.depthFunc = this.depthFunc;\n\t\tdata.depthTest = this.depthTest;\n\t\tdata.depthWrite = this.depthWrite;\n\t\tdata.colorWrite = this.colorWrite;\n\n\t\tdata.stencilWrite = this.stencilWrite;\n\t\tdata.stencilWriteMask = this.stencilWriteMask;\n\t\tdata.stencilFunc = this.stencilFunc;\n\t\tdata.stencilRef = this.stencilRef;\n\t\tdata.stencilFuncMask = this.stencilFuncMask;\n\t\tdata.stencilFail = this.stencilFail;\n\t\tdata.stencilZFail = this.stencilZFail;\n\t\tdata.stencilZPass = this.stencilZPass;\n\n\t\t// rotation (SpriteMaterial)\n\t\tif ( this.rotation && this.rotation !== 0 ) data.rotation = this.rotation;\n\n\t\tif ( this.polygonOffset === true ) data.polygonOffset = true;\n\t\tif ( this.polygonOffsetFactor !== 0 ) data.polygonOffsetFactor = this.polygonOffsetFactor;\n\t\tif ( this.polygonOffsetUnits !== 0 ) data.polygonOffsetUnits = this.polygonOffsetUnits;\n\n\t\tif ( this.linewidth && this.linewidth !== 1 ) data.linewidth = this.linewidth;\n\t\tif ( this.dashSize !== undefined ) data.dashSize = this.dashSize;\n\t\tif ( this.gapSize !== undefined ) data.gapSize = this.gapSize;\n\t\tif ( this.scale !== undefined ) data.scale = this.scale;\n\n\t\tif ( this.dithering === true ) data.dithering = true;\n\n\t\tif ( this.alphaTest > 0 ) data.alphaTest = this.alphaTest;\n\t\tif ( this.alphaToCoverage === true ) data.alphaToCoverage = this.alphaToCoverage;\n\t\tif ( this.premultipliedAlpha === true ) data.premultipliedAlpha = this.premultipliedAlpha;\n\n\t\tif ( this.wireframe === true ) data.wireframe = this.wireframe;\n\t\tif ( this.wireframeLinewidth > 1 ) data.wireframeLinewidth = this.wireframeLinewidth;\n\t\tif ( this.wireframeLinecap !== 'round' ) data.wireframeLinecap = this.wireframeLinecap;\n\t\tif ( this.wireframeLinejoin !== 'round' ) data.wireframeLinejoin = this.wireframeLinejoin;\n\n\t\tif ( this.flatShading === true ) data.flatShading = this.flatShading;\n\n\t\tif ( this.visible === false ) data.visible = false;\n\n\t\tif ( this.toneMapped === false ) data.toneMapped = false;\n\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) data.userData = this.userData;\n\n\t\t// TODO: Copied from Object3D.toJSON\n\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t\tif ( isRoot ) {\n\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\n\t\t\tif ( textures.length > 0 ) data.textures = textures;\n\t\t\tif ( images.length > 0 ) data.images = images;\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.fog = source.fog;\n\n\t\tthis.blending = source.blending;\n\t\tthis.side = source.side;\n\t\tthis.vertexColors = source.vertexColors;\n\n\t\tthis.opacity = source.opacity;\n\t\tthis.format = source.format;\n\t\tthis.transparent = source.transparent;\n\n\t\tthis.blendSrc = source.blendSrc;\n\t\tthis.blendDst = source.blendDst;\n\t\tthis.blendEquation = source.blendEquation;\n\t\tthis.blendSrcAlpha = source.blendSrcAlpha;\n\t\tthis.blendDstAlpha = source.blendDstAlpha;\n\t\tthis.blendEquationAlpha = source.blendEquationAlpha;\n\n\t\tthis.depthFunc = source.depthFunc;\n\t\tthis.depthTest = source.depthTest;\n\t\tthis.depthWrite = source.depthWrite;\n\n\t\tthis.stencilWriteMask = source.stencilWriteMask;\n\t\tthis.stencilFunc = source.stencilFunc;\n\t\tthis.stencilRef = source.stencilRef;\n\t\tthis.stencilFuncMask = source.stencilFuncMask;\n\t\tthis.stencilFail = source.stencilFail;\n\t\tthis.stencilZFail = source.stencilZFail;\n\t\tthis.stencilZPass = source.stencilZPass;\n\t\tthis.stencilWrite = source.stencilWrite;\n\n\t\tconst srcPlanes = source.clippingPlanes;\n\t\tlet dstPlanes = null;\n\n\t\tif ( srcPlanes !== null ) {\n\n\t\t\tconst n = srcPlanes.length;\n\t\t\tdstPlanes = new Array( n );\n\n\t\t\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\t\t\tdstPlanes[ i ] = srcPlanes[ i ].clone();\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.clippingPlanes = dstPlanes;\n\t\tthis.clipIntersection = source.clipIntersection;\n\t\tthis.clipShadows = source.clipShadows;\n\n\t\tthis.shadowSide = source.shadowSide;\n\n\t\tthis.colorWrite = source.colorWrite;\n\n\t\tthis.precision = source.precision;\n\n\t\tthis.polygonOffset = source.polygonOffset;\n\t\tthis.polygonOffsetFactor = source.polygonOffsetFactor;\n\t\tthis.polygonOffsetUnits = source.polygonOffsetUnits;\n\n\t\tthis.dithering = source.dithering;\n\n\t\tthis.alphaTest = source.alphaTest;\n\t\tthis.alphaToCoverage = source.alphaToCoverage;\n\t\tthis.premultipliedAlpha = source.premultipliedAlpha;\n\n\t\tthis.visible = source.visible;\n\n\t\tthis.toneMapped = source.toneMapped;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n}\n\nMaterial.prototype.isMaterial = true;\n\nexport { Material };\n","import * as MathUtils from './MathUtils.js';\n\nconst _colorKeywords = { 'aliceblue': 0xF0F8FF, 'antiquewhite': 0xFAEBD7, 'aqua': 0x00FFFF, 'aquamarine': 0x7FFFD4, 'azure': 0xF0FFFF,\n\t'beige': 0xF5F5DC, 'bisque': 0xFFE4C4, 'black': 0x000000, 'blanchedalmond': 0xFFEBCD, 'blue': 0x0000FF, 'blueviolet': 0x8A2BE2,\n\t'brown': 0xA52A2A, 'burlywood': 0xDEB887, 'cadetblue': 0x5F9EA0, 'chartreuse': 0x7FFF00, 'chocolate': 0xD2691E, 'coral': 0xFF7F50,\n\t'cornflowerblue': 0x6495ED, 'cornsilk': 0xFFF8DC, 'crimson': 0xDC143C, 'cyan': 0x00FFFF, 'darkblue': 0x00008B, 'darkcyan': 0x008B8B,\n\t'darkgoldenrod': 0xB8860B, 'darkgray': 0xA9A9A9, 'darkgreen': 0x006400, 'darkgrey': 0xA9A9A9, 'darkkhaki': 0xBDB76B, 'darkmagenta': 0x8B008B,\n\t'darkolivegreen': 0x556B2F, 'darkorange': 0xFF8C00, 'darkorchid': 0x9932CC, 'darkred': 0x8B0000, 'darksalmon': 0xE9967A, 'darkseagreen': 0x8FBC8F,\n\t'darkslateblue': 0x483D8B, 'darkslategray': 0x2F4F4F, 'darkslategrey': 0x2F4F4F, 'darkturquoise': 0x00CED1, 'darkviolet': 0x9400D3,\n\t'deeppink': 0xFF1493, 'deepskyblue': 0x00BFFF, 'dimgray': 0x696969, 'dimgrey': 0x696969, 'dodgerblue': 0x1E90FF, 'firebrick': 0xB22222,\n\t'floralwhite': 0xFFFAF0, 'forestgreen': 0x228B22, 'fuchsia': 0xFF00FF, 'gainsboro': 0xDCDCDC, 'ghostwhite': 0xF8F8FF, 'gold': 0xFFD700,\n\t'goldenrod': 0xDAA520, 'gray': 0x808080, 'green': 0x008000, 'greenyellow': 0xADFF2F, 'grey': 0x808080, 'honeydew': 0xF0FFF0, 'hotpink': 0xFF69B4,\n\t'indianred': 0xCD5C5C, 'indigo': 0x4B0082, 'ivory': 0xFFFFF0, 'khaki': 0xF0E68C, 'lavender': 0xE6E6FA, 'lavenderblush': 0xFFF0F5, 'lawngreen': 0x7CFC00,\n\t'lemonchiffon': 0xFFFACD, 'lightblue': 0xADD8E6, 'lightcoral': 0xF08080, 'lightcyan': 0xE0FFFF, 'lightgoldenrodyellow': 0xFAFAD2, 'lightgray': 0xD3D3D3,\n\t'lightgreen': 0x90EE90, 'lightgrey': 0xD3D3D3, 'lightpink': 0xFFB6C1, 'lightsalmon': 0xFFA07A, 'lightseagreen': 0x20B2AA, 'lightskyblue': 0x87CEFA,\n\t'lightslategray': 0x778899, 'lightslategrey': 0x778899, 'lightsteelblue': 0xB0C4DE, 'lightyellow': 0xFFFFE0, 'lime': 0x00FF00, 'limegreen': 0x32CD32,\n\t'linen': 0xFAF0E6, 'magenta': 0xFF00FF, 'maroon': 0x800000, 'mediumaquamarine': 0x66CDAA, 'mediumblue': 0x0000CD, 'mediumorchid': 0xBA55D3,\n\t'mediumpurple': 0x9370DB, 'mediumseagreen': 0x3CB371, 'mediumslateblue': 0x7B68EE, 'mediumspringgreen': 0x00FA9A, 'mediumturquoise': 0x48D1CC,\n\t'mediumvioletred': 0xC71585, 'midnightblue': 0x191970, 'mintcream': 0xF5FFFA, 'mistyrose': 0xFFE4E1, 'moccasin': 0xFFE4B5, 'navajowhite': 0xFFDEAD,\n\t'navy': 0x000080, 'oldlace': 0xFDF5E6, 'olive': 0x808000, 'olivedrab': 0x6B8E23, 'orange': 0xFFA500, 'orangered': 0xFF4500, 'orchid': 0xDA70D6,\n\t'palegoldenrod': 0xEEE8AA, 'palegreen': 0x98FB98, 'paleturquoise': 0xAFEEEE, 'palevioletred': 0xDB7093, 'papayawhip': 0xFFEFD5, 'peachpuff': 0xFFDAB9,\n\t'peru': 0xCD853F, 'pink': 0xFFC0CB, 'plum': 0xDDA0DD, 'powderblue': 0xB0E0E6, 'purple': 0x800080, 'rebeccapurple': 0x663399, 'red': 0xFF0000, 'rosybrown': 0xBC8F8F,\n\t'royalblue': 0x4169E1, 'saddlebrown': 0x8B4513, 'salmon': 0xFA8072, 'sandybrown': 0xF4A460, 'seagreen': 0x2E8B57, 'seashell': 0xFFF5EE,\n\t'sienna': 0xA0522D, 'silver': 0xC0C0C0, 'skyblue': 0x87CEEB, 'slateblue': 0x6A5ACD, 'slategray': 0x708090, 'slategrey': 0x708090, 'snow': 0xFFFAFA,\n\t'springgreen': 0x00FF7F, 'steelblue': 0x4682B4, 'tan': 0xD2B48C, 'teal': 0x008080, 'thistle': 0xD8BFD8, 'tomato': 0xFF6347, 'turquoise': 0x40E0D0,\n\t'violet': 0xEE82EE, 'wheat': 0xF5DEB3, 'white': 0xFFFFFF, 'whitesmoke': 0xF5F5F5, 'yellow': 0xFFFF00, 'yellowgreen': 0x9ACD32 };\n\nconst _hslA = { h: 0, s: 0, l: 0 };\nconst _hslB = { h: 0, s: 0, l: 0 };\n\nfunction hue2rgb( p, q, t ) {\n\n\tif ( t < 0 ) t += 1;\n\tif ( t > 1 ) t -= 1;\n\tif ( t < 1 / 6 ) return p + ( q - p ) * 6 * t;\n\tif ( t < 1 / 2 ) return q;\n\tif ( t < 2 / 3 ) return p + ( q - p ) * 6 * ( 2 / 3 - t );\n\treturn p;\n\n}\n\nfunction SRGBToLinear( c ) {\n\n\treturn ( c < 0.04045 ) ? c * 0.0773993808 : Math.pow( c * 0.9478672986 + 0.0521327014, 2.4 );\n\n}\n\nfunction LinearToSRGB( c ) {\n\n\treturn ( c < 0.0031308 ) ? c * 12.92 : 1.055 * ( Math.pow( c, 0.41666 ) ) - 0.055;\n\n}\n\nclass Color {\n\n\tconstructor( r, g, b ) {\n\n\t\tif ( g === undefined && b === undefined ) {\n\n\t\t\t// r is THREE.Color, hex or string\n\t\t\treturn this.set( r );\n\n\t\t}\n\n\t\treturn this.setRGB( r, g, b );\n\n\t}\n\n\tset( value ) {\n\n\t\tif ( value && value.isColor ) {\n\n\t\t\tthis.copy( value );\n\n\t\t} else if ( typeof value === 'number' ) {\n\n\t\t\tthis.setHex( value );\n\n\t\t} else if ( typeof value === 'string' ) {\n\n\t\t\tthis.setStyle( value );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.r = scalar;\n\t\tthis.g = scalar;\n\t\tthis.b = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetHex( hex ) {\n\n\t\thex = Math.floor( hex );\n\n\t\tthis.r = ( hex >> 16 & 255 ) / 255;\n\t\tthis.g = ( hex >> 8 & 255 ) / 255;\n\t\tthis.b = ( hex & 255 ) / 255;\n\n\t\treturn this;\n\n\t}\n\n\tsetRGB( r, g, b ) {\n\n\t\tthis.r = r;\n\t\tthis.g = g;\n\t\tthis.b = b;\n\n\t\treturn this;\n\n\t}\n\n\tsetHSL( h, s, l ) {\n\n\t\t// h,s,l ranges are in 0.0 - 1.0\n\t\th = MathUtils.euclideanModulo( h, 1 );\n\t\ts = MathUtils.clamp( s, 0, 1 );\n\t\tl = MathUtils.clamp( l, 0, 1 );\n\n\t\tif ( s === 0 ) {\n\n\t\t\tthis.r = this.g = this.b = l;\n\n\t\t} else {\n\n\t\t\tconst p = l <= 0.5 ? l * ( 1 + s ) : l + s - ( l * s );\n\t\t\tconst q = ( 2 * l ) - p;\n\n\t\t\tthis.r = hue2rgb( q, p, h + 1 / 3 );\n\t\t\tthis.g = hue2rgb( q, p, h );\n\t\t\tthis.b = hue2rgb( q, p, h - 1 / 3 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetStyle( style ) {\n\n\t\tfunction handleAlpha( string ) {\n\n\t\t\tif ( string === undefined ) return;\n\n\t\t\tif ( parseFloat( string ) < 1 ) {\n\n\t\t\t\tconsole.warn( 'THREE.Color: Alpha component of ' + style + ' will be ignored.' );\n\n\t\t\t}\n\n\t\t}\n\n\n\t\tlet m;\n\n\t\tif ( m = /^((?:rgb|hsl)a?)\\(([^\\)]*)\\)/.exec( style ) ) {\n\n\t\t\t// rgb / hsl\n\n\t\t\tlet color;\n\t\t\tconst name = m[ 1 ];\n\t\t\tconst components = m[ 2 ];\n\n\t\t\tswitch ( name ) {\n\n\t\t\t\tcase 'rgb':\n\t\t\t\tcase 'rgba':\n\n\t\t\t\t\tif ( color = /^\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgb(255,0,0) rgba(255,0,0,0.5)\n\t\t\t\t\t\tthis.r = Math.min( 255, parseInt( color[ 1 ], 10 ) ) / 255;\n\t\t\t\t\t\tthis.g = Math.min( 255, parseInt( color[ 2 ], 10 ) ) / 255;\n\t\t\t\t\t\tthis.b = Math.min( 255, parseInt( color[ 3 ], 10 ) ) / 255;\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( color = /^\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgb(100%,0%,0%) rgba(100%,0%,0%,0.5)\n\t\t\t\t\t\tthis.r = Math.min( 100, parseInt( color[ 1 ], 10 ) ) / 100;\n\t\t\t\t\t\tthis.g = Math.min( 100, parseInt( color[ 2 ], 10 ) ) / 100;\n\t\t\t\t\t\tthis.b = Math.min( 100, parseInt( color[ 3 ], 10 ) ) / 100;\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'hsl':\n\t\t\t\tcase 'hsla':\n\n\t\t\t\t\tif ( color = /^\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// hsl(120,50%,50%) hsla(120,50%,50%,0.5)\n\t\t\t\t\t\tconst h = parseFloat( color[ 1 ] ) / 360;\n\t\t\t\t\t\tconst s = parseInt( color[ 2 ], 10 ) / 100;\n\t\t\t\t\t\tconst l = parseInt( color[ 3 ], 10 ) / 100;\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this.setHSL( h, s, l );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t} else if ( m = /^\\#([A-Fa-f\\d]+)$/.exec( style ) ) {\n\n\t\t\t// hex color\n\n\t\t\tconst hex = m[ 1 ];\n\t\t\tconst size = hex.length;\n\n\t\t\tif ( size === 3 ) {\n\n\t\t\t\t// #ff0\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 0 ), 16 ) / 255;\n\t\t\t\tthis.g = parseInt( hex.charAt( 1 ) + hex.charAt( 1 ), 16 ) / 255;\n\t\t\t\tthis.b = parseInt( hex.charAt( 2 ) + hex.charAt( 2 ), 16 ) / 255;\n\n\t\t\t\treturn this;\n\n\t\t\t} else if ( size === 6 ) {\n\n\t\t\t\t// #ff0000\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 1 ), 16 ) / 255;\n\t\t\t\tthis.g = parseInt( hex.charAt( 2 ) + hex.charAt( 3 ), 16 ) / 255;\n\t\t\t\tthis.b = parseInt( hex.charAt( 4 ) + hex.charAt( 5 ), 16 ) / 255;\n\n\t\t\t\treturn this;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( style && style.length > 0 ) {\n\n\t\t\treturn this.setColorName( style );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetColorName( style ) {\n\n\t\t// color keywords\n\t\tconst hex = _colorKeywords[ style.toLowerCase() ];\n\n\t\tif ( hex !== undefined ) {\n\n\t\t\t// red\n\t\t\tthis.setHex( hex );\n\n\t\t} else {\n\n\t\t\t// unknown color\n\t\t\tconsole.warn( 'THREE.Color: Unknown color ' + style );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.r, this.g, this.b );\n\n\t}\n\n\tcopy( color ) {\n\n\t\tthis.r = color.r;\n\t\tthis.g = color.g;\n\t\tthis.b = color.b;\n\n\t\treturn this;\n\n\t}\n\n\tcopyGammaToLinear( color, gammaFactor = 2.0 ) {\n\n\t\tthis.r = Math.pow( color.r, gammaFactor );\n\t\tthis.g = Math.pow( color.g, gammaFactor );\n\t\tthis.b = Math.pow( color.b, gammaFactor );\n\n\t\treturn this;\n\n\t}\n\n\tcopyLinearToGamma( color, gammaFactor = 2.0 ) {\n\n\t\tconst safeInverse = ( gammaFactor > 0 ) ? ( 1.0 / gammaFactor ) : 1.0;\n\n\t\tthis.r = Math.pow( color.r, safeInverse );\n\t\tthis.g = Math.pow( color.g, safeInverse );\n\t\tthis.b = Math.pow( color.b, safeInverse );\n\n\t\treturn this;\n\n\t}\n\n\tconvertGammaToLinear( gammaFactor ) {\n\n\t\tthis.copyGammaToLinear( this, gammaFactor );\n\n\t\treturn this;\n\n\t}\n\n\tconvertLinearToGamma( gammaFactor ) {\n\n\t\tthis.copyLinearToGamma( this, gammaFactor );\n\n\t\treturn this;\n\n\t}\n\n\tcopySRGBToLinear( color ) {\n\n\t\tthis.r = SRGBToLinear( color.r );\n\t\tthis.g = SRGBToLinear( color.g );\n\t\tthis.b = SRGBToLinear( color.b );\n\n\t\treturn this;\n\n\t}\n\n\tcopyLinearToSRGB( color ) {\n\n\t\tthis.r = LinearToSRGB( color.r );\n\t\tthis.g = LinearToSRGB( color.g );\n\t\tthis.b = LinearToSRGB( color.b );\n\n\t\treturn this;\n\n\t}\n\n\tconvertSRGBToLinear() {\n\n\t\tthis.copySRGBToLinear( this );\n\n\t\treturn this;\n\n\t}\n\n\tconvertLinearToSRGB() {\n\n\t\tthis.copyLinearToSRGB( this );\n\n\t\treturn this;\n\n\t}\n\n\tgetHex() {\n\n\t\treturn ( this.r * 255 ) << 16 ^ ( this.g * 255 ) << 8 ^ ( this.b * 255 ) << 0;\n\n\t}\n\n\tgetHexString() {\n\n\t\treturn ( '000000' + this.getHex().toString( 16 ) ).slice( - 6 );\n\n\t}\n\n\tgetHSL( target ) {\n\n\t\t// h,s,l ranges are in 0.0 - 1.0\n\n\t\tconst r = this.r, g = this.g, b = this.b;\n\n\t\tconst max = Math.max( r, g, b );\n\t\tconst min = Math.min( r, g, b );\n\n\t\tlet hue, saturation;\n\t\tconst lightness = ( min + max ) / 2.0;\n\n\t\tif ( min === max ) {\n\n\t\t\thue = 0;\n\t\t\tsaturation = 0;\n\n\t\t} else {\n\n\t\t\tconst delta = max - min;\n\n\t\t\tsaturation = lightness <= 0.5 ? delta / ( max + min ) : delta / ( 2 - max - min );\n\n\t\t\tswitch ( max ) {\n\n\t\t\t\tcase r: hue = ( g - b ) / delta + ( g < b ? 6 : 0 ); break;\n\t\t\t\tcase g: hue = ( b - r ) / delta + 2; break;\n\t\t\t\tcase b: hue = ( r - g ) / delta + 4; break;\n\n\t\t\t}\n\n\t\t\thue /= 6;\n\n\t\t}\n\n\t\ttarget.h = hue;\n\t\ttarget.s = saturation;\n\t\ttarget.l = lightness;\n\n\t\treturn target;\n\n\t}\n\n\tgetStyle() {\n\n\t\treturn 'rgb(' + ( ( this.r * 255 ) | 0 ) + ',' + ( ( this.g * 255 ) | 0 ) + ',' + ( ( this.b * 255 ) | 0 ) + ')';\n\n\t}\n\n\toffsetHSL( h, s, l ) {\n\n\t\tthis.getHSL( _hslA );\n\n\t\t_hslA.h += h; _hslA.s += s; _hslA.l += l;\n\n\t\tthis.setHSL( _hslA.h, _hslA.s, _hslA.l );\n\n\t\treturn this;\n\n\t}\n\n\tadd( color ) {\n\n\t\tthis.r += color.r;\n\t\tthis.g += color.g;\n\t\tthis.b += color.b;\n\n\t\treturn this;\n\n\t}\n\n\taddColors( color1, color2 ) {\n\n\t\tthis.r = color1.r + color2.r;\n\t\tthis.g = color1.g + color2.g;\n\t\tthis.b = color1.b + color2.b;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.r += s;\n\t\tthis.g += s;\n\t\tthis.b += s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( color ) {\n\n\t\tthis.r = Math.max( 0, this.r - color.r );\n\t\tthis.g = Math.max( 0, this.g - color.g );\n\t\tthis.b = Math.max( 0, this.b - color.b );\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( color ) {\n\n\t\tthis.r *= color.r;\n\t\tthis.g *= color.g;\n\t\tthis.b *= color.b;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tthis.r *= s;\n\t\tthis.g *= s;\n\t\tthis.b *= s;\n\n\t\treturn this;\n\n\t}\n\n\tlerp( color, alpha ) {\n\n\t\tthis.r += ( color.r - this.r ) * alpha;\n\t\tthis.g += ( color.g - this.g ) * alpha;\n\t\tthis.b += ( color.b - this.b ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpColors( color1, color2, alpha ) {\n\n\t\tthis.r = color1.r + ( color2.r - color1.r ) * alpha;\n\t\tthis.g = color1.g + ( color2.g - color1.g ) * alpha;\n\t\tthis.b = color1.b + ( color2.b - color1.b ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpHSL( color, alpha ) {\n\n\t\tthis.getHSL( _hslA );\n\t\tcolor.getHSL( _hslB );\n\n\t\tconst h = MathUtils.lerp( _hslA.h, _hslB.h, alpha );\n\t\tconst s = MathUtils.lerp( _hslA.s, _hslB.s, alpha );\n\t\tconst l = MathUtils.lerp( _hslA.l, _hslB.l, alpha );\n\n\t\tthis.setHSL( h, s, l );\n\n\t\treturn this;\n\n\t}\n\n\tequals( c ) {\n\n\t\treturn ( c.r === this.r ) && ( c.g === this.g ) && ( c.b === this.b );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.r = array[ offset ];\n\t\tthis.g = array[ offset + 1 ];\n\t\tthis.b = array[ offset + 2 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.r;\n\t\tarray[ offset + 1 ] = this.g;\n\t\tarray[ offset + 2 ] = this.b;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis.r = attribute.getX( index );\n\t\tthis.g = attribute.getY( index );\n\t\tthis.b = attribute.getZ( index );\n\n\t\tif ( attribute.normalized === true ) {\n\n\t\t\t// assuming Uint8Array\n\n\t\t\tthis.r /= 255;\n\t\t\tthis.g /= 255;\n\t\t\tthis.b /= 255;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\treturn this.getHex();\n\n\t}\n\n}\n\nColor.NAMES = _colorKeywords;\n\nColor.prototype.isColor = true;\nColor.prototype.r = 1;\nColor.prototype.g = 1;\nColor.prototype.b = 1;\n\nexport { Color };\n","import { MultiplyOperation, TangentSpaceNormalMap } from '../constants.js';\nimport { Material } from './Material.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Color } from '../math/Color.js';\n\n/**\n * parameters = {\n *  color: <hex>,\n *  specular: <hex>,\n *  shininess: <float>,\n *  opacity: <float>,\n *\n *  map: new THREE.Texture( <Image> ),\n *\n *  lightMap: new THREE.Texture( <Image> ),\n *  lightMapIntensity: <float>\n *\n *  aoMap: new THREE.Texture( <Image> ),\n *  aoMapIntensity: <float>\n *\n *  emissive: <hex>,\n *  emissiveIntensity: <float>\n *  emissiveMap: new THREE.Texture( <Image> ),\n *\n *  bumpMap: new THREE.Texture( <Image> ),\n *  bumpScale: <float>,\n *\n *  normalMap: new THREE.Texture( <Image> ),\n *  normalMapType: THREE.TangentSpaceNormalMap,\n *  normalScale: <Vector2>,\n *\n *  displacementMap: new THREE.Texture( <Image> ),\n *  displacementScale: <float>,\n *  displacementBias: <float>,\n *\n *  specularMap: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\n *  combine: THREE.MultiplyOperation,\n *  reflectivity: <float>,\n *  refractionRatio: <float>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n *\n *  flatShading: <bool>\n * }\n */\n\nclass MeshPhongMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshPhongMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\t\tthis.specular = new Color( 0x111111 );\n\t\tthis.shininess = 30;\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.flatShading = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\t\tthis.specular.copy( source.specular );\n\t\tthis.shininess = source.shininess;\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshPhongMaterial.prototype.isMeshPhongMaterial = true;\n\nexport { MeshPhongMaterial };\n","import * as THREE from 'three';\n\ntype WrapEntryType = (\n  entry: [string, Promise<THREE.Texture>],\n) => Promise<[string, THREE.Texture]>;\n\nexport default class AlbumCoverManager {\n  loader: THREE.TextureLoader;\n  materials: { [key: string]: THREE.MeshPhongMaterial };\n\n  constructor() {\n    this.loader = new THREE.TextureLoader();\n    this.materials = {};\n  }\n\n  async fetchAlbums(imageUrls: string[]): Promise<THREE.MeshPhongMaterial[]> {\n    const promises: { [key: string]: Promise<THREE.Texture> } = {};\n\n    imageUrls.forEach((url) => {\n      if (!this.materials[url]) promises[url] = this.loader.loadAsync(url);\n    });\n\n    const wrapEntry: WrapEntryType = ([url, prom]) =>\n      new Promise(async (resolve) => resolve([url, await prom]));\n\n    const texturesList = await Promise.all(\n      Object.entries(promises).map(wrapEntry),\n    );\n    texturesList.forEach(([url, texture]) => {\n      this.materials[url] = new THREE.MeshPhongMaterial({\n        map: texture,\n        side: THREE.DoubleSide,\n      });\n    });\n\n    return imageUrls.map((url) => this.materials[url]);\n  }\n}\n","import { SpotifyTrack } from 'spotify';\n\ninterface InitialState {\n  status: 'initial';\n}\n\ninterface PausedState {\n  status: 'paused';\n  url: string;\n  player: HTMLAudioElement;\n}\n\ninterface PlayingState {\n  status: 'playing';\n  url: string;\n  player: HTMLAudioElement;\n}\n\ntype AudioPlayerState = InitialState | PausedState | PlayingState;\n\nexport default class AudioPlayer {\n  state: AudioPlayerState;\n  onSongEnd: () => void;\n\n  constructor() {\n    this.state = { status: 'initial' };\n    this.onSongEnd = () => {};\n  }\n\n  setOnSongEnd(callback: () => void) {\n    this.onSongEnd = callback;\n  }\n\n  playPauseTrack(track: SpotifyTrack) {\n    const url = track.preview_url;\n    if (this.state.status === 'initial') {\n      this.#reset(url);\n    } else if (this.state.status === 'playing') {\n      this.state.player.pause();\n      if (this.state.url === url) {\n        this.state = { ...this.state, status: 'paused' };\n      } else {\n        this.#reset(url);\n      }\n    } else if (this.state.status === 'paused') {\n      if (this.state.url === url) {\n        this.state.player.play();\n        this.state = { ...this.state, status: 'playing' };\n      } else {\n        this.#reset(url);\n      }\n    }\n  }\n\n  #reset(url: string) {\n    const player = new Audio(url);\n    player.volume = 0.2;\n    player.autoplay = false;\n    player.addEventListener('ended', () => {\n      this.state = { status: 'initial' };\n      this.onSongEnd();\n    });\n\n    player.play().catch((e) => {\n      console.error('Error playing audio: ' + e);\n      this.onSongEnd();\n    });\n\n    this.state = { status: 'playing', player, url };\n  }\n}\n","import * as MathUtils from './MathUtils.js';\n\nclass Quaternion {\n\n\tconstructor( x = 0, y = 0, z = 0, w = 1 ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._w = w;\n\n\t}\n\n\tstatic slerp( qa, qb, qm, t ) {\n\n\t\tconsole.warn( 'THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead.' );\n\t\treturn qm.slerpQuaternions( qa, qb, t );\n\n\t}\n\n\tstatic slerpFlat( dst, dstOffset, src0, srcOffset0, src1, srcOffset1, t ) {\n\n\t\t// fuzz-free, array-based Quaternion SLERP operation\n\n\t\tlet x0 = src0[ srcOffset0 + 0 ],\n\t\t\ty0 = src0[ srcOffset0 + 1 ],\n\t\t\tz0 = src0[ srcOffset0 + 2 ],\n\t\t\tw0 = src0[ srcOffset0 + 3 ];\n\n\t\tconst x1 = src1[ srcOffset1 + 0 ],\n\t\t\ty1 = src1[ srcOffset1 + 1 ],\n\t\t\tz1 = src1[ srcOffset1 + 2 ],\n\t\t\tw1 = src1[ srcOffset1 + 3 ];\n\n\t\tif ( t === 0 ) {\n\n\t\t\tdst[ dstOffset + 0 ] = x0;\n\t\t\tdst[ dstOffset + 1 ] = y0;\n\t\t\tdst[ dstOffset + 2 ] = z0;\n\t\t\tdst[ dstOffset + 3 ] = w0;\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( t === 1 ) {\n\n\t\t\tdst[ dstOffset + 0 ] = x1;\n\t\t\tdst[ dstOffset + 1 ] = y1;\n\t\t\tdst[ dstOffset + 2 ] = z1;\n\t\t\tdst[ dstOffset + 3 ] = w1;\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( w0 !== w1 || x0 !== x1 || y0 !== y1 || z0 !== z1 ) {\n\n\t\t\tlet s = 1 - t;\n\t\t\tconst cos = x0 * x1 + y0 * y1 + z0 * z1 + w0 * w1,\n\t\t\t\tdir = ( cos >= 0 ? 1 : - 1 ),\n\t\t\t\tsqrSin = 1 - cos * cos;\n\n\t\t\t// Skip the Slerp for tiny steps to avoid numeric problems:\n\t\t\tif ( sqrSin > Number.EPSILON ) {\n\n\t\t\t\tconst sin = Math.sqrt( sqrSin ),\n\t\t\t\t\tlen = Math.atan2( sin, cos * dir );\n\n\t\t\t\ts = Math.sin( s * len ) / sin;\n\t\t\t\tt = Math.sin( t * len ) / sin;\n\n\t\t\t}\n\n\t\t\tconst tDir = t * dir;\n\n\t\t\tx0 = x0 * s + x1 * tDir;\n\t\t\ty0 = y0 * s + y1 * tDir;\n\t\t\tz0 = z0 * s + z1 * tDir;\n\t\t\tw0 = w0 * s + w1 * tDir;\n\n\t\t\t// Normalize in case we just did a lerp:\n\t\t\tif ( s === 1 - t ) {\n\n\t\t\t\tconst f = 1 / Math.sqrt( x0 * x0 + y0 * y0 + z0 * z0 + w0 * w0 );\n\n\t\t\t\tx0 *= f;\n\t\t\t\ty0 *= f;\n\t\t\t\tz0 *= f;\n\t\t\t\tw0 *= f;\n\n\t\t\t}\n\n\t\t}\n\n\t\tdst[ dstOffset ] = x0;\n\t\tdst[ dstOffset + 1 ] = y0;\n\t\tdst[ dstOffset + 2 ] = z0;\n\t\tdst[ dstOffset + 3 ] = w0;\n\n\t}\n\n\tstatic multiplyQuaternionsFlat( dst, dstOffset, src0, srcOffset0, src1, srcOffset1 ) {\n\n\t\tconst x0 = src0[ srcOffset0 ];\n\t\tconst y0 = src0[ srcOffset0 + 1 ];\n\t\tconst z0 = src0[ srcOffset0 + 2 ];\n\t\tconst w0 = src0[ srcOffset0 + 3 ];\n\n\t\tconst x1 = src1[ srcOffset1 ];\n\t\tconst y1 = src1[ srcOffset1 + 1 ];\n\t\tconst z1 = src1[ srcOffset1 + 2 ];\n\t\tconst w1 = src1[ srcOffset1 + 3 ];\n\n\t\tdst[ dstOffset ] = x0 * w1 + w0 * x1 + y0 * z1 - z0 * y1;\n\t\tdst[ dstOffset + 1 ] = y0 * w1 + w0 * y1 + z0 * x1 - x0 * z1;\n\t\tdst[ dstOffset + 2 ] = z0 * w1 + w0 * z1 + x0 * y1 - y0 * x1;\n\t\tdst[ dstOffset + 3 ] = w0 * w1 - x0 * x1 - y0 * y1 - z0 * z1;\n\n\t\treturn dst;\n\n\t}\n\n\tget x() {\n\n\t\treturn this._x;\n\n\t}\n\n\tset x( value ) {\n\n\t\tthis._x = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget y() {\n\n\t\treturn this._y;\n\n\t}\n\n\tset y( value ) {\n\n\t\tthis._y = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget z() {\n\n\t\treturn this._z;\n\n\t}\n\n\tset z( value ) {\n\n\t\tthis._z = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget w() {\n\n\t\treturn this._w;\n\n\t}\n\n\tset w( value ) {\n\n\t\tthis._w = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tset( x, y, z, w ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._w = w;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this._x, this._y, this._z, this._w );\n\n\t}\n\n\tcopy( quaternion ) {\n\n\t\tthis._x = quaternion.x;\n\t\tthis._y = quaternion.y;\n\t\tthis._z = quaternion.z;\n\t\tthis._w = quaternion.w;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromEuler( euler, update ) {\n\n\t\tif ( ! ( euler && euler.isEuler ) ) {\n\n\t\t\tthrow new Error( 'THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.' );\n\n\t\t}\n\n\t\tconst x = euler._x, y = euler._y, z = euler._z, order = euler._order;\n\n\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\n\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\n\t\t//\tcontent/SpinCalc.m\n\n\t\tconst cos = Math.cos;\n\t\tconst sin = Math.sin;\n\n\t\tconst c1 = cos( x / 2 );\n\t\tconst c2 = cos( y / 2 );\n\t\tconst c3 = cos( z / 2 );\n\n\t\tconst s1 = sin( x / 2 );\n\t\tconst s2 = sin( y / 2 );\n\t\tconst s3 = sin( z / 2 );\n\n\t\tswitch ( order ) {\n\n\t\t\tcase 'XYZ':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'YXZ':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZXY':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZYX':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'YZX':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'XZY':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.warn( 'THREE.Quaternion: .setFromEuler() encountered an unknown order: ' + order );\n\n\t\t}\n\n\t\tif ( update !== false ) this._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromAxisAngle( axis, angle ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\n\n\t\t// assumes axis is normalized\n\n\t\tconst halfAngle = angle / 2, s = Math.sin( halfAngle );\n\n\t\tthis._x = axis.x * s;\n\t\tthis._y = axis.y * s;\n\t\tthis._z = axis.z * s;\n\t\tthis._w = Math.cos( halfAngle );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromRotationMatrix( m ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tconst te = m.elements,\n\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\n\n\t\t\ttrace = m11 + m22 + m33;\n\n\t\tif ( trace > 0 ) {\n\n\t\t\tconst s = 0.5 / Math.sqrt( trace + 1.0 );\n\n\t\t\tthis._w = 0.25 / s;\n\t\t\tthis._x = ( m32 - m23 ) * s;\n\t\t\tthis._y = ( m13 - m31 ) * s;\n\t\t\tthis._z = ( m21 - m12 ) * s;\n\n\t\t} else if ( m11 > m22 && m11 > m33 ) {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\n\n\t\t\tthis._w = ( m32 - m23 ) / s;\n\t\t\tthis._x = 0.25 * s;\n\t\t\tthis._y = ( m12 + m21 ) / s;\n\t\t\tthis._z = ( m13 + m31 ) / s;\n\n\t\t} else if ( m22 > m33 ) {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\n\n\t\t\tthis._w = ( m13 - m31 ) / s;\n\t\t\tthis._x = ( m12 + m21 ) / s;\n\t\t\tthis._y = 0.25 * s;\n\t\t\tthis._z = ( m23 + m32 ) / s;\n\n\t\t} else {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\n\n\t\t\tthis._w = ( m21 - m12 ) / s;\n\t\t\tthis._x = ( m13 + m31 ) / s;\n\t\t\tthis._y = ( m23 + m32 ) / s;\n\t\t\tthis._z = 0.25 * s;\n\n\t\t}\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromUnitVectors( vFrom, vTo ) {\n\n\t\t// assumes direction vectors vFrom and vTo are normalized\n\n\t\tlet r = vFrom.dot( vTo ) + 1;\n\n\t\tif ( r < Number.EPSILON ) {\n\n\t\t\t// vFrom and vTo point in opposite directions\n\n\t\t\tr = 0;\n\n\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\n\n\t\t\t\tthis._x = - vFrom.y;\n\t\t\t\tthis._y = vFrom.x;\n\t\t\t\tthis._z = 0;\n\t\t\t\tthis._w = r;\n\n\t\t\t} else {\n\n\t\t\t\tthis._x = 0;\n\t\t\t\tthis._y = - vFrom.z;\n\t\t\t\tthis._z = vFrom.y;\n\t\t\t\tthis._w = r;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// crossVectors( vFrom, vTo ); // inlined to avoid cyclic dependency on Vector3\n\n\t\t\tthis._x = vFrom.y * vTo.z - vFrom.z * vTo.y;\n\t\t\tthis._y = vFrom.z * vTo.x - vFrom.x * vTo.z;\n\t\t\tthis._z = vFrom.x * vTo.y - vFrom.y * vTo.x;\n\t\t\tthis._w = r;\n\n\t\t}\n\n\t\treturn this.normalize();\n\n\t}\n\n\tangleTo( q ) {\n\n\t\treturn 2 * Math.acos( Math.abs( MathUtils.clamp( this.dot( q ), - 1, 1 ) ) );\n\n\t}\n\n\trotateTowards( q, step ) {\n\n\t\tconst angle = this.angleTo( q );\n\n\t\tif ( angle === 0 ) return this;\n\n\t\tconst t = Math.min( 1, step / angle );\n\n\t\tthis.slerp( q, t );\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\treturn this.set( 0, 0, 0, 1 );\n\n\t}\n\n\tinvert() {\n\n\t\t// quaternion is assumed to have unit length\n\n\t\treturn this.conjugate();\n\n\t}\n\n\tconjugate() {\n\n\t\tthis._x *= - 1;\n\t\tthis._y *= - 1;\n\t\tthis._z *= - 1;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\n\n\t}\n\n\tnormalize() {\n\n\t\tlet l = this.length();\n\n\t\tif ( l === 0 ) {\n\n\t\t\tthis._x = 0;\n\t\t\tthis._y = 0;\n\t\t\tthis._z = 0;\n\t\t\tthis._w = 1;\n\n\t\t} else {\n\n\t\t\tl = 1 / l;\n\n\t\t\tthis._x = this._x * l;\n\t\t\tthis._y = this._y * l;\n\t\t\tthis._z = this._z * l;\n\t\t\tthis._w = this._w * l;\n\n\t\t}\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( q, p ) {\n\n\t\tif ( p !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.' );\n\t\t\treturn this.multiplyQuaternions( q, p );\n\n\t\t}\n\n\t\treturn this.multiplyQuaternions( this, q );\n\n\t}\n\n\tpremultiply( q ) {\n\n\t\treturn this.multiplyQuaternions( q, this );\n\n\t}\n\n\tmultiplyQuaternions( a, b ) {\n\n\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\n\n\t\tconst qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\n\t\tconst qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\n\n\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\n\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\n\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\n\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tslerp( qb, t ) {\n\n\t\tif ( t === 0 ) return this;\n\t\tif ( t === 1 ) return this.copy( qb );\n\n\t\tconst x = this._x, y = this._y, z = this._z, w = this._w;\n\n\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\n\n\t\tlet cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\n\n\t\tif ( cosHalfTheta < 0 ) {\n\n\t\t\tthis._w = - qb._w;\n\t\t\tthis._x = - qb._x;\n\t\t\tthis._y = - qb._y;\n\t\t\tthis._z = - qb._z;\n\n\t\t\tcosHalfTheta = - cosHalfTheta;\n\n\t\t} else {\n\n\t\t\tthis.copy( qb );\n\n\t\t}\n\n\t\tif ( cosHalfTheta >= 1.0 ) {\n\n\t\t\tthis._w = w;\n\t\t\tthis._x = x;\n\t\t\tthis._y = y;\n\t\t\tthis._z = z;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst sqrSinHalfTheta = 1.0 - cosHalfTheta * cosHalfTheta;\n\n\t\tif ( sqrSinHalfTheta <= Number.EPSILON ) {\n\n\t\t\tconst s = 1 - t;\n\t\t\tthis._w = s * w + t * this._w;\n\t\t\tthis._x = s * x + t * this._x;\n\t\t\tthis._y = s * y + t * this._y;\n\t\t\tthis._z = s * z + t * this._z;\n\n\t\t\tthis.normalize();\n\t\t\tthis._onChangeCallback();\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst sinHalfTheta = Math.sqrt( sqrSinHalfTheta );\n\t\tconst halfTheta = Math.atan2( sinHalfTheta, cosHalfTheta );\n\t\tconst ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\n\t\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\n\n\t\tthis._w = ( w * ratioA + this._w * ratioB );\n\t\tthis._x = ( x * ratioA + this._x * ratioB );\n\t\tthis._y = ( y * ratioA + this._y * ratioB );\n\t\tthis._z = ( z * ratioA + this._z * ratioB );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tslerpQuaternions( qa, qb, t ) {\n\n\t\tthis.copy( qa ).slerp( qb, t );\n\n\t}\n\n\trandom() {\n\n\t\t// Derived from http://planning.cs.uiuc.edu/node198.html\n\t\t// Note, this source uses w, x, y, z ordering,\n\t\t// so we swap the order below.\n\n\t\tconst u1 = Math.random();\n\t\tconst sqrt1u1 = Math.sqrt( 1 - u1 );\n\t\tconst sqrtu1 = Math.sqrt( u1 );\n\n\t\tconst u2 = 2 * Math.PI * Math.random();\n\n\t\tconst u3 = 2 * Math.PI * Math.random();\n\n\t\treturn this.set(\n\t\t\tsqrt1u1 * Math.cos( u2 ),\n\t\t\tsqrtu1 * Math.sin( u3 ),\n\t\t\tsqrtu1 * Math.cos( u3 ),\n\t\t\tsqrt1u1 * Math.sin( u2 ),\n\t\t);\n\n\t}\n\n\tequals( quaternion ) {\n\n\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis._x = array[ offset ];\n\t\tthis._y = array[ offset + 1 ];\n\t\tthis._z = array[ offset + 2 ];\n\t\tthis._w = array[ offset + 3 ];\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this._x;\n\t\tarray[ offset + 1 ] = this._y;\n\t\tarray[ offset + 2 ] = this._z;\n\t\tarray[ offset + 3 ] = this._w;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis._x = attribute.getX( index );\n\t\tthis._y = attribute.getY( index );\n\t\tthis._z = attribute.getZ( index );\n\t\tthis._w = attribute.getW( index );\n\n\t\treturn this;\n\n\t}\n\n\t_onChange( callback ) {\n\n\t\tthis._onChangeCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\t_onChangeCallback() {}\n\n}\n\nQuaternion.prototype.isQuaternion = true;\n\nexport { Quaternion };\n","import * as MathUtils from './MathUtils.js';\nimport { Quaternion } from './Quaternion.js';\n\nclass Vector3 {\n\n\tconstructor( x = 0, y = 0, z = 0 ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\n\t}\n\n\tset( x, y, z ) {\n\n\t\tif ( z === undefined ) z = this.z; // sprite.scale.set(x,y)\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\t\tthis.z = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( z ) {\n\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tcase 2: this.z = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tcase 2: return this.z;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y, this.z );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t\tthis.z = v.z;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\n\t\t\treturn this.addVectors( v, w );\n\n\t\t}\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t\tthis.z += v.z;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\t\tthis.z += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\t\tthis.z = a.z + b.z;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\t\tthis.z += v.z * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\n\t\t\treturn this.subVectors( v, w );\n\n\t\t}\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\t\tthis.z -= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\t\tthis.z -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\t\tthis.z = a.z - b.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.' );\n\t\t\treturn this.multiplyVectors( v, w );\n\n\t\t}\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\t\tthis.z *= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\tthis.z *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyVectors( a, b ) {\n\n\t\tthis.x = a.x * b.x;\n\t\tthis.y = a.y * b.y;\n\t\tthis.z = a.z * b.z;\n\n\t\treturn this;\n\n\t}\n\n\tapplyEuler( euler ) {\n\n\t\tif ( ! ( euler && euler.isEuler ) ) {\n\n\t\t\tconsole.error( 'THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.' );\n\n\t\t}\n\n\t\treturn this.applyQuaternion( _quaternion.setFromEuler( euler ) );\n\n\t}\n\n\tapplyAxisAngle( axis, angle ) {\n\n\t\treturn this.applyQuaternion( _quaternion.setFromAxisAngle( axis, angle ) );\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ] * z;\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ] * z;\n\t\tthis.z = e[ 2 ] * x + e[ 5 ] * y + e[ 8 ] * z;\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\treturn this.applyMatrix3( m ).normalize();\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tconst w = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] );\n\n\t\tthis.x = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] ) * w;\n\t\tthis.y = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] ) * w;\n\t\tthis.z = ( e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] ) * w;\n\n\t\treturn this;\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst qx = q.x, qy = q.y, qz = q.z, qw = q.w;\n\n\t\t// calculate quat * vector\n\n\t\tconst ix = qw * x + qy * z - qz * y;\n\t\tconst iy = qw * y + qz * x - qx * z;\n\t\tconst iz = qw * z + qx * y - qy * x;\n\t\tconst iw = - qx * x - qy * y - qz * z;\n\n\t\t// calculate result * inverse quat\n\n\t\tthis.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\n\t\tthis.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\n\t\tthis.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\n\n\t\treturn this;\n\n\t}\n\n\tproject( camera ) {\n\n\t\treturn this.applyMatrix4( camera.matrixWorldInverse ).applyMatrix4( camera.projectionMatrix );\n\n\t}\n\n\tunproject( camera ) {\n\n\t\treturn this.applyMatrix4( camera.projectionMatrixInverse ).applyMatrix4( camera.matrixWorld );\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\t// input: THREE.Matrix4 affine matrix\n\t\t// vector interpreted as a direction\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z;\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z;\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\n\n\t\treturn this.normalize();\n\n\t}\n\n\tdivide( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\t\tthis.z /= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\t\tthis.z = Math.min( this.z, v.z );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\t\tthis.z = Math.max( this.z, v.z );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\n\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\n\t\tthis.z = Math.max( minVal, Math.min( maxVal, this.z ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\t\tthis.z = Math.floor( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\t\tthis.z = Math.ceil( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\t\tthis.z = Math.round( this.z );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\t\tthis.z = - this.z;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z;\n\n\t}\n\n\t// TODO lengthSquared?\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\tthis.z += ( v.z - this.z ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\t\tthis.z = v1.z + ( v2.z - v1.z ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tcross( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.' );\n\t\t\treturn this.crossVectors( v, w );\n\n\t\t}\n\n\t\treturn this.crossVectors( this, v );\n\n\t}\n\n\tcrossVectors( a, b ) {\n\n\t\tconst ax = a.x, ay = a.y, az = a.z;\n\t\tconst bx = b.x, by = b.y, bz = b.z;\n\n\t\tthis.x = ay * bz - az * by;\n\t\tthis.y = az * bx - ax * bz;\n\t\tthis.z = ax * by - ay * bx;\n\n\t\treturn this;\n\n\t}\n\n\tprojectOnVector( v ) {\n\n\t\tconst denominator = v.lengthSq();\n\n\t\tif ( denominator === 0 ) return this.set( 0, 0, 0 );\n\n\t\tconst scalar = v.dot( this ) / denominator;\n\n\t\treturn this.copy( v ).multiplyScalar( scalar );\n\n\t}\n\n\tprojectOnPlane( planeNormal ) {\n\n\t\t_vector.copy( this ).projectOnVector( planeNormal );\n\n\t\treturn this.sub( _vector );\n\n\t}\n\n\treflect( normal ) {\n\n\t\t// reflect incident vector off plane orthogonal to normal\n\t\t// normal is assumed to have unit length\n\n\t\treturn this.sub( _vector.copy( normal ).multiplyScalar( 2 * this.dot( normal ) ) );\n\n\t}\n\n\tangleTo( v ) {\n\n\t\tconst denominator = Math.sqrt( this.lengthSq() * v.lengthSq() );\n\n\t\tif ( denominator === 0 ) return Math.PI / 2;\n\n\t\tconst theta = this.dot( v ) / denominator;\n\n\t\t// clamp, to handle numerical problems\n\n\t\treturn Math.acos( MathUtils.clamp( theta, - 1, 1 ) );\n\n\t}\n\n\tdistanceTo( v ) {\n\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t}\n\n\tdistanceToSquared( v ) {\n\n\t\tconst dx = this.x - v.x, dy = this.y - v.y, dz = this.z - v.z;\n\n\t\treturn dx * dx + dy * dy + dz * dz;\n\n\t}\n\n\tmanhattanDistanceTo( v ) {\n\n\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y ) + Math.abs( this.z - v.z );\n\n\t}\n\n\tsetFromSpherical( s ) {\n\n\t\treturn this.setFromSphericalCoords( s.radius, s.phi, s.theta );\n\n\t}\n\n\tsetFromSphericalCoords( radius, phi, theta ) {\n\n\t\tconst sinPhiRadius = Math.sin( phi ) * radius;\n\n\t\tthis.x = sinPhiRadius * Math.sin( theta );\n\t\tthis.y = Math.cos( phi ) * radius;\n\t\tthis.z = sinPhiRadius * Math.cos( theta );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCylindrical( c ) {\n\n\t\treturn this.setFromCylindricalCoords( c.radius, c.theta, c.y );\n\n\t}\n\n\tsetFromCylindricalCoords( radius, theta, y ) {\n\n\t\tthis.x = radius * Math.sin( theta );\n\t\tthis.y = y;\n\t\tthis.z = radius * Math.cos( theta );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixPosition( m ) {\n\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 12 ];\n\t\tthis.y = e[ 13 ];\n\t\tthis.z = e[ 14 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixScale( m ) {\n\n\t\tconst sx = this.setFromMatrixColumn( m, 0 ).length();\n\t\tconst sy = this.setFromMatrixColumn( m, 1 ).length();\n\t\tconst sz = this.setFromMatrixColumn( m, 2 ).length();\n\n\t\tthis.x = sx;\n\t\tthis.y = sy;\n\t\tthis.z = sz;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixColumn( m, index ) {\n\n\t\treturn this.fromArray( m.elements, index * 4 );\n\n\t}\n\n\tsetFromMatrix3Column( m, index ) {\n\n\t\treturn this.fromArray( m.elements, index * 3 );\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\t\tthis.z = array[ offset + 2 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\t\tarray[ offset + 2 ] = this.z;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index, offset ) {\n\n\t\tif ( offset !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: offset has been removed from .fromBufferAttribute().' );\n\n\t\t}\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\t\tthis.z = attribute.getZ( index );\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\t\tthis.z = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\trandomDirection() {\n\n\t\t// Derived from https://mathworld.wolfram.com/SpherePointPicking.html\n\n\t\tconst u = ( Math.random() - 0.5 ) * 2;\n\t\tconst t = Math.random() * Math.PI * 2;\n\t\tconst f = Math.sqrt( 1 - u ** 2 );\n\n\t\tthis.x = f * Math.cos( t );\n\t\tthis.y = f * Math.sin( t );\n\t\tthis.z = u;\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\t\tyield this.z;\n\n\t}\n\n}\n\nVector3.prototype.isVector3 = true;\n\nconst _vector = /*@__PURE__*/ new Vector3();\nconst _quaternion = /*@__PURE__*/ new Quaternion();\n\nexport { Vector3 };\n","import { Vector3 } from './Vector3.js';\n\nclass Box3 {\n\n\tconstructor( min = new Vector3( + Infinity, + Infinity, + Infinity ), max = new Vector3( - Infinity, - Infinity, - Infinity ) ) {\n\n\t\tthis.min = min;\n\t\tthis.max = max;\n\n\t}\n\n\tset( min, max ) {\n\n\t\tthis.min.copy( min );\n\t\tthis.max.copy( max );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromArray( array ) {\n\n\t\tlet minX = + Infinity;\n\t\tlet minY = + Infinity;\n\t\tlet minZ = + Infinity;\n\n\t\tlet maxX = - Infinity;\n\t\tlet maxY = - Infinity;\n\t\tlet maxZ = - Infinity;\n\n\t\tfor ( let i = 0, l = array.length; i < l; i += 3 ) {\n\n\t\t\tconst x = array[ i ];\n\t\t\tconst y = array[ i + 1 ];\n\t\t\tconst z = array[ i + 2 ];\n\n\t\t\tif ( x < minX ) minX = x;\n\t\t\tif ( y < minY ) minY = y;\n\t\t\tif ( z < minZ ) minZ = z;\n\n\t\t\tif ( x > maxX ) maxX = x;\n\t\t\tif ( y > maxY ) maxY = y;\n\t\t\tif ( z > maxZ ) maxZ = z;\n\n\t\t}\n\n\t\tthis.min.set( minX, minY, minZ );\n\t\tthis.max.set( maxX, maxY, maxZ );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromBufferAttribute( attribute ) {\n\n\t\tlet minX = + Infinity;\n\t\tlet minY = + Infinity;\n\t\tlet minZ = + Infinity;\n\n\t\tlet maxX = - Infinity;\n\t\tlet maxY = - Infinity;\n\t\tlet maxZ = - Infinity;\n\n\t\tfor ( let i = 0, l = attribute.count; i < l; i ++ ) {\n\n\t\t\tconst x = attribute.getX( i );\n\t\t\tconst y = attribute.getY( i );\n\t\t\tconst z = attribute.getZ( i );\n\n\t\t\tif ( x < minX ) minX = x;\n\t\t\tif ( y < minY ) minY = y;\n\t\t\tif ( z < minZ ) minZ = z;\n\n\t\t\tif ( x > maxX ) maxX = x;\n\t\t\tif ( y > maxY ) maxY = y;\n\t\t\tif ( z > maxZ ) maxZ = z;\n\n\t\t}\n\n\t\tthis.min.set( minX, minY, minZ );\n\t\tthis.max.set( maxX, maxY, maxZ );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tthis.expandByPoint( points[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCenterAndSize( center, size ) {\n\n\t\tconst halfSize = _vector.copy( size ).multiplyScalar( 0.5 );\n\n\t\tthis.min.copy( center ).sub( halfSize );\n\t\tthis.max.copy( center ).add( halfSize );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromObject( object ) {\n\n\t\tthis.makeEmpty();\n\n\t\treturn this.expandByObject( object );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( box ) {\n\n\t\tthis.min.copy( box.min );\n\t\tthis.max.copy( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.min.x = this.min.y = this.min.z = + Infinity;\n\t\tthis.max.x = this.max.y = this.max.z = - Infinity;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y ) || ( this.max.z < this.min.z );\n\n\t}\n\n\tgetCenter( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\n\n\t}\n\n\tgetSize( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.subVectors( this.max, this.min );\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\tthis.min.min( point );\n\t\tthis.max.max( point );\n\n\t\treturn this;\n\n\t}\n\n\texpandByVector( vector ) {\n\n\t\tthis.min.sub( vector );\n\t\tthis.max.add( vector );\n\n\t\treturn this;\n\n\t}\n\n\texpandByScalar( scalar ) {\n\n\t\tthis.min.addScalar( - scalar );\n\t\tthis.max.addScalar( scalar );\n\n\t\treturn this;\n\n\t}\n\n\texpandByObject( object ) {\n\n\t\t// Computes the world-axis-aligned bounding box of an object (including its children),\n\t\t// accounting for both the object's, and children's, world transforms\n\n\t\tobject.updateWorldMatrix( false, false );\n\n\t\tconst geometry = object.geometry;\n\n\t\tif ( geometry !== undefined ) {\n\n\t\t\tif ( geometry.boundingBox === null ) {\n\n\t\t\t\tgeometry.computeBoundingBox();\n\n\t\t\t}\n\n\t\t\t_box.copy( geometry.boundingBox );\n\t\t\t_box.applyMatrix4( object.matrixWorld );\n\n\t\t\tthis.union( _box );\n\n\t\t}\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tthis.expandByObject( children[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn point.x < this.min.x || point.x > this.max.x ||\n\t\t\tpoint.y < this.min.y || point.y > this.max.y ||\n\t\t\tpoint.z < this.min.z || point.z > this.max.z ? false : true;\n\n\t}\n\n\tcontainsBox( box ) {\n\n\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\n\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y &&\n\t\t\tthis.min.z <= box.min.z && box.max.z <= this.max.z;\n\n\t}\n\n\tgetParameter( point, target ) {\n\n\t\t// This can potentially have a divide by zero if the box\n\t\t// has a size dimension of 0.\n\n\t\treturn target.set(\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y ),\n\t\t\t( point.z - this.min.z ) / ( this.max.z - this.min.z )\n\t\t);\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\t// using 6 splitting planes to rule out intersections.\n\t\treturn box.max.x < this.min.x || box.min.x > this.max.x ||\n\t\t\tbox.max.y < this.min.y || box.min.y > this.max.y ||\n\t\t\tbox.max.z < this.min.z || box.min.z > this.max.z ? false : true;\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\t// Find the point on the AABB closest to the sphere center.\n\t\tthis.clampPoint( sphere.center, _vector );\n\n\t\t// If that point is inside the sphere, the AABB and sphere intersect.\n\t\treturn _vector.distanceToSquared( sphere.center ) <= ( sphere.radius * sphere.radius );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\t// We compute the minimum and maximum dot product values. If those values\n\t\t// are on the same side (back or front) of the plane, then there is no intersection.\n\n\t\tlet min, max;\n\n\t\tif ( plane.normal.x > 0 ) {\n\n\t\t\tmin = plane.normal.x * this.min.x;\n\t\t\tmax = plane.normal.x * this.max.x;\n\n\t\t} else {\n\n\t\t\tmin = plane.normal.x * this.max.x;\n\t\t\tmax = plane.normal.x * this.min.x;\n\n\t\t}\n\n\t\tif ( plane.normal.y > 0 ) {\n\n\t\t\tmin += plane.normal.y * this.min.y;\n\t\t\tmax += plane.normal.y * this.max.y;\n\n\t\t} else {\n\n\t\t\tmin += plane.normal.y * this.max.y;\n\t\t\tmax += plane.normal.y * this.min.y;\n\n\t\t}\n\n\t\tif ( plane.normal.z > 0 ) {\n\n\t\t\tmin += plane.normal.z * this.min.z;\n\t\t\tmax += plane.normal.z * this.max.z;\n\n\t\t} else {\n\n\t\t\tmin += plane.normal.z * this.max.z;\n\t\t\tmax += plane.normal.z * this.min.z;\n\n\t\t}\n\n\t\treturn ( min <= - plane.constant && max >= - plane.constant );\n\n\t}\n\n\tintersectsTriangle( triangle ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// compute box center and extents\n\t\tthis.getCenter( _center );\n\t\t_extents.subVectors( this.max, _center );\n\n\t\t// translate triangle to aabb origin\n\t\t_v0.subVectors( triangle.a, _center );\n\t\t_v1.subVectors( triangle.b, _center );\n\t\t_v2.subVectors( triangle.c, _center );\n\n\t\t// compute edge vectors for triangle\n\t\t_f0.subVectors( _v1, _v0 );\n\t\t_f1.subVectors( _v2, _v1 );\n\t\t_f2.subVectors( _v0, _v2 );\n\n\t\t// test against axes that are given by cross product combinations of the edges of the triangle and the edges of the aabb\n\t\t// make an axis testing of each of the 3 sides of the aabb against each of the 3 sides of the triangle = 9 axis of separation\n\t\t// axis_ij = u_i x f_j (u0, u1, u2 = face normals of aabb = x,y,z axes vectors since aabb is axis aligned)\n\t\tlet axes = [\n\t\t\t0, - _f0.z, _f0.y, 0, - _f1.z, _f1.y, 0, - _f2.z, _f2.y,\n\t\t\t_f0.z, 0, - _f0.x, _f1.z, 0, - _f1.x, _f2.z, 0, - _f2.x,\n\t\t\t- _f0.y, _f0.x, 0, - _f1.y, _f1.x, 0, - _f2.y, _f2.x, 0\n\t\t];\n\t\tif ( ! satForAxes( axes, _v0, _v1, _v2, _extents ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// test 3 face normals from the aabb\n\t\taxes = [ 1, 0, 0, 0, 1, 0, 0, 0, 1 ];\n\t\tif ( ! satForAxes( axes, _v0, _v1, _v2, _extents ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// finally testing the face normal of the triangle\n\t\t// use already existing triangle edge vectors here\n\t\t_triangleNormal.crossVectors( _f0, _f1 );\n\t\taxes = [ _triangleNormal.x, _triangleNormal.y, _triangleNormal.z ];\n\n\t\treturn satForAxes( axes, _v0, _v1, _v2, _extents );\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\treturn target.copy( point ).clamp( this.min, this.max );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\tconst clampedPoint = _vector.copy( point ).clamp( this.min, this.max );\n\n\t\treturn clampedPoint.sub( point ).length();\n\n\t}\n\n\tgetBoundingSphere( target ) {\n\n\t\tthis.getCenter( target.center );\n\n\t\ttarget.radius = this.getSize( _vector ).length() * 0.5;\n\n\t\treturn target;\n\n\t}\n\n\tintersect( box ) {\n\n\t\tthis.min.max( box.min );\n\t\tthis.max.min( box.max );\n\n\t\t// ensure that if there is no overlap, the result is fully empty, not slightly empty with non-inf/+inf values that will cause subsequence intersects to erroneously return valid values.\n\t\tif ( this.isEmpty() ) this.makeEmpty();\n\n\t\treturn this;\n\n\t}\n\n\tunion( box ) {\n\n\t\tthis.min.min( box.min );\n\t\tthis.max.max( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\t// transform of empty box is an empty box.\n\t\tif ( this.isEmpty() ) return this;\n\n\t\t// NOTE: I am using a binary pattern to specify all 2^3 combinations below\n\t\t_points[ 0 ].set( this.min.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 000\n\t\t_points[ 1 ].set( this.min.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 001\n\t\t_points[ 2 ].set( this.min.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 010\n\t\t_points[ 3 ].set( this.min.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 011\n\t\t_points[ 4 ].set( this.max.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 100\n\t\t_points[ 5 ].set( this.max.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 101\n\t\t_points[ 6 ].set( this.max.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 110\n\t\t_points[ 7 ].set( this.max.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 111\n\n\t\tthis.setFromPoints( _points );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.min.add( offset );\n\t\tthis.max.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\tequals( box ) {\n\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\n\n\t}\n\n}\n\nBox3.prototype.isBox3 = true;\n\nconst _points = [\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3()\n];\n\nconst _vector = /*@__PURE__*/ new Vector3();\n\nconst _box = /*@__PURE__*/ new Box3();\n\n// triangle centered vertices\n\nconst _v0 = /*@__PURE__*/ new Vector3();\nconst _v1 = /*@__PURE__*/ new Vector3();\nconst _v2 = /*@__PURE__*/ new Vector3();\n\n// triangle edge vectors\n\nconst _f0 = /*@__PURE__*/ new Vector3();\nconst _f1 = /*@__PURE__*/ new Vector3();\nconst _f2 = /*@__PURE__*/ new Vector3();\n\nconst _center = /*@__PURE__*/ new Vector3();\nconst _extents = /*@__PURE__*/ new Vector3();\nconst _triangleNormal = /*@__PURE__*/ new Vector3();\nconst _testAxis = /*@__PURE__*/ new Vector3();\n\nfunction satForAxes( axes, v0, v1, v2, extents ) {\n\n\tfor ( let i = 0, j = axes.length - 3; i <= j; i += 3 ) {\n\n\t\t_testAxis.fromArray( axes, i );\n\t\t// project the aabb onto the seperating axis\n\t\tconst r = extents.x * Math.abs( _testAxis.x ) + extents.y * Math.abs( _testAxis.y ) + extents.z * Math.abs( _testAxis.z );\n\t\t// project all 3 vertices of the triangle onto the seperating axis\n\t\tconst p0 = v0.dot( _testAxis );\n\t\tconst p1 = v1.dot( _testAxis );\n\t\tconst p2 = v2.dot( _testAxis );\n\t\t// actual test, basically see if either of the most extreme of the triangle points intersects r\n\t\tif ( Math.max( - Math.max( p0, p1, p2 ), Math.min( p0, p1, p2 ) ) > r ) {\n\n\t\t\t// points of the projected triangle are outside the projected half-length of the aabb\n\t\t\t// the axis is seperating and we can exit\n\t\t\treturn false;\n\n\t\t}\n\n\t}\n\n\treturn true;\n\n}\n\nexport { Box3 };\n","import { Box3 } from './Box3.js';\nimport { Vector3 } from './Vector3.js';\n\nconst _box = /*@__PURE__*/ new Box3();\nconst _v1 = /*@__PURE__*/ new Vector3();\nconst _toFarthestPoint = /*@__PURE__*/ new Vector3();\nconst _toPoint = /*@__PURE__*/ new Vector3();\n\nclass Sphere {\n\n\tconstructor( center = new Vector3(), radius = - 1 ) {\n\n\t\tthis.center = center;\n\t\tthis.radius = radius;\n\n\t}\n\n\tset( center, radius ) {\n\n\t\tthis.center.copy( center );\n\t\tthis.radius = radius;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points, optionalCenter ) {\n\n\t\tconst center = this.center;\n\n\t\tif ( optionalCenter !== undefined ) {\n\n\t\t\tcenter.copy( optionalCenter );\n\n\t\t} else {\n\n\t\t\t_box.setFromPoints( points ).getCenter( center );\n\n\t\t}\n\n\t\tlet maxRadiusSq = 0;\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( points[ i ] ) );\n\n\t\t}\n\n\t\tthis.radius = Math.sqrt( maxRadiusSq );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( sphere ) {\n\n\t\tthis.center.copy( sphere.center );\n\t\tthis.radius = sphere.radius;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\treturn ( this.radius < 0 );\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.center.set( 0, 0, 0 );\n\t\tthis.radius = - 1;\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn ( point.distanceToSquared( this.center ) <= ( this.radius * this.radius ) );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn ( point.distanceTo( this.center ) - this.radius );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\tconst radiusSum = this.radius + sphere.radius;\n\n\t\treturn sphere.center.distanceToSquared( this.center ) <= ( radiusSum * radiusSum );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsSphere( this );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\treturn Math.abs( plane.distanceToPoint( this.center ) ) <= this.radius;\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\tconst deltaLengthSq = this.center.distanceToSquared( point );\n\n\t\ttarget.copy( point );\n\n\t\tif ( deltaLengthSq > ( this.radius * this.radius ) ) {\n\n\t\t\ttarget.sub( this.center ).normalize();\n\t\t\ttarget.multiplyScalar( this.radius ).add( this.center );\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n\tgetBoundingBox( target ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\t// Empty sphere produces empty bounding box\n\t\t\ttarget.makeEmpty();\n\t\t\treturn target;\n\n\t\t}\n\n\t\ttarget.set( this.center, this.center );\n\t\ttarget.expandByScalar( this.radius );\n\n\t\treturn target;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tthis.center.applyMatrix4( matrix );\n\t\tthis.radius = this.radius * matrix.getMaxScaleOnAxis();\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.center.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\t// from https://github.com/juj/MathGeoLib/blob/2940b99b99cfe575dd45103ef20f4019dee15b54/src/Geometry/Sphere.cpp#L649-L671\n\n\t\t_toPoint.subVectors( point, this.center );\n\n\t\tconst lengthSq = _toPoint.lengthSq();\n\n\t\tif ( lengthSq > ( this.radius * this.radius ) ) {\n\n\t\t\tconst length = Math.sqrt( lengthSq );\n\t\t\tconst missingRadiusHalf = ( length - this.radius ) * 0.5;\n\n\t\t\t// Nudge this sphere towards the target point. Add half the missing distance to radius,\n\t\t\t// and the other half to position. This gives a tighter enclosure, instead of if\n\t\t\t// the whole missing distance were just added to radius.\n\n\t\t\tthis.center.add( _toPoint.multiplyScalar( missingRadiusHalf / length ) );\n\t\t\tthis.radius += missingRadiusHalf;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunion( sphere ) {\n\n\t\t// from https://github.com/juj/MathGeoLib/blob/2940b99b99cfe575dd45103ef20f4019dee15b54/src/Geometry/Sphere.cpp#L759-L769\n\n\t\t// To enclose another sphere into this sphere, we only need to enclose two points:\n\t\t// 1) Enclose the farthest point on the other sphere into this sphere.\n\t\t// 2) Enclose the opposite point of the farthest point into this sphere.\n\n\t\t_toFarthestPoint.subVectors( sphere.center, this.center ).normalize().multiplyScalar( sphere.radius );\n\n\t\tthis.expandByPoint( _v1.copy( sphere.center ).add( _toFarthestPoint ) );\n\t\tthis.expandByPoint( _v1.copy( sphere.center ).sub( _toFarthestPoint ) );\n\n\t\treturn this;\n\n\t}\n\n\tequals( sphere ) {\n\n\t\treturn sphere.center.equals( this.center ) && ( sphere.radius === this.radius );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nexport { Sphere };\n","import { Matrix3 } from './Matrix3.js';\nimport { Vector3 } from './Vector3.js';\n\nconst _vector1 = /*@__PURE__*/ new Vector3();\nconst _vector2 = /*@__PURE__*/ new Vector3();\nconst _normalMatrix = /*@__PURE__*/ new Matrix3();\n\nclass Plane {\n\n\tconstructor( normal = new Vector3( 1, 0, 0 ), constant = 0 ) {\n\n\t\t// normal is assumed to be normalized\n\n\t\tthis.normal = normal;\n\t\tthis.constant = constant;\n\n\t}\n\n\tset( normal, constant ) {\n\n\t\tthis.normal.copy( normal );\n\t\tthis.constant = constant;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponents( x, y, z, w ) {\n\n\t\tthis.normal.set( x, y, z );\n\t\tthis.constant = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromNormalAndCoplanarPoint( normal, point ) {\n\n\t\tthis.normal.copy( normal );\n\t\tthis.constant = - point.dot( this.normal );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCoplanarPoints( a, b, c ) {\n\n\t\tconst normal = _vector1.subVectors( c, b ).cross( _vector2.subVectors( a, b ) ).normalize();\n\n\t\t// Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\n\n\t\tthis.setFromNormalAndCoplanarPoint( normal, a );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( plane ) {\n\n\t\tthis.normal.copy( plane.normal );\n\t\tthis.constant = plane.constant;\n\n\t\treturn this;\n\n\t}\n\n\tnormalize() {\n\n\t\t// Note: will lead to a divide by zero if the plane is invalid.\n\n\t\tconst inverseNormalLength = 1.0 / this.normal.length();\n\t\tthis.normal.multiplyScalar( inverseNormalLength );\n\t\tthis.constant *= inverseNormalLength;\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.constant *= - 1;\n\t\tthis.normal.negate();\n\n\t\treturn this;\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn this.normal.dot( point ) + this.constant;\n\n\t}\n\n\tdistanceToSphere( sphere ) {\n\n\t\treturn this.distanceToPoint( sphere.center ) - sphere.radius;\n\n\t}\n\n\tprojectPoint( point, target ) {\n\n\t\treturn target.copy( this.normal ).multiplyScalar( - this.distanceToPoint( point ) ).add( point );\n\n\t}\n\n\tintersectLine( line, target ) {\n\n\t\tconst direction = line.delta( _vector1 );\n\n\t\tconst denominator = this.normal.dot( direction );\n\n\t\tif ( denominator === 0 ) {\n\n\t\t\t// line is coplanar, return origin\n\t\t\tif ( this.distanceToPoint( line.start ) === 0 ) {\n\n\t\t\t\treturn target.copy( line.start );\n\n\t\t\t}\n\n\t\t\t// Unsure if this is the correct method to handle this case.\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst t = - ( line.start.dot( this.normal ) + this.constant ) / denominator;\n\n\t\tif ( t < 0 || t > 1 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn target.copy( direction ).multiplyScalar( t ).add( line.start );\n\n\t}\n\n\tintersectsLine( line ) {\n\n\t\t// Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\n\n\t\tconst startSign = this.distanceToPoint( line.start );\n\t\tconst endSign = this.distanceToPoint( line.end );\n\n\t\treturn ( startSign < 0 && endSign > 0 ) || ( endSign < 0 && startSign > 0 );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsPlane( this );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\treturn sphere.intersectsPlane( this );\n\n\t}\n\n\tcoplanarPoint( target ) {\n\n\t\treturn target.copy( this.normal ).multiplyScalar( - this.constant );\n\n\t}\n\n\tapplyMatrix4( matrix, optionalNormalMatrix ) {\n\n\t\tconst normalMatrix = optionalNormalMatrix || _normalMatrix.getNormalMatrix( matrix );\n\n\t\tconst referencePoint = this.coplanarPoint( _vector1 ).applyMatrix4( matrix );\n\n\t\tconst normal = this.normal.applyMatrix3( normalMatrix ).normalize();\n\n\t\tthis.constant = - referencePoint.dot( normal );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.constant -= offset.dot( this.normal );\n\n\t\treturn this;\n\n\t}\n\n\tequals( plane ) {\n\n\t\treturn plane.normal.equals( this.normal ) && ( plane.constant === this.constant );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nPlane.prototype.isPlane = true;\n\nexport { Plane };\n","import { Vector3 } from './Vector3.js';\nimport { Sphere } from './Sphere.js';\nimport { Plane } from './Plane.js';\n\nconst _sphere = /*@__PURE__*/ new Sphere();\nconst _vector = /*@__PURE__*/ new Vector3();\n\nclass Frustum {\n\n\tconstructor( p0 = new Plane(), p1 = new Plane(), p2 = new Plane(), p3 = new Plane(), p4 = new Plane(), p5 = new Plane() ) {\n\n\t\tthis.planes = [ p0, p1, p2, p3, p4, p5 ];\n\n\t}\n\n\tset( p0, p1, p2, p3, p4, p5 ) {\n\n\t\tconst planes = this.planes;\n\n\t\tplanes[ 0 ].copy( p0 );\n\t\tplanes[ 1 ].copy( p1 );\n\t\tplanes[ 2 ].copy( p2 );\n\t\tplanes[ 3 ].copy( p3 );\n\t\tplanes[ 4 ].copy( p4 );\n\t\tplanes[ 5 ].copy( p5 );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( frustum ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tplanes[ i ].copy( frustum.planes[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromProjectionMatrix( m ) {\n\n\t\tconst planes = this.planes;\n\t\tconst me = m.elements;\n\t\tconst me0 = me[ 0 ], me1 = me[ 1 ], me2 = me[ 2 ], me3 = me[ 3 ];\n\t\tconst me4 = me[ 4 ], me5 = me[ 5 ], me6 = me[ 6 ], me7 = me[ 7 ];\n\t\tconst me8 = me[ 8 ], me9 = me[ 9 ], me10 = me[ 10 ], me11 = me[ 11 ];\n\t\tconst me12 = me[ 12 ], me13 = me[ 13 ], me14 = me[ 14 ], me15 = me[ 15 ];\n\n\t\tplanes[ 0 ].setComponents( me3 - me0, me7 - me4, me11 - me8, me15 - me12 ).normalize();\n\t\tplanes[ 1 ].setComponents( me3 + me0, me7 + me4, me11 + me8, me15 + me12 ).normalize();\n\t\tplanes[ 2 ].setComponents( me3 + me1, me7 + me5, me11 + me9, me15 + me13 ).normalize();\n\t\tplanes[ 3 ].setComponents( me3 - me1, me7 - me5, me11 - me9, me15 - me13 ).normalize();\n\t\tplanes[ 4 ].setComponents( me3 - me2, me7 - me6, me11 - me10, me15 - me14 ).normalize();\n\t\tplanes[ 5 ].setComponents( me3 + me2, me7 + me6, me11 + me10, me15 + me14 ).normalize();\n\n\t\treturn this;\n\n\t}\n\n\tintersectsObject( object ) {\n\n\t\tconst geometry = object.geometry;\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere.copy( geometry.boundingSphere ).applyMatrix4( object.matrixWorld );\n\n\t\treturn this.intersectsSphere( _sphere );\n\n\t}\n\n\tintersectsSprite( sprite ) {\n\n\t\t_sphere.center.set( 0, 0, 0 );\n\t\t_sphere.radius = 0.7071067811865476;\n\t\t_sphere.applyMatrix4( sprite.matrixWorld );\n\n\t\treturn this.intersectsSphere( _sphere );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\tconst planes = this.planes;\n\t\tconst center = sphere.center;\n\t\tconst negRadius = - sphere.radius;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst distance = planes[ i ].distanceToPoint( center );\n\n\t\t\tif ( distance < negRadius ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst plane = planes[ i ];\n\n\t\t\t// corner at max distance\n\n\t\t\t_vector.x = plane.normal.x > 0 ? box.max.x : box.min.x;\n\t\t\t_vector.y = plane.normal.y > 0 ? box.max.y : box.min.y;\n\t\t\t_vector.z = plane.normal.z > 0 ? box.max.z : box.min.z;\n\n\t\t\tif ( plane.distanceToPoint( _vector ) < 0 ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tif ( planes[ i ].distanceToPoint( point ) < 0 ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\n\nexport { Frustum };\n","import { Vector3 } from './Vector3.js';\n\nclass Matrix4 {\n\n\tconstructor() {\n\n\t\tthis.elements = [\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, 1, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t];\n\n\t\tif ( arguments.length > 0 ) {\n\n\t\t\tconsole.error( 'THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.' );\n\n\t\t}\n\n\t}\n\n\tset( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\n\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\n\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\n\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, 1, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new Matrix4().fromArray( this.elements );\n\n\t}\n\n\tcopy( m ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ]; te[ 3 ] = me[ 3 ];\n\t\tte[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ]; te[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ];\n\t\tte[ 8 ] = me[ 8 ]; te[ 9 ] = me[ 9 ]; te[ 10 ] = me[ 10 ]; te[ 11 ] = me[ 11 ];\n\t\tte[ 12 ] = me[ 12 ]; te[ 13 ] = me[ 13 ]; te[ 14 ] = me[ 14 ]; te[ 15 ] = me[ 15 ];\n\n\t\treturn this;\n\n\t}\n\n\tcopyPosition( m ) {\n\n\t\tconst te = this.elements, me = m.elements;\n\n\t\tte[ 12 ] = me[ 12 ];\n\t\tte[ 13 ] = me[ 13 ];\n\t\tte[ 14 ] = me[ 14 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrix3( m ) {\n\n\t\tconst me = m.elements;\n\n\t\tthis.set(\n\n\t\t\tme[ 0 ], me[ 3 ], me[ 6 ], 0,\n\t\t\tme[ 1 ], me[ 4 ], me[ 7 ], 0,\n\t\t\tme[ 2 ], me[ 5 ], me[ 8 ], 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\textractBasis( xAxis, yAxis, zAxis ) {\n\n\t\txAxis.setFromMatrixColumn( this, 0 );\n\t\tyAxis.setFromMatrixColumn( this, 1 );\n\t\tzAxis.setFromMatrixColumn( this, 2 );\n\n\t\treturn this;\n\n\t}\n\n\tmakeBasis( xAxis, yAxis, zAxis ) {\n\n\t\tthis.set(\n\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\n\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\n\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\n\t\t\t0, 0, 0, 1\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\textractRotation( m ) {\n\n\t\t// this method does not support reflection matrices\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tconst scaleX = 1 / _v1.setFromMatrixColumn( m, 0 ).length();\n\t\tconst scaleY = 1 / _v1.setFromMatrixColumn( m, 1 ).length();\n\t\tconst scaleZ = 1 / _v1.setFromMatrixColumn( m, 2 ).length();\n\n\t\tte[ 0 ] = me[ 0 ] * scaleX;\n\t\tte[ 1 ] = me[ 1 ] * scaleX;\n\t\tte[ 2 ] = me[ 2 ] * scaleX;\n\t\tte[ 3 ] = 0;\n\n\t\tte[ 4 ] = me[ 4 ] * scaleY;\n\t\tte[ 5 ] = me[ 5 ] * scaleY;\n\t\tte[ 6 ] = me[ 6 ] * scaleY;\n\t\tte[ 7 ] = 0;\n\n\t\tte[ 8 ] = me[ 8 ] * scaleZ;\n\t\tte[ 9 ] = me[ 9 ] * scaleZ;\n\t\tte[ 10 ] = me[ 10 ] * scaleZ;\n\t\tte[ 11 ] = 0;\n\n\t\tte[ 12 ] = 0;\n\t\tte[ 13 ] = 0;\n\t\tte[ 14 ] = 0;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationFromEuler( euler ) {\n\n\t\tif ( ! ( euler && euler.isEuler ) ) {\n\n\t\t\tconsole.error( 'THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\n\n\t\t}\n\n\t\tconst te = this.elements;\n\n\t\tconst x = euler.x, y = euler.y, z = euler.z;\n\t\tconst a = Math.cos( x ), b = Math.sin( x );\n\t\tconst c = Math.cos( y ), d = Math.sin( y );\n\t\tconst e = Math.cos( z ), f = Math.sin( z );\n\n\t\tif ( euler.order === 'XYZ' ) {\n\n\t\t\tconst ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = - c * f;\n\t\t\tte[ 8 ] = d;\n\n\t\t\tte[ 1 ] = af + be * d;\n\t\t\tte[ 5 ] = ae - bf * d;\n\t\t\tte[ 9 ] = - b * c;\n\n\t\t\tte[ 2 ] = bf - ae * d;\n\t\t\tte[ 6 ] = be + af * d;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'YXZ' ) {\n\n\t\t\tconst ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\tte[ 0 ] = ce + df * b;\n\t\t\tte[ 4 ] = de * b - cf;\n\t\t\tte[ 8 ] = a * d;\n\n\t\t\tte[ 1 ] = a * f;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = - b;\n\n\t\t\tte[ 2 ] = cf * b - de;\n\t\t\tte[ 6 ] = df + ce * b;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'ZXY' ) {\n\n\t\t\tconst ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\tte[ 0 ] = ce - df * b;\n\t\t\tte[ 4 ] = - a * f;\n\t\t\tte[ 8 ] = de + cf * b;\n\n\t\t\tte[ 1 ] = cf + de * b;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = df - ce * b;\n\n\t\t\tte[ 2 ] = - a * d;\n\t\t\tte[ 6 ] = b;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'ZYX' ) {\n\n\t\t\tconst ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = be * d - af;\n\t\t\tte[ 8 ] = ae * d + bf;\n\n\t\t\tte[ 1 ] = c * f;\n\t\t\tte[ 5 ] = bf * d + ae;\n\t\t\tte[ 9 ] = af * d - be;\n\n\t\t\tte[ 2 ] = - d;\n\t\t\tte[ 6 ] = b * c;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'YZX' ) {\n\n\t\t\tconst ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = bd - ac * f;\n\t\t\tte[ 8 ] = bc * f + ad;\n\n\t\t\tte[ 1 ] = f;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = - b * e;\n\n\t\t\tte[ 2 ] = - d * e;\n\t\t\tte[ 6 ] = ad * f + bc;\n\t\t\tte[ 10 ] = ac - bd * f;\n\n\t\t} else if ( euler.order === 'XZY' ) {\n\n\t\t\tconst ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = - f;\n\t\t\tte[ 8 ] = d * e;\n\n\t\t\tte[ 1 ] = ac * f + bd;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = ad * f - bc;\n\n\t\t\tte[ 2 ] = bc * f - ad;\n\t\t\tte[ 6 ] = b * e;\n\t\t\tte[ 10 ] = bd * f + ac;\n\n\t\t}\n\n\t\t// bottom row\n\t\tte[ 3 ] = 0;\n\t\tte[ 7 ] = 0;\n\t\tte[ 11 ] = 0;\n\n\t\t// last column\n\t\tte[ 12 ] = 0;\n\t\tte[ 13 ] = 0;\n\t\tte[ 14 ] = 0;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationFromQuaternion( q ) {\n\n\t\treturn this.compose( _zero, q, _one );\n\n\t}\n\n\tlookAt( eye, target, up ) {\n\n\t\tconst te = this.elements;\n\n\t\t_z.subVectors( eye, target );\n\n\t\tif ( _z.lengthSq() === 0 ) {\n\n\t\t\t// eye and target are in the same position\n\n\t\t\t_z.z = 1;\n\n\t\t}\n\n\t\t_z.normalize();\n\t\t_x.crossVectors( up, _z );\n\n\t\tif ( _x.lengthSq() === 0 ) {\n\n\t\t\t// up and z are parallel\n\n\t\t\tif ( Math.abs( up.z ) === 1 ) {\n\n\t\t\t\t_z.x += 0.0001;\n\n\t\t\t} else {\n\n\t\t\t\t_z.z += 0.0001;\n\n\t\t\t}\n\n\t\t\t_z.normalize();\n\t\t\t_x.crossVectors( up, _z );\n\n\t\t}\n\n\t\t_x.normalize();\n\t\t_y.crossVectors( _z, _x );\n\n\t\tte[ 0 ] = _x.x; te[ 4 ] = _y.x; te[ 8 ] = _z.x;\n\t\tte[ 1 ] = _x.y; te[ 5 ] = _y.y; te[ 9 ] = _z.y;\n\t\tte[ 2 ] = _x.z; te[ 6 ] = _y.z; te[ 10 ] = _z.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( m, n ) {\n\n\t\tif ( n !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.' );\n\t\t\treturn this.multiplyMatrices( m, n );\n\n\t\t}\n\n\t\treturn this.multiplyMatrices( this, m );\n\n\t}\n\n\tpremultiply( m ) {\n\n\t\treturn this.multiplyMatrices( m, this );\n\n\t}\n\n\tmultiplyMatrices( a, b ) {\n\n\t\tconst ae = a.elements;\n\t\tconst be = b.elements;\n\t\tconst te = this.elements;\n\n\t\tconst a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\n\t\tconst a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\n\t\tconst a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\n\t\tconst a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\n\n\t\tconst b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\n\t\tconst b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\n\t\tconst b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\n\t\tconst b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\n\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\n\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\n\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\n\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\n\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\n\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\n\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\n\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\n\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\n\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\n\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\n\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\n\n\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\n\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\n\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\n\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\n\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\n\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\n\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\n\n\t\treturn this;\n\n\t}\n\n\tdeterminant() {\n\n\t\tconst te = this.elements;\n\n\t\tconst n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\n\t\tconst n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\n\t\tconst n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\n\t\tconst n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\n\n\t\t//TODO: make this more efficient\n\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\n\n\t\treturn (\n\t\t\tn41 * (\n\t\t\t\t+ n14 * n23 * n32\n\t\t\t\t - n13 * n24 * n32\n\t\t\t\t - n14 * n22 * n33\n\t\t\t\t + n12 * n24 * n33\n\t\t\t\t + n13 * n22 * n34\n\t\t\t\t - n12 * n23 * n34\n\t\t\t) +\n\t\t\tn42 * (\n\t\t\t\t+ n11 * n23 * n34\n\t\t\t\t - n11 * n24 * n33\n\t\t\t\t + n14 * n21 * n33\n\t\t\t\t - n13 * n21 * n34\n\t\t\t\t + n13 * n24 * n31\n\t\t\t\t - n14 * n23 * n31\n\t\t\t) +\n\t\t\tn43 * (\n\t\t\t\t+ n11 * n24 * n32\n\t\t\t\t - n11 * n22 * n34\n\t\t\t\t - n14 * n21 * n32\n\t\t\t\t + n12 * n21 * n34\n\t\t\t\t + n14 * n22 * n31\n\t\t\t\t - n12 * n24 * n31\n\t\t\t) +\n\t\t\tn44 * (\n\t\t\t\t- n13 * n22 * n31\n\t\t\t\t - n11 * n23 * n32\n\t\t\t\t + n11 * n22 * n33\n\t\t\t\t + n13 * n21 * n32\n\t\t\t\t - n12 * n21 * n33\n\t\t\t\t + n12 * n23 * n31\n\t\t\t)\n\n\t\t);\n\n\t}\n\n\ttranspose() {\n\n\t\tconst te = this.elements;\n\t\tlet tmp;\n\n\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\n\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\n\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\n\n\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\n\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\n\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\n\n\t\treturn this;\n\n\t}\n\n\tsetPosition( x, y, z ) {\n\n\t\tconst te = this.elements;\n\n\t\tif ( x.isVector3 ) {\n\n\t\t\tte[ 12 ] = x.x;\n\t\t\tte[ 13 ] = x.y;\n\t\t\tte[ 14 ] = x.z;\n\n\t\t} else {\n\n\t\t\tte[ 12 ] = x;\n\t\t\tte[ 13 ] = y;\n\t\t\tte[ 14 ] = z;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tinvert() {\n\n\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\n\t\tconst te = this.elements,\n\n\t\t\tn11 = te[ 0 ], n21 = te[ 1 ], n31 = te[ 2 ], n41 = te[ 3 ],\n\t\t\tn12 = te[ 4 ], n22 = te[ 5 ], n32 = te[ 6 ], n42 = te[ 7 ],\n\t\t\tn13 = te[ 8 ], n23 = te[ 9 ], n33 = te[ 10 ], n43 = te[ 11 ],\n\t\t\tn14 = te[ 12 ], n24 = te[ 13 ], n34 = te[ 14 ], n44 = te[ 15 ],\n\n\t\t\tt11 = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44,\n\t\t\tt12 = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44,\n\t\t\tt13 = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44,\n\t\t\tt14 = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\n\n\t\tconst det = n11 * t11 + n21 * t12 + n31 * t13 + n41 * t14;\n\n\t\tif ( det === 0 ) return this.set( 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );\n\n\t\tconst detInv = 1 / det;\n\n\t\tte[ 0 ] = t11 * detInv;\n\t\tte[ 1 ] = ( n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44 ) * detInv;\n\t\tte[ 2 ] = ( n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44 ) * detInv;\n\t\tte[ 3 ] = ( n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43 ) * detInv;\n\n\t\tte[ 4 ] = t12 * detInv;\n\t\tte[ 5 ] = ( n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44 ) * detInv;\n\t\tte[ 6 ] = ( n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44 ) * detInv;\n\t\tte[ 7 ] = ( n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43 ) * detInv;\n\n\t\tte[ 8 ] = t13 * detInv;\n\t\tte[ 9 ] = ( n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44 ) * detInv;\n\t\tte[ 10 ] = ( n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44 ) * detInv;\n\t\tte[ 11 ] = ( n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43 ) * detInv;\n\n\t\tte[ 12 ] = t14 * detInv;\n\t\tte[ 13 ] = ( n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34 ) * detInv;\n\t\tte[ 14 ] = ( n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34 ) * detInv;\n\t\tte[ 15 ] = ( n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33 ) * detInv;\n\n\t\treturn this;\n\n\t}\n\n\tscale( v ) {\n\n\t\tconst te = this.elements;\n\t\tconst x = v.x, y = v.y, z = v.z;\n\n\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\n\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\n\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\n\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\n\n\t\treturn this;\n\n\t}\n\n\tgetMaxScaleOnAxis() {\n\n\t\tconst te = this.elements;\n\n\t\tconst scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\n\t\tconst scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\n\t\tconst scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\n\n\t\treturn Math.sqrt( Math.max( scaleXSq, scaleYSq, scaleZSq ) );\n\n\t}\n\n\tmakeTranslation( x, y, z ) {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, x,\n\t\t\t0, 1, 0, y,\n\t\t\t0, 0, 1, z,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationX( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, c, - s, 0,\n\t\t\t0, s, c, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationY( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\t c, 0, s, 0,\n\t\t\t 0, 1, 0, 0,\n\t\t\t- s, 0, c, 0,\n\t\t\t 0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationZ( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\tc, - s, 0, 0,\n\t\t\ts, c, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationAxis( axis, angle ) {\n\n\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\n\n\t\tconst c = Math.cos( angle );\n\t\tconst s = Math.sin( angle );\n\t\tconst t = 1 - c;\n\t\tconst x = axis.x, y = axis.y, z = axis.z;\n\t\tconst tx = t * x, ty = t * y;\n\n\t\tthis.set(\n\n\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\n\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\n\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeScale( x, y, z ) {\n\n\t\tthis.set(\n\n\t\t\tx, 0, 0, 0,\n\t\t\t0, y, 0, 0,\n\t\t\t0, 0, z, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeShear( xy, xz, yx, yz, zx, zy ) {\n\n\t\tthis.set(\n\n\t\t\t1, yx, zx, 0,\n\t\t\txy, 1, zy, 0,\n\t\t\txz, yz, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tcompose( position, quaternion, scale ) {\n\n\t\tconst te = this.elements;\n\n\t\tconst x = quaternion._x, y = quaternion._y, z = quaternion._z, w = quaternion._w;\n\t\tconst x2 = x + x,\ty2 = y + y, z2 = z + z;\n\t\tconst xx = x * x2, xy = x * y2, xz = x * z2;\n\t\tconst yy = y * y2, yz = y * z2, zz = z * z2;\n\t\tconst wx = w * x2, wy = w * y2, wz = w * z2;\n\n\t\tconst sx = scale.x, sy = scale.y, sz = scale.z;\n\n\t\tte[ 0 ] = ( 1 - ( yy + zz ) ) * sx;\n\t\tte[ 1 ] = ( xy + wz ) * sx;\n\t\tte[ 2 ] = ( xz - wy ) * sx;\n\t\tte[ 3 ] = 0;\n\n\t\tte[ 4 ] = ( xy - wz ) * sy;\n\t\tte[ 5 ] = ( 1 - ( xx + zz ) ) * sy;\n\t\tte[ 6 ] = ( yz + wx ) * sy;\n\t\tte[ 7 ] = 0;\n\n\t\tte[ 8 ] = ( xz + wy ) * sz;\n\t\tte[ 9 ] = ( yz - wx ) * sz;\n\t\tte[ 10 ] = ( 1 - ( xx + yy ) ) * sz;\n\t\tte[ 11 ] = 0;\n\n\t\tte[ 12 ] = position.x;\n\t\tte[ 13 ] = position.y;\n\t\tte[ 14 ] = position.z;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tdecompose( position, quaternion, scale ) {\n\n\t\tconst te = this.elements;\n\n\t\tlet sx = _v1.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\n\t\tconst sy = _v1.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\n\t\tconst sz = _v1.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\n\n\t\t// if determine is negative, we need to invert one scale\n\t\tconst det = this.determinant();\n\t\tif ( det < 0 ) sx = - sx;\n\n\t\tposition.x = te[ 12 ];\n\t\tposition.y = te[ 13 ];\n\t\tposition.z = te[ 14 ];\n\n\t\t// scale the rotation part\n\t\t_m1.copy( this );\n\n\t\tconst invSX = 1 / sx;\n\t\tconst invSY = 1 / sy;\n\t\tconst invSZ = 1 / sz;\n\n\t\t_m1.elements[ 0 ] *= invSX;\n\t\t_m1.elements[ 1 ] *= invSX;\n\t\t_m1.elements[ 2 ] *= invSX;\n\n\t\t_m1.elements[ 4 ] *= invSY;\n\t\t_m1.elements[ 5 ] *= invSY;\n\t\t_m1.elements[ 6 ] *= invSY;\n\n\t\t_m1.elements[ 8 ] *= invSZ;\n\t\t_m1.elements[ 9 ] *= invSZ;\n\t\t_m1.elements[ 10 ] *= invSZ;\n\n\t\tquaternion.setFromRotationMatrix( _m1 );\n\n\t\tscale.x = sx;\n\t\tscale.y = sy;\n\t\tscale.z = sz;\n\n\t\treturn this;\n\n\t}\n\n\tmakePerspective( left, right, top, bottom, near, far ) {\n\n\t\tif ( far === undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.' );\n\n\t\t}\n\n\t\tconst te = this.elements;\n\t\tconst x = 2 * near / ( right - left );\n\t\tconst y = 2 * near / ( top - bottom );\n\n\t\tconst a = ( right + left ) / ( right - left );\n\t\tconst b = ( top + bottom ) / ( top - bottom );\n\t\tconst c = - ( far + near ) / ( far - near );\n\t\tconst d = - 2 * far * near / ( far - near );\n\n\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a;\tte[ 12 ] = 0;\n\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b;\tte[ 13 ] = 0;\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c;\tte[ 14 ] = d;\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\n\n\t\treturn this;\n\n\t}\n\n\tmakeOrthographic( left, right, top, bottom, near, far ) {\n\n\t\tconst te = this.elements;\n\t\tconst w = 1.0 / ( right - left );\n\t\tconst h = 1.0 / ( top - bottom );\n\t\tconst p = 1.0 / ( far - near );\n\n\t\tconst x = ( right + left ) * w;\n\t\tconst y = ( top + bottom ) * h;\n\t\tconst z = ( far + near ) * p;\n\n\t\tte[ 0 ] = 2 * w;\tte[ 4 ] = 0;\tte[ 8 ] = 0;\tte[ 12 ] = - x;\n\t\tte[ 1 ] = 0;\tte[ 5 ] = 2 * h;\tte[ 9 ] = 0;\tte[ 13 ] = - y;\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = - 2 * p;\tte[ 14 ] = - z;\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = 0;\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tequals( matrix ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = matrix.elements;\n\n\t\tfor ( let i = 0; i < 16; i ++ ) {\n\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tfor ( let i = 0; i < 16; i ++ ) {\n\n\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst te = this.elements;\n\n\t\tarray[ offset ] = te[ 0 ];\n\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\tarray[ offset + 2 ] = te[ 2 ];\n\t\tarray[ offset + 3 ] = te[ 3 ];\n\n\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\tarray[ offset + 5 ] = te[ 5 ];\n\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\tarray[ offset + 7 ] = te[ 7 ];\n\n\t\tarray[ offset + 8 ] = te[ 8 ];\n\t\tarray[ offset + 9 ] = te[ 9 ];\n\t\tarray[ offset + 10 ] = te[ 10 ];\n\t\tarray[ offset + 11 ] = te[ 11 ];\n\n\t\tarray[ offset + 12 ] = te[ 12 ];\n\t\tarray[ offset + 13 ] = te[ 13 ];\n\t\tarray[ offset + 14 ] = te[ 14 ];\n\t\tarray[ offset + 15 ] = te[ 15 ];\n\n\t\treturn array;\n\n\t}\n\n}\n\nMatrix4.prototype.isMatrix4 = true;\n\nconst _v1 = /*@__PURE__*/ new Vector3();\nconst _m1 = /*@__PURE__*/ new Matrix4();\nconst _zero = /*@__PURE__*/ new Vector3( 0, 0, 0 );\nconst _one = /*@__PURE__*/ new Vector3( 1, 1, 1 );\nconst _x = /*@__PURE__*/ new Vector3();\nconst _y = /*@__PURE__*/ new Vector3();\nconst _z = /*@__PURE__*/ new Vector3();\n\nexport { Matrix4 };\n","class Vector4 {\n\n\tconstructor( x = 0, y = 0, z = 0, w = 1 ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t\tthis.w = w;\n\n\t}\n\n\tget width() {\n\n\t\treturn this.z;\n\n\t}\n\n\tset width( value ) {\n\n\t\tthis.z = value;\n\n\t}\n\n\tget height() {\n\n\t\treturn this.w;\n\n\t}\n\n\tset height( value ) {\n\n\t\tthis.w = value;\n\n\t}\n\n\tset( x, y, z, w ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t\tthis.w = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\t\tthis.z = scalar;\n\t\tthis.w = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( z ) {\n\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetW( w ) {\n\n\t\tthis.w = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tcase 2: this.z = value; break;\n\t\t\tcase 3: this.w = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tcase 2: return this.z;\n\t\t\tcase 3: return this.w;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y, this.z, this.w );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t\tthis.z = v.z;\n\t\tthis.w = ( v.w !== undefined ) ? v.w : 1;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\n\t\t\treturn this.addVectors( v, w );\n\n\t\t}\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t\tthis.z += v.z;\n\t\tthis.w += v.w;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\t\tthis.z += s;\n\t\tthis.w += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\t\tthis.z = a.z + b.z;\n\t\tthis.w = a.w + b.w;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\t\tthis.z += v.z * s;\n\t\tthis.w += v.w * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\n\t\t\treturn this.subVectors( v, w );\n\n\t\t}\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\t\tthis.z -= v.z;\n\t\tthis.w -= v.w;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\t\tthis.z -= s;\n\t\tthis.w -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\t\tthis.z = a.z - b.z;\n\t\tthis.w = a.w - b.w;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\t\tthis.z *= v.z;\n\t\tthis.w *= v.w;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\tthis.z *= scalar;\n\t\tthis.w *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z, w = this.w;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\n\t\tthis.w = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tsetAxisAngleFromQuaternion( q ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\n\n\t\t// q is assumed to be normalized\n\n\t\tthis.w = 2 * Math.acos( q.w );\n\n\t\tconst s = Math.sqrt( 1 - q.w * q.w );\n\n\t\tif ( s < 0.0001 ) {\n\n\t\t\tthis.x = 1;\n\t\t\tthis.y = 0;\n\t\t\tthis.z = 0;\n\n\t\t} else {\n\n\t\t\tthis.x = q.x / s;\n\t\t\tthis.y = q.y / s;\n\t\t\tthis.z = q.z / s;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetAxisAngleFromRotationMatrix( m ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tlet angle, x, y, z; // variables for result\n\t\tconst epsilon = 0.01,\t\t// margin to allow for rounding errors\n\t\t\tepsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\n\n\t\t\tte = m.elements,\n\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\tif ( ( Math.abs( m12 - m21 ) < epsilon ) &&\n\t\t     ( Math.abs( m13 - m31 ) < epsilon ) &&\n\t\t     ( Math.abs( m23 - m32 ) < epsilon ) ) {\n\n\t\t\t// singularity found\n\t\t\t// first check for identity matrix which must have +1 for all terms\n\t\t\t// in leading diagonal and zero in other terms\n\n\t\t\tif ( ( Math.abs( m12 + m21 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m13 + m31 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m23 + m32 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m11 + m22 + m33 - 3 ) < epsilon2 ) ) {\n\n\t\t\t\t// this singularity is identity matrix so angle = 0\n\n\t\t\t\tthis.set( 1, 0, 0, 0 );\n\n\t\t\t\treturn this; // zero angle, arbitrary axis\n\n\t\t\t}\n\n\t\t\t// otherwise this singularity is angle = 180\n\n\t\t\tangle = Math.PI;\n\n\t\t\tconst xx = ( m11 + 1 ) / 2;\n\t\t\tconst yy = ( m22 + 1 ) / 2;\n\t\t\tconst zz = ( m33 + 1 ) / 2;\n\t\t\tconst xy = ( m12 + m21 ) / 4;\n\t\t\tconst xz = ( m13 + m31 ) / 4;\n\t\t\tconst yz = ( m23 + m32 ) / 4;\n\n\t\t\tif ( ( xx > yy ) && ( xx > zz ) ) {\n\n\t\t\t\t// m11 is the largest diagonal term\n\n\t\t\t\tif ( xx < epsilon ) {\n\n\t\t\t\t\tx = 0;\n\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tx = Math.sqrt( xx );\n\t\t\t\t\ty = xy / x;\n\t\t\t\t\tz = xz / x;\n\n\t\t\t\t}\n\n\t\t\t} else if ( yy > zz ) {\n\n\t\t\t\t// m22 is the largest diagonal term\n\n\t\t\t\tif ( yy < epsilon ) {\n\n\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\ty = 0;\n\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t} else {\n\n\t\t\t\t\ty = Math.sqrt( yy );\n\t\t\t\t\tx = xy / y;\n\t\t\t\t\tz = yz / y;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// m33 is the largest diagonal term so base result on this\n\n\t\t\t\tif ( zz < epsilon ) {\n\n\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\tz = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tz = Math.sqrt( zz );\n\t\t\t\t\tx = xz / z;\n\t\t\t\t\ty = yz / z;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.set( x, y, z, angle );\n\n\t\t\treturn this; // return 180 deg rotation\n\n\t\t}\n\n\t\t// as we have reached here there are no singularities so we can handle normally\n\n\t\tlet s = Math.sqrt( ( m32 - m23 ) * ( m32 - m23 ) +\n\t\t\t( m13 - m31 ) * ( m13 - m31 ) +\n\t\t\t( m21 - m12 ) * ( m21 - m12 ) ); // used to normalize\n\n\t\tif ( Math.abs( s ) < 0.001 ) s = 1;\n\n\t\t// prevent divide by zero, should not happen if matrix is orthogonal and should be\n\t\t// caught by singularity test above, but I've left it in just in case\n\n\t\tthis.x = ( m32 - m23 ) / s;\n\t\tthis.y = ( m13 - m31 ) / s;\n\t\tthis.z = ( m21 - m12 ) / s;\n\t\tthis.w = Math.acos( ( m11 + m22 + m33 - 1 ) / 2 );\n\n\t\treturn this;\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\t\tthis.z = Math.min( this.z, v.z );\n\t\tthis.w = Math.min( this.w, v.w );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\t\tthis.z = Math.max( this.z, v.z );\n\t\tthis.w = Math.max( this.w, v.w );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\n\t\tthis.w = Math.max( min.w, Math.min( max.w, this.w ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\n\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\n\t\tthis.z = Math.max( minVal, Math.min( maxVal, this.z ) );\n\t\tthis.w = Math.max( minVal, Math.min( maxVal, this.w ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\t\tthis.z = Math.floor( this.z );\n\t\tthis.w = Math.floor( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\t\tthis.z = Math.ceil( this.z );\n\t\tthis.w = Math.ceil( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\t\tthis.z = Math.round( this.z );\n\t\tthis.w = Math.round( this.w );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\n\t\tthis.w = ( this.w < 0 ) ? Math.ceil( this.w ) : Math.floor( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\t\tthis.z = - this.z;\n\t\tthis.w = - this.w;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z ) + Math.abs( this.w );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\tthis.z += ( v.z - this.z ) * alpha;\n\t\tthis.w += ( v.w - this.w ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\t\tthis.z = v1.z + ( v2.z - v1.z ) * alpha;\n\t\tthis.w = v1.w + ( v2.w - v1.w ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) && ( v.w === this.w ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\t\tthis.z = array[ offset + 2 ];\n\t\tthis.w = array[ offset + 3 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\t\tarray[ offset + 2 ] = this.z;\n\t\tarray[ offset + 3 ] = this.w;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index, offset ) {\n\n\t\tif ( offset !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector4: offset has been removed from .fromBufferAttribute().' );\n\n\t\t}\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\t\tthis.z = attribute.getZ( index );\n\t\tthis.w = attribute.getW( index );\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\t\tthis.z = Math.random();\n\t\tthis.w = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\t\tyield this.z;\n\t\tyield this.w;\n\n\t}\n\n}\n\nVector4.prototype.isVector4 = true;\n\nexport { Vector4 };\n","function WebGLAnimation() {\n\n\tlet context = null;\n\tlet isAnimating = false;\n\tlet animationLoop = null;\n\tlet requestId = null;\n\n\tfunction onAnimationFrame( time, frame ) {\n\n\t\tanimationLoop( time, frame );\n\n\t\trequestId = context.requestAnimationFrame( onAnimationFrame );\n\n\t}\n\n\treturn {\n\n\t\tstart: function () {\n\n\t\t\tif ( isAnimating === true ) return;\n\t\t\tif ( animationLoop === null ) return;\n\n\t\t\trequestId = context.requestAnimationFrame( onAnimationFrame );\n\n\t\t\tisAnimating = true;\n\n\t\t},\n\n\t\tstop: function () {\n\n\t\t\tcontext.cancelAnimationFrame( requestId );\n\n\t\t\tisAnimating = false;\n\n\t\t},\n\n\t\tsetAnimationLoop: function ( callback ) {\n\n\t\t\tanimationLoop = callback;\n\n\t\t},\n\n\t\tsetContext: function ( value ) {\n\n\t\t\tcontext = value;\n\n\t\t}\n\n\t};\n\n}\n\nexport { WebGLAnimation };\n","function WebGLAttributes( gl, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tconst buffers = new WeakMap();\n\n\tfunction createBuffer( attribute, bufferType ) {\n\n\t\tconst array = attribute.array;\n\t\tconst usage = attribute.usage;\n\n\t\tconst buffer = gl.createBuffer();\n\n\t\tgl.bindBuffer( bufferType, buffer );\n\t\tgl.bufferData( bufferType, array, usage );\n\n\t\tattribute.onUploadCallback();\n\n\t\tlet type = gl.FLOAT;\n\n\t\tif ( array instanceof Float32Array ) {\n\n\t\t\ttype = gl.FLOAT;\n\n\t\t} else if ( array instanceof Float64Array ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.' );\n\n\t\t} else if ( array instanceof Uint16Array ) {\n\n\t\t\tif ( attribute.isFloat16BufferAttribute ) {\n\n\t\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\t\ttype = gl.HALF_FLOAT;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.' );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\ttype = gl.UNSIGNED_SHORT;\n\n\t\t\t}\n\n\t\t} else if ( array instanceof Int16Array ) {\n\n\t\t\ttype = gl.SHORT;\n\n\t\t} else if ( array instanceof Uint32Array ) {\n\n\t\t\ttype = gl.UNSIGNED_INT;\n\n\t\t} else if ( array instanceof Int32Array ) {\n\n\t\t\ttype = gl.INT;\n\n\t\t} else if ( array instanceof Int8Array ) {\n\n\t\t\ttype = gl.BYTE;\n\n\t\t} else if ( array instanceof Uint8Array ) {\n\n\t\t\ttype = gl.UNSIGNED_BYTE;\n\n\t\t} else if ( array instanceof Uint8ClampedArray ) {\n\n\t\t\ttype = gl.UNSIGNED_BYTE;\n\n\t\t}\n\n\t\treturn {\n\t\t\tbuffer: buffer,\n\t\t\ttype: type,\n\t\t\tbytesPerElement: array.BYTES_PER_ELEMENT,\n\t\t\tversion: attribute.version\n\t\t};\n\n\t}\n\n\tfunction updateBuffer( buffer, attribute, bufferType ) {\n\n\t\tconst array = attribute.array;\n\t\tconst updateRange = attribute.updateRange;\n\n\t\tgl.bindBuffer( bufferType, buffer );\n\n\t\tif ( updateRange.count === - 1 ) {\n\n\t\t\t// Not using update ranges\n\n\t\t\tgl.bufferSubData( bufferType, 0, array );\n\n\t\t} else {\n\n\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\tgl.bufferSubData( bufferType, updateRange.offset * array.BYTES_PER_ELEMENT,\n\t\t\t\t\tarray, updateRange.offset, updateRange.count );\n\n\t\t\t} else {\n\n\t\t\t\tgl.bufferSubData( bufferType, updateRange.offset * array.BYTES_PER_ELEMENT,\n\t\t\t\t\tarray.subarray( updateRange.offset, updateRange.offset + updateRange.count ) );\n\n\t\t\t}\n\n\t\t\tupdateRange.count = - 1; // reset range\n\n\t\t}\n\n\t}\n\n\t//\n\n\tfunction get( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\treturn buffers.get( attribute );\n\n\t}\n\n\tfunction remove( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\tconst data = buffers.get( attribute );\n\n\t\tif ( data ) {\n\n\t\t\tgl.deleteBuffer( data.buffer );\n\n\t\t\tbuffers.delete( attribute );\n\n\t\t}\n\n\t}\n\n\tfunction update( attribute, bufferType ) {\n\n\t\tif ( attribute.isGLBufferAttribute ) {\n\n\t\t\tconst cached = buffers.get( attribute );\n\n\t\t\tif ( ! cached || cached.version < attribute.version ) {\n\n\t\t\t\tbuffers.set( attribute, {\n\t\t\t\t\tbuffer: attribute.buffer,\n\t\t\t\t\ttype: attribute.type,\n\t\t\t\t\tbytesPerElement: attribute.elementSize,\n\t\t\t\t\tversion: attribute.version\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\tconst data = buffers.get( attribute );\n\n\t\tif ( data === undefined ) {\n\n\t\t\tbuffers.set( attribute, createBuffer( attribute, bufferType ) );\n\n\t\t} else if ( data.version < attribute.version ) {\n\n\t\t\tupdateBuffer( data.buffer, attribute, bufferType );\n\n\t\t\tdata.version = attribute.version;\n\n\t\t}\n\n\t}\n\n\treturn {\n\n\t\tget: get,\n\t\tremove: remove,\n\t\tupdate: update\n\n\t};\n\n}\n\n\nexport { WebGLAttributes };\n","import { Vector4 } from '../math/Vector4.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Color } from '../math/Color.js';\nimport { StaticDrawUsage } from '../constants.js';\n\nconst _vector = /*@__PURE__*/ new Vector3();\nconst _vector2 = /*@__PURE__*/ new Vector2();\n\nclass BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tif ( Array.isArray( array ) ) {\n\n\t\t\tthrow new TypeError( 'THREE.BufferAttribute: array should be a Typed Array.' );\n\n\t\t}\n\n\t\tthis.name = '';\n\n\t\tthis.array = array;\n\t\tthis.itemSize = itemSize;\n\t\tthis.count = array !== undefined ? array.length / itemSize : 0;\n\t\tthis.normalized = normalized === true;\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.updateRange = { offset: 0, count: - 1 };\n\n\t\tthis.version = 0;\n\n\t}\n\n\tonUploadCallback() {}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\t\tthis.array = new source.array.constructor( source.array );\n\t\tthis.itemSize = source.itemSize;\n\t\tthis.count = source.count;\n\t\tthis.normalized = source.normalized;\n\n\t\tthis.usage = source.usage;\n\n\t\treturn this;\n\n\t}\n\n\tcopyAt( index1, attribute, index2 ) {\n\n\t\tindex1 *= this.itemSize;\n\t\tindex2 *= attribute.itemSize;\n\n\t\tfor ( let i = 0, l = this.itemSize; i < l; i ++ ) {\n\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcopyArray( array ) {\n\n\t\tthis.array.set( array );\n\n\t\treturn this;\n\n\t}\n\n\tcopyColorsArray( colors ) {\n\n\t\tconst array = this.array;\n\t\tlet offset = 0;\n\n\t\tfor ( let i = 0, l = colors.length; i < l; i ++ ) {\n\n\t\t\tlet color = colors[ i ];\n\n\t\t\tif ( color === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyColorsArray(): color is undefined', i );\n\t\t\t\tcolor = new Color();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = color.r;\n\t\t\tarray[ offset ++ ] = color.g;\n\t\t\tarray[ offset ++ ] = color.b;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcopyVector2sArray( vectors ) {\n\n\t\tconst array = this.array;\n\t\tlet offset = 0;\n\n\t\tfor ( let i = 0, l = vectors.length; i < l; i ++ ) {\n\n\t\t\tlet vector = vectors[ i ];\n\n\t\t\tif ( vector === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector2sArray(): vector is undefined', i );\n\t\t\t\tvector = new Vector2();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = vector.x;\n\t\t\tarray[ offset ++ ] = vector.y;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcopyVector3sArray( vectors ) {\n\n\t\tconst array = this.array;\n\t\tlet offset = 0;\n\n\t\tfor ( let i = 0, l = vectors.length; i < l; i ++ ) {\n\n\t\t\tlet vector = vectors[ i ];\n\n\t\t\tif ( vector === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector3sArray(): vector is undefined', i );\n\t\t\t\tvector = new Vector3();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = vector.x;\n\t\t\tarray[ offset ++ ] = vector.y;\n\t\t\tarray[ offset ++ ] = vector.z;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcopyVector4sArray( vectors ) {\n\n\t\tconst array = this.array;\n\t\tlet offset = 0;\n\n\t\tfor ( let i = 0, l = vectors.length; i < l; i ++ ) {\n\n\t\t\tlet vector = vectors[ i ];\n\n\t\t\tif ( vector === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector4sArray(): vector is undefined', i );\n\t\t\t\tvector = new Vector4();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = vector.x;\n\t\t\tarray[ offset ++ ] = vector.y;\n\t\t\tarray[ offset ++ ] = vector.z;\n\t\t\tarray[ offset ++ ] = vector.w;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tif ( this.itemSize === 2 ) {\n\n\t\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t\t_vector2.fromBufferAttribute( this, i );\n\t\t\t\t_vector2.applyMatrix3( m );\n\n\t\t\t\tthis.setXY( i, _vector2.x, _vector2.y );\n\n\t\t\t}\n\n\t\t} else if ( this.itemSize === 3 ) {\n\n\t\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t\t_vector.fromBufferAttribute( this, i );\n\t\t\t\t_vector.applyMatrix3( m );\n\n\t\t\t\tthis.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector.x = this.getX( i );\n\t\t\t_vector.y = this.getY( i );\n\t\t\t_vector.z = this.getZ( i );\n\n\t\t\t_vector.applyMatrix4( m );\n\n\t\t\tthis.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector.x = this.getX( i );\n\t\t\t_vector.y = this.getY( i );\n\t\t\t_vector.z = this.getZ( i );\n\n\t\t\t_vector.applyNormalMatrix( m );\n\n\t\t\tthis.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector.x = this.getX( i );\n\t\t\t_vector.y = this.getY( i );\n\t\t\t_vector.z = this.getZ( i );\n\n\t\t\t_vector.transformDirection( m );\n\n\t\t\tthis.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tset( value, offset = 0 ) {\n\n\t\tthis.array.set( value, offset );\n\n\t\treturn this;\n\n\t}\n\n\tgetX( index ) {\n\n\t\treturn this.array[ index * this.itemSize ];\n\n\t}\n\n\tsetX( index, x ) {\n\n\t\tthis.array[ index * this.itemSize ] = x;\n\n\t\treturn this;\n\n\t}\n\n\tgetY( index ) {\n\n\t\treturn this.array[ index * this.itemSize + 1 ];\n\n\t}\n\n\tsetY( index, y ) {\n\n\t\tthis.array[ index * this.itemSize + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tgetZ( index ) {\n\n\t\treturn this.array[ index * this.itemSize + 2 ];\n\n\t}\n\n\tsetZ( index, z ) {\n\n\t\tthis.array[ index * this.itemSize + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tgetW( index ) {\n\n\t\treturn this.array[ index * this.itemSize + 3 ];\n\n\t}\n\n\tsetW( index, w ) {\n\n\t\tthis.array[ index * this.itemSize + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetXY( index, x, y ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZ( index, x, y, z ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\t\tthis.array[ index + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZW( index, x, y, z, w ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\t\tthis.array[ index + 2 ] = z;\n\t\tthis.array[ index + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tonUpload( callback ) {\n\n\t\tthis.onUploadCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.array, this.itemSize ).copy( this );\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\titemSize: this.itemSize,\n\t\t\ttype: this.array.constructor.name,\n\t\t\tarray: Array.prototype.slice.call( this.array ),\n\t\t\tnormalized: this.normalized\n\t\t};\n\n\t\tif ( this.name !== '' ) data.name = this.name;\n\t\tif ( this.usage !== StaticDrawUsage ) data.usage = this.usage;\n\t\tif ( this.updateRange.offset !== 0 || this.updateRange.count !== - 1 ) data.updateRange = this.updateRange;\n\n\t\treturn data;\n\n\t}\n\n}\n\nBufferAttribute.prototype.isBufferAttribute = true;\n\n//\n\nclass Int8BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int8Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint8BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint8Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint8ClampedBufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint8ClampedArray( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Int16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int16Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint16Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Int32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Float16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint16Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nFloat16BufferAttribute.prototype.isFloat16BufferAttribute = true;\n\nclass Float32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Float32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Float64BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Float64Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\n//\n\nexport {\n\tFloat64BufferAttribute,\n\tFloat32BufferAttribute,\n\tFloat16BufferAttribute,\n\tUint32BufferAttribute,\n\tInt32BufferAttribute,\n\tUint16BufferAttribute,\n\tInt16BufferAttribute,\n\tUint8ClampedBufferAttribute,\n\tUint8BufferAttribute,\n\tInt8BufferAttribute,\n\tBufferAttribute\n};\n","import { Quaternion } from './Quaternion.js';\nimport { Vector3 } from './Vector3.js';\nimport { Matrix4 } from './Matrix4.js';\nimport { clamp } from './MathUtils.js';\n\nconst _matrix = /*@__PURE__*/ new Matrix4();\nconst _quaternion = /*@__PURE__*/ new Quaternion();\n\nclass Euler {\n\n\tconstructor( x = 0, y = 0, z = 0, order = Euler.DefaultOrder ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._order = order;\n\n\t}\n\n\tget x() {\n\n\t\treturn this._x;\n\n\t}\n\n\tset x( value ) {\n\n\t\tthis._x = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget y() {\n\n\t\treturn this._y;\n\n\t}\n\n\tset y( value ) {\n\n\t\tthis._y = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget z() {\n\n\t\treturn this._z;\n\n\t}\n\n\tset z( value ) {\n\n\t\tthis._z = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget order() {\n\n\t\treturn this._order;\n\n\t}\n\n\tset order( value ) {\n\n\t\tthis._order = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tset( x, y, z, order = this._order ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._order = order;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this._x, this._y, this._z, this._order );\n\n\t}\n\n\tcopy( euler ) {\n\n\t\tthis._x = euler._x;\n\t\tthis._y = euler._y;\n\t\tthis._z = euler._z;\n\t\tthis._order = euler._order;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromRotationMatrix( m, order = this._order, update = true ) {\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tconst te = m.elements;\n\t\tconst m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ];\n\t\tconst m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ];\n\t\tconst m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\tswitch ( order ) {\n\n\t\t\tcase 'XYZ':\n\n\t\t\t\tthis._y = Math.asin( clamp( m13, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m13 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\t\tthis._z = Math.atan2( - m12, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\t\tthis._z = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'YXZ':\n\n\t\t\t\tthis._x = Math.asin( - clamp( m23, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m23 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\t\t\t\t\tthis._z = Math.atan2( m21, m22 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\t\t\t\t\tthis._z = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZXY':\n\n\t\t\t\tthis._x = Math.asin( clamp( m32, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m32 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._y = Math.atan2( - m31, m33 );\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._y = 0;\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZYX':\n\n\t\t\t\tthis._y = Math.asin( - clamp( m31, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m31 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m33 );\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = 0;\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'YZX':\n\n\t\t\t\tthis._z = Math.asin( clamp( m21, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m21 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m22 );\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = 0;\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'XZY':\n\n\t\t\t\tthis._z = Math.asin( - clamp( m12, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m12 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\t\tthis._y = Math.atan2( m13, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\t\tthis._y = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tconsole.warn( 'THREE.Euler: .setFromRotationMatrix() encountered an unknown order: ' + order );\n\n\t\t}\n\n\t\tthis._order = order;\n\n\t\tif ( update === true ) this._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromQuaternion( q, order, update ) {\n\n\t\t_matrix.makeRotationFromQuaternion( q );\n\n\t\treturn this.setFromRotationMatrix( _matrix, order, update );\n\n\t}\n\n\tsetFromVector3( v, order = this._order ) {\n\n\t\treturn this.set( v.x, v.y, v.z, order );\n\n\t}\n\n\treorder( newOrder ) {\n\n\t\t// WARNING: this discards revolution information -bhouston\n\n\t\t_quaternion.setFromEuler( this );\n\n\t\treturn this.setFromQuaternion( _quaternion, newOrder );\n\n\t}\n\n\tequals( euler ) {\n\n\t\treturn ( euler._x === this._x ) && ( euler._y === this._y ) && ( euler._z === this._z ) && ( euler._order === this._order );\n\n\t}\n\n\tfromArray( array ) {\n\n\t\tthis._x = array[ 0 ];\n\t\tthis._y = array[ 1 ];\n\t\tthis._z = array[ 2 ];\n\t\tif ( array[ 3 ] !== undefined ) this._order = array[ 3 ];\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this._x;\n\t\tarray[ offset + 1 ] = this._y;\n\t\tarray[ offset + 2 ] = this._z;\n\t\tarray[ offset + 3 ] = this._order;\n\n\t\treturn array;\n\n\t}\n\n\ttoVector3( optionalResult ) {\n\n\t\tif ( optionalResult ) {\n\n\t\t\treturn optionalResult.set( this._x, this._y, this._z );\n\n\t\t} else {\n\n\t\t\treturn new Vector3( this._x, this._y, this._z );\n\n\t\t}\n\n\t}\n\n\t_onChange( callback ) {\n\n\t\tthis._onChangeCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\t_onChangeCallback() {}\n\n}\n\nEuler.prototype.isEuler = true;\n\nEuler.DefaultOrder = 'XYZ';\nEuler.RotationOrders = [ 'XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX' ];\n\nexport { Euler };\n","class Layers {\n\n\tconstructor() {\n\n\t\tthis.mask = 1 | 0;\n\n\t}\n\n\tset( channel ) {\n\n\t\tthis.mask = 1 << channel | 0;\n\n\t}\n\n\tenable( channel ) {\n\n\t\tthis.mask |= 1 << channel | 0;\n\n\t}\n\n\tenableAll() {\n\n\t\tthis.mask = 0xffffffff | 0;\n\n\t}\n\n\ttoggle( channel ) {\n\n\t\tthis.mask ^= 1 << channel | 0;\n\n\t}\n\n\tdisable( channel ) {\n\n\t\tthis.mask &= ~ ( 1 << channel | 0 );\n\n\t}\n\n\tdisableAll() {\n\n\t\tthis.mask = 0;\n\n\t}\n\n\ttest( layers ) {\n\n\t\treturn ( this.mask & layers.mask ) !== 0;\n\n\t}\n\n}\n\n\nexport { Layers };\n","import { Quaternion } from '../math/Quaternion.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { EventDispatcher } from './EventDispatcher.js';\nimport { Euler } from '../math/Euler.js';\nimport { Layers } from './Layers.js';\nimport { Matrix3 } from '../math/Matrix3.js';\nimport * as MathUtils from '../math/MathUtils.js';\n\nlet _object3DId = 0;\n\nconst _v1 = /*@__PURE__*/ new Vector3();\nconst _q1 = /*@__PURE__*/ new Quaternion();\nconst _m1 = /*@__PURE__*/ new Matrix4();\nconst _target = /*@__PURE__*/ new Vector3();\n\nconst _position = /*@__PURE__*/ new Vector3();\nconst _scale = /*@__PURE__*/ new Vector3();\nconst _quaternion = /*@__PURE__*/ new Quaternion();\n\nconst _xAxis = /*@__PURE__*/ new Vector3( 1, 0, 0 );\nconst _yAxis = /*@__PURE__*/ new Vector3( 0, 1, 0 );\nconst _zAxis = /*@__PURE__*/ new Vector3( 0, 0, 1 );\n\nconst _addedEvent = { type: 'added' };\nconst _removedEvent = { type: 'removed' };\n\nclass Object3D extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tObject.defineProperty( this, 'id', { value: _object3DId ++ } );\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'Object3D';\n\n\t\tthis.parent = null;\n\t\tthis.children = [];\n\n\t\tthis.up = Object3D.DefaultUp.clone();\n\n\t\tconst position = new Vector3();\n\t\tconst rotation = new Euler();\n\t\tconst quaternion = new Quaternion();\n\t\tconst scale = new Vector3( 1, 1, 1 );\n\n\t\tfunction onRotationChange() {\n\n\t\t\tquaternion.setFromEuler( rotation, false );\n\n\t\t}\n\n\t\tfunction onQuaternionChange() {\n\n\t\t\trotation.setFromQuaternion( quaternion, undefined, false );\n\n\t\t}\n\n\t\trotation._onChange( onRotationChange );\n\t\tquaternion._onChange( onQuaternionChange );\n\n\t\tObject.defineProperties( this, {\n\t\t\tposition: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: position\n\t\t\t},\n\t\t\trotation: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: rotation\n\t\t\t},\n\t\t\tquaternion: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: quaternion\n\t\t\t},\n\t\t\tscale: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: scale\n\t\t\t},\n\t\t\tmodelViewMatrix: {\n\t\t\t\tvalue: new Matrix4()\n\t\t\t},\n\t\t\tnormalMatrix: {\n\t\t\t\tvalue: new Matrix3()\n\t\t\t}\n\t\t} );\n\n\t\tthis.matrix = new Matrix4();\n\t\tthis.matrixWorld = new Matrix4();\n\n\t\tthis.matrixAutoUpdate = Object3D.DefaultMatrixAutoUpdate;\n\t\tthis.matrixWorldNeedsUpdate = false;\n\n\t\tthis.layers = new Layers();\n\t\tthis.visible = true;\n\n\t\tthis.castShadow = false;\n\t\tthis.receiveShadow = false;\n\n\t\tthis.frustumCulled = true;\n\t\tthis.renderOrder = 0;\n\n\t\tthis.animations = [];\n\n\t\tthis.userData = {};\n\n\t}\n\n\tonBeforeRender( /* renderer, scene, camera, geometry, material, group */ ) {}\n\n\tonAfterRender( /* renderer, scene, camera, geometry, material, group */ ) {}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tthis.matrix.premultiply( matrix );\n\n\t\tthis.matrix.decompose( this.position, this.quaternion, this.scale );\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\tthis.quaternion.premultiply( q );\n\n\t\treturn this;\n\n\t}\n\n\tsetRotationFromAxisAngle( axis, angle ) {\n\n\t\t// assumes axis is normalized\n\n\t\tthis.quaternion.setFromAxisAngle( axis, angle );\n\n\t}\n\n\tsetRotationFromEuler( euler ) {\n\n\t\tthis.quaternion.setFromEuler( euler, true );\n\n\t}\n\n\tsetRotationFromMatrix( m ) {\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tthis.quaternion.setFromRotationMatrix( m );\n\n\t}\n\n\tsetRotationFromQuaternion( q ) {\n\n\t\t// assumes q is normalized\n\n\t\tthis.quaternion.copy( q );\n\n\t}\n\n\trotateOnAxis( axis, angle ) {\n\n\t\t// rotate object on axis in object space\n\t\t// axis is assumed to be normalized\n\n\t\t_q1.setFromAxisAngle( axis, angle );\n\n\t\tthis.quaternion.multiply( _q1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateOnWorldAxis( axis, angle ) {\n\n\t\t// rotate object on axis in world space\n\t\t// axis is assumed to be normalized\n\t\t// method assumes no rotated parent\n\n\t\t_q1.setFromAxisAngle( axis, angle );\n\n\t\tthis.quaternion.premultiply( _q1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateX( angle ) {\n\n\t\treturn this.rotateOnAxis( _xAxis, angle );\n\n\t}\n\n\trotateY( angle ) {\n\n\t\treturn this.rotateOnAxis( _yAxis, angle );\n\n\t}\n\n\trotateZ( angle ) {\n\n\t\treturn this.rotateOnAxis( _zAxis, angle );\n\n\t}\n\n\ttranslateOnAxis( axis, distance ) {\n\n\t\t// translate object by distance along axis in object space\n\t\t// axis is assumed to be normalized\n\n\t\t_v1.copy( axis ).applyQuaternion( this.quaternion );\n\n\t\tthis.position.add( _v1.multiplyScalar( distance ) );\n\n\t\treturn this;\n\n\t}\n\n\ttranslateX( distance ) {\n\n\t\treturn this.translateOnAxis( _xAxis, distance );\n\n\t}\n\n\ttranslateY( distance ) {\n\n\t\treturn this.translateOnAxis( _yAxis, distance );\n\n\t}\n\n\ttranslateZ( distance ) {\n\n\t\treturn this.translateOnAxis( _zAxis, distance );\n\n\t}\n\n\tlocalToWorld( vector ) {\n\n\t\treturn vector.applyMatrix4( this.matrixWorld );\n\n\t}\n\n\tworldToLocal( vector ) {\n\n\t\treturn vector.applyMatrix4( _m1.copy( this.matrixWorld ).invert() );\n\n\t}\n\n\tlookAt( x, y, z ) {\n\n\t\t// This method does not support objects having non-uniformly-scaled parent(s)\n\n\t\tif ( x.isVector3 ) {\n\n\t\t\t_target.copy( x );\n\n\t\t} else {\n\n\t\t\t_target.set( x, y, z );\n\n\t\t}\n\n\t\tconst parent = this.parent;\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\t_position.setFromMatrixPosition( this.matrixWorld );\n\n\t\tif ( this.isCamera || this.isLight ) {\n\n\t\t\t_m1.lookAt( _position, _target, this.up );\n\n\t\t} else {\n\n\t\t\t_m1.lookAt( _target, _position, this.up );\n\n\t\t}\n\n\t\tthis.quaternion.setFromRotationMatrix( _m1 );\n\n\t\tif ( parent ) {\n\n\t\t\t_m1.extractRotation( parent.matrixWorld );\n\t\t\t_q1.setFromRotationMatrix( _m1 );\n\t\t\tthis.quaternion.premultiply( _q1.invert() );\n\n\t\t}\n\n\t}\n\n\tadd( object ) {\n\n\t\tif ( arguments.length > 1 ) {\n\n\t\t\tfor ( let i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\tthis.add( arguments[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( object === this ) {\n\n\t\t\tconsole.error( 'THREE.Object3D.add: object can\\'t be added as a child of itself.', object );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( object && object.isObject3D ) {\n\n\t\t\tif ( object.parent !== null ) {\n\n\t\t\t\tobject.parent.remove( object );\n\n\t\t\t}\n\n\t\t\tobject.parent = this;\n\t\t\tthis.children.push( object );\n\n\t\t\tobject.dispatchEvent( _addedEvent );\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Object3D.add: object not an instance of THREE.Object3D.', object );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremove( object ) {\n\n\t\tif ( arguments.length > 1 ) {\n\n\t\t\tfor ( let i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\tthis.remove( arguments[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst index = this.children.indexOf( object );\n\n\t\tif ( index !== - 1 ) {\n\n\t\t\tobject.parent = null;\n\t\t\tthis.children.splice( index, 1 );\n\n\t\t\tobject.dispatchEvent( _removedEvent );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremoveFromParent() {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( parent !== null ) {\n\n\t\t\tparent.remove( this );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclear() {\n\n\t\tfor ( let i = 0; i < this.children.length; i ++ ) {\n\n\t\t\tconst object = this.children[ i ];\n\n\t\t\tobject.parent = null;\n\n\t\t\tobject.dispatchEvent( _removedEvent );\n\n\t\t}\n\n\t\tthis.children.length = 0;\n\n\t\treturn this;\n\n\n\t}\n\n\tattach( object ) {\n\n\t\t// adds object as a child of this, while maintaining the object's world transform\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\t_m1.copy( this.matrixWorld ).invert();\n\n\t\tif ( object.parent !== null ) {\n\n\t\t\tobject.parent.updateWorldMatrix( true, false );\n\n\t\t\t_m1.multiply( object.parent.matrixWorld );\n\n\t\t}\n\n\t\tobject.applyMatrix4( _m1 );\n\n\t\tthis.add( object );\n\n\t\tobject.updateWorldMatrix( false, true );\n\n\t\treturn this;\n\n\t}\n\n\tgetObjectById( id ) {\n\n\t\treturn this.getObjectByProperty( 'id', id );\n\n\t}\n\n\tgetObjectByName( name ) {\n\n\t\treturn this.getObjectByProperty( 'name', name );\n\n\t}\n\n\tgetObjectByProperty( name, value ) {\n\n\t\tif ( this[ name ] === value ) return this;\n\n\t\tfor ( let i = 0, l = this.children.length; i < l; i ++ ) {\n\n\t\t\tconst child = this.children[ i ];\n\t\t\tconst object = child.getObjectByProperty( name, value );\n\n\t\t\tif ( object !== undefined ) {\n\n\t\t\t\treturn object;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn undefined;\n\n\t}\n\n\tgetWorldPosition( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\treturn target.setFromMatrixPosition( this.matrixWorld );\n\n\t}\n\n\tgetWorldQuaternion( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tthis.matrixWorld.decompose( _position, target, _scale );\n\n\t\treturn target;\n\n\t}\n\n\tgetWorldScale( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tthis.matrixWorld.decompose( _position, _quaternion, target );\n\n\t\treturn target;\n\n\t}\n\n\tgetWorldDirection( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tconst e = this.matrixWorld.elements;\n\n\t\treturn target.set( e[ 8 ], e[ 9 ], e[ 10 ] ).normalize();\n\n\t}\n\n\traycast() {}\n\n\ttraverse( callback ) {\n\n\t\tcallback( this );\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].traverse( callback );\n\n\t\t}\n\n\t}\n\n\ttraverseVisible( callback ) {\n\n\t\tif ( this.visible === false ) return;\n\n\t\tcallback( this );\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].traverseVisible( callback );\n\n\t\t}\n\n\t}\n\n\ttraverseAncestors( callback ) {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( parent !== null ) {\n\n\t\t\tcallback( parent );\n\n\t\t\tparent.traverseAncestors( callback );\n\n\t\t}\n\n\t}\n\n\tupdateMatrix() {\n\n\t\tthis.matrix.compose( this.position, this.quaternion, this.scale );\n\n\t\tthis.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tif ( this.matrixWorldNeedsUpdate || force ) {\n\n\t\t\tif ( this.parent === null ) {\n\n\t\t\t\tthis.matrixWorld.copy( this.matrix );\n\n\t\t\t} else {\n\n\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\n\n\t\t\t}\n\n\t\t\tthis.matrixWorldNeedsUpdate = false;\n\n\t\t\tforce = true;\n\n\t\t}\n\n\t\t// update children\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].updateMatrixWorld( force );\n\n\t\t}\n\n\t}\n\n\tupdateWorldMatrix( updateParents, updateChildren ) {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( updateParents === true && parent !== null ) {\n\n\t\t\tparent.updateWorldMatrix( true, false );\n\n\t\t}\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tif ( this.parent === null ) {\n\n\t\t\tthis.matrixWorld.copy( this.matrix );\n\n\t\t} else {\n\n\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\n\n\t\t}\n\n\t\t// update children\n\n\t\tif ( updateChildren === true ) {\n\n\t\t\tconst children = this.children;\n\n\t\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tchildren[ i ].updateWorldMatrix( false, true );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\t// meta is a string when called from JSON.stringify\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tconst output = {};\n\n\t\t// meta is a hash used to collect geometries, materials.\n\t\t// not providing it implies that this is the root object\n\t\t// being serialized.\n\t\tif ( isRootObject ) {\n\n\t\t\t// initialize meta obj\n\t\t\tmeta = {\n\t\t\t\tgeometries: {},\n\t\t\t\tmaterials: {},\n\t\t\t\ttextures: {},\n\t\t\t\timages: {},\n\t\t\t\tshapes: {},\n\t\t\t\tskeletons: {},\n\t\t\t\tanimations: {}\n\t\t\t};\n\n\t\t\toutput.metadata = {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Object',\n\t\t\t\tgenerator: 'Object3D.toJSON'\n\t\t\t};\n\n\t\t}\n\n\t\t// standard Object3D serialization\n\n\t\tconst object = {};\n\n\t\tobject.uuid = this.uuid;\n\t\tobject.type = this.type;\n\n\t\tif ( this.name !== '' ) object.name = this.name;\n\t\tif ( this.castShadow === true ) object.castShadow = true;\n\t\tif ( this.receiveShadow === true ) object.receiveShadow = true;\n\t\tif ( this.visible === false ) object.visible = false;\n\t\tif ( this.frustumCulled === false ) object.frustumCulled = false;\n\t\tif ( this.renderOrder !== 0 ) object.renderOrder = this.renderOrder;\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) object.userData = this.userData;\n\n\t\tobject.layers = this.layers.mask;\n\t\tobject.matrix = this.matrix.toArray();\n\n\t\tif ( this.matrixAutoUpdate === false ) object.matrixAutoUpdate = false;\n\n\t\t// object specific properties\n\n\t\tif ( this.isInstancedMesh ) {\n\n\t\t\tobject.type = 'InstancedMesh';\n\t\t\tobject.count = this.count;\n\t\t\tobject.instanceMatrix = this.instanceMatrix.toJSON();\n\t\t\tif ( this.instanceColor !== null ) object.instanceColor = this.instanceColor.toJSON();\n\n\t\t}\n\n\t\t//\n\n\t\tfunction serialize( library, element ) {\n\n\t\t\tif ( library[ element.uuid ] === undefined ) {\n\n\t\t\t\tlibrary[ element.uuid ] = element.toJSON( meta );\n\n\t\t\t}\n\n\t\t\treturn element.uuid;\n\n\t\t}\n\n\t\tif ( this.isScene ) {\n\n\t\t\tif ( this.background ) {\n\n\t\t\t\tif ( this.background.isColor ) {\n\n\t\t\t\t\tobject.background = this.background.toJSON();\n\n\t\t\t\t} else if ( this.background.isTexture ) {\n\n\t\t\t\t\tobject.background = this.background.toJSON( meta ).uuid;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.environment && this.environment.isTexture ) {\n\n\t\t\t\tobject.environment = this.environment.toJSON( meta ).uuid;\n\n\t\t\t}\n\n\t\t} else if ( this.isMesh || this.isLine || this.isPoints ) {\n\n\t\t\tobject.geometry = serialize( meta.geometries, this.geometry );\n\n\t\t\tconst parameters = this.geometry.parameters;\n\n\t\t\tif ( parameters !== undefined && parameters.shapes !== undefined ) {\n\n\t\t\t\tconst shapes = parameters.shapes;\n\n\t\t\t\tif ( Array.isArray( shapes ) ) {\n\n\t\t\t\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\t\t\t\tconst shape = shapes[ i ];\n\n\t\t\t\t\t\tserialize( meta.shapes, shape );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tserialize( meta.shapes, shapes );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.isSkinnedMesh ) {\n\n\t\t\tobject.bindMode = this.bindMode;\n\t\t\tobject.bindMatrix = this.bindMatrix.toArray();\n\n\t\t\tif ( this.skeleton !== undefined ) {\n\n\t\t\t\tserialize( meta.skeletons, this.skeleton );\n\n\t\t\t\tobject.skeleton = this.skeleton.uuid;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.material !== undefined ) {\n\n\t\t\tif ( Array.isArray( this.material ) ) {\n\n\t\t\t\tconst uuids = [];\n\n\t\t\t\tfor ( let i = 0, l = this.material.length; i < l; i ++ ) {\n\n\t\t\t\t\tuuids.push( serialize( meta.materials, this.material[ i ] ) );\n\n\t\t\t\t}\n\n\t\t\t\tobject.material = uuids;\n\n\t\t\t} else {\n\n\t\t\t\tobject.material = serialize( meta.materials, this.material );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.children.length > 0 ) {\n\n\t\t\tobject.children = [];\n\n\t\t\tfor ( let i = 0; i < this.children.length; i ++ ) {\n\n\t\t\t\tobject.children.push( this.children[ i ].toJSON( meta ).object );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.animations.length > 0 ) {\n\n\t\t\tobject.animations = [];\n\n\t\t\tfor ( let i = 0; i < this.animations.length; i ++ ) {\n\n\t\t\t\tconst animation = this.animations[ i ];\n\n\t\t\t\tobject.animations.push( serialize( meta.animations, animation ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( isRootObject ) {\n\n\t\t\tconst geometries = extractFromCache( meta.geometries );\n\t\t\tconst materials = extractFromCache( meta.materials );\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\t\t\tconst shapes = extractFromCache( meta.shapes );\n\t\t\tconst skeletons = extractFromCache( meta.skeletons );\n\t\t\tconst animations = extractFromCache( meta.animations );\n\n\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\n\t\t\tif ( materials.length > 0 ) output.materials = materials;\n\t\t\tif ( textures.length > 0 ) output.textures = textures;\n\t\t\tif ( images.length > 0 ) output.images = images;\n\t\t\tif ( shapes.length > 0 ) output.shapes = shapes;\n\t\t\tif ( skeletons.length > 0 ) output.skeletons = skeletons;\n\t\t\tif ( animations.length > 0 ) output.animations = animations;\n\n\t\t}\n\n\t\toutput.object = object;\n\n\t\treturn output;\n\n\t\t// extract data from the cache hash\n\t\t// remove metadata on each item\n\t\t// and return as array\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t}\n\n\tclone( recursive ) {\n\n\t\treturn new this.constructor().copy( this, recursive );\n\n\t}\n\n\tcopy( source, recursive = true ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.up.copy( source.up );\n\n\t\tthis.position.copy( source.position );\n\t\tthis.rotation.order = source.rotation.order;\n\t\tthis.quaternion.copy( source.quaternion );\n\t\tthis.scale.copy( source.scale );\n\n\t\tthis.matrix.copy( source.matrix );\n\t\tthis.matrixWorld.copy( source.matrixWorld );\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\t\tthis.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\n\n\t\tthis.layers.mask = source.layers.mask;\n\t\tthis.visible = source.visible;\n\n\t\tthis.castShadow = source.castShadow;\n\t\tthis.receiveShadow = source.receiveShadow;\n\n\t\tthis.frustumCulled = source.frustumCulled;\n\t\tthis.renderOrder = source.renderOrder;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\tif ( recursive === true ) {\n\n\t\t\tfor ( let i = 0; i < source.children.length; i ++ ) {\n\n\t\t\t\tconst child = source.children[ i ];\n\t\t\t\tthis.add( child.clone() );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nObject3D.DefaultUp = new Vector3( 0, 1, 0 );\nObject3D.DefaultMatrixAutoUpdate = true;\n\nObject3D.prototype.isObject3D = true;\n\nexport { Object3D };\n","import { Vector3 } from '../math/Vector3.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Box3 } from '../math/Box3.js';\nimport { EventDispatcher } from './EventDispatcher.js';\nimport { BufferAttribute, Float32BufferAttribute, Uint16BufferAttribute, Uint32BufferAttribute } from './BufferAttribute.js';\nimport { Sphere } from '../math/Sphere.js';\nimport { Object3D } from './Object3D.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Matrix3 } from '../math/Matrix3.js';\nimport * as MathUtils from '../math/MathUtils.js';\nimport { arrayMax } from '../utils.js';\n\nlet _id = 0;\n\nconst _m1 = /*@__PURE__*/ new Matrix4();\nconst _obj = /*@__PURE__*/ new Object3D();\nconst _offset = /*@__PURE__*/ new Vector3();\nconst _box = /*@__PURE__*/ new Box3();\nconst _boxMorphTargets = /*@__PURE__*/ new Box3();\nconst _vector = /*@__PURE__*/ new Vector3();\n\nclass BufferGeometry extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tObject.defineProperty( this, 'id', { value: _id ++ } );\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'BufferGeometry';\n\n\t\tthis.index = null;\n\t\tthis.attributes = {};\n\n\t\tthis.morphAttributes = {};\n\t\tthis.morphTargetsRelative = false;\n\n\t\tthis.groups = [];\n\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\tthis.drawRange = { start: 0, count: Infinity };\n\n\t\tthis.userData = {};\n\n\t}\n\n\tgetIndex() {\n\n\t\treturn this.index;\n\n\t}\n\n\tsetIndex( index ) {\n\n\t\tif ( Array.isArray( index ) ) {\n\n\t\t\tthis.index = new ( arrayMax( index ) > 65535 ? Uint32BufferAttribute : Uint16BufferAttribute )( index, 1 );\n\n\t\t} else {\n\n\t\t\tthis.index = index;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetAttribute( name ) {\n\n\t\treturn this.attributes[ name ];\n\n\t}\n\n\tsetAttribute( name, attribute ) {\n\n\t\tthis.attributes[ name ] = attribute;\n\n\t\treturn this;\n\n\t}\n\n\tdeleteAttribute( name ) {\n\n\t\tdelete this.attributes[ name ];\n\n\t\treturn this;\n\n\t}\n\n\thasAttribute( name ) {\n\n\t\treturn this.attributes[ name ] !== undefined;\n\n\t}\n\n\taddGroup( start, count, materialIndex = 0 ) {\n\n\t\tthis.groups.push( {\n\n\t\t\tstart: start,\n\t\t\tcount: count,\n\t\t\tmaterialIndex: materialIndex\n\n\t\t} );\n\n\t}\n\n\tclearGroups() {\n\n\t\tthis.groups = [];\n\n\t}\n\n\tsetDrawRange( start, count ) {\n\n\t\tthis.drawRange.start = start;\n\t\tthis.drawRange.count = count;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tconst position = this.attributes.position;\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tposition.applyMatrix4( matrix );\n\n\t\t\tposition.needsUpdate = true;\n\n\t\t}\n\n\t\tconst normal = this.attributes.normal;\n\n\t\tif ( normal !== undefined ) {\n\n\t\t\tconst normalMatrix = new Matrix3().getNormalMatrix( matrix );\n\n\t\t\tnormal.applyNormalMatrix( normalMatrix );\n\n\t\t\tnormal.needsUpdate = true;\n\n\t\t}\n\n\t\tconst tangent = this.attributes.tangent;\n\n\t\tif ( tangent !== undefined ) {\n\n\t\t\ttangent.transformDirection( matrix );\n\n\t\t\ttangent.needsUpdate = true;\n\n\t\t}\n\n\t\tif ( this.boundingBox !== null ) {\n\n\t\t\tthis.computeBoundingBox();\n\n\t\t}\n\n\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\tthis.computeBoundingSphere();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\t_m1.makeRotationFromQuaternion( q );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateX( angle ) {\n\n\t\t// rotate geometry around world x-axis\n\n\t\t_m1.makeRotationX( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateY( angle ) {\n\n\t\t// rotate geometry around world y-axis\n\n\t\t_m1.makeRotationY( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateZ( angle ) {\n\n\t\t// rotate geometry around world z-axis\n\n\t\t_m1.makeRotationZ( angle );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( x, y, z ) {\n\n\t\t// translate geometry\n\n\t\t_m1.makeTranslation( x, y, z );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\tscale( x, y, z ) {\n\n\t\t// scale geometry\n\n\t\t_m1.makeScale( x, y, z );\n\n\t\tthis.applyMatrix4( _m1 );\n\n\t\treturn this;\n\n\t}\n\n\tlookAt( vector ) {\n\n\t\t_obj.lookAt( vector );\n\n\t\t_obj.updateMatrix();\n\n\t\tthis.applyMatrix4( _obj.matrix );\n\n\t\treturn this;\n\n\t}\n\n\tcenter() {\n\n\t\tthis.computeBoundingBox();\n\n\t\tthis.boundingBox.getCenter( _offset ).negate();\n\n\t\tthis.translate( _offset.x, _offset.y, _offset.z );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tconst position = [];\n\n\t\tfor ( let i = 0, l = points.length; i < l; i ++ ) {\n\n\t\t\tconst point = points[ i ];\n\t\t\tposition.push( point.x, point.y, point.z || 0 );\n\n\t\t}\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( position, 3 ) );\n\n\t\treturn this;\n\n\t}\n\n\tcomputeBoundingBox() {\n\n\t\tif ( this.boundingBox === null ) {\n\n\t\t\tthis.boundingBox = new Box3();\n\n\t\t}\n\n\t\tconst position = this.attributes.position;\n\t\tconst morphAttributesPosition = this.morphAttributes.position;\n\n\t\tif ( position && position.isGLBufferAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set \"mesh.frustumCulled\" to \"false\".', this );\n\n\t\t\tthis.boundingBox.set(\n\t\t\t\tnew Vector3( - Infinity, - Infinity, - Infinity ),\n\t\t\t\tnew Vector3( + Infinity, + Infinity, + Infinity )\n\t\t\t);\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tthis.boundingBox.setFromBufferAttribute( position );\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\t_box.setFromBufferAttribute( morphAttribute );\n\n\t\t\t\t\tif ( this.morphTargetsRelative ) {\n\n\t\t\t\t\t\t_vector.addVectors( this.boundingBox.min, _box.min );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector );\n\n\t\t\t\t\t\t_vector.addVectors( this.boundingBox.max, _box.max );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box.min );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box.max );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis.boundingBox.makeEmpty();\n\n\t\t}\n\n\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t}\n\n\t}\n\n\tcomputeBoundingSphere() {\n\n\t\tif ( this.boundingSphere === null ) {\n\n\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t}\n\n\t\tconst position = this.attributes.position;\n\t\tconst morphAttributesPosition = this.morphAttributes.position;\n\n\t\tif ( position && position.isGLBufferAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set \"mesh.frustumCulled\" to \"false\".', this );\n\n\t\t\tthis.boundingSphere.set( new Vector3(), Infinity );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( position ) {\n\n\t\t\t// first, find the center of the bounding sphere\n\n\t\t\tconst center = this.boundingSphere.center;\n\n\t\t\t_box.setFromBufferAttribute( position );\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\t_boxMorphTargets.setFromBufferAttribute( morphAttribute );\n\n\t\t\t\t\tif ( this.morphTargetsRelative ) {\n\n\t\t\t\t\t\t_vector.addVectors( _box.min, _boxMorphTargets.min );\n\t\t\t\t\t\t_box.expandByPoint( _vector );\n\n\t\t\t\t\t\t_vector.addVectors( _box.max, _boxMorphTargets.max );\n\t\t\t\t\t\t_box.expandByPoint( _vector );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t_box.expandByPoint( _boxMorphTargets.min );\n\t\t\t\t\t\t_box.expandByPoint( _boxMorphTargets.max );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_box.getCenter( center );\n\n\t\t\t// second, try to find a boundingSphere with a radius smaller than the\n\t\t\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\n\n\t\t\tlet maxRadiusSq = 0;\n\n\t\t\tfor ( let i = 0, il = position.count; i < il; i ++ ) {\n\n\t\t\t\t_vector.fromBufferAttribute( position, i );\n\n\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector ) );\n\n\t\t\t}\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\tconst morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t\t\t\tfor ( let j = 0, jl = morphAttribute.count; j < jl; j ++ ) {\n\n\t\t\t\t\t\t_vector.fromBufferAttribute( morphAttribute, j );\n\n\t\t\t\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t\t\t\t_offset.fromBufferAttribute( position, j );\n\t\t\t\t\t\t\t_vector.add( _offset );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\n\n\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcomputeTangents() {\n\n\t\tconst index = this.index;\n\t\tconst attributes = this.attributes;\n\n\t\t// based on http://www.terathon.com/code/tangent.html\n\t\t// (per vertex tangents)\n\n\t\tif ( index === null ||\n\t\t\t attributes.position === undefined ||\n\t\t\t attributes.normal === undefined ||\n\t\t\t attributes.uv === undefined ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst indices = index.array;\n\t\tconst positions = attributes.position.array;\n\t\tconst normals = attributes.normal.array;\n\t\tconst uvs = attributes.uv.array;\n\n\t\tconst nVertices = positions.length / 3;\n\n\t\tif ( attributes.tangent === undefined ) {\n\n\t\t\tthis.setAttribute( 'tangent', new BufferAttribute( new Float32Array( 4 * nVertices ), 4 ) );\n\n\t\t}\n\n\t\tconst tangents = attributes.tangent.array;\n\n\t\tconst tan1 = [], tan2 = [];\n\n\t\tfor ( let i = 0; i < nVertices; i ++ ) {\n\n\t\t\ttan1[ i ] = new Vector3();\n\t\t\ttan2[ i ] = new Vector3();\n\n\t\t}\n\n\t\tconst vA = new Vector3(),\n\t\t\tvB = new Vector3(),\n\t\t\tvC = new Vector3(),\n\n\t\t\tuvA = new Vector2(),\n\t\t\tuvB = new Vector2(),\n\t\t\tuvC = new Vector2(),\n\n\t\t\tsdir = new Vector3(),\n\t\t\ttdir = new Vector3();\n\n\t\tfunction handleTriangle( a, b, c ) {\n\n\t\t\tvA.fromArray( positions, a * 3 );\n\t\t\tvB.fromArray( positions, b * 3 );\n\t\t\tvC.fromArray( positions, c * 3 );\n\n\t\t\tuvA.fromArray( uvs, a * 2 );\n\t\t\tuvB.fromArray( uvs, b * 2 );\n\t\t\tuvC.fromArray( uvs, c * 2 );\n\n\t\t\tvB.sub( vA );\n\t\t\tvC.sub( vA );\n\n\t\t\tuvB.sub( uvA );\n\t\t\tuvC.sub( uvA );\n\n\t\t\tconst r = 1.0 / ( uvB.x * uvC.y - uvC.x * uvB.y );\n\n\t\t\t// silently ignore degenerate uv triangles having coincident or colinear vertices\n\n\t\t\tif ( ! isFinite( r ) ) return;\n\n\t\t\tsdir.copy( vB ).multiplyScalar( uvC.y ).addScaledVector( vC, - uvB.y ).multiplyScalar( r );\n\t\t\ttdir.copy( vC ).multiplyScalar( uvB.x ).addScaledVector( vB, - uvC.x ).multiplyScalar( r );\n\n\t\t\ttan1[ a ].add( sdir );\n\t\t\ttan1[ b ].add( sdir );\n\t\t\ttan1[ c ].add( sdir );\n\n\t\t\ttan2[ a ].add( tdir );\n\t\t\ttan2[ b ].add( tdir );\n\t\t\ttan2[ c ].add( tdir );\n\n\t\t}\n\n\t\tlet groups = this.groups;\n\n\t\tif ( groups.length === 0 ) {\n\n\t\t\tgroups = [ {\n\t\t\t\tstart: 0,\n\t\t\t\tcount: indices.length\n\t\t\t} ];\n\n\t\t}\n\n\t\tfor ( let i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tconst group = groups[ i ];\n\n\t\t\tconst start = group.start;\n\t\t\tconst count = group.count;\n\n\t\t\tfor ( let j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleTriangle(\n\t\t\t\t\tindices[ j + 0 ],\n\t\t\t\t\tindices[ j + 1 ],\n\t\t\t\t\tindices[ j + 2 ]\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst tmp = new Vector3(), tmp2 = new Vector3();\n\t\tconst n = new Vector3(), n2 = new Vector3();\n\n\t\tfunction handleVertex( v ) {\n\n\t\t\tn.fromArray( normals, v * 3 );\n\t\t\tn2.copy( n );\n\n\t\t\tconst t = tan1[ v ];\n\n\t\t\t// Gram-Schmidt orthogonalize\n\n\t\t\ttmp.copy( t );\n\t\t\ttmp.sub( n.multiplyScalar( n.dot( t ) ) ).normalize();\n\n\t\t\t// Calculate handedness\n\n\t\t\ttmp2.crossVectors( n2, t );\n\t\t\tconst test = tmp2.dot( tan2[ v ] );\n\t\t\tconst w = ( test < 0.0 ) ? - 1.0 : 1.0;\n\n\t\t\ttangents[ v * 4 ] = tmp.x;\n\t\t\ttangents[ v * 4 + 1 ] = tmp.y;\n\t\t\ttangents[ v * 4 + 2 ] = tmp.z;\n\t\t\ttangents[ v * 4 + 3 ] = w;\n\n\t\t}\n\n\t\tfor ( let i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tconst group = groups[ i ];\n\n\t\t\tconst start = group.start;\n\t\t\tconst count = group.count;\n\n\t\t\tfor ( let j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleVertex( indices[ j + 0 ] );\n\t\t\t\thandleVertex( indices[ j + 1 ] );\n\t\t\t\thandleVertex( indices[ j + 2 ] );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcomputeVertexNormals() {\n\n\t\tconst index = this.index;\n\t\tconst positionAttribute = this.getAttribute( 'position' );\n\n\t\tif ( positionAttribute !== undefined ) {\n\n\t\t\tlet normalAttribute = this.getAttribute( 'normal' );\n\n\t\t\tif ( normalAttribute === undefined ) {\n\n\t\t\t\tnormalAttribute = new BufferAttribute( new Float32Array( positionAttribute.count * 3 ), 3 );\n\t\t\t\tthis.setAttribute( 'normal', normalAttribute );\n\n\t\t\t} else {\n\n\t\t\t\t// reset existing normals to zero\n\n\t\t\t\tfor ( let i = 0, il = normalAttribute.count; i < il; i ++ ) {\n\n\t\t\t\t\tnormalAttribute.setXYZ( i, 0, 0, 0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst pA = new Vector3(), pB = new Vector3(), pC = new Vector3();\n\t\t\tconst nA = new Vector3(), nB = new Vector3(), nC = new Vector3();\n\t\t\tconst cb = new Vector3(), ab = new Vector3();\n\n\t\t\t// indexed elements\n\n\t\t\tif ( index ) {\n\n\t\t\t\tfor ( let i = 0, il = index.count; i < il; i += 3 ) {\n\n\t\t\t\t\tconst vA = index.getX( i + 0 );\n\t\t\t\t\tconst vB = index.getX( i + 1 );\n\t\t\t\t\tconst vC = index.getX( i + 2 );\n\n\t\t\t\t\tpA.fromBufferAttribute( positionAttribute, vA );\n\t\t\t\t\tpB.fromBufferAttribute( positionAttribute, vB );\n\t\t\t\t\tpC.fromBufferAttribute( positionAttribute, vC );\n\n\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\tnA.fromBufferAttribute( normalAttribute, vA );\n\t\t\t\t\tnB.fromBufferAttribute( normalAttribute, vB );\n\t\t\t\t\tnC.fromBufferAttribute( normalAttribute, vC );\n\n\t\t\t\t\tnA.add( cb );\n\t\t\t\t\tnB.add( cb );\n\t\t\t\t\tnC.add( cb );\n\n\t\t\t\t\tnormalAttribute.setXYZ( vA, nA.x, nA.y, nA.z );\n\t\t\t\t\tnormalAttribute.setXYZ( vB, nB.x, nB.y, nB.z );\n\t\t\t\t\tnormalAttribute.setXYZ( vC, nC.x, nC.y, nC.z );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// non-indexed elements (unconnected triangle soup)\n\n\t\t\t\tfor ( let i = 0, il = positionAttribute.count; i < il; i += 3 ) {\n\n\t\t\t\t\tpA.fromBufferAttribute( positionAttribute, i + 0 );\n\t\t\t\t\tpB.fromBufferAttribute( positionAttribute, i + 1 );\n\t\t\t\t\tpC.fromBufferAttribute( positionAttribute, i + 2 );\n\n\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\tnormalAttribute.setXYZ( i + 0, cb.x, cb.y, cb.z );\n\t\t\t\t\tnormalAttribute.setXYZ( i + 1, cb.x, cb.y, cb.z );\n\t\t\t\t\tnormalAttribute.setXYZ( i + 2, cb.x, cb.y, cb.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.normalizeNormals();\n\n\t\t\tnormalAttribute.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\tmerge( geometry, offset ) {\n\n\t\tif ( ! ( geometry && geometry.isBufferGeometry ) ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( offset === undefined ) {\n\n\t\t\toffset = 0;\n\n\t\t\tconsole.warn(\n\t\t\t\t'THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. '\n\t\t\t\t+ 'Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge.'\n\t\t\t);\n\n\t\t}\n\n\t\tconst attributes = this.attributes;\n\n\t\tfor ( const key in attributes ) {\n\n\t\t\tif ( geometry.attributes[ key ] === undefined ) continue;\n\n\t\t\tconst attribute1 = attributes[ key ];\n\t\t\tconst attributeArray1 = attribute1.array;\n\n\t\t\tconst attribute2 = geometry.attributes[ key ];\n\t\t\tconst attributeArray2 = attribute2.array;\n\n\t\t\tconst attributeOffset = attribute2.itemSize * offset;\n\t\t\tconst length = Math.min( attributeArray2.length, attributeArray1.length - attributeOffset );\n\n\t\t\tfor ( let i = 0, j = attributeOffset; i < length; i ++, j ++ ) {\n\n\t\t\t\tattributeArray1[ j ] = attributeArray2[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tnormalizeNormals() {\n\n\t\tconst normals = this.attributes.normal;\n\n\t\tfor ( let i = 0, il = normals.count; i < il; i ++ ) {\n\n\t\t\t_vector.fromBufferAttribute( normals, i );\n\n\t\t\t_vector.normalize();\n\n\t\t\tnormals.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t}\n\n\ttoNonIndexed() {\n\n\t\tfunction convertBufferAttribute( attribute, indices ) {\n\n\t\t\tconst array = attribute.array;\n\t\t\tconst itemSize = attribute.itemSize;\n\t\t\tconst normalized = attribute.normalized;\n\n\t\t\tconst array2 = new array.constructor( indices.length * itemSize );\n\n\t\t\tlet index = 0, index2 = 0;\n\n\t\t\tfor ( let i = 0, l = indices.length; i < l; i ++ ) {\n\n\t\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\t\tindex = indices[ i ] * attribute.data.stride + attribute.offset;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tindex = indices[ i ] * itemSize;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let j = 0; j < itemSize; j ++ ) {\n\n\t\t\t\t\tarray2[ index2 ++ ] = array[ index ++ ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new BufferAttribute( array2, itemSize, normalized );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.index === null ) {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed.' );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst geometry2 = new BufferGeometry();\n\n\t\tconst indices = this.index.array;\n\t\tconst attributes = this.attributes;\n\n\t\t// attributes\n\n\t\tfor ( const name in attributes ) {\n\n\t\t\tconst attribute = attributes[ name ];\n\n\t\t\tconst newAttribute = convertBufferAttribute( attribute, indices );\n\n\t\t\tgeometry2.setAttribute( name, newAttribute );\n\n\t\t}\n\n\t\t// morph attributes\n\n\t\tconst morphAttributes = this.morphAttributes;\n\n\t\tfor ( const name in morphAttributes ) {\n\n\t\t\tconst morphArray = [];\n\t\t\tconst morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\n\n\t\t\tfor ( let i = 0, il = morphAttribute.length; i < il; i ++ ) {\n\n\t\t\t\tconst attribute = morphAttribute[ i ];\n\n\t\t\t\tconst newAttribute = convertBufferAttribute( attribute, indices );\n\n\t\t\t\tmorphArray.push( newAttribute );\n\n\t\t\t}\n\n\t\t\tgeometry2.morphAttributes[ name ] = morphArray;\n\n\t\t}\n\n\t\tgeometry2.morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t// groups\n\n\t\tconst groups = this.groups;\n\n\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\tconst group = groups[ i ];\n\t\t\tgeometry2.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t}\n\n\t\treturn geometry2;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'BufferGeometry',\n\t\t\t\tgenerator: 'BufferGeometry.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard BufferGeometry serialization\n\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\t\tif ( this.name !== '' ) data.name = this.name;\n\t\tif ( Object.keys( this.userData ).length > 0 ) data.userData = this.userData;\n\n\t\tif ( this.parameters !== undefined ) {\n\n\t\t\tconst parameters = this.parameters;\n\n\t\t\tfor ( const key in parameters ) {\n\n\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\t// for simplicity the code assumes attributes are not shared across geometries, see #15811\n\n\t\tdata.data = { attributes: {} };\n\n\t\tconst index = this.index;\n\n\t\tif ( index !== null ) {\n\n\t\t\tdata.data.index = {\n\t\t\t\ttype: index.array.constructor.name,\n\t\t\t\tarray: Array.prototype.slice.call( index.array )\n\t\t\t};\n\n\t\t}\n\n\t\tconst attributes = this.attributes;\n\n\t\tfor ( const key in attributes ) {\n\n\t\t\tconst attribute = attributes[ key ];\n\n\t\t\tdata.data.attributes[ key ] = attribute.toJSON( data.data );\n\n\t\t}\n\n\t\tconst morphAttributes = {};\n\t\tlet hasMorphAttributes = false;\n\n\t\tfor ( const key in this.morphAttributes ) {\n\n\t\t\tconst attributeArray = this.morphAttributes[ key ];\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0, il = attributeArray.length; i < il; i ++ ) {\n\n\t\t\t\tconst attribute = attributeArray[ i ];\n\n\t\t\t\tarray.push( attribute.toJSON( data.data ) );\n\n\t\t\t}\n\n\t\t\tif ( array.length > 0 ) {\n\n\t\t\t\tmorphAttributes[ key ] = array;\n\n\t\t\t\thasMorphAttributes = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( hasMorphAttributes ) {\n\n\t\t\tdata.data.morphAttributes = morphAttributes;\n\t\t\tdata.data.morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t}\n\n\t\tconst groups = this.groups;\n\n\t\tif ( groups.length > 0 ) {\n\n\t\t\tdata.data.groups = JSON.parse( JSON.stringify( groups ) );\n\n\t\t}\n\n\t\tconst boundingSphere = this.boundingSphere;\n\n\t\tif ( boundingSphere !== null ) {\n\n\t\t\tdata.data.boundingSphere = {\n\t\t\t\tcenter: boundingSphere.center.toArray(),\n\t\t\t\tradius: boundingSphere.radius\n\t\t\t};\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tclone() {\n\n\t\t return new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\t// reset\n\n\t\tthis.index = null;\n\t\tthis.attributes = {};\n\t\tthis.morphAttributes = {};\n\t\tthis.groups = [];\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\t// used for storing cloned, shared data\n\n\t\tconst data = {};\n\n\t\t// name\n\n\t\tthis.name = source.name;\n\n\t\t// index\n\n\t\tconst index = source.index;\n\n\t\tif ( index !== null ) {\n\n\t\t\tthis.setIndex( index.clone( data ) );\n\n\t\t}\n\n\t\t// attributes\n\n\t\tconst attributes = source.attributes;\n\n\t\tfor ( const name in attributes ) {\n\n\t\t\tconst attribute = attributes[ name ];\n\t\t\tthis.setAttribute( name, attribute.clone( data ) );\n\n\t\t}\n\n\t\t// morph attributes\n\n\t\tconst morphAttributes = source.morphAttributes;\n\n\t\tfor ( const name in morphAttributes ) {\n\n\t\t\tconst array = [];\n\t\t\tconst morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\n\n\t\t\tfor ( let i = 0, l = morphAttribute.length; i < l; i ++ ) {\n\n\t\t\t\tarray.push( morphAttribute[ i ].clone( data ) );\n\n\t\t\t}\n\n\t\t\tthis.morphAttributes[ name ] = array;\n\n\t\t}\n\n\t\tthis.morphTargetsRelative = source.morphTargetsRelative;\n\n\t\t// groups\n\n\t\tconst groups = source.groups;\n\n\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\tconst group = groups[ i ];\n\t\t\tthis.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t}\n\n\t\t// bounding box\n\n\t\tconst boundingBox = source.boundingBox;\n\n\t\tif ( boundingBox !== null ) {\n\n\t\t\tthis.boundingBox = boundingBox.clone();\n\n\t\t}\n\n\t\t// bounding sphere\n\n\t\tconst boundingSphere = source.boundingSphere;\n\n\t\tif ( boundingSphere !== null ) {\n\n\t\t\tthis.boundingSphere = boundingSphere.clone();\n\n\t\t}\n\n\t\t// draw range\n\n\t\tthis.drawRange.start = source.drawRange.start;\n\t\tthis.drawRange.count = source.drawRange.count;\n\n\t\t// user data\n\n\t\tthis.userData = source.userData;\n\n\t\t// geometry generator parameters\n\n\t\tif ( source.parameters !== undefined ) this.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n}\n\nBufferGeometry.prototype.isBufferGeometry = true;\n\nexport { BufferGeometry };\n","import { BufferGeometry } from '../core/BufferGeometry.js';\nimport { Float32BufferAttribute } from '../core/BufferAttribute.js';\nimport { Vector3 } from '../math/Vector3.js';\n\nclass BoxGeometry extends BufferGeometry {\n\n\tconstructor( width = 1, height = 1, depth = 1, widthSegments = 1, heightSegments = 1, depthSegments = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'BoxGeometry';\n\n\t\tthis.parameters = {\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\tdepth: depth,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\tdepthSegments: depthSegments\n\t\t};\n\n\t\tconst scope = this;\n\n\t\t// segments\n\n\t\twidthSegments = Math.floor( widthSegments );\n\t\theightSegments = Math.floor( heightSegments );\n\t\tdepthSegments = Math.floor( depthSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tlet numberOfVertices = 0;\n\t\tlet groupStart = 0;\n\n\t\t// build each side of the box geometry\n\n\t\tbuildPlane( 'z', 'y', 'x', - 1, - 1, depth, height, width, depthSegments, heightSegments, 0 ); // px\n\t\tbuildPlane( 'z', 'y', 'x', 1, - 1, depth, height, - width, depthSegments, heightSegments, 1 ); // nx\n\t\tbuildPlane( 'x', 'z', 'y', 1, 1, width, depth, height, widthSegments, depthSegments, 2 ); // py\n\t\tbuildPlane( 'x', 'z', 'y', 1, - 1, width, depth, - height, widthSegments, depthSegments, 3 ); // ny\n\t\tbuildPlane( 'x', 'y', 'z', 1, - 1, width, height, depth, widthSegments, heightSegments, 4 ); // pz\n\t\tbuildPlane( 'x', 'y', 'z', - 1, - 1, width, height, - depth, widthSegments, heightSegments, 5 ); // nz\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\tfunction buildPlane( u, v, w, udir, vdir, width, height, depth, gridX, gridY, materialIndex ) {\n\n\t\t\tconst segmentWidth = width / gridX;\n\t\t\tconst segmentHeight = height / gridY;\n\n\t\t\tconst widthHalf = width / 2;\n\t\t\tconst heightHalf = height / 2;\n\t\t\tconst depthHalf = depth / 2;\n\n\t\t\tconst gridX1 = gridX + 1;\n\t\t\tconst gridY1 = gridY + 1;\n\n\t\t\tlet vertexCounter = 0;\n\t\t\tlet groupCount = 0;\n\n\t\t\tconst vector = new Vector3();\n\n\t\t\t// generate vertices, normals and uvs\n\n\t\t\tfor ( let iy = 0; iy < gridY1; iy ++ ) {\n\n\t\t\t\tconst y = iy * segmentHeight - heightHalf;\n\n\t\t\t\tfor ( let ix = 0; ix < gridX1; ix ++ ) {\n\n\t\t\t\t\tconst x = ix * segmentWidth - widthHalf;\n\n\t\t\t\t\t// set values to correct vector component\n\n\t\t\t\t\tvector[ u ] = x * udir;\n\t\t\t\t\tvector[ v ] = y * vdir;\n\t\t\t\t\tvector[ w ] = depthHalf;\n\n\t\t\t\t\t// now apply vector to vertex buffer\n\n\t\t\t\t\tvertices.push( vector.x, vector.y, vector.z );\n\n\t\t\t\t\t// set values to correct vector component\n\n\t\t\t\t\tvector[ u ] = 0;\n\t\t\t\t\tvector[ v ] = 0;\n\t\t\t\t\tvector[ w ] = depth > 0 ? 1 : - 1;\n\n\t\t\t\t\t// now apply vector to normal buffer\n\n\t\t\t\t\tnormals.push( vector.x, vector.y, vector.z );\n\n\t\t\t\t\t// uvs\n\n\t\t\t\t\tuvs.push( ix / gridX );\n\t\t\t\t\tuvs.push( 1 - ( iy / gridY ) );\n\n\t\t\t\t\t// counters\n\n\t\t\t\t\tvertexCounter += 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// indices\n\n\t\t\t// 1. you need three indices to draw a single face\n\t\t\t// 2. a single segment consists of two faces\n\t\t\t// 3. so we need to generate six (2*3) indices per segment\n\n\t\t\tfor ( let iy = 0; iy < gridY; iy ++ ) {\n\n\t\t\t\tfor ( let ix = 0; ix < gridX; ix ++ ) {\n\n\t\t\t\t\tconst a = numberOfVertices + ix + gridX1 * iy;\n\t\t\t\t\tconst b = numberOfVertices + ix + gridX1 * ( iy + 1 );\n\t\t\t\t\tconst c = numberOfVertices + ( ix + 1 ) + gridX1 * ( iy + 1 );\n\t\t\t\t\tconst d = numberOfVertices + ( ix + 1 ) + gridX1 * iy;\n\n\t\t\t\t\t// faces\n\n\t\t\t\t\tindices.push( a, b, d );\n\t\t\t\t\tindices.push( b, c, d );\n\n\t\t\t\t\t// increase counter\n\n\t\t\t\t\tgroupCount += 6;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\n\t\t\tscope.addGroup( groupStart, groupCount, materialIndex );\n\n\t\t\t// calculate new start value for groups\n\n\t\t\tgroupStart += groupCount;\n\n\t\t\t// update total number of vertices\n\n\t\t\tnumberOfVertices += vertexCounter;\n\n\t\t}\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new BoxGeometry( data.width, data.height, data.depth, data.widthSegments, data.heightSegments, data.depthSegments );\n\n\t}\n\n}\n\nexport { BoxGeometry, BoxGeometry as BoxBufferGeometry };\n","import { BufferGeometry } from '../core/BufferGeometry.js';\nimport { Float32BufferAttribute } from '../core/BufferAttribute.js';\n\nclass PlaneGeometry extends BufferGeometry {\n\n\tconstructor( width = 1, height = 1, widthSegments = 1, heightSegments = 1 ) {\n\n\t\tsuper();\n\t\tthis.type = 'PlaneGeometry';\n\n\t\tthis.parameters = {\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments\n\t\t};\n\n\t\tconst width_half = width / 2;\n\t\tconst height_half = height / 2;\n\n\t\tconst gridX = Math.floor( widthSegments );\n\t\tconst gridY = Math.floor( heightSegments );\n\n\t\tconst gridX1 = gridX + 1;\n\t\tconst gridY1 = gridY + 1;\n\n\t\tconst segment_width = width / gridX;\n\t\tconst segment_height = height / gridY;\n\n\t\t//\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\tfor ( let iy = 0; iy < gridY1; iy ++ ) {\n\n\t\t\tconst y = iy * segment_height - height_half;\n\n\t\t\tfor ( let ix = 0; ix < gridX1; ix ++ ) {\n\n\t\t\t\tconst x = ix * segment_width - width_half;\n\n\t\t\t\tvertices.push( x, - y, 0 );\n\n\t\t\t\tnormals.push( 0, 0, 1 );\n\n\t\t\t\tuvs.push( ix / gridX );\n\t\t\t\tuvs.push( 1 - ( iy / gridY ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( let iy = 0; iy < gridY; iy ++ ) {\n\n\t\t\tfor ( let ix = 0; ix < gridX; ix ++ ) {\n\n\t\t\t\tconst a = ix + gridX1 * iy;\n\t\t\t\tconst b = ix + gridX1 * ( iy + 1 );\n\t\t\t\tconst c = ( ix + 1 ) + gridX1 * ( iy + 1 );\n\t\t\t\tconst d = ( ix + 1 ) + gridX1 * iy;\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new PlaneGeometry( data.width, data.height, data.widthSegments, data.heightSegments );\n\n\t}\n\n}\n\nexport { PlaneGeometry, PlaneGeometry as PlaneBufferGeometry };\n","/**\n * Uniform Utilities\n */\n\nexport function cloneUniforms( src ) {\n\n\tconst dst = {};\n\n\tfor ( const u in src ) {\n\n\t\tdst[ u ] = {};\n\n\t\tfor ( const p in src[ u ] ) {\n\n\t\t\tconst property = src[ u ][ p ];\n\n\t\t\tif ( property && ( property.isColor ||\n\t\t\t\tproperty.isMatrix3 || property.isMatrix4 ||\n\t\t\t\tproperty.isVector2 || property.isVector3 || property.isVector4 ||\n\t\t\t\tproperty.isTexture || property.isQuaternion ) ) {\n\n\t\t\t\tdst[ u ][ p ] = property.clone();\n\n\t\t\t} else if ( Array.isArray( property ) ) {\n\n\t\t\t\tdst[ u ][ p ] = property.slice();\n\n\t\t\t} else {\n\n\t\t\t\tdst[ u ][ p ] = property;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn dst;\n\n}\n\nexport function mergeUniforms( uniforms ) {\n\n\tconst merged = {};\n\n\tfor ( let u = 0; u < uniforms.length; u ++ ) {\n\n\t\tconst tmp = cloneUniforms( uniforms[ u ] );\n\n\t\tfor ( const p in tmp ) {\n\n\t\t\tmerged[ p ] = tmp[ p ];\n\n\t\t}\n\n\t}\n\n\treturn merged;\n\n}\n\n// Legacy\n\nconst UniformsUtils = { clone: cloneUniforms, merge: mergeUniforms };\n\nexport { UniformsUtils };\n","import { Material } from './Material.js';\nimport { cloneUniforms } from '../renderers/shaders/UniformsUtils.js';\n\nimport default_vertex from '../renderers/shaders/ShaderChunk/default_vertex.glsl.js';\nimport default_fragment from '../renderers/shaders/ShaderChunk/default_fragment.glsl.js';\n\n/**\n * parameters = {\n *  defines: { \"label\" : \"value\" },\n *  uniforms: { \"parameter1\": { value: 1.0 }, \"parameter2\": { value2: 2 } },\n *\n *  fragmentShader: <string>,\n *  vertexShader: <string>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n *\n *  lights: <bool>\n * }\n */\n\nclass ShaderMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ShaderMaterial';\n\n\t\tthis.defines = {};\n\t\tthis.uniforms = {};\n\n\t\tthis.vertexShader = default_vertex;\n\t\tthis.fragmentShader = default_fragment;\n\n\t\tthis.linewidth = 1;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.fog = false; // set to use scene fog\n\t\tthis.lights = false; // set to use scene lights\n\t\tthis.clipping = false; // set to use user-defined clipping planes\n\n\t\tthis.extensions = {\n\t\t\tderivatives: false, // set to use derivatives\n\t\t\tfragDepth: false, // set to use fragment depth values\n\t\t\tdrawBuffers: false, // set to use draw buffers\n\t\t\tshaderTextureLOD: false // set to use shader texture LOD\n\t\t};\n\n\t\t// When rendered geometry doesn't include these attributes but the material does,\n\t\t// use these default values in WebGL. This avoids errors when buffer data is missing.\n\t\tthis.defaultAttributeValues = {\n\t\t\t'color': [ 1, 1, 1 ],\n\t\t\t'uv': [ 0, 0 ],\n\t\t\t'uv2': [ 0, 0 ]\n\t\t};\n\n\t\tthis.index0AttributeName = undefined;\n\t\tthis.uniformsNeedUpdate = false;\n\n\t\tthis.glslVersion = null;\n\n\t\tif ( parameters !== undefined ) {\n\n\t\t\tif ( parameters.attributes !== undefined ) {\n\n\t\t\t\tconsole.error( 'THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.' );\n\n\t\t\t}\n\n\t\t\tthis.setValues( parameters );\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.fragmentShader = source.fragmentShader;\n\t\tthis.vertexShader = source.vertexShader;\n\n\t\tthis.uniforms = cloneUniforms( source.uniforms );\n\n\t\tthis.defines = Object.assign( {}, source.defines );\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\tthis.lights = source.lights;\n\t\tthis.clipping = source.clipping;\n\n\t\tthis.extensions = Object.assign( {}, source.extensions );\n\n\t\tthis.glslVersion = source.glslVersion;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.glslVersion = this.glslVersion;\n\t\tdata.uniforms = {};\n\n\t\tfor ( const name in this.uniforms ) {\n\n\t\t\tconst uniform = this.uniforms[ name ];\n\t\t\tconst value = uniform.value;\n\n\t\t\tif ( value && value.isTexture ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 't',\n\t\t\t\t\tvalue: value.toJSON( meta ).uuid\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isColor ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'c',\n\t\t\t\t\tvalue: value.getHex()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector2 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v2',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector3 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v3',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector4 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v4',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isMatrix3 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'm3',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isMatrix4 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'm4',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\tvalue: value\n\t\t\t\t};\n\n\t\t\t\t// note: the array variants v2v, v3v, v4v, m4v and tv are not supported so far\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( Object.keys( this.defines ).length > 0 ) data.defines = this.defines;\n\n\t\tdata.vertexShader = this.vertexShader;\n\t\tdata.fragmentShader = this.fragmentShader;\n\n\t\tconst extensions = {};\n\n\t\tfor ( const key in this.extensions ) {\n\n\t\t\tif ( this.extensions[ key ] === true ) extensions[ key ] = true;\n\n\t\t}\n\n\t\tif ( Object.keys( extensions ).length > 0 ) data.extensions = extensions;\n\n\t\treturn data;\n\n\t}\n\n}\n\nShaderMaterial.prototype.isShaderMaterial = true;\n\nexport { ShaderMaterial };\n","export default /* glsl */`\nvoid main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n`;\n","export default /* glsl */`\nvoid main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}\n`;\n","import { Vector3 } from './Vector3.js';\n\nconst _vector = /*@__PURE__*/ new Vector3();\nconst _segCenter = /*@__PURE__*/ new Vector3();\nconst _segDir = /*@__PURE__*/ new Vector3();\nconst _diff = /*@__PURE__*/ new Vector3();\n\nconst _edge1 = /*@__PURE__*/ new Vector3();\nconst _edge2 = /*@__PURE__*/ new Vector3();\nconst _normal = /*@__PURE__*/ new Vector3();\n\nclass Ray {\n\n\tconstructor( origin = new Vector3(), direction = new Vector3( 0, 0, - 1 ) ) {\n\n\t\tthis.origin = origin;\n\t\tthis.direction = direction;\n\n\t}\n\n\tset( origin, direction ) {\n\n\t\tthis.origin.copy( origin );\n\t\tthis.direction.copy( direction );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( ray ) {\n\n\t\tthis.origin.copy( ray.origin );\n\t\tthis.direction.copy( ray.direction );\n\n\t\treturn this;\n\n\t}\n\n\tat( t, target ) {\n\n\t\treturn target.copy( this.direction ).multiplyScalar( t ).add( this.origin );\n\n\t}\n\n\tlookAt( v ) {\n\n\t\tthis.direction.copy( v ).sub( this.origin ).normalize();\n\n\t\treturn this;\n\n\t}\n\n\trecast( t ) {\n\n\t\tthis.origin.copy( this.at( t, _vector ) );\n\n\t\treturn this;\n\n\t}\n\n\tclosestPointToPoint( point, target ) {\n\n\t\ttarget.subVectors( point, this.origin );\n\n\t\tconst directionDistance = target.dot( this.direction );\n\n\t\tif ( directionDistance < 0 ) {\n\n\t\t\treturn target.copy( this.origin );\n\n\t\t}\n\n\t\treturn target.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn Math.sqrt( this.distanceSqToPoint( point ) );\n\n\t}\n\n\tdistanceSqToPoint( point ) {\n\n\t\tconst directionDistance = _vector.subVectors( point, this.origin ).dot( this.direction );\n\n\t\t// point behind the ray\n\n\t\tif ( directionDistance < 0 ) {\n\n\t\t\treturn this.origin.distanceToSquared( point );\n\n\t\t}\n\n\t\t_vector.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\n\n\t\treturn _vector.distanceToSquared( point );\n\n\t}\n\n\tdistanceSqToSegment( v0, v1, optionalPointOnRay, optionalPointOnSegment ) {\n\n\t\t// from http://www.geometrictools.com/GTEngine/Include/Mathematics/GteDistRaySegment.h\n\t\t// It returns the min distance between the ray and the segment\n\t\t// defined by v0 and v1\n\t\t// It can also set two optional targets :\n\t\t// - The closest point on the ray\n\t\t// - The closest point on the segment\n\n\t\t_segCenter.copy( v0 ).add( v1 ).multiplyScalar( 0.5 );\n\t\t_segDir.copy( v1 ).sub( v0 ).normalize();\n\t\t_diff.copy( this.origin ).sub( _segCenter );\n\n\t\tconst segExtent = v0.distanceTo( v1 ) * 0.5;\n\t\tconst a01 = - this.direction.dot( _segDir );\n\t\tconst b0 = _diff.dot( this.direction );\n\t\tconst b1 = - _diff.dot( _segDir );\n\t\tconst c = _diff.lengthSq();\n\t\tconst det = Math.abs( 1 - a01 * a01 );\n\t\tlet s0, s1, sqrDist, extDet;\n\n\t\tif ( det > 0 ) {\n\n\t\t\t// The ray and segment are not parallel.\n\n\t\t\ts0 = a01 * b1 - b0;\n\t\t\ts1 = a01 * b0 - b1;\n\t\t\textDet = segExtent * det;\n\n\t\t\tif ( s0 >= 0 ) {\n\n\t\t\t\tif ( s1 >= - extDet ) {\n\n\t\t\t\t\tif ( s1 <= extDet ) {\n\n\t\t\t\t\t\t// region 0\n\t\t\t\t\t\t// Minimum at interior points of ray and segment.\n\n\t\t\t\t\t\tconst invDet = 1 / det;\n\t\t\t\t\t\ts0 *= invDet;\n\t\t\t\t\t\ts1 *= invDet;\n\t\t\t\t\t\tsqrDist = s0 * ( s0 + a01 * s1 + 2 * b0 ) + s1 * ( a01 * s0 + s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// region 1\n\n\t\t\t\t\t\ts1 = segExtent;\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// region 5\n\n\t\t\t\t\ts1 = - segExtent;\n\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( s1 <= - extDet ) {\n\n\t\t\t\t\t// region 4\n\n\t\t\t\t\ts0 = Math.max( 0, - ( - a01 * segExtent + b0 ) );\n\t\t\t\t\ts1 = ( s0 > 0 ) ? - segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t} else if ( s1 <= extDet ) {\n\n\t\t\t\t\t// region 3\n\n\t\t\t\t\ts0 = 0;\n\t\t\t\t\ts1 = Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// region 2\n\n\t\t\t\t\ts0 = Math.max( 0, - ( a01 * segExtent + b0 ) );\n\t\t\t\t\ts1 = ( s0 > 0 ) ? segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// Ray and segment are parallel.\n\n\t\t\ts1 = ( a01 > 0 ) ? - segExtent : segExtent;\n\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t}\n\n\t\tif ( optionalPointOnRay ) {\n\n\t\t\toptionalPointOnRay.copy( this.direction ).multiplyScalar( s0 ).add( this.origin );\n\n\t\t}\n\n\t\tif ( optionalPointOnSegment ) {\n\n\t\t\toptionalPointOnSegment.copy( _segDir ).multiplyScalar( s1 ).add( _segCenter );\n\n\t\t}\n\n\t\treturn sqrDist;\n\n\t}\n\n\tintersectSphere( sphere, target ) {\n\n\t\t_vector.subVectors( sphere.center, this.origin );\n\t\tconst tca = _vector.dot( this.direction );\n\t\tconst d2 = _vector.dot( _vector ) - tca * tca;\n\t\tconst radius2 = sphere.radius * sphere.radius;\n\n\t\tif ( d2 > radius2 ) return null;\n\n\t\tconst thc = Math.sqrt( radius2 - d2 );\n\n\t\t// t0 = first intersect point - entrance on front of sphere\n\t\tconst t0 = tca - thc;\n\n\t\t// t1 = second intersect point - exit point on back of sphere\n\t\tconst t1 = tca + thc;\n\n\t\t// test to see if both t0 and t1 are behind the ray - if so, return null\n\t\tif ( t0 < 0 && t1 < 0 ) return null;\n\n\t\t// test to see if t0 is behind the ray:\n\t\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\n\t\t// in order to always return an intersect point that is in front of the ray.\n\t\tif ( t0 < 0 ) return this.at( t1, target );\n\n\t\t// else t0 is in front of the ray, so return the first collision point scaled by t0\n\t\treturn this.at( t0, target );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\treturn this.distanceSqToPoint( sphere.center ) <= ( sphere.radius * sphere.radius );\n\n\t}\n\n\tdistanceToPlane( plane ) {\n\n\t\tconst denominator = plane.normal.dot( this.direction );\n\n\t\tif ( denominator === 0 ) {\n\n\t\t\t// line is coplanar, return origin\n\t\t\tif ( plane.distanceToPoint( this.origin ) === 0 ) {\n\n\t\t\t\treturn 0;\n\n\t\t\t}\n\n\t\t\t// Null is preferable to undefined since undefined means.... it is undefined\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst t = - ( this.origin.dot( plane.normal ) + plane.constant ) / denominator;\n\n\t\t// Return if the ray never intersects the plane\n\n\t\treturn t >= 0 ? t : null;\n\n\t}\n\n\tintersectPlane( plane, target ) {\n\n\t\tconst t = this.distanceToPlane( plane );\n\n\t\tif ( t === null ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn this.at( t, target );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\t// check if the ray lies on the plane first\n\n\t\tconst distToPoint = plane.distanceToPoint( this.origin );\n\n\t\tif ( distToPoint === 0 ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\tconst denominator = plane.normal.dot( this.direction );\n\n\t\tif ( denominator * distToPoint < 0 ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\t// ray origin is behind the plane (and is pointing behind it)\n\n\t\treturn false;\n\n\t}\n\n\tintersectBox( box, target ) {\n\n\t\tlet tmin, tmax, tymin, tymax, tzmin, tzmax;\n\n\t\tconst invdirx = 1 / this.direction.x,\n\t\t\tinvdiry = 1 / this.direction.y,\n\t\t\tinvdirz = 1 / this.direction.z;\n\n\t\tconst origin = this.origin;\n\n\t\tif ( invdirx >= 0 ) {\n\n\t\t\ttmin = ( box.min.x - origin.x ) * invdirx;\n\t\t\ttmax = ( box.max.x - origin.x ) * invdirx;\n\n\t\t} else {\n\n\t\t\ttmin = ( box.max.x - origin.x ) * invdirx;\n\t\t\ttmax = ( box.min.x - origin.x ) * invdirx;\n\n\t\t}\n\n\t\tif ( invdiry >= 0 ) {\n\n\t\t\ttymin = ( box.min.y - origin.y ) * invdiry;\n\t\t\ttymax = ( box.max.y - origin.y ) * invdiry;\n\n\t\t} else {\n\n\t\t\ttymin = ( box.max.y - origin.y ) * invdiry;\n\t\t\ttymax = ( box.min.y - origin.y ) * invdiry;\n\n\t\t}\n\n\t\tif ( ( tmin > tymax ) || ( tymin > tmax ) ) return null;\n\n\t\t// These lines also handle the case where tmin or tmax is NaN\n\t\t// (result of 0 * Infinity). x !== x returns true if x is NaN\n\n\t\tif ( tymin > tmin || tmin !== tmin ) tmin = tymin;\n\n\t\tif ( tymax < tmax || tmax !== tmax ) tmax = tymax;\n\n\t\tif ( invdirz >= 0 ) {\n\n\t\t\ttzmin = ( box.min.z - origin.z ) * invdirz;\n\t\t\ttzmax = ( box.max.z - origin.z ) * invdirz;\n\n\t\t} else {\n\n\t\t\ttzmin = ( box.max.z - origin.z ) * invdirz;\n\t\t\ttzmax = ( box.min.z - origin.z ) * invdirz;\n\n\t\t}\n\n\t\tif ( ( tmin > tzmax ) || ( tzmin > tmax ) ) return null;\n\n\t\tif ( tzmin > tmin || tmin !== tmin ) tmin = tzmin;\n\n\t\tif ( tzmax < tmax || tmax !== tmax ) tmax = tzmax;\n\n\t\t//return point closest to the ray (positive side)\n\n\t\tif ( tmax < 0 ) return null;\n\n\t\treturn this.at( tmin >= 0 ? tmin : tmax, target );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn this.intersectBox( box, _vector ) !== null;\n\n\t}\n\n\tintersectTriangle( a, b, c, backfaceCulling, target ) {\n\n\t\t// Compute the offset origin, edges, and normal.\n\n\t\t// from http://www.geometrictools.com/GTEngine/Include/Mathematics/GteIntrRay3Triangle3.h\n\n\t\t_edge1.subVectors( b, a );\n\t\t_edge2.subVectors( c, a );\n\t\t_normal.crossVectors( _edge1, _edge2 );\n\n\t\t// Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\n\t\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\n\t\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\n\t\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\n\t\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\n\t\tlet DdN = this.direction.dot( _normal );\n\t\tlet sign;\n\n\t\tif ( DdN > 0 ) {\n\n\t\t\tif ( backfaceCulling ) return null;\n\t\t\tsign = 1;\n\n\t\t} else if ( DdN < 0 ) {\n\n\t\t\tsign = - 1;\n\t\t\tDdN = - DdN;\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t_diff.subVectors( this.origin, a );\n\t\tconst DdQxE2 = sign * this.direction.dot( _edge2.crossVectors( _diff, _edge2 ) );\n\n\t\t// b1 < 0, no intersection\n\t\tif ( DdQxE2 < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst DdE1xQ = sign * this.direction.dot( _edge1.cross( _diff ) );\n\n\t\t// b2 < 0, no intersection\n\t\tif ( DdE1xQ < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// b1+b2 > 1, no intersection\n\t\tif ( DdQxE2 + DdE1xQ > DdN ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// Line intersects triangle, check if ray does.\n\t\tconst QdN = - sign * _diff.dot( _normal );\n\n\t\t// t < 0, no intersection\n\t\tif ( QdN < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// Ray intersects triangle.\n\t\treturn this.at( QdN / DdN, target );\n\n\t}\n\n\tapplyMatrix4( matrix4 ) {\n\n\t\tthis.origin.applyMatrix4( matrix4 );\n\t\tthis.direction.transformDirection( matrix4 );\n\n\t\treturn this;\n\n\t}\n\n\tequals( ray ) {\n\n\t\treturn ray.origin.equals( this.origin ) && ray.direction.equals( this.direction );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nexport { Ray };\n","import { Vector3 } from './Vector3.js';\n\nconst _v0 = /*@__PURE__*/ new Vector3();\nconst _v1 = /*@__PURE__*/ new Vector3();\nconst _v2 = /*@__PURE__*/ new Vector3();\nconst _v3 = /*@__PURE__*/ new Vector3();\n\nconst _vab = /*@__PURE__*/ new Vector3();\nconst _vac = /*@__PURE__*/ new Vector3();\nconst _vbc = /*@__PURE__*/ new Vector3();\nconst _vap = /*@__PURE__*/ new Vector3();\nconst _vbp = /*@__PURE__*/ new Vector3();\nconst _vcp = /*@__PURE__*/ new Vector3();\n\nclass Triangle {\n\n\tconstructor( a = new Vector3(), b = new Vector3(), c = new Vector3() ) {\n\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.c = c;\n\n\t}\n\n\tstatic getNormal( a, b, c, target ) {\n\n\t\ttarget.subVectors( c, b );\n\t\t_v0.subVectors( a, b );\n\t\ttarget.cross( _v0 );\n\n\t\tconst targetLengthSq = target.lengthSq();\n\t\tif ( targetLengthSq > 0 ) {\n\n\t\t\treturn target.multiplyScalar( 1 / Math.sqrt( targetLengthSq ) );\n\n\t\t}\n\n\t\treturn target.set( 0, 0, 0 );\n\n\t}\n\n\t// static/instance method to calculate barycentric coordinates\n\t// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\n\tstatic getBarycoord( point, a, b, c, target ) {\n\n\t\t_v0.subVectors( c, a );\n\t\t_v1.subVectors( b, a );\n\t\t_v2.subVectors( point, a );\n\n\t\tconst dot00 = _v0.dot( _v0 );\n\t\tconst dot01 = _v0.dot( _v1 );\n\t\tconst dot02 = _v0.dot( _v2 );\n\t\tconst dot11 = _v1.dot( _v1 );\n\t\tconst dot12 = _v1.dot( _v2 );\n\n\t\tconst denom = ( dot00 * dot11 - dot01 * dot01 );\n\n\t\t// collinear or singular triangle\n\t\tif ( denom === 0 ) {\n\n\t\t\t// arbitrary location outside of triangle?\n\t\t\t// not sure if this is the best idea, maybe should be returning undefined\n\t\t\treturn target.set( - 2, - 1, - 1 );\n\n\t\t}\n\n\t\tconst invDenom = 1 / denom;\n\t\tconst u = ( dot11 * dot02 - dot01 * dot12 ) * invDenom;\n\t\tconst v = ( dot00 * dot12 - dot01 * dot02 ) * invDenom;\n\n\t\t// barycentric coordinates must always sum to 1\n\t\treturn target.set( 1 - u - v, v, u );\n\n\t}\n\n\tstatic containsPoint( point, a, b, c ) {\n\n\t\tthis.getBarycoord( point, a, b, c, _v3 );\n\n\t\treturn ( _v3.x >= 0 ) && ( _v3.y >= 0 ) && ( ( _v3.x + _v3.y ) <= 1 );\n\n\t}\n\n\tstatic getUV( point, p1, p2, p3, uv1, uv2, uv3, target ) {\n\n\t\tthis.getBarycoord( point, p1, p2, p3, _v3 );\n\n\t\ttarget.set( 0, 0 );\n\t\ttarget.addScaledVector( uv1, _v3.x );\n\t\ttarget.addScaledVector( uv2, _v3.y );\n\t\ttarget.addScaledVector( uv3, _v3.z );\n\n\t\treturn target;\n\n\t}\n\n\tstatic isFrontFacing( a, b, c, direction ) {\n\n\t\t_v0.subVectors( c, b );\n\t\t_v1.subVectors( a, b );\n\n\t\t// strictly front facing\n\t\treturn ( _v0.cross( _v1 ).dot( direction ) < 0 ) ? true : false;\n\n\t}\n\n\tset( a, b, c ) {\n\n\t\tthis.a.copy( a );\n\t\tthis.b.copy( b );\n\t\tthis.c.copy( c );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPointsAndIndices( points, i0, i1, i2 ) {\n\n\t\tthis.a.copy( points[ i0 ] );\n\t\tthis.b.copy( points[ i1 ] );\n\t\tthis.c.copy( points[ i2 ] );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromAttributeAndIndices( attribute, i0, i1, i2 ) {\n\n\t\tthis.a.fromBufferAttribute( attribute, i0 );\n\t\tthis.b.fromBufferAttribute( attribute, i1 );\n\t\tthis.c.fromBufferAttribute( attribute, i2 );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( triangle ) {\n\n\t\tthis.a.copy( triangle.a );\n\t\tthis.b.copy( triangle.b );\n\t\tthis.c.copy( triangle.c );\n\n\t\treturn this;\n\n\t}\n\n\tgetArea() {\n\n\t\t_v0.subVectors( this.c, this.b );\n\t\t_v1.subVectors( this.a, this.b );\n\n\t\treturn _v0.cross( _v1 ).length() * 0.5;\n\n\t}\n\n\tgetMidpoint( target ) {\n\n\t\treturn target.addVectors( this.a, this.b ).add( this.c ).multiplyScalar( 1 / 3 );\n\n\t}\n\n\tgetNormal( target ) {\n\n\t\treturn Triangle.getNormal( this.a, this.b, this.c, target );\n\n\t}\n\n\tgetPlane( target ) {\n\n\t\treturn target.setFromCoplanarPoints( this.a, this.b, this.c );\n\n\t}\n\n\tgetBarycoord( point, target ) {\n\n\t\treturn Triangle.getBarycoord( point, this.a, this.b, this.c, target );\n\n\t}\n\n\tgetUV( point, uv1, uv2, uv3, target ) {\n\n\t\treturn Triangle.getUV( point, this.a, this.b, this.c, uv1, uv2, uv3, target );\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn Triangle.containsPoint( point, this.a, this.b, this.c );\n\n\t}\n\n\tisFrontFacing( direction ) {\n\n\t\treturn Triangle.isFrontFacing( this.a, this.b, this.c, direction );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsTriangle( this );\n\n\t}\n\n\tclosestPointToPoint( p, target ) {\n\n\t\tconst a = this.a, b = this.b, c = this.c;\n\t\tlet v, w;\n\n\t\t// algorithm thanks to Real-Time Collision Detection by Christer Ericson,\n\t\t// published by Morgan Kaufmann Publishers, (c) 2005 Elsevier Inc.,\n\t\t// under the accompanying license; see chapter 5.1.5 for detailed explanation.\n\t\t// basically, we're distinguishing which of the voronoi regions of the triangle\n\t\t// the point lies in with the minimum amount of redundant computation.\n\n\t\t_vab.subVectors( b, a );\n\t\t_vac.subVectors( c, a );\n\t\t_vap.subVectors( p, a );\n\t\tconst d1 = _vab.dot( _vap );\n\t\tconst d2 = _vac.dot( _vap );\n\t\tif ( d1 <= 0 && d2 <= 0 ) {\n\n\t\t\t// vertex region of A; barycentric coords (1, 0, 0)\n\t\t\treturn target.copy( a );\n\n\t\t}\n\n\t\t_vbp.subVectors( p, b );\n\t\tconst d3 = _vab.dot( _vbp );\n\t\tconst d4 = _vac.dot( _vbp );\n\t\tif ( d3 >= 0 && d4 <= d3 ) {\n\n\t\t\t// vertex region of B; barycentric coords (0, 1, 0)\n\t\t\treturn target.copy( b );\n\n\t\t}\n\n\t\tconst vc = d1 * d4 - d3 * d2;\n\t\tif ( vc <= 0 && d1 >= 0 && d3 <= 0 ) {\n\n\t\t\tv = d1 / ( d1 - d3 );\n\t\t\t// edge region of AB; barycentric coords (1-v, v, 0)\n\t\t\treturn target.copy( a ).addScaledVector( _vab, v );\n\n\t\t}\n\n\t\t_vcp.subVectors( p, c );\n\t\tconst d5 = _vab.dot( _vcp );\n\t\tconst d6 = _vac.dot( _vcp );\n\t\tif ( d6 >= 0 && d5 <= d6 ) {\n\n\t\t\t// vertex region of C; barycentric coords (0, 0, 1)\n\t\t\treturn target.copy( c );\n\n\t\t}\n\n\t\tconst vb = d5 * d2 - d1 * d6;\n\t\tif ( vb <= 0 && d2 >= 0 && d6 <= 0 ) {\n\n\t\t\tw = d2 / ( d2 - d6 );\n\t\t\t// edge region of AC; barycentric coords (1-w, 0, w)\n\t\t\treturn target.copy( a ).addScaledVector( _vac, w );\n\n\t\t}\n\n\t\tconst va = d3 * d6 - d5 * d4;\n\t\tif ( va <= 0 && ( d4 - d3 ) >= 0 && ( d5 - d6 ) >= 0 ) {\n\n\t\t\t_vbc.subVectors( c, b );\n\t\t\tw = ( d4 - d3 ) / ( ( d4 - d3 ) + ( d5 - d6 ) );\n\t\t\t// edge region of BC; barycentric coords (0, 1-w, w)\n\t\t\treturn target.copy( b ).addScaledVector( _vbc, w ); // edge region of BC\n\n\t\t}\n\n\t\t// face region\n\t\tconst denom = 1 / ( va + vb + vc );\n\t\t// u = va * denom\n\t\tv = vb * denom;\n\t\tw = vc * denom;\n\n\t\treturn target.copy( a ).addScaledVector( _vab, v ).addScaledVector( _vac, w );\n\n\t}\n\n\tequals( triangle ) {\n\n\t\treturn triangle.a.equals( this.a ) && triangle.b.equals( this.b ) && triangle.c.equals( this.c );\n\n\t}\n\n}\n\nexport { Triangle };\n","import { Material } from './Material.js';\nimport { MultiplyOperation } from '../constants.js';\nimport { Color } from '../math/Color.js';\n\n/**\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *  map: new THREE.Texture( <Image> ),\n *\n *  lightMap: new THREE.Texture( <Image> ),\n *  lightMapIntensity: <float>\n *\n *  aoMap: new THREE.Texture( <Image> ),\n *  aoMapIntensity: <float>\n *\n *  specularMap: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\n *  combine: THREE.Multiply,\n *  reflectivity: <float>,\n *  refractionRatio: <float>,\n *\n *  depthTest: <bool>,\n *  depthWrite: <bool>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n * }\n */\n\nclass MeshBasicMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshBasicMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // emissive\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshBasicMaterial.prototype.isMeshBasicMaterial = true;\n\nexport { MeshBasicMaterial };\n","import { Vector3 } from '../math/Vector3.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Sphere } from '../math/Sphere.js';\nimport { Ray } from '../math/Ray.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Object3D } from '../core/Object3D.js';\nimport { Triangle } from '../math/Triangle.js';\nimport { DoubleSide, BackSide } from '../constants.js';\nimport { MeshBasicMaterial } from '../materials/MeshBasicMaterial.js';\nimport { BufferGeometry } from '../core/BufferGeometry.js';\n\nconst _inverseMatrix = /*@__PURE__*/ new Matrix4();\nconst _ray = /*@__PURE__*/ new Ray();\nconst _sphere = /*@__PURE__*/ new Sphere();\n\nconst _vA = /*@__PURE__*/ new Vector3();\nconst _vB = /*@__PURE__*/ new Vector3();\nconst _vC = /*@__PURE__*/ new Vector3();\n\nconst _tempA = /*@__PURE__*/ new Vector3();\nconst _tempB = /*@__PURE__*/ new Vector3();\nconst _tempC = /*@__PURE__*/ new Vector3();\n\nconst _morphA = /*@__PURE__*/ new Vector3();\nconst _morphB = /*@__PURE__*/ new Vector3();\nconst _morphC = /*@__PURE__*/ new Vector3();\n\nconst _uvA = /*@__PURE__*/ new Vector2();\nconst _uvB = /*@__PURE__*/ new Vector2();\nconst _uvC = /*@__PURE__*/ new Vector2();\n\nconst _intersectionPoint = /*@__PURE__*/ new Vector3();\nconst _intersectionPointWorld = /*@__PURE__*/ new Vector3();\n\nclass Mesh extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new MeshBasicMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Mesh';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tif ( source.morphTargetInfluences !== undefined ) {\n\n\t\t\tthis.morphTargetInfluences = source.morphTargetInfluences.slice();\n\n\t\t}\n\n\t\tif ( source.morphTargetDictionary !== undefined ) {\n\n\t\t\tthis.morphTargetDictionary = Object.assign( {}, source.morphTargetDictionary );\n\n\t\t}\n\n\t\tthis.material = source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst morphAttributes = geometry.morphAttributes;\n\t\t\tconst keys = Object.keys( morphAttributes );\n\n\t\t\tif ( keys.length > 0 ) {\n\n\t\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst morphTargets = geometry.morphTargets;\n\n\t\t\tif ( morphTargets !== undefined && morphTargets.length > 0 ) {\n\n\t\t\t\tconsole.error( 'THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst material = this.material;\n\t\tconst matrixWorld = this.matrixWorld;\n\n\t\tif ( material === undefined ) return;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere.copy( geometry.boundingSphere );\n\t\t_sphere.applyMatrix4( matrixWorld );\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix.copy( matrixWorld ).invert();\n\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\n\n\t\t// Check boundingBox before continuing\n\n\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\tif ( _ray.intersectsBox( geometry.boundingBox ) === false ) return;\n\n\t\t}\n\n\t\tlet intersection;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst index = geometry.index;\n\t\t\tconst position = geometry.attributes.position;\n\t\t\tconst morphPosition = geometry.morphAttributes.position;\n\t\t\tconst morphTargetsRelative = geometry.morphTargetsRelative;\n\t\t\tconst uv = geometry.attributes.uv;\n\t\t\tconst uv2 = geometry.attributes.uv2;\n\t\t\tconst groups = geometry.groups;\n\t\t\tconst drawRange = geometry.drawRange;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\t// indexed buffer geometry\n\n\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\tfor ( let i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\t\tconst start = Math.max( group.start, drawRange.start );\n\t\t\t\t\t\tconst end = Math.min( index.count, Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) ) );\n\n\t\t\t\t\t\tfor ( let j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\t\t\tconst a = index.getX( j );\n\t\t\t\t\t\t\tconst b = index.getX( j + 1 );\n\t\t\t\t\t\t\tconst c = index.getX( j + 2 );\n\n\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, groupMaterial, raycaster, _ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\n\n\t\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in indexed buffer semantics\n\t\t\t\t\t\t\t\tintersection.face.materialIndex = group.materialIndex;\n\t\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\t\tfor ( let i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\t\t\tconst a = index.getX( i );\n\t\t\t\t\t\tconst b = index.getX( i + 1 );\n\t\t\t\t\t\tconst c = index.getX( i + 2 );\n\n\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, material, raycaster, _ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\n\n\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in indexed buffer semantics\n\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( position !== undefined ) {\n\n\t\t\t\t// non-indexed buffer geometry\n\n\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\tfor ( let i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\t\tconst start = Math.max( group.start, drawRange.start );\n\t\t\t\t\t\tconst end = Math.min( position.count, Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) ) );\n\n\t\t\t\t\t\tfor ( let j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\t\t\tconst a = j;\n\t\t\t\t\t\t\tconst b = j + 1;\n\t\t\t\t\t\t\tconst c = j + 2;\n\n\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, groupMaterial, raycaster, _ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\n\n\t\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in non-indexed buffer semantics\n\t\t\t\t\t\t\t\tintersection.face.materialIndex = group.materialIndex;\n\t\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\t\tconst end = Math.min( position.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\t\tfor ( let i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\t\t\tconst a = i;\n\t\t\t\t\t\tconst b = i + 1;\n\t\t\t\t\t\tconst c = i + 2;\n\n\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, material, raycaster, _ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\n\n\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in non-indexed buffer semantics\n\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\tconsole.error( 'THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t}\n\n}\n\nMesh.prototype.isMesh = true;\n\nfunction checkIntersection( object, material, raycaster, ray, pA, pB, pC, point ) {\n\n\tlet intersect;\n\n\tif ( material.side === BackSide ) {\n\n\t\tintersect = ray.intersectTriangle( pC, pB, pA, true, point );\n\n\t} else {\n\n\t\tintersect = ray.intersectTriangle( pA, pB, pC, material.side !== DoubleSide, point );\n\n\t}\n\n\tif ( intersect === null ) return null;\n\n\t_intersectionPointWorld.copy( point );\n\t_intersectionPointWorld.applyMatrix4( object.matrixWorld );\n\n\tconst distance = raycaster.ray.origin.distanceTo( _intersectionPointWorld );\n\n\tif ( distance < raycaster.near || distance > raycaster.far ) return null;\n\n\treturn {\n\t\tdistance: distance,\n\t\tpoint: _intersectionPointWorld.clone(),\n\t\tobject: object\n\t};\n\n}\n\nfunction checkBufferGeometryIntersection( object, material, raycaster, ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c ) {\n\n\t_vA.fromBufferAttribute( position, a );\n\t_vB.fromBufferAttribute( position, b );\n\t_vC.fromBufferAttribute( position, c );\n\n\tconst morphInfluences = object.morphTargetInfluences;\n\n\tif ( morphPosition && morphInfluences ) {\n\n\t\t_morphA.set( 0, 0, 0 );\n\t\t_morphB.set( 0, 0, 0 );\n\t\t_morphC.set( 0, 0, 0 );\n\n\t\tfor ( let i = 0, il = morphPosition.length; i < il; i ++ ) {\n\n\t\t\tconst influence = morphInfluences[ i ];\n\t\t\tconst morphAttribute = morphPosition[ i ];\n\n\t\t\tif ( influence === 0 ) continue;\n\n\t\t\t_tempA.fromBufferAttribute( morphAttribute, a );\n\t\t\t_tempB.fromBufferAttribute( morphAttribute, b );\n\t\t\t_tempC.fromBufferAttribute( morphAttribute, c );\n\n\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t_morphA.addScaledVector( _tempA, influence );\n\t\t\t\t_morphB.addScaledVector( _tempB, influence );\n\t\t\t\t_morphC.addScaledVector( _tempC, influence );\n\n\t\t\t} else {\n\n\t\t\t\t_morphA.addScaledVector( _tempA.sub( _vA ), influence );\n\t\t\t\t_morphB.addScaledVector( _tempB.sub( _vB ), influence );\n\t\t\t\t_morphC.addScaledVector( _tempC.sub( _vC ), influence );\n\n\t\t\t}\n\n\t\t}\n\n\t\t_vA.add( _morphA );\n\t\t_vB.add( _morphB );\n\t\t_vC.add( _morphC );\n\n\t}\n\n\tif ( object.isSkinnedMesh ) {\n\n\t\tobject.boneTransform( a, _vA );\n\t\tobject.boneTransform( b, _vB );\n\t\tobject.boneTransform( c, _vC );\n\n\t}\n\n\tconst intersection = checkIntersection( object, material, raycaster, ray, _vA, _vB, _vC, _intersectionPoint );\n\n\tif ( intersection ) {\n\n\t\tif ( uv ) {\n\n\t\t\t_uvA.fromBufferAttribute( uv, a );\n\t\t\t_uvB.fromBufferAttribute( uv, b );\n\t\t\t_uvC.fromBufferAttribute( uv, c );\n\n\t\t\tintersection.uv = Triangle.getUV( _intersectionPoint, _vA, _vB, _vC, _uvA, _uvB, _uvC, new Vector2() );\n\n\t\t}\n\n\t\tif ( uv2 ) {\n\n\t\t\t_uvA.fromBufferAttribute( uv2, a );\n\t\t\t_uvB.fromBufferAttribute( uv2, b );\n\t\t\t_uvC.fromBufferAttribute( uv2, c );\n\n\t\t\tintersection.uv2 = Triangle.getUV( _intersectionPoint, _vA, _vB, _vC, _uvA, _uvB, _uvC, new Vector2() );\n\n\t\t}\n\n\t\tconst face = {\n\t\t\ta: a,\n\t\t\tb: b,\n\t\t\tc: c,\n\t\t\tnormal: new Vector3(),\n\t\t\tmaterialIndex: 0\n\t\t};\n\n\t\tTriangle.getNormal( _vA, _vB, _vC, face.normal );\n\n\t\tintersection.face = face;\n\n\t}\n\n\treturn intersection;\n\n}\n\nexport { Mesh };\n","export const vertex = /* glsl */`\nvarying vec2 vUv;\nuniform mat3 uvTransform;\n\nvoid main() {\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n\n}\n`;\n\nexport const fragment = /* glsl */`\nuniform sampler2D t2D;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvec4 texColor = texture2D( t2D, vUv );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n`;\n","import alphamap_fragment from './ShaderChunk/alphamap_fragment.glsl.js';\nimport alphamap_pars_fragment from './ShaderChunk/alphamap_pars_fragment.glsl.js';\nimport alphatest_fragment from './ShaderChunk/alphatest_fragment.glsl.js';\nimport alphatest_pars_fragment from './ShaderChunk/alphatest_pars_fragment.glsl.js';\nimport aomap_fragment from './ShaderChunk/aomap_fragment.glsl.js';\nimport aomap_pars_fragment from './ShaderChunk/aomap_pars_fragment.glsl.js';\nimport begin_vertex from './ShaderChunk/begin_vertex.glsl.js';\nimport beginnormal_vertex from './ShaderChunk/beginnormal_vertex.glsl.js';\nimport bsdfs from './ShaderChunk/bsdfs.glsl.js';\nimport bumpmap_pars_fragment from './ShaderChunk/bumpmap_pars_fragment.glsl.js';\nimport clipping_planes_fragment from './ShaderChunk/clipping_planes_fragment.glsl.js';\nimport clipping_planes_pars_fragment from './ShaderChunk/clipping_planes_pars_fragment.glsl.js';\nimport clipping_planes_pars_vertex from './ShaderChunk/clipping_planes_pars_vertex.glsl.js';\nimport clipping_planes_vertex from './ShaderChunk/clipping_planes_vertex.glsl.js';\nimport color_fragment from './ShaderChunk/color_fragment.glsl.js';\nimport color_pars_fragment from './ShaderChunk/color_pars_fragment.glsl.js';\nimport color_pars_vertex from './ShaderChunk/color_pars_vertex.glsl.js';\nimport color_vertex from './ShaderChunk/color_vertex.glsl.js';\nimport common from './ShaderChunk/common.glsl.js';\nimport cube_uv_reflection_fragment from './ShaderChunk/cube_uv_reflection_fragment.glsl.js';\nimport defaultnormal_vertex from './ShaderChunk/defaultnormal_vertex.glsl.js';\nimport displacementmap_pars_vertex from './ShaderChunk/displacementmap_pars_vertex.glsl.js';\nimport displacementmap_vertex from './ShaderChunk/displacementmap_vertex.glsl.js';\nimport emissivemap_fragment from './ShaderChunk/emissivemap_fragment.glsl.js';\nimport emissivemap_pars_fragment from './ShaderChunk/emissivemap_pars_fragment.glsl.js';\nimport encodings_fragment from './ShaderChunk/encodings_fragment.glsl.js';\nimport encodings_pars_fragment from './ShaderChunk/encodings_pars_fragment.glsl.js';\nimport envmap_fragment from './ShaderChunk/envmap_fragment.glsl.js';\nimport envmap_common_pars_fragment from './ShaderChunk/envmap_common_pars_fragment.glsl.js';\nimport envmap_pars_fragment from './ShaderChunk/envmap_pars_fragment.glsl.js';\nimport envmap_pars_vertex from './ShaderChunk/envmap_pars_vertex.glsl.js';\nimport envmap_vertex from './ShaderChunk/envmap_vertex.glsl.js';\nimport fog_vertex from './ShaderChunk/fog_vertex.glsl.js';\nimport fog_pars_vertex from './ShaderChunk/fog_pars_vertex.glsl.js';\nimport fog_fragment from './ShaderChunk/fog_fragment.glsl.js';\nimport fog_pars_fragment from './ShaderChunk/fog_pars_fragment.glsl.js';\nimport gradientmap_pars_fragment from './ShaderChunk/gradientmap_pars_fragment.glsl.js';\nimport lightmap_fragment from './ShaderChunk/lightmap_fragment.glsl.js';\nimport lightmap_pars_fragment from './ShaderChunk/lightmap_pars_fragment.glsl.js';\nimport lights_lambert_vertex from './ShaderChunk/lights_lambert_vertex.glsl.js';\nimport lights_pars_begin from './ShaderChunk/lights_pars_begin.glsl.js';\nimport envmap_physical_pars_fragment from './ShaderChunk/envmap_physical_pars_fragment.glsl.js';\nimport lights_toon_fragment from './ShaderChunk/lights_toon_fragment.glsl.js';\nimport lights_toon_pars_fragment from './ShaderChunk/lights_toon_pars_fragment.glsl.js';\nimport lights_phong_fragment from './ShaderChunk/lights_phong_fragment.glsl.js';\nimport lights_phong_pars_fragment from './ShaderChunk/lights_phong_pars_fragment.glsl.js';\nimport lights_physical_fragment from './ShaderChunk/lights_physical_fragment.glsl.js';\nimport lights_physical_pars_fragment from './ShaderChunk/lights_physical_pars_fragment.glsl.js';\nimport lights_fragment_begin from './ShaderChunk/lights_fragment_begin.glsl.js';\nimport lights_fragment_maps from './ShaderChunk/lights_fragment_maps.glsl.js';\nimport lights_fragment_end from './ShaderChunk/lights_fragment_end.glsl.js';\nimport logdepthbuf_fragment from './ShaderChunk/logdepthbuf_fragment.glsl.js';\nimport logdepthbuf_pars_fragment from './ShaderChunk/logdepthbuf_pars_fragment.glsl.js';\nimport logdepthbuf_pars_vertex from './ShaderChunk/logdepthbuf_pars_vertex.glsl.js';\nimport logdepthbuf_vertex from './ShaderChunk/logdepthbuf_vertex.glsl.js';\nimport map_fragment from './ShaderChunk/map_fragment.glsl.js';\nimport map_pars_fragment from './ShaderChunk/map_pars_fragment.glsl.js';\nimport map_particle_fragment from './ShaderChunk/map_particle_fragment.glsl.js';\nimport map_particle_pars_fragment from './ShaderChunk/map_particle_pars_fragment.glsl.js';\nimport metalnessmap_fragment from './ShaderChunk/metalnessmap_fragment.glsl.js';\nimport metalnessmap_pars_fragment from './ShaderChunk/metalnessmap_pars_fragment.glsl.js';\nimport morphnormal_vertex from './ShaderChunk/morphnormal_vertex.glsl.js';\nimport morphtarget_pars_vertex from './ShaderChunk/morphtarget_pars_vertex.glsl.js';\nimport morphtarget_vertex from './ShaderChunk/morphtarget_vertex.glsl.js';\nimport normal_fragment_begin from './ShaderChunk/normal_fragment_begin.glsl.js';\nimport normal_fragment_maps from './ShaderChunk/normal_fragment_maps.glsl.js';\nimport normal_pars_fragment from './ShaderChunk/normal_pars_fragment.glsl.js';\nimport normal_pars_vertex from './ShaderChunk/normal_pars_vertex.glsl.js';\nimport normal_vertex from './ShaderChunk/normal_vertex.glsl.js';\nimport normalmap_pars_fragment from './ShaderChunk/normalmap_pars_fragment.glsl.js';\nimport clearcoat_normal_fragment_begin from './ShaderChunk/clearcoat_normal_fragment_begin.glsl.js';\nimport clearcoat_normal_fragment_maps from './ShaderChunk/clearcoat_normal_fragment_maps.glsl.js';\nimport clearcoat_pars_fragment from './ShaderChunk/clearcoat_pars_fragment.glsl.js';\nimport output_fragment from './ShaderChunk/output_fragment.glsl.js';\nimport packing from './ShaderChunk/packing.glsl.js';\nimport premultiplied_alpha_fragment from './ShaderChunk/premultiplied_alpha_fragment.glsl.js';\nimport project_vertex from './ShaderChunk/project_vertex.glsl.js';\nimport dithering_fragment from './ShaderChunk/dithering_fragment.glsl.js';\nimport dithering_pars_fragment from './ShaderChunk/dithering_pars_fragment.glsl.js';\nimport roughnessmap_fragment from './ShaderChunk/roughnessmap_fragment.glsl.js';\nimport roughnessmap_pars_fragment from './ShaderChunk/roughnessmap_pars_fragment.glsl.js';\nimport shadowmap_pars_fragment from './ShaderChunk/shadowmap_pars_fragment.glsl.js';\nimport shadowmap_pars_vertex from './ShaderChunk/shadowmap_pars_vertex.glsl.js';\nimport shadowmap_vertex from './ShaderChunk/shadowmap_vertex.glsl.js';\nimport shadowmask_pars_fragment from './ShaderChunk/shadowmask_pars_fragment.glsl.js';\nimport skinbase_vertex from './ShaderChunk/skinbase_vertex.glsl.js';\nimport skinning_pars_vertex from './ShaderChunk/skinning_pars_vertex.glsl.js';\nimport skinning_vertex from './ShaderChunk/skinning_vertex.glsl.js';\nimport skinnormal_vertex from './ShaderChunk/skinnormal_vertex.glsl.js';\nimport specularmap_fragment from './ShaderChunk/specularmap_fragment.glsl.js';\nimport specularmap_pars_fragment from './ShaderChunk/specularmap_pars_fragment.glsl.js';\nimport tonemapping_fragment from './ShaderChunk/tonemapping_fragment.glsl.js';\nimport tonemapping_pars_fragment from './ShaderChunk/tonemapping_pars_fragment.glsl.js';\nimport transmission_fragment from './ShaderChunk/transmission_fragment.glsl.js';\nimport transmission_pars_fragment from './ShaderChunk/transmission_pars_fragment.glsl.js';\nimport uv_pars_fragment from './ShaderChunk/uv_pars_fragment.glsl.js';\nimport uv_pars_vertex from './ShaderChunk/uv_pars_vertex.glsl.js';\nimport uv_vertex from './ShaderChunk/uv_vertex.glsl.js';\nimport uv2_pars_fragment from './ShaderChunk/uv2_pars_fragment.glsl.js';\nimport uv2_pars_vertex from './ShaderChunk/uv2_pars_vertex.glsl.js';\nimport uv2_vertex from './ShaderChunk/uv2_vertex.glsl.js';\nimport worldpos_vertex from './ShaderChunk/worldpos_vertex.glsl.js';\n\nimport * as background from './ShaderLib/background.glsl.js';\nimport * as cube from './ShaderLib/cube.glsl.js';\nimport * as depth from './ShaderLib/depth.glsl.js';\nimport * as distanceRGBA from './ShaderLib/distanceRGBA.glsl.js';\nimport * as equirect from './ShaderLib/equirect.glsl.js';\nimport * as linedashed from './ShaderLib/linedashed.glsl.js';\nimport * as meshbasic from './ShaderLib/meshbasic.glsl.js';\nimport * as meshlambert from './ShaderLib/meshlambert.glsl.js';\nimport * as meshmatcap from './ShaderLib/meshmatcap.glsl.js';\nimport * as meshnormal from './ShaderLib/meshnormal.glsl.js';\nimport * as meshphong from './ShaderLib/meshphong.glsl.js';\nimport * as meshphysical from './ShaderLib/meshphysical.glsl.js';\nimport * as meshtoon from './ShaderLib/meshtoon.glsl.js';\nimport * as points from './ShaderLib/points.glsl.js';\nimport * as shadow from './ShaderLib/shadow.glsl.js';\nimport * as sprite from './ShaderLib/sprite.glsl.js';\n\nexport const ShaderChunk = {\n\talphamap_fragment: alphamap_fragment,\n\talphamap_pars_fragment: alphamap_pars_fragment,\n\talphatest_fragment: alphatest_fragment,\n\talphatest_pars_fragment: alphatest_pars_fragment,\n\taomap_fragment: aomap_fragment,\n\taomap_pars_fragment: aomap_pars_fragment,\n\tbegin_vertex: begin_vertex,\n\tbeginnormal_vertex: beginnormal_vertex,\n\tbsdfs: bsdfs,\n\tbumpmap_pars_fragment: bumpmap_pars_fragment,\n\tclipping_planes_fragment: clipping_planes_fragment,\n\tclipping_planes_pars_fragment: clipping_planes_pars_fragment,\n\tclipping_planes_pars_vertex: clipping_planes_pars_vertex,\n\tclipping_planes_vertex: clipping_planes_vertex,\n\tcolor_fragment: color_fragment,\n\tcolor_pars_fragment: color_pars_fragment,\n\tcolor_pars_vertex: color_pars_vertex,\n\tcolor_vertex: color_vertex,\n\tcommon: common,\n\tcube_uv_reflection_fragment: cube_uv_reflection_fragment,\n\tdefaultnormal_vertex: defaultnormal_vertex,\n\tdisplacementmap_pars_vertex: displacementmap_pars_vertex,\n\tdisplacementmap_vertex: displacementmap_vertex,\n\temissivemap_fragment: emissivemap_fragment,\n\temissivemap_pars_fragment: emissivemap_pars_fragment,\n\tencodings_fragment: encodings_fragment,\n\tencodings_pars_fragment: encodings_pars_fragment,\n\tenvmap_fragment: envmap_fragment,\n\tenvmap_common_pars_fragment: envmap_common_pars_fragment,\n\tenvmap_pars_fragment: envmap_pars_fragment,\n\tenvmap_pars_vertex: envmap_pars_vertex,\n\tenvmap_physical_pars_fragment: envmap_physical_pars_fragment,\n\tenvmap_vertex: envmap_vertex,\n\tfog_vertex: fog_vertex,\n\tfog_pars_vertex: fog_pars_vertex,\n\tfog_fragment: fog_fragment,\n\tfog_pars_fragment: fog_pars_fragment,\n\tgradientmap_pars_fragment: gradientmap_pars_fragment,\n\tlightmap_fragment: lightmap_fragment,\n\tlightmap_pars_fragment: lightmap_pars_fragment,\n\tlights_lambert_vertex: lights_lambert_vertex,\n\tlights_pars_begin: lights_pars_begin,\n\tlights_toon_fragment: lights_toon_fragment,\n\tlights_toon_pars_fragment: lights_toon_pars_fragment,\n\tlights_phong_fragment: lights_phong_fragment,\n\tlights_phong_pars_fragment: lights_phong_pars_fragment,\n\tlights_physical_fragment: lights_physical_fragment,\n\tlights_physical_pars_fragment: lights_physical_pars_fragment,\n\tlights_fragment_begin: lights_fragment_begin,\n\tlights_fragment_maps: lights_fragment_maps,\n\tlights_fragment_end: lights_fragment_end,\n\tlogdepthbuf_fragment: logdepthbuf_fragment,\n\tlogdepthbuf_pars_fragment: logdepthbuf_pars_fragment,\n\tlogdepthbuf_pars_vertex: logdepthbuf_pars_vertex,\n\tlogdepthbuf_vertex: logdepthbuf_vertex,\n\tmap_fragment: map_fragment,\n\tmap_pars_fragment: map_pars_fragment,\n\tmap_particle_fragment: map_particle_fragment,\n\tmap_particle_pars_fragment: map_particle_pars_fragment,\n\tmetalnessmap_fragment: metalnessmap_fragment,\n\tmetalnessmap_pars_fragment: metalnessmap_pars_fragment,\n\tmorphnormal_vertex: morphnormal_vertex,\n\tmorphtarget_pars_vertex: morphtarget_pars_vertex,\n\tmorphtarget_vertex: morphtarget_vertex,\n\tnormal_fragment_begin: normal_fragment_begin,\n\tnormal_fragment_maps: normal_fragment_maps,\n\tnormal_pars_fragment: normal_pars_fragment,\n\tnormal_pars_vertex: normal_pars_vertex,\n\tnormal_vertex: normal_vertex,\n\tnormalmap_pars_fragment: normalmap_pars_fragment,\n\tclearcoat_normal_fragment_begin: clearcoat_normal_fragment_begin,\n\tclearcoat_normal_fragment_maps: clearcoat_normal_fragment_maps,\n\tclearcoat_pars_fragment: clearcoat_pars_fragment,\n\toutput_fragment: output_fragment,\n\tpacking: packing,\n\tpremultiplied_alpha_fragment: premultiplied_alpha_fragment,\n\tproject_vertex: project_vertex,\n\tdithering_fragment: dithering_fragment,\n\tdithering_pars_fragment: dithering_pars_fragment,\n\troughnessmap_fragment: roughnessmap_fragment,\n\troughnessmap_pars_fragment: roughnessmap_pars_fragment,\n\tshadowmap_pars_fragment: shadowmap_pars_fragment,\n\tshadowmap_pars_vertex: shadowmap_pars_vertex,\n\tshadowmap_vertex: shadowmap_vertex,\n\tshadowmask_pars_fragment: shadowmask_pars_fragment,\n\tskinbase_vertex: skinbase_vertex,\n\tskinning_pars_vertex: skinning_pars_vertex,\n\tskinning_vertex: skinning_vertex,\n\tskinnormal_vertex: skinnormal_vertex,\n\tspecularmap_fragment: specularmap_fragment,\n\tspecularmap_pars_fragment: specularmap_pars_fragment,\n\ttonemapping_fragment: tonemapping_fragment,\n\ttonemapping_pars_fragment: tonemapping_pars_fragment,\n\ttransmission_fragment: transmission_fragment,\n\ttransmission_pars_fragment: transmission_pars_fragment,\n\tuv_pars_fragment: uv_pars_fragment,\n\tuv_pars_vertex: uv_pars_vertex,\n\tuv_vertex: uv_vertex,\n\tuv2_pars_fragment: uv2_pars_fragment,\n\tuv2_pars_vertex: uv2_pars_vertex,\n\tuv2_vertex: uv2_vertex,\n\tworldpos_vertex: worldpos_vertex,\n\n\tbackground_vert: background.vertex,\n\tbackground_frag: background.fragment,\n\tcube_vert: cube.vertex,\n\tcube_frag: cube.fragment,\n\tdepth_vert: depth.vertex,\n\tdepth_frag: depth.fragment,\n\tdistanceRGBA_vert: distanceRGBA.vertex,\n\tdistanceRGBA_frag: distanceRGBA.fragment,\n\tequirect_vert: equirect.vertex,\n\tequirect_frag: equirect.fragment,\n\tlinedashed_vert: linedashed.vertex,\n\tlinedashed_frag: linedashed.fragment,\n\tmeshbasic_vert: meshbasic.vertex,\n\tmeshbasic_frag: meshbasic.fragment,\n\tmeshlambert_vert: meshlambert.vertex,\n\tmeshlambert_frag: meshlambert.fragment,\n\tmeshmatcap_vert: meshmatcap.vertex,\n\tmeshmatcap_frag: meshmatcap.fragment,\n\tmeshnormal_vert: meshnormal.vertex,\n\tmeshnormal_frag: meshnormal.fragment,\n\tmeshphong_vert: meshphong.vertex,\n\tmeshphong_frag: meshphong.fragment,\n\tmeshphysical_vert: meshphysical.vertex,\n\tmeshphysical_frag: meshphysical.fragment,\n\tmeshtoon_vert: meshtoon.vertex,\n\tmeshtoon_frag: meshtoon.fragment,\n\tpoints_vert: points.vertex,\n\tpoints_frag: points.fragment,\n\tshadow_vert: shadow.vertex,\n\tshadow_frag: shadow.fragment,\n\tsprite_vert: sprite.vertex,\n\tsprite_frag: sprite.fragment\n};\n","export default /* glsl */`\n#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_ALPHATEST\n\n\tif ( diffuseColor.a < alphaTest ) discard;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_AOMAP\n\n\t// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_AOMAP\n\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n\n#endif\n`;\n","export default /* glsl */`\nvec3 transformed = vec3( position );\n`;\n","export default /* glsl */`\nvec3 objectNormal = vec3( normal );\n\n#ifdef USE_TANGENT\n\n\tvec3 objectTangent = vec3( tangent.xyz );\n\n#endif\n`;\n","export default /* glsl */`\n\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\n\treturn RECIPROCAL_PI * diffuseColor;\n\n} // validated\n\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\n\t// Original approximation by Christophe Schlick '94\n\t// float fresnel = pow( 1.0 - dotVH, 5.0 );\n\n\t// Optimized variant (presented by Epic at SIGGRAPH '13)\n\t// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n\n} // validated\n\n// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2\n// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\n\tfloat a2 = pow2( alpha );\n\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\n\treturn 0.5 / max( gv + gl, EPSILON );\n\n}\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (33)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is \"roughness squared\" in Disney’s reparameterization\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\n\tfloat a2 = pow2( alpha );\n\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1\n\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n\n}\n\n// GGX Distribution, Schlick Fresnel, GGX_SmithCorrelated Visibility\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\n\tfloat alpha = pow2( roughness ); // UE4's roughness\n\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\n\tfloat D = D_GGX( alpha, dotNH );\n\n\treturn F * ( V * D );\n\n}\n\n// Rect Area Light\n\n// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines\n// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt\n// code: https://github.com/selfshadow/ltc_code/\n\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\n\tfloat dotNV = saturate( dot( N, V ) );\n\n\t// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\n\treturn uv;\n\n}\n\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\n\t// Real-Time Area Lighting: a Journey from Research to Production (p.102)\n\t// An approximation of the form factor of a horizon-clipped rectangle.\n\n\tfloat l = length( f );\n\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n\n}\n\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\n\tfloat x = dot( v1, v2 );\n\n\tfloat y = abs( x );\n\n\t// rational polynomial approximation to theta / sin( theta ) / 2PI\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\n\treturn cross( v1, v2 ) * theta_sintheta;\n\n}\n\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\n\t// bail if point is on back side of plane of light\n\t// assumes ccw winding order of light vertices\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\n\t// construct orthonormal basis around N\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system\n\n\t// compute transform\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\n\t// transform rect\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\n\t// project rect onto sphere\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\n\t// calculate vector form factor\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\n\t// adjust for horizon clipping\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\n/*\n\t// alternate method of adjusting for horizon clipping (see referece)\n\t// refactoring required\n\tfloat len = length( vectorFormFactor );\n\tfloat z = vectorFormFactor.z / len;\n\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\n\t// tabulated horizon-clipped sphere, apparently...\n\tvec2 uv = vec2( z * 0.5 + 0.5, len );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\n\tfloat scale = texture2D( ltc_2, uv ).w;\n\n\tfloat result = len * scale;\n*/\n\n\treturn vec3( result );\n\n}\n\n// End Rect Area Light\n\n\nfloat G_BlinnPhong_Implicit( /* const in float dotNL, const in float dotNV */ ) {\n\n\t// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)\n\treturn 0.25;\n\n}\n\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n\n}\n\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\n\tfloat G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );\n\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\n\treturn F * ( G * D );\n\n} // validated\n\n#if defined( USE_SHEEN )\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nfloat D_Charlie( float roughness, float dotNH ) {\n\n\tfloat alpha = pow2( roughness );\n\n\t// Estevez and Kulla 2017, \"Production Friendly Microfacet Sheen BRDF\"\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 ); // 2^(-14/2), so sin2h^2 > 0 in fp16\n\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n\n}\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\n\t// Neubelt and Pettineo 2013, \"Crafting a Next-gen Material Pipeline for The Order: 1886\"\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n\n}\n\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\n\treturn sheenColor * ( D * V );\n\n}\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\t// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen\n\t// http://api.unrealengine.com/attachments/Engine/Rendering/LightingAndShadows/BumpMappingWithoutTangentSpace/mm_sfgrad_bump.pdf\n\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\t\t// normalized\n\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n`;\n","export default /* glsl */`\n#if NUM_CLIPPING_PLANES > 0\n\n\tvec4 plane;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\n\t\tbool clipped = true;\n\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\n\t\t}\n\t\t#pragma unroll_loop_end\n\n\t\tif ( clipped ) discard;\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#if NUM_CLIPPING_PLANES > 0\n\n\tvarying vec3 vClipPosition;\n\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n\n#endif\n`;\n","export default /* glsl */`\n#if NUM_CLIPPING_PLANES > 0\n\n\tvarying vec3 vClipPosition;\n\n#endif\n`;\n","export default /* glsl */`\n#if NUM_CLIPPING_PLANES > 0\n\n\tvClipPosition = - mvPosition.xyz;\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( USE_COLOR_ALPHA )\n\n\tdiffuseColor *= vColor;\n\n#elif defined( USE_COLOR )\n\n\tdiffuseColor.rgb *= vColor;\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( USE_COLOR_ALPHA )\n\n\tvarying vec4 vColor;\n\n#elif defined( USE_COLOR )\n\n\tvarying vec3 vColor;\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( USE_COLOR_ALPHA )\n\n\tvarying vec4 vColor;\n\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\n\tvarying vec3 vColor;\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( USE_COLOR_ALPHA )\n\n\tvColor = vec4( 1.0 );\n\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\n\tvColor = vec3( 1.0 );\n\n#endif\n\n#ifdef USE_COLOR\n\n\tvColor *= color;\n\n#endif\n\n#ifdef USE_INSTANCING_COLOR\n\n\tvColor.xyz *= instanceColor.xyz;\n\n#endif\n`;\n","export default /* glsl */`\n#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n\n#ifndef saturate\n// <tonemapping_pars_fragment> may have defined saturate() already\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\n\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\n\n// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.\n// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand( const in vec2 uv ) {\n\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\n\treturn fract( sin( sn ) * c );\n\n}\n\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\n\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\n\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n}\n\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t// dir can be either a direction vector or a normal vector\n\t// upper-left 3x3 of matrix is assumed to be orthogonal\n\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n\n}\n\nmat3 transposeMat3( const in mat3 m ) {\n\n\tmat3 tmp;\n\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\n\treturn tmp;\n\n}\n\n// https://en.wikipedia.org/wiki/Relative_luminance\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\n\treturn dot( weights, color.rgb );\n\n}\n\nbool isPerspectiveMatrix( mat4 m ) {\n\n\treturn m[ 2 ][ 3 ] == - 1.0;\n\n}\n\nvec2 equirectUv( in vec3 dir ) {\n\n\t// dir is assumed to be unit length\n\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\treturn vec2( u, v );\n\n}\n`;\n","export default /* glsl */`\n#ifdef ENVMAP_TYPE_CUBE_UV\n\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\n\t// These shader functions convert between the UV coordinates of a single face of\n\t// a cubemap, the 0-5 integer index of a cube face, and the direction vector for\n\t// sampling a textureCube (not generally normalized ).\n\n\tfloat getFace( vec3 direction ) {\n\n\t\tvec3 absDirection = abs( direction );\n\n\t\tfloat face = - 1.0;\n\n\t\tif ( absDirection.x > absDirection.z ) {\n\n\t\t\tif ( absDirection.x > absDirection.y )\n\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\n\t\t\telse\n\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\n\t\t} else {\n\n\t\t\tif ( absDirection.z > absDirection.y )\n\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\n\t\t\telse\n\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\n\t\t}\n\n\t\treturn face;\n\n\t}\n\n\t// RH coordinate system; PMREM face-indexing convention\n\tvec2 getUV( vec3 direction, float face ) {\n\n\t\tvec2 uv;\n\n\t\tif ( face == 0.0 ) {\n\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x ); // pos x\n\n\t\t} else if ( face == 1.0 ) {\n\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y ); // pos y\n\n\t\t} else if ( face == 2.0 ) {\n\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z ); // pos z\n\n\t\t} else if ( face == 3.0 ) {\n\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x ); // neg x\n\n\t\t} else if ( face == 4.0 ) {\n\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y ); // neg y\n\n\t\t} else {\n\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z ); // neg z\n\n\t\t}\n\n\t\treturn 0.5 * ( uv + 1.0 );\n\n\t}\n\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\n\t\tfloat face = getFace( direction );\n\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\n\t\tfloat faceSize = exp2( mipInt );\n\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\n\t\tvec2 f = fract( uv );\n\n\t\tuv += 0.5 - f;\n\n\t\tif ( face > 2.0 ) {\n\n\t\t\tuv.y += faceSize;\n\n\t\t\tface -= 3.0;\n\n\t\t}\n\n\t\tuv.x += face * faceSize;\n\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\n\t\t}\n\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\n\t\tuv *= texelSize;\n\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\n\t\tuv.x += texelSize;\n\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\n\t\tuv.y += texelSize;\n\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\n\t\tuv.x -= texelSize;\n\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\n\t\tvec3 tm = mix( tl, tr, f.x );\n\n\t\tvec3 bm = mix( bl, br, f.x );\n\n\t\treturn mix( tm, bm, f.y );\n\n\t}\n\n\t// These defines must match with PMREMGenerator\n\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\n\tfloat roughnessToMip( float roughness ) {\n\n\t\tfloat mip = 0.0;\n\n\t\tif ( roughness >= r1 ) {\n\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\n\t\t} else if ( roughness >= r4 ) {\n\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\n\t\t} else if ( roughness >= r5 ) {\n\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\n\t\t} else if ( roughness >= r6 ) {\n\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\n\t\t} else {\n\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness ); // 1.16 = 1.79^0.25\n\t\t}\n\n\t\treturn mip;\n\n\t}\n\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\n\t\tfloat mipF = fract( mip );\n\n\t\tfloat mipInt = floor( mip );\n\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\n\t\tif ( mipF == 0.0 ) {\n\n\t\t\treturn vec4( color0, 1.0 );\n\n\t\t} else {\n\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\n\t\t}\n\n\t}\n\n#endif\n`;\n","export default /* glsl */`\nvec3 transformedNormal = objectNormal;\n\n#ifdef USE_INSTANCING\n\n\t// this is in lieu of a per-instance normal-matrix\n\t// shear transforms in the instance matrix are not supported\n\n\tmat3 m = mat3( instanceMatrix );\n\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\n\ttransformedNormal = m * transformedNormal;\n\n#endif\n\ntransformedNormal = normalMatrix * transformedNormal;\n\n#ifdef FLIP_SIDED\n\n\ttransformedNormal = - transformedNormal;\n\n#endif\n\n#ifdef USE_TANGENT\n\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\n\t#ifdef FLIP_SIDED\n\n\t\ttransformedTangent = - transformedTangent;\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_DISPLACEMENTMAP\n\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_DISPLACEMENTMAP\n\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_EMISSIVEMAP\n\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_EMISSIVEMAP\n\n\tuniform sampler2D emissiveMap;\n\n#endif\n`;\n","export default /* glsl */`\ngl_FragColor = linearToOutputTexel( gl_FragColor );\n`;\n","export default /* glsl */`\n// For a discussion of what this is, please read this: http://lousodrome.net/blog/light/2013/05/26/gamma-correct-and-hdr-rendering-in-a-32-bits-buffer/\n\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\n\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\n\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\n\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\n\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\n\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\n\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n\t// return vec4( value.brg, ( 3.0 + 128.0 ) / 256.0 );\n}\n\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\n\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\n\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\n\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\t// NOTE: The implementation with min causes the shader to not compile on\n\t// a common Alcatel A502DL in Chrome 78/Android 8.1. Some research suggests \n\t// that the chipset is Mediatek MT6739 w/ IMG PowerVR GE8100 GPU.\n\t// D = min( floor( D ) / 255.0, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\n\n// LogLuv reference: http://graphicrants.blogspot.ca/2009/04/rgbm-color-encoding.html\n\n// M matrix, for encoding\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\n\n// Inverse M matrix, for decoding\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}\n`;\n","export default /* glsl */`\n#ifdef USE_ENVMAP\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvec3 cameraToFrag;\n\n\t\tif ( isOrthographic ) {\n\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\n\t\t} else {\n\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\n\t\t}\n\n\t\t// Transforming Normal Vectors with the Inverse Transformation\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t\tenvColor = envMapTexelToLinear( envColor );\n\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\n\t#else\n\n\t\tvec4 envColor = vec4( 0.0 );\n\n\t#endif\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_ENVMAP\n\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_ENVMAP\n\n\tuniform float reflectivity;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\t#define ENV_WORLDPOS\n\n\t#endif\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\n\t\t#define ENV_WORLDPOS\n\n\t#endif\n\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( USE_ENVMAP )\n\n\t#ifdef ENVMAP_MODE_REFRACTION\n\n\t\tuniform float refractionRatio;\n\n\t#endif\n\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\n\t\t#else\n\n\t\t\treturn vec3( 0.0 );\n\n\t\t#endif\n\n\t}\n\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec3 reflectVec;\n\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\n\t\t\t\t// Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\n\t\t\t#else\n\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\n\t\t\t#endif\n\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\n\t\t#else\n\n\t\t\treturn vec3( 0.0 );\n\n\t\t#endif\n\n\t}\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_ENVMAP\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvWorldPosition = worldPosition.xyz;\n\n\t#else\n\n\t\tvec3 cameraToVertex;\n\n\t\tif ( isOrthographic ) {\n\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\n\t\t} else {\n\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\t\t}\n\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_FOG\n\n\tvFogDepth = - mvPosition.z;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_FOG\n\n\tvarying float vFogDepth;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_FOG\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\n\t#endif\n\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n\n#ifdef USE_GRADIENTMAP\n\n\tuniform sampler2D gradientMap;\n\n#endif\n\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\n\t// dotNL will be from -1.0 to 1.0\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\n\t#ifdef USE_GRADIENTMAP\n\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\n\t#else\n\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\n\t#endif\n\n}\n`;\n","export default /* glsl */`\n#ifdef USE_LIGHTMAP\n\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tlightMapIrradiance *= PI;\n\n\t#endif\n\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_LIGHTMAP\n\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n\n#endif\n`;\n","export default /* glsl */`\nvec3 diffuse = vec3( 1.0 );\n\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\n\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\n\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\n\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\n\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n\n#ifdef DOUBLE_SIDED\n\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n\n#endif\n\n#if NUM_POINT_LIGHTS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if NUM_SPOT_LIGHTS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if NUM_DIR_LIGHTS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if NUM_HEMI_LIGHTS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\n\t\t#endif\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n`;\n","export default /* glsl */`\nuniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\n\n// get the irradiance (radiance convolved with cosine lobe) at the point 'normal' on the unit sphere\n// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\n\t// normal is assumed to have unit length\n\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\n\t// band 0\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\n\t// band 1\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\n\t// band 2\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\n\treturn result;\n\n}\n\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\n\treturn irradiance;\n\n}\n\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\n\tvec3 irradiance = ambientLightColor;\n\n\treturn irradiance;\n\n}\n\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\n\t\t// based upon Frostbite 3 Moving to Physically-based Rendering\n\t\t// page 32, equation 26: E[window1]\n\t\t// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\n\t\tif ( cutoffDistance > 0.0 ) {\n\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\n\t\t}\n\n\t\treturn distanceFalloff;\n\n\t#else\n\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\n\t\t}\n\n\t\treturn 1.0;\n\n\t#endif\n\n}\n\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n\n}\n\n#if NUM_DIR_LIGHTS > 0\n\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\n\t}\n\n#endif\n\n\n#if NUM_POINT_LIGHTS > 0\n\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\n\t// light is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\n\t\tlight.direction = normalize( lVector );\n\n\t\tfloat lightDistance = length( lVector );\n\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\n\t}\n\n#endif\n\n\n#if NUM_SPOT_LIGHTS > 0\n\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\n\t// light is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\n\t\tlight.direction = normalize( lVector );\n\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\n\t\tif ( spotAttenuation > 0.0 ) {\n\n\t\t\tfloat lightDistance = length( lVector );\n\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\n\t\t} else {\n\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\n\t\t}\n\n\t}\n\n#endif\n\n\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\n\t// Pre-computed values of LinearTransformedCosine approximation of BRDF\n\t// BRDF approximation Texture is 64x64\n\tuniform sampler2D ltc_1; // RGBA Float\n\tuniform sampler2D ltc_2; // RGBA Float\n\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n\n#endif\n\n\n#if NUM_HEMI_LIGHTS > 0\n\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\n\t\treturn irradiance;\n\n\t}\n\n#endif\n`;\n","export default /* glsl */`\nToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\n`;\n","export default /* glsl */`\nvarying vec3 vViewPosition;\n\nstruct ToonMaterial {\n\n\tvec3 diffuseColor;\n\n};\n\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\n}\n\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n\n#define Material_LightProbeLOD( material )\t(0)\n`;\n","export default /* glsl */`\nBlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n`;\n","export default /* glsl */`\nvarying vec3 vViewPosition;\n\nstruct BlinnPhongMaterial {\n\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n\n};\n\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n\n}\n\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n\n#define Material_LightProbeLOD( material )\t(0)\n`;\n","export default /* glsl */`\nPhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\n\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\n\nmaterial.roughness = max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.\nmaterial.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n\n#ifdef IOR\n\n\t#ifdef SPECULAR\n\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\n\t\t#endif\n\n\t\t#ifdef USE_SPECULARCOLORMAP\n\n\t\t\tspecularColorFactor *= specularColorMapTexelToLinear( texture2D( specularColorMap, vUv ) ).rgb;\n\n\t\t#endif\n\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\n\t#else\n\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\n\t#endif\n\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n\n#else\n\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n\n#endif\n\n#ifdef USE_CLEARCOAT\n\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\n\t#ifdef USE_CLEARCOATMAP\n\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\n\t#endif\n\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\n\t#endif\n\n\tmaterial.clearcoat = saturate( material.clearcoat ); // Burley clearcoat model\n\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n\n#endif\n\n#ifdef USE_SHEEN\n\n\tmaterial.sheenColor = sheenColor;\n\n\t#ifdef USE_SHEENCOLORMAP\n\n\t\tmaterial.sheenColor *= sheenColorMapTexelToLinear( texture2D( sheenColorMap, vUv ) ).rgb;\n\n\t#endif\n\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\n\t#ifdef USE_SHEENROUGHNESSMAP\n\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\nstruct PhysicalMaterial {\n\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\n};\n\n// temporary\nvec3 clearcoatSpecular = vec3( 0.0 );\n\n// Analytical approximation of the DFG LUT, one half of the\n// split-sum approximation used in indirect specular lighting.\n// via 'environmentBRDF' from \"Physically Based Shading on Mobile\"\n// https://www.unrealengine.com/blog/physically-based-shading-on-mobile\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\n\tvec4 r = roughness * c0 + c1;\n\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\n\treturn fab;\n\n}\n\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\n\treturn specularColor * fab.x + specularF90 * fab.y;\n\n}\n\n// Fdez-Agüera's \"Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting\"\n// Approximates multiscattering in order to preserve energy.\n// http://www.jcgt.org/published/0008/01/03/\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619; // 1/21\n\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n\n}\n\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight; // counterclockwise; light shines in local neg z direction\n\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\n\t\t// LTC Fresnel Approximation by Stephen Hill\n\t\t// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\n\t}\n\n#endif\n\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\n\tvec3 irradiance = dotNL * directLight.color;\n\n\t#ifdef USE_CLEARCOAT\n\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\n\t#endif\n\n\t#ifdef USE_SHEEN\n\n\t\treflectedLight.directSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\n\t#endif\n\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\n}\n\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\n\t#ifdef USE_CLEARCOAT\n\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\n\t#endif\n\n\t// Both indirect specular and indirect diffuse light accumulate here\n\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n\n// ref: https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n\n}\n`;\n","export default /* glsl */`\n/**\n * This is a template that can be used to light a material, it uses pluggable\n * RenderEquations (RE)for specific lighting scenarios.\n *\n * Instructions for use:\n * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined\n * - If you have defined an RE_IndirectSpecular, you need to also provide a Material_LightProbeLOD. <---- ???\n * - Create a material parameter that is to be passed as the third parameter to your lighting functions.\n *\n * TODO:\n * - Add area light support.\n * - Add sphere light support.\n * - Add diffuse light probe (irradiance cubemap) support.\n */\n\nGeometricContext geometry;\n\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n\n#ifdef USE_CLEARCOAT\n\n\tgeometry.clearcoatNormal = clearcoatNormal;\n\n#endif\n\nIncidentLight directLight;\n\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\n\tRectAreaLight rectAreaLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if defined( RE_IndirectDiffuse )\n\n\tvec3 iblIrradiance = vec3( 0.0 );\n\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\n\t\t}\n\t\t#pragma unroll_loop_end\n\n\t#endif\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( RE_IndirectDiffuse )\n\n\t#ifdef USE_LIGHTMAP\n\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tlightMapIrradiance *= PI;\n\n\t\t#endif\n\n\t\tirradiance += lightMapIrradiance;\n\n\t#endif\n\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\n\t#endif\n\n#endif\n\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\n\t#ifdef USE_CLEARCOAT\n\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( RE_IndirectDiffuse )\n\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\n\t// Doing a strict comparison with == 1.0 can cause noise artifacts\n\t// on some platforms. See issue #17623.\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\n\t#else\n\n\t\tuniform float logDepthBufFC;\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\n\t#else\n\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\n\t\t\tgl_Position.z *= gl_Position.w;\n\n\t\t}\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\n#endif\n\n#ifdef USE_MAP\n\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n\n#endif\n\n#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\n\tuniform mat3 uvTransform;\n\n#endif\n\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif\n\n#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n`;\n","export default /* glsl */`\nfloat metalnessFactor = metalness;\n\n#ifdef USE_METALNESSMAP\n\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\n\t// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\tmetalnessFactor *= texelMetalness.b;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_METALNESSMAP\n\n\tuniform sampler2D metalnessMap;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_MORPHNORMALS\n\n\t// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:\n\t// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)\n\t// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting\n\tobjectNormal *= morphTargetBaseInfluence;\n\n\t#ifdef MORPHTARGETS_TEXTURE\n\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\n\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\n\t\t}\n\n\t#else\n\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_MORPHTARGETS\n\n\tuniform float morphTargetBaseInfluence;\n\n\t#ifdef MORPHTARGETS_TEXTURE\n\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\n\t\t}\n\n\t#else\n\n\t\t#ifndef USE_MORPHNORMALS\n\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\n\t\t#else\n\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\n\t\t#endif\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_MORPHTARGETS\n\n\t// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:\n\t// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in position = sum((target - base) * influence)\n\t// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting\n\ttransformed *= morphTargetBaseInfluence;\n\n\t#ifdef MORPHTARGETS_TEXTURE\n\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\n\t\t\t#ifndef USE_MORPHNORMALS\n\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\n\t\t\t#else\n\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\n\t\t\t#endif\n\n\t\t}\n\n\t#else\n\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\n\t\t#ifndef USE_MORPHNORMALS\n\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\n\t\t#endif\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\nfloat faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n\n#ifdef FLAT_SHADED\n\n\t// Workaround for Adreno GPUs not able to do dFdx( vViewPosition )\n\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n\n#else\n\n\tvec3 normal = normalize( vNormal );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * faceDirection;\n\n\t#endif\n\n\t#ifdef USE_TANGENT\n\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\n\t\t#endif\n\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\n\t\t#endif\n\n\t#endif\n\n#endif\n\n// non perturbed normal for clearcoat among others\n\nvec3 geometryNormal = normal;\n\n`;\n","export default /* glsl */`\n\n#ifdef OBJECTSPACE_NORMALMAP\n\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals\n\n\t#ifdef FLIP_SIDED\n\n\t\tnormal = - normal;\n\n\t#endif\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * faceDirection;\n\n\t#endif\n\n\tnormal = normalize( normalMatrix * normal );\n\n#elif defined( TANGENTSPACE_NORMALMAP )\n\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\n\t#ifdef USE_TANGENT\n\n\t\tnormal = normalize( vTBN * mapN );\n\n\t#else\n\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\n\t#endif\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n\n#endif\n`;\n","export default /* glsl */`\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#ifndef FLAT_SHADED // normal is computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n#endif\n\n#ifdef OBJECTSPACE_NORMALMAP\n\n\tuniform mat3 normalMatrix;\n\n#endif\n\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\n\t// Normal Mapping Without Precomputed Tangents\n\t// http://www.thetenthplanet.de/archives/1180\n\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tvec3 N = surf_norm; // normalized\n\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\n\t}\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_CLEARCOAT\n\n\tvec3 clearcoatNormal = geometryNormal;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_CLEARCOAT_NORMALMAP\n\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\n\t#ifdef USE_TANGENT\n\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\n\t#else\n\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n\n#ifdef USE_CLEARCOATMAP\n\n\tuniform sampler2D clearcoatMap;\n\n#endif\n\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\n\tuniform sampler2D clearcoatRoughnessMap;\n\n#endif\n\n#ifdef USE_CLEARCOAT_NORMALMAP\n\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n\n// https://github.com/mrdoob/three.js/pull/22425\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\n\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );\n`;\n","export default /* glsl */`\nvec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\n\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\n\nconst float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)\nconst float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)\n\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\n\nconst float ShiftRight8 = 1. / 256.;\n\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8; // tidy overflow\n\treturn r * PackUpscale;\n}\n\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\n\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\n\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\n\n// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions\n\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\n\n// NOTE: https://twitter.com/gonnavis/status/1377183786949959682\n\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n`;\n","export default /* glsl */`\n#ifdef PREMULTIPLIED_ALPHA\n\n\t// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.\n\tgl_FragColor.rgb *= gl_FragColor.a;\n\n#endif\n`;\n","export default /* glsl */`\nvec4 mvPosition = vec4( transformed, 1.0 );\n\n#ifdef USE_INSTANCING\n\n\tmvPosition = instanceMatrix * mvPosition;\n\n#endif\n\nmvPosition = modelViewMatrix * mvPosition;\n\ngl_Position = projectionMatrix * mvPosition;\n`;\n","export default /* glsl */`\n#ifdef DITHERING\n\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef DITHERING\n\n\t// based on https://www.shadertoy.com/view/MslGR8\n\tvec3 dithering( vec3 color ) {\n\t\t//Calculate grid position\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\n\t\t//Shift the individual colors differently, thus making it even harder to see the dithering pattern\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\n\t\t//modify shift acording to grid position.\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\n\t\t//shift the color by dither_shift\n\t\treturn color + dither_shift_RGB;\n\t}\n\n#endif\n`;\n","export default /* glsl */`\nfloat roughnessFactor = roughness;\n\n#ifdef USE_ROUGHNESSMAP\n\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\n\t// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\troughnessFactor *= texelRoughness.g;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_ROUGHNESSMAP\n\n\tuniform sampler2D roughnessMap;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): create uniforms for area light shadows\n\n\t#endif\n\t*/\n\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\n\t}\n\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\n\t}\n\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\n\t\tfloat occlusion = 1.0;\n\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\n\t\tfloat hard_shadow = step( compare , distribution.x ); // Hard Shadow\n\n\t\tif (hard_shadow != 1.0 ) {\n\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality\n\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed\n\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\n\t\t}\n\t\treturn occlusion;\n\n\t}\n\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\n\t\tfloat shadow = 1.0;\n\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\n\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\n\t\t// if ( all( something, something ) ) using this instead\n\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\tbool frustumTest = all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n\t\t#else // no percentage-closer filtering:\n\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n\t\t#endif\n\n\t\t}\n\n\t\treturn shadow;\n\n\t}\n\n\t// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\n\t// vector suitable for 2D texture mapping. This code uses the following layout for the\n\t// 2D texture:\n\t//\n\t// xzXZ\n\t//  y Y\n\t//\n\t// Y - Positive y direction\n\t// y - Negative y direction\n\t// X - Positive x direction\n\t// x - Negative x direction\n\t// Z - Positive z direction\n\t// z - Negative z direction\n\t//\n\t// Source and test bed:\n\t// https://gist.github.com/tschw/da10c43c467ce8afd0c4\n\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\n\t\t// Number of texels to avoid at the edge of each square\n\n\t\tvec3 absV = abs( v );\n\n\t\t// Intersect unit cube\n\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\n\t\t// Apply scale to avoid seams\n\n\t\t// two texels less per square (one texel will do for NEAREST)\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\n\t\t// Unwrap\n\n\t\t// space: -1 ... 1 range for each square\n\t\t//\n\t\t// #X##\t\tdim    := ( 4 , 2 )\n\t\t//  # #\t\tcenter := ( 1 , 1 )\n\n\t\tvec2 planar = v.xy;\n\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\n\t\tif ( absV.z >= almostOne ) {\n\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\n\t\t} else if ( absV.x >= almostOne ) {\n\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\n\t\t} else if ( absV.y >= almostOne ) {\n\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\n\t\t}\n\n\t\t// Transform to UV space\n\n\t\t// scale := 0.5 / dim\n\t\t// translate := ( center + 0.5 ) / dim\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n\t}\n\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\n\t\t// for point lights, the uniform @vShadowCoord is re-purposed to hold\n\t\t// the vector from the light to the world-space position of the fragment.\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\n\t\t// dp = normalized distance from light to fragment position\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?\n\t\tdp += shadowBias;\n\n\t\t// bd3D = base direction 3D\n\t\tvec3 bd3D = normalize( lightToPosition );\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#else // no percentage-closer filtering\n\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\n\t\t#endif\n\n\t}\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): uniforms for area light shadows\n\n\t#endif\n\t*/\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\n\t\t// Offsetting the position used for querying occlusion along the world normal can be used to reduce shadow acne.\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\n\t#endif\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): update vAreaShadowCoord with area light info\n\n\t#endif\n\t*/\n\n#endif\n`;\n","export default /* glsl */`\nfloat getShadowMask() {\n\n\tfloat shadow = 1.0;\n\n\t#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\tDirectionalLightShadow directionalLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\tSpotLightShadow spotLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\tPointLightShadow pointLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): update shadow for Area light\n\n\t#endif\n\t*/\n\n\t#endif\n\n\treturn shadow;\n\n}\n`;\n","export default /* glsl */`\n#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_SKINNING\n\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\n\t#ifdef USE_TANGENT\n\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\n\t#endif\n\n#endif\n`;\n","export default /* glsl */`\nfloat specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( TONE_MAPPING )\n\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n\n#endif\n`;\n","export default /* glsl */`\n#ifndef saturate\n// <common> may have defined saturate() already\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n\nuniform float toneMappingExposure;\n\n// exposure only\nvec3 LinearToneMapping( vec3 color ) {\n\n\treturn toneMappingExposure * color;\n\n}\n\n// source: https://www.cs.utah.edu/~reinhard/cdrom/\nvec3 ReinhardToneMapping( vec3 color ) {\n\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n\n}\n\n// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\n\t// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n\n}\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\nvec3 RRTAndODTFit( vec3 v ) {\n\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n\n}\n\n// this implementation of ACES is modified to accommodate a brighter viewing environment.\n// the scale factor of 1/0.6 is subjective. see discussion in #19621.\n\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\n\t// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ), // transposed from source\n\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\n\t// ODT_SAT => XYZ => D60_2_D65 => sRGB\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ), // transposed from source\n\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\n\tcolor *= toneMappingExposure / 0.6;\n\n\tcolor = ACESInputMat * color;\n\n\t// Apply RRT and ODT\n\tcolor = RRTAndODTFit( color );\n\n\tcolor = ACESOutputMat * color;\n\n\t// Clamp to [0, 1]\n\treturn saturate( color );\n\n}\n\nvec3 CustomToneMapping( vec3 color ) { return color; }\n`;\n","export default /* glsl */`\n#ifdef USE_TRANSMISSION\n\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\n\t#ifdef USE_TRANSMISSIONMAP\n\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\n\t#endif\n\n\t#ifdef USE_THICKNESSMAP\n\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\n\t#endif\n\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_TRANSMISSION\n\n\t// Transmission code is based on glTF-Sampler-Viewer\n\t// https://github.com/KhronosGroup/glTF-Sample-Viewer\n\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\n\t#ifdef USE_TRANSMISSIONMAP\n\n\t\tuniform sampler2D transmissionMap;\n\n\t#endif\n\n\t#ifdef USE_THICKNESSMAP\n\n\t\tuniform sampler2D thicknessMap;\n\n\t#endif\n\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\n\tvarying vec3 vWorldPosition;\n\n\tvec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\n\t\t// Direction of refracted light.\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\n\t\t// Compute rotation-independant scaling of the model matrix.\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\n\t\t// The thickness is specified in local space.\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\n\t}\n\n\tfloat applyIorToRoughness( float roughness, float ior ) {\n\n\t\t// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and\n\t\t// an IOR of 1.5 results in the default amount of microfacet refraction.\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\n\t}\n\n\tvec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {\n\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\n\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\n\t\t#else\n\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\n\t\t#endif\n\n\t}\n\n\tvec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {\n\n\t\tif ( attenuationDistance == 0.0 ) {\n\n\t\t\t// Attenuation distance is +∞ (which we indicate by zero), i.e. the transmitted color is not attenuated at all.\n\t\t\treturn radiance;\n\n\t\t} else {\n\n\t\t\t// Compute light attenuation using Beer's law.\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law\n\t\t\treturn transmittance * radiance;\n\n\t\t}\n\n\t}\n\n\tvec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance ) {\n\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\n\t\t// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\n\t\t// Sample framebuffer to get pixel the refracted ray hits.\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\n\t\t// Get the specular component.\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\n\t}\n#endif\n`;\n","export default /* glsl */`\n#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\n\tvarying vec2 vUv;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_UV\n\n\t#ifdef UVS_VERTEX_ONLY\n\n\t\tvec2 vUv;\n\n\t#else\n\n\t\tvarying vec2 vUv;\n\n\t#endif\n\n\tuniform mat3 uvTransform;\n\n#endif\n`;\n","export default /* glsl */`\n#ifdef USE_UV\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvarying vec2 vUv2;\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\n\tuniform mat3 uv2Transform;\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n\n#endif\n`;\n","export default /* glsl */`\n#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\n\t#ifdef USE_INSTANCING\n\n\t\tworldPosition = instanceMatrix * worldPosition;\n\n\t#endif\n\n\tworldPosition = modelMatrix * worldPosition;\n\n#endif\n`;\n","export const vertex = /* glsl */`\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n\tgl_Position.z = gl_Position.w; // set z to camera.far\n\n}\n`;\n\nexport const fragment = /* glsl */`\n#include <envmap_common_pars_fragment>\nuniform float opacity;\n\nvarying vec3 vWorldDirection;\n\n#include <cube_uv_reflection_fragment>\n\nvoid main() {\n\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n`;\n","export const vertex = /* glsl */`\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\n// This is used for computing an equivalent of gl_FragCoord.z that is as high precision as possible.\n// Some platforms compute gl_FragCoord at a lower precision which makes the manually computed value better for\n// depth-based postprocessing effects. Reproduced on iPad with A10 processor / iPadOS 13.3.1.\nvarying vec2 vHighPrecisionZW;\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvHighPrecisionZW = gl_Position.zw;\n\n}\n`;\n\nexport const fragment = /* glsl */`\n#if DEPTH_PACKING == 3200\n\n\tuniform float opacity;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvarying vec2 vHighPrecisionZW;\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tdiffuseColor.a = opacity;\n\n\t#endif\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\t#include <logdepthbuf_fragment>\n\n\t// Higher precision equivalent of gl_FragCoord.z. This assumes depthRange has been left to its default values.\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\n\t#elif DEPTH_PACKING == 3201\n\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\n\t#endif\n\n}\n`;\n","export const vertex = /* glsl */`\n#define DISTANCE\n\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvWorldPosition = worldPosition.xyz;\n\n}\n`;\n\nexport const fragment = /* glsl */`\n#define DISTANCE\n\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main () {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist ); // clamp to [ 0, 1 ]\n\n\tgl_FragColor = packDepthToRGBA( dist );\n\n}\n`;\n","export const vertex = /* glsl */`\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n}\n`;\n\nexport const fragment = /* glsl */`\nuniform sampler2D tEquirect;\n\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvec3 direction = normalize( vWorldDirection );\n\n\tvec2 sampleUV = equirectUv( direction );\n\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n`;\n","export const vertex = /* glsl */`\nuniform float scale;\nattribute float lineDistance;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\tvLineDistance = scale * lineDistance;\n\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n`;\n\nexport const fragment = /* glsl */`\nuniform vec3 diffuse;\nuniform float opacity;\n\nuniform float dashSize;\nuniform float totalSize;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\n\t\tdiscard;\n\n\t}\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\n\toutgoingLight = diffuseColor.rgb; // simple shader\n\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n`;\n","export const vertex = /* glsl */`\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n\n}\n`;\n\nexport const fragment = /* glsl */`\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\n\t// accumulation (baked indirect lighting only)\n\t#ifdef USE_LIGHTMAP\n\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\n\t#endif\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\t#include <envmap_fragment>\n\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n`;\n","export const vertex = /* glsl */`\n#define LAMBERT\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n`;\n\nexport const fragment = /* glsl */`\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\n\t#endif\n\n\t#include <lightmap_fragment>\n\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\n\t#else\n\n\t\treflectedLight.directDiffuse = vLightFront;\n\n\t#endif\n\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\n\t// modulation\n\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n`;\n","export const vertex = /* glsl */`\n#define MATCAP\n\nvarying vec3 vViewPosition;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n}\n`;\n\nexport const fragment = /* glsl */`\n#define MATCAP\n\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\n\nvarying vec3 vViewPosition;\n\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n\n\t#ifdef USE_MATCAP\n\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\n\t#else\n\n\t\tvec4 matcapColor = vec4( 1.0 );\n\n\t#endif\n\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n`;\n","export const vertex = /* glsl */`\n#define NORMAL\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvViewPosition = - mvPosition.xyz;\n\n#endif\n\n}\n`;\n\nexport const fragment = /* glsl */`\n#define NORMAL\n\nuniform float opacity;\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\n}\n`;\n","export const vertex = /* glsl */`\n#define PHONG\n\nvarying vec3 vViewPosition;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n`;\n\nexport const fragment = /* glsl */`\n#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n`;\n","export const vertex = /* glsl */`\n#define STANDARD\n\nvarying vec3 vViewPosition;\n\n#ifdef USE_TRANSMISSION\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n#ifdef USE_TRANSMISSION\n\n\tvWorldPosition = worldPosition.xyz;\n\n#endif\n}\n`;\n\nexport const fragment = /* glsl */`\n#define STANDARD\n\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef IOR\n\tuniform float ior;\n#endif\n\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n\nvarying vec3 vViewPosition;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\n\t#include <transmission_fragment>\n\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\n\t#ifdef USE_CLEARCOAT\n\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\n\t\toutgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;\n\n\t#endif\n\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n`;\n","export const vertex = /* glsl */`\n#define TOON\n\nvarying vec3 vViewPosition;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n`;\n\nexport const fragment = /* glsl */`\n#define TOON\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n`;\n","export const vertex = /* glsl */`\nuniform float size;\nuniform float scale;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\n\tgl_PointSize = size;\n\n\t#ifdef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\n\t#endif\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n\n}\n`;\n\nexport const fragment = /* glsl */`\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n`;\n","export const vertex = /* glsl */`\n#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n\nvoid main() {\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n`;\n\nexport const fragment = /* glsl */`\nuniform vec3 color;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n\nvoid main() {\n\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n`;\n","export const vertex = /* glsl */`\nuniform float rotation;\nuniform vec2 center;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n\t#ifndef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\n\t#endif\n\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\n\tmvPosition.xy += rotatedPosition;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n`;\n\nexport const fragment = /* glsl */`\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n`;\n","import { Color } from '../../math/Color.js';\nimport { Vector2 } from '../../math/Vector2.js';\nimport { Matrix3 } from '../../math/Matrix3.js';\n\n/**\n * Uniforms library for shared webgl shaders\n */\n\nconst UniformsLib = {\n\n\tcommon: {\n\n\t\tdiffuse: { value: new Color( 0xffffff ) },\n\t\topacity: { value: 1.0 },\n\n\t\tmap: { value: null },\n\t\tuvTransform: { value: new Matrix3() },\n\t\tuv2Transform: { value: new Matrix3() },\n\n\t\talphaMap: { value: null },\n\t\talphaTest: { value: 0 }\n\n\t},\n\n\tspecularmap: {\n\n\t\tspecularMap: { value: null },\n\n\t},\n\n\tenvmap: {\n\n\t\tenvMap: { value: null },\n\t\tflipEnvMap: { value: - 1 },\n\t\treflectivity: { value: 1.0 }, // basic, lambert, phong\n\t\tior: { value: 1.5 }, // standard, physical\n\t\trefractionRatio: { value: 0.98 },\n\t\tmaxMipLevel: { value: 0 }\n\n\t},\n\n\taomap: {\n\n\t\taoMap: { value: null },\n\t\taoMapIntensity: { value: 1 }\n\n\t},\n\n\tlightmap: {\n\n\t\tlightMap: { value: null },\n\t\tlightMapIntensity: { value: 1 }\n\n\t},\n\n\temissivemap: {\n\n\t\temissiveMap: { value: null }\n\n\t},\n\n\tbumpmap: {\n\n\t\tbumpMap: { value: null },\n\t\tbumpScale: { value: 1 }\n\n\t},\n\n\tnormalmap: {\n\n\t\tnormalMap: { value: null },\n\t\tnormalScale: { value: new Vector2( 1, 1 ) }\n\n\t},\n\n\tdisplacementmap: {\n\n\t\tdisplacementMap: { value: null },\n\t\tdisplacementScale: { value: 1 },\n\t\tdisplacementBias: { value: 0 }\n\n\t},\n\n\troughnessmap: {\n\n\t\troughnessMap: { value: null }\n\n\t},\n\n\tmetalnessmap: {\n\n\t\tmetalnessMap: { value: null }\n\n\t},\n\n\tgradientmap: {\n\n\t\tgradientMap: { value: null }\n\n\t},\n\n\tfog: {\n\n\t\tfogDensity: { value: 0.00025 },\n\t\tfogNear: { value: 1 },\n\t\tfogFar: { value: 2000 },\n\t\tfogColor: { value: new Color( 0xffffff ) }\n\n\t},\n\n\tlights: {\n\n\t\tambientLightColor: { value: [] },\n\n\t\tlightProbe: { value: [] },\n\n\t\tdirectionalLights: { value: [], properties: {\n\t\t\tdirection: {},\n\t\t\tcolor: {}\n\t\t} },\n\n\t\tdirectionalLightShadows: { value: [], properties: {\n\t\t\tshadowBias: {},\n\t\t\tshadowNormalBias: {},\n\t\t\tshadowRadius: {},\n\t\t\tshadowMapSize: {}\n\t\t} },\n\n\t\tdirectionalShadowMap: { value: [] },\n\t\tdirectionalShadowMatrix: { value: [] },\n\n\t\tspotLights: { value: [], properties: {\n\t\t\tcolor: {},\n\t\t\tposition: {},\n\t\t\tdirection: {},\n\t\t\tdistance: {},\n\t\t\tconeCos: {},\n\t\t\tpenumbraCos: {},\n\t\t\tdecay: {}\n\t\t} },\n\n\t\tspotLightShadows: { value: [], properties: {\n\t\t\tshadowBias: {},\n\t\t\tshadowNormalBias: {},\n\t\t\tshadowRadius: {},\n\t\t\tshadowMapSize: {}\n\t\t} },\n\n\t\tspotShadowMap: { value: [] },\n\t\tspotShadowMatrix: { value: [] },\n\n\t\tpointLights: { value: [], properties: {\n\t\t\tcolor: {},\n\t\t\tposition: {},\n\t\t\tdecay: {},\n\t\t\tdistance: {}\n\t\t} },\n\n\t\tpointLightShadows: { value: [], properties: {\n\t\t\tshadowBias: {},\n\t\t\tshadowNormalBias: {},\n\t\t\tshadowRadius: {},\n\t\t\tshadowMapSize: {},\n\t\t\tshadowCameraNear: {},\n\t\t\tshadowCameraFar: {}\n\t\t} },\n\n\t\tpointShadowMap: { value: [] },\n\t\tpointShadowMatrix: { value: [] },\n\n\t\themisphereLights: { value: [], properties: {\n\t\t\tdirection: {},\n\t\t\tskyColor: {},\n\t\t\tgroundColor: {}\n\t\t} },\n\n\t\t// TODO (abelnation): RectAreaLight BRDF data needs to be moved from example to main src\n\t\trectAreaLights: { value: [], properties: {\n\t\t\tcolor: {},\n\t\t\tposition: {},\n\t\t\twidth: {},\n\t\t\theight: {}\n\t\t} },\n\n\t\tltc_1: { value: null },\n\t\tltc_2: { value: null }\n\n\t},\n\n\tpoints: {\n\n\t\tdiffuse: { value: new Color( 0xffffff ) },\n\t\topacity: { value: 1.0 },\n\t\tsize: { value: 1.0 },\n\t\tscale: { value: 1.0 },\n\t\tmap: { value: null },\n\t\talphaMap: { value: null },\n\t\talphaTest: { value: 0 },\n\t\tuvTransform: { value: new Matrix3() }\n\n\t},\n\n\tsprite: {\n\n\t\tdiffuse: { value: new Color( 0xffffff ) },\n\t\topacity: { value: 1.0 },\n\t\tcenter: { value: new Vector2( 0.5, 0.5 ) },\n\t\trotation: { value: 0.0 },\n\t\tmap: { value: null },\n\t\talphaMap: { value: null },\n\t\talphaTest: { value: 0 },\n\t\tuvTransform: { value: new Matrix3() }\n\n\t}\n\n};\n\nexport { UniformsLib };\n","import { ShaderChunk } from './ShaderChunk.js';\nimport { mergeUniforms } from './UniformsUtils.js';\nimport { Vector2 } from '../../math/Vector2.js';\nimport { Vector3 } from '../../math/Vector3.js';\nimport { UniformsLib } from './UniformsLib.js';\nimport { Color } from '../../math/Color.js';\nimport { Matrix3 } from '../../math/Matrix3.js';\n\nconst ShaderLib = {\n\n\tbasic: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.specularmap,\n\t\t\tUniformsLib.envmap,\n\t\t\tUniformsLib.aomap,\n\t\t\tUniformsLib.lightmap,\n\t\t\tUniformsLib.fog\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshbasic_vert,\n\t\tfragmentShader: ShaderChunk.meshbasic_frag\n\n\t},\n\n\tlambert: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.specularmap,\n\t\t\tUniformsLib.envmap,\n\t\t\tUniformsLib.aomap,\n\t\t\tUniformsLib.lightmap,\n\t\t\tUniformsLib.emissivemap,\n\t\t\tUniformsLib.fog,\n\t\t\tUniformsLib.lights,\n\t\t\t{\n\t\t\t\temissive: { value: new Color( 0x000000 ) }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshlambert_vert,\n\t\tfragmentShader: ShaderChunk.meshlambert_frag\n\n\t},\n\n\tphong: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.specularmap,\n\t\t\tUniformsLib.envmap,\n\t\t\tUniformsLib.aomap,\n\t\t\tUniformsLib.lightmap,\n\t\t\tUniformsLib.emissivemap,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\tUniformsLib.fog,\n\t\t\tUniformsLib.lights,\n\t\t\t{\n\t\t\t\temissive: { value: new Color( 0x000000 ) },\n\t\t\t\tspecular: { value: new Color( 0x111111 ) },\n\t\t\t\tshininess: { value: 30 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshphong_vert,\n\t\tfragmentShader: ShaderChunk.meshphong_frag\n\n\t},\n\n\tstandard: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.envmap,\n\t\t\tUniformsLib.aomap,\n\t\t\tUniformsLib.lightmap,\n\t\t\tUniformsLib.emissivemap,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\tUniformsLib.roughnessmap,\n\t\t\tUniformsLib.metalnessmap,\n\t\t\tUniformsLib.fog,\n\t\t\tUniformsLib.lights,\n\t\t\t{\n\t\t\t\temissive: { value: new Color( 0x000000 ) },\n\t\t\t\troughness: { value: 1.0 },\n\t\t\t\tmetalness: { value: 0.0 },\n\t\t\t\tenvMapIntensity: { value: 1 } // temporary\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshphysical_vert,\n\t\tfragmentShader: ShaderChunk.meshphysical_frag\n\n\t},\n\n\ttoon: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.aomap,\n\t\t\tUniformsLib.lightmap,\n\t\t\tUniformsLib.emissivemap,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\tUniformsLib.gradientmap,\n\t\t\tUniformsLib.fog,\n\t\t\tUniformsLib.lights,\n\t\t\t{\n\t\t\t\temissive: { value: new Color( 0x000000 ) }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshtoon_vert,\n\t\tfragmentShader: ShaderChunk.meshtoon_frag\n\n\t},\n\n\tmatcap: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\tUniformsLib.fog,\n\t\t\t{\n\t\t\t\tmatcap: { value: null }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshmatcap_vert,\n\t\tfragmentShader: ShaderChunk.meshmatcap_frag\n\n\t},\n\n\tpoints: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.points,\n\t\t\tUniformsLib.fog\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.points_vert,\n\t\tfragmentShader: ShaderChunk.points_frag\n\n\t},\n\n\tdashed: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.fog,\n\t\t\t{\n\t\t\t\tscale: { value: 1 },\n\t\t\t\tdashSize: { value: 1 },\n\t\t\t\ttotalSize: { value: 2 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.linedashed_vert,\n\t\tfragmentShader: ShaderChunk.linedashed_frag\n\n\t},\n\n\tdepth: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.displacementmap\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.depth_vert,\n\t\tfragmentShader: ShaderChunk.depth_frag\n\n\t},\n\n\tnormal: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.bumpmap,\n\t\t\tUniformsLib.normalmap,\n\t\t\tUniformsLib.displacementmap,\n\t\t\t{\n\t\t\t\topacity: { value: 1.0 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.meshnormal_vert,\n\t\tfragmentShader: ShaderChunk.meshnormal_frag\n\n\t},\n\n\tsprite: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.sprite,\n\t\t\tUniformsLib.fog\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.sprite_vert,\n\t\tfragmentShader: ShaderChunk.sprite_frag\n\n\t},\n\n\tbackground: {\n\n\t\tuniforms: {\n\t\t\tuvTransform: { value: new Matrix3() },\n\t\t\tt2D: { value: null },\n\t\t},\n\n\t\tvertexShader: ShaderChunk.background_vert,\n\t\tfragmentShader: ShaderChunk.background_frag\n\n\t},\n\t/* -------------------------------------------------------------------------\n\t//\tCube map shader\n\t ------------------------------------------------------------------------- */\n\n\tcube: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.envmap,\n\t\t\t{\n\t\t\t\topacity: { value: 1.0 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.cube_vert,\n\t\tfragmentShader: ShaderChunk.cube_frag\n\n\t},\n\n\tequirect: {\n\n\t\tuniforms: {\n\t\t\ttEquirect: { value: null },\n\t\t},\n\n\t\tvertexShader: ShaderChunk.equirect_vert,\n\t\tfragmentShader: ShaderChunk.equirect_frag\n\n\t},\n\n\tdistanceRGBA: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.common,\n\t\t\tUniformsLib.displacementmap,\n\t\t\t{\n\t\t\t\treferencePosition: { value: new Vector3() },\n\t\t\t\tnearDistance: { value: 1 },\n\t\t\t\tfarDistance: { value: 1000 }\n\t\t\t}\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.distanceRGBA_vert,\n\t\tfragmentShader: ShaderChunk.distanceRGBA_frag\n\n\t},\n\n\tshadow: {\n\n\t\tuniforms: mergeUniforms( [\n\t\t\tUniformsLib.lights,\n\t\t\tUniformsLib.fog,\n\t\t\t{\n\t\t\t\tcolor: { value: new Color( 0x00000 ) },\n\t\t\t\topacity: { value: 1.0 }\n\t\t\t},\n\t\t] ),\n\n\t\tvertexShader: ShaderChunk.shadow_vert,\n\t\tfragmentShader: ShaderChunk.shadow_frag\n\n\t}\n\n};\n\nShaderLib.physical = {\n\n\tuniforms: mergeUniforms( [\n\t\tShaderLib.standard.uniforms,\n\t\t{\n\t\t\tclearcoat: { value: 0 },\n\t\t\tclearcoatMap: { value: null },\n\t\t\tclearcoatRoughness: { value: 0 },\n\t\t\tclearcoatRoughnessMap: { value: null },\n\t\t\tclearcoatNormalScale: { value: new Vector2( 1, 1 ) },\n\t\t\tclearcoatNormalMap: { value: null },\n\t\t\tsheen: { value: 0 },\n\t\t\tsheenColor: { value: new Color( 0x000000 ) },\n\t\t\tsheenColorMap: { value: null },\n\t\t\tsheenRoughness: { value: 0 },\n\t\t\tsheenRoughnessMap: { value: null },\n\t\t\ttransmission: { value: 0 },\n\t\t\ttransmissionMap: { value: null },\n\t\t\ttransmissionSamplerSize: { value: new Vector2() },\n\t\t\ttransmissionSamplerMap: { value: null },\n\t\t\tthickness: { value: 0 },\n\t\t\tthicknessMap: { value: null },\n\t\t\tattenuationDistance: { value: 0 },\n\t\t\tattenuationColor: { value: new Color( 0x000000 ) },\n\t\t\tspecularIntensity: { value: 0 },\n\t\t\tspecularIntensityMap: { value: null },\n\t\t\tspecularColor: { value: new Color( 1, 1, 1 ) },\n\t\t\tspecularColorMap: { value: null },\n\t\t}\n\t] ),\n\n\tvertexShader: ShaderChunk.meshphysical_vert,\n\tfragmentShader: ShaderChunk.meshphysical_frag\n\n};\n\n\nexport { ShaderLib };\n","import { BackSide, FrontSide, CubeUVReflectionMapping } from '../../constants.js';\nimport { BoxGeometry } from '../../geometries/BoxGeometry.js';\nimport { PlaneGeometry } from '../../geometries/PlaneGeometry.js';\nimport { ShaderMaterial } from '../../materials/ShaderMaterial.js';\nimport { Color } from '../../math/Color.js';\nimport { Mesh } from '../../objects/Mesh.js';\nimport { ShaderLib } from '../shaders/ShaderLib.js';\nimport { cloneUniforms } from '../shaders/UniformsUtils.js';\n\nfunction WebGLBackground( renderer, cubemaps, state, objects, premultipliedAlpha ) {\n\n\tconst clearColor = new Color( 0x000000 );\n\tlet clearAlpha = 0;\n\n\tlet planeMesh;\n\tlet boxMesh;\n\n\tlet currentBackground = null;\n\tlet currentBackgroundVersion = 0;\n\tlet currentTonemapping = null;\n\n\tfunction render( renderList, scene ) {\n\n\t\tlet forceClear = false;\n\t\tlet background = scene.isScene === true ? scene.background : null;\n\n\t\tif ( background && background.isTexture ) {\n\n\t\t\tbackground = cubemaps.get( background );\n\n\t\t}\n\n\t\t// Ignore background in AR\n\t\t// TODO: Reconsider this.\n\n\t\tconst xr = renderer.xr;\n\t\tconst session = xr.getSession && xr.getSession();\n\n\t\tif ( session && session.environmentBlendMode === 'additive' ) {\n\n\t\t\tbackground = null;\n\n\t\t}\n\n\t\tif ( background === null ) {\n\n\t\t\tsetClear( clearColor, clearAlpha );\n\n\t\t} else if ( background && background.isColor ) {\n\n\t\t\tsetClear( background, 1 );\n\t\t\tforceClear = true;\n\n\t\t}\n\n\t\tif ( renderer.autoClear || forceClear ) {\n\n\t\t\trenderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\n\n\t\t}\n\n\t\tif ( background && ( background.isCubeTexture || background.mapping === CubeUVReflectionMapping ) ) {\n\n\t\t\tif ( boxMesh === undefined ) {\n\n\t\t\t\tboxMesh = new Mesh(\n\t\t\t\t\tnew BoxGeometry( 1, 1, 1 ),\n\t\t\t\t\tnew ShaderMaterial( {\n\t\t\t\t\t\tname: 'BackgroundCubeMaterial',\n\t\t\t\t\t\tuniforms: cloneUniforms( ShaderLib.cube.uniforms ),\n\t\t\t\t\t\tvertexShader: ShaderLib.cube.vertexShader,\n\t\t\t\t\t\tfragmentShader: ShaderLib.cube.fragmentShader,\n\t\t\t\t\t\tside: BackSide,\n\t\t\t\t\t\tdepthTest: false,\n\t\t\t\t\t\tdepthWrite: false,\n\t\t\t\t\t\tfog: false\n\t\t\t\t\t} )\n\t\t\t\t);\n\n\t\t\t\tboxMesh.geometry.deleteAttribute( 'normal' );\n\t\t\t\tboxMesh.geometry.deleteAttribute( 'uv' );\n\n\t\t\t\tboxMesh.onBeforeRender = function ( renderer, scene, camera ) {\n\n\t\t\t\t\tthis.matrixWorld.copyPosition( camera.matrixWorld );\n\n\t\t\t\t};\n\n\t\t\t\t// enable code injection for non-built-in material\n\t\t\t\tObject.defineProperty( boxMesh.material, 'envMap', {\n\n\t\t\t\t\tget: function () {\n\n\t\t\t\t\t\treturn this.uniforms.envMap.value;\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\tobjects.update( boxMesh );\n\n\t\t\t}\n\n\t\t\tboxMesh.material.uniforms.envMap.value = background;\n\t\t\tboxMesh.material.uniforms.flipEnvMap.value = ( background.isCubeTexture && background.isRenderTargetTexture === false ) ? - 1 : 1;\n\n\t\t\tif ( currentBackground !== background ||\n\t\t\t\tcurrentBackgroundVersion !== background.version ||\n\t\t\t\tcurrentTonemapping !== renderer.toneMapping ) {\n\n\t\t\t\tboxMesh.material.needsUpdate = true;\n\n\t\t\t\tcurrentBackground = background;\n\t\t\t\tcurrentBackgroundVersion = background.version;\n\t\t\t\tcurrentTonemapping = renderer.toneMapping;\n\n\t\t\t}\n\n\t\t\t// push to the pre-sorted opaque render list\n\t\t\trenderList.unshift( boxMesh, boxMesh.geometry, boxMesh.material, 0, 0, null );\n\n\t\t} else if ( background && background.isTexture ) {\n\n\t\t\tif ( planeMesh === undefined ) {\n\n\t\t\t\tplaneMesh = new Mesh(\n\t\t\t\t\tnew PlaneGeometry( 2, 2 ),\n\t\t\t\t\tnew ShaderMaterial( {\n\t\t\t\t\t\tname: 'BackgroundMaterial',\n\t\t\t\t\t\tuniforms: cloneUniforms( ShaderLib.background.uniforms ),\n\t\t\t\t\t\tvertexShader: ShaderLib.background.vertexShader,\n\t\t\t\t\t\tfragmentShader: ShaderLib.background.fragmentShader,\n\t\t\t\t\t\tside: FrontSide,\n\t\t\t\t\t\tdepthTest: false,\n\t\t\t\t\t\tdepthWrite: false,\n\t\t\t\t\t\tfog: false\n\t\t\t\t\t} )\n\t\t\t\t);\n\n\t\t\t\tplaneMesh.geometry.deleteAttribute( 'normal' );\n\n\t\t\t\t// enable code injection for non-built-in material\n\t\t\t\tObject.defineProperty( planeMesh.material, 'map', {\n\n\t\t\t\t\tget: function () {\n\n\t\t\t\t\t\treturn this.uniforms.t2D.value;\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\tobjects.update( planeMesh );\n\n\t\t\t}\n\n\t\t\tplaneMesh.material.uniforms.t2D.value = background;\n\n\t\t\tif ( background.matrixAutoUpdate === true ) {\n\n\t\t\t\tbackground.updateMatrix();\n\n\t\t\t}\n\n\t\t\tplaneMesh.material.uniforms.uvTransform.value.copy( background.matrix );\n\n\t\t\tif ( currentBackground !== background ||\n\t\t\t\tcurrentBackgroundVersion !== background.version ||\n\t\t\t\tcurrentTonemapping !== renderer.toneMapping ) {\n\n\t\t\t\tplaneMesh.material.needsUpdate = true;\n\n\t\t\t\tcurrentBackground = background;\n\t\t\t\tcurrentBackgroundVersion = background.version;\n\t\t\t\tcurrentTonemapping = renderer.toneMapping;\n\n\t\t\t}\n\n\n\t\t\t// push to the pre-sorted opaque render list\n\t\t\trenderList.unshift( planeMesh, planeMesh.geometry, planeMesh.material, 0, 0, null );\n\n\t\t}\n\n\t}\n\n\tfunction setClear( color, alpha ) {\n\n\t\tstate.buffers.color.setClear( color.r, color.g, color.b, alpha, premultipliedAlpha );\n\n\t}\n\n\treturn {\n\n\t\tgetClearColor: function () {\n\n\t\t\treturn clearColor;\n\n\t\t},\n\t\tsetClearColor: function ( color, alpha = 1 ) {\n\n\t\t\tclearColor.set( color );\n\t\t\tclearAlpha = alpha;\n\t\t\tsetClear( clearColor, clearAlpha );\n\n\t\t},\n\t\tgetClearAlpha: function () {\n\n\t\t\treturn clearAlpha;\n\n\t\t},\n\t\tsetClearAlpha: function ( alpha ) {\n\n\t\t\tclearAlpha = alpha;\n\t\t\tsetClear( clearColor, clearAlpha );\n\n\t\t},\n\t\trender: render\n\n\t};\n\n}\n\n\nexport { WebGLBackground };\n","function WebGLBindingStates( gl, extensions, attributes, capabilities ) {\n\n\tconst maxVertexAttributes = gl.getParameter( gl.MAX_VERTEX_ATTRIBS );\n\n\tconst extension = capabilities.isWebGL2 ? null : extensions.get( 'OES_vertex_array_object' );\n\tconst vaoAvailable = capabilities.isWebGL2 || extension !== null;\n\n\tconst bindingStates = {};\n\n\tconst defaultState = createBindingState( null );\n\tlet currentState = defaultState;\n\n\tfunction setup( object, material, program, geometry, index ) {\n\n\t\tlet updateBuffers = false;\n\n\t\tif ( vaoAvailable ) {\n\n\t\t\tconst state = getBindingState( geometry, program, material );\n\n\t\t\tif ( currentState !== state ) {\n\n\t\t\t\tcurrentState = state;\n\t\t\t\tbindVertexArrayObject( currentState.object );\n\n\t\t\t}\n\n\t\t\tupdateBuffers = needsUpdate( geometry, index );\n\n\t\t\tif ( updateBuffers ) saveCache( geometry, index );\n\n\t\t} else {\n\n\t\t\tconst wireframe = ( material.wireframe === true );\n\n\t\t\tif ( currentState.geometry !== geometry.id ||\n\t\t\t\tcurrentState.program !== program.id ||\n\t\t\t\tcurrentState.wireframe !== wireframe ) {\n\n\t\t\t\tcurrentState.geometry = geometry.id;\n\t\t\t\tcurrentState.program = program.id;\n\t\t\t\tcurrentState.wireframe = wireframe;\n\n\t\t\t\tupdateBuffers = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( object.isInstancedMesh === true ) {\n\n\t\t\tupdateBuffers = true;\n\n\t\t}\n\n\t\tif ( index !== null ) {\n\n\t\t\tattributes.update( index, gl.ELEMENT_ARRAY_BUFFER );\n\n\t\t}\n\n\t\tif ( updateBuffers ) {\n\n\t\t\tsetupVertexAttributes( object, material, program, geometry );\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, attributes.get( index ).buffer );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction createVertexArrayObject() {\n\n\t\tif ( capabilities.isWebGL2 ) return gl.createVertexArray();\n\n\t\treturn extension.createVertexArrayOES();\n\n\t}\n\n\tfunction bindVertexArrayObject( vao ) {\n\n\t\tif ( capabilities.isWebGL2 ) return gl.bindVertexArray( vao );\n\n\t\treturn extension.bindVertexArrayOES( vao );\n\n\t}\n\n\tfunction deleteVertexArrayObject( vao ) {\n\n\t\tif ( capabilities.isWebGL2 ) return gl.deleteVertexArray( vao );\n\n\t\treturn extension.deleteVertexArrayOES( vao );\n\n\t}\n\n\tfunction getBindingState( geometry, program, material ) {\n\n\t\tconst wireframe = ( material.wireframe === true );\n\n\t\tlet programMap = bindingStates[ geometry.id ];\n\n\t\tif ( programMap === undefined ) {\n\n\t\t\tprogramMap = {};\n\t\t\tbindingStates[ geometry.id ] = programMap;\n\n\t\t}\n\n\t\tlet stateMap = programMap[ program.id ];\n\n\t\tif ( stateMap === undefined ) {\n\n\t\t\tstateMap = {};\n\t\t\tprogramMap[ program.id ] = stateMap;\n\n\t\t}\n\n\t\tlet state = stateMap[ wireframe ];\n\n\t\tif ( state === undefined ) {\n\n\t\t\tstate = createBindingState( createVertexArrayObject() );\n\t\t\tstateMap[ wireframe ] = state;\n\n\t\t}\n\n\t\treturn state;\n\n\t}\n\n\tfunction createBindingState( vao ) {\n\n\t\tconst newAttributes = [];\n\t\tconst enabledAttributes = [];\n\t\tconst attributeDivisors = [];\n\n\t\tfor ( let i = 0; i < maxVertexAttributes; i ++ ) {\n\n\t\t\tnewAttributes[ i ] = 0;\n\t\t\tenabledAttributes[ i ] = 0;\n\t\t\tattributeDivisors[ i ] = 0;\n\n\t\t}\n\n\t\treturn {\n\n\t\t\t// for backward compatibility on non-VAO support browser\n\t\t\tgeometry: null,\n\t\t\tprogram: null,\n\t\t\twireframe: false,\n\n\t\t\tnewAttributes: newAttributes,\n\t\t\tenabledAttributes: enabledAttributes,\n\t\t\tattributeDivisors: attributeDivisors,\n\t\t\tobject: vao,\n\t\t\tattributes: {},\n\t\t\tindex: null\n\n\t\t};\n\n\t}\n\n\tfunction needsUpdate( geometry, index ) {\n\n\t\tconst cachedAttributes = currentState.attributes;\n\t\tconst geometryAttributes = geometry.attributes;\n\n\t\tlet attributesNum = 0;\n\n\t\tfor ( const key in geometryAttributes ) {\n\n\t\t\tconst cachedAttribute = cachedAttributes[ key ];\n\t\t\tconst geometryAttribute = geometryAttributes[ key ];\n\n\t\t\tif ( cachedAttribute === undefined ) return true;\n\n\t\t\tif ( cachedAttribute.attribute !== geometryAttribute ) return true;\n\n\t\t\tif ( cachedAttribute.data !== geometryAttribute.data ) return true;\n\n\t\t\tattributesNum ++;\n\n\t\t}\n\n\t\tif ( currentState.attributesNum !== attributesNum ) return true;\n\n\t\tif ( currentState.index !== index ) return true;\n\n\t\treturn false;\n\n\t}\n\n\tfunction saveCache( geometry, index ) {\n\n\t\tconst cache = {};\n\t\tconst attributes = geometry.attributes;\n\t\tlet attributesNum = 0;\n\n\t\tfor ( const key in attributes ) {\n\n\t\t\tconst attribute = attributes[ key ];\n\n\t\t\tconst data = {};\n\t\t\tdata.attribute = attribute;\n\n\t\t\tif ( attribute.data ) {\n\n\t\t\t\tdata.data = attribute.data;\n\n\t\t\t}\n\n\t\t\tcache[ key ] = data;\n\n\t\t\tattributesNum ++;\n\n\t\t}\n\n\t\tcurrentState.attributes = cache;\n\t\tcurrentState.attributesNum = attributesNum;\n\n\t\tcurrentState.index = index;\n\n\t}\n\n\tfunction initAttributes() {\n\n\t\tconst newAttributes = currentState.newAttributes;\n\n\t\tfor ( let i = 0, il = newAttributes.length; i < il; i ++ ) {\n\n\t\t\tnewAttributes[ i ] = 0;\n\n\t\t}\n\n\t}\n\n\tfunction enableAttribute( attribute ) {\n\n\t\tenableAttributeAndDivisor( attribute, 0 );\n\n\t}\n\n\tfunction enableAttributeAndDivisor( attribute, meshPerAttribute ) {\n\n\t\tconst newAttributes = currentState.newAttributes;\n\t\tconst enabledAttributes = currentState.enabledAttributes;\n\t\tconst attributeDivisors = currentState.attributeDivisors;\n\n\t\tnewAttributes[ attribute ] = 1;\n\n\t\tif ( enabledAttributes[ attribute ] === 0 ) {\n\n\t\t\tgl.enableVertexAttribArray( attribute );\n\t\t\tenabledAttributes[ attribute ] = 1;\n\n\t\t}\n\n\t\tif ( attributeDivisors[ attribute ] !== meshPerAttribute ) {\n\n\t\t\tconst extension = capabilities.isWebGL2 ? gl : extensions.get( 'ANGLE_instanced_arrays' );\n\n\t\t\textension[ capabilities.isWebGL2 ? 'vertexAttribDivisor' : 'vertexAttribDivisorANGLE' ]( attribute, meshPerAttribute );\n\t\t\tattributeDivisors[ attribute ] = meshPerAttribute;\n\n\t\t}\n\n\t}\n\n\tfunction disableUnusedAttributes() {\n\n\t\tconst newAttributes = currentState.newAttributes;\n\t\tconst enabledAttributes = currentState.enabledAttributes;\n\n\t\tfor ( let i = 0, il = enabledAttributes.length; i < il; i ++ ) {\n\n\t\t\tif ( enabledAttributes[ i ] !== newAttributes[ i ] ) {\n\n\t\t\t\tgl.disableVertexAttribArray( i );\n\t\t\t\tenabledAttributes[ i ] = 0;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction vertexAttribPointer( index, size, type, normalized, stride, offset ) {\n\n\t\tif ( capabilities.isWebGL2 === true && ( type === gl.INT || type === gl.UNSIGNED_INT ) ) {\n\n\t\t\tgl.vertexAttribIPointer( index, size, type, stride, offset );\n\n\t\t} else {\n\n\t\t\tgl.vertexAttribPointer( index, size, type, normalized, stride, offset );\n\n\t\t}\n\n\t}\n\n\tfunction setupVertexAttributes( object, material, program, geometry ) {\n\n\t\tif ( capabilities.isWebGL2 === false && ( object.isInstancedMesh || geometry.isInstancedBufferGeometry ) ) {\n\n\t\t\tif ( extensions.get( 'ANGLE_instanced_arrays' ) === null ) return;\n\n\t\t}\n\n\t\tinitAttributes();\n\n\t\tconst geometryAttributes = geometry.attributes;\n\n\t\tconst programAttributes = program.getAttributes();\n\n\t\tconst materialDefaultAttributeValues = material.defaultAttributeValues;\n\n\t\tfor ( const name in programAttributes ) {\n\n\t\t\tconst programAttribute = programAttributes[ name ];\n\n\t\t\tif ( programAttribute.location >= 0 ) {\n\n\t\t\t\tlet geometryAttribute = geometryAttributes[ name ];\n\n\t\t\t\tif ( geometryAttribute === undefined ) {\n\n\t\t\t\t\tif ( name === 'instanceMatrix' && object.instanceMatrix ) geometryAttribute = object.instanceMatrix;\n\t\t\t\t\tif ( name === 'instanceColor' && object.instanceColor ) geometryAttribute = object.instanceColor;\n\n\t\t\t\t}\n\n\t\t\t\tif ( geometryAttribute !== undefined ) {\n\n\t\t\t\t\tconst normalized = geometryAttribute.normalized;\n\t\t\t\t\tconst size = geometryAttribute.itemSize;\n\n\t\t\t\t\tconst attribute = attributes.get( geometryAttribute );\n\n\t\t\t\t\t// TODO Attribute may not be available on context restore\n\n\t\t\t\t\tif ( attribute === undefined ) continue;\n\n\t\t\t\t\tconst buffer = attribute.buffer;\n\t\t\t\t\tconst type = attribute.type;\n\t\t\t\t\tconst bytesPerElement = attribute.bytesPerElement;\n\n\t\t\t\t\tif ( geometryAttribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\t\t\tconst data = geometryAttribute.data;\n\t\t\t\t\t\tconst stride = data.stride;\n\t\t\t\t\t\tconst offset = geometryAttribute.offset;\n\n\t\t\t\t\t\tif ( data && data.isInstancedInterleavedBuffer ) {\n\n\t\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\t\tenableAttributeAndDivisor( programAttribute.location + i, data.meshPerAttribute );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( object.isInstancedMesh !== true && geometry._maxInstanceCount === undefined ) {\n\n\t\t\t\t\t\t\t\tgeometry._maxInstanceCount = data.meshPerAttribute * data.count;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\t\tenableAttribute( programAttribute.location + i );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, buffer );\n\n\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\tvertexAttribPointer(\n\t\t\t\t\t\t\t\tprogramAttribute.location + i,\n\t\t\t\t\t\t\t\tsize / programAttribute.locationSize,\n\t\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\t\tnormalized,\n\t\t\t\t\t\t\t\tstride * bytesPerElement,\n\t\t\t\t\t\t\t\t( offset + ( size / programAttribute.locationSize ) * i ) * bytesPerElement\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( geometryAttribute.isInstancedBufferAttribute ) {\n\n\t\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\t\tenableAttributeAndDivisor( programAttribute.location + i, geometryAttribute.meshPerAttribute );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( object.isInstancedMesh !== true && geometry._maxInstanceCount === undefined ) {\n\n\t\t\t\t\t\t\t\tgeometry._maxInstanceCount = geometryAttribute.meshPerAttribute * geometryAttribute.count;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\t\tenableAttribute( programAttribute.location + i );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, buffer );\n\n\t\t\t\t\t\tfor ( let i = 0; i < programAttribute.locationSize; i ++ ) {\n\n\t\t\t\t\t\t\tvertexAttribPointer(\n\t\t\t\t\t\t\t\tprogramAttribute.location + i,\n\t\t\t\t\t\t\t\tsize / programAttribute.locationSize,\n\t\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\t\tnormalized,\n\t\t\t\t\t\t\t\tsize * bytesPerElement,\n\t\t\t\t\t\t\t\t( size / programAttribute.locationSize ) * i * bytesPerElement\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( materialDefaultAttributeValues !== undefined ) {\n\n\t\t\t\t\tconst value = materialDefaultAttributeValues[ name ];\n\n\t\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\t\tswitch ( value.length ) {\n\n\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\t\tgl.vertexAttrib2fv( programAttribute.location, value );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\t\tgl.vertexAttrib3fv( programAttribute.location, value );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\t\tgl.vertexAttrib4fv( programAttribute.location, value );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tgl.vertexAttrib1fv( programAttribute.location, value );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tdisableUnusedAttributes();\n\n\t}\n\n\tfunction dispose() {\n\n\t\treset();\n\n\t\tfor ( const geometryId in bindingStates ) {\n\n\t\t\tconst programMap = bindingStates[ geometryId ];\n\n\t\t\tfor ( const programId in programMap ) {\n\n\t\t\t\tconst stateMap = programMap[ programId ];\n\n\t\t\t\tfor ( const wireframe in stateMap ) {\n\n\t\t\t\t\tdeleteVertexArrayObject( stateMap[ wireframe ].object );\n\n\t\t\t\t\tdelete stateMap[ wireframe ];\n\n\t\t\t\t}\n\n\t\t\t\tdelete programMap[ programId ];\n\n\t\t\t}\n\n\t\t\tdelete bindingStates[ geometryId ];\n\n\t\t}\n\n\t}\n\n\tfunction releaseStatesOfGeometry( geometry ) {\n\n\t\tif ( bindingStates[ geometry.id ] === undefined ) return;\n\n\t\tconst programMap = bindingStates[ geometry.id ];\n\n\t\tfor ( const programId in programMap ) {\n\n\t\t\tconst stateMap = programMap[ programId ];\n\n\t\t\tfor ( const wireframe in stateMap ) {\n\n\t\t\t\tdeleteVertexArrayObject( stateMap[ wireframe ].object );\n\n\t\t\t\tdelete stateMap[ wireframe ];\n\n\t\t\t}\n\n\t\t\tdelete programMap[ programId ];\n\n\t\t}\n\n\t\tdelete bindingStates[ geometry.id ];\n\n\t}\n\n\tfunction releaseStatesOfProgram( program ) {\n\n\t\tfor ( const geometryId in bindingStates ) {\n\n\t\t\tconst programMap = bindingStates[ geometryId ];\n\n\t\t\tif ( programMap[ program.id ] === undefined ) continue;\n\n\t\t\tconst stateMap = programMap[ program.id ];\n\n\t\t\tfor ( const wireframe in stateMap ) {\n\n\t\t\t\tdeleteVertexArrayObject( stateMap[ wireframe ].object );\n\n\t\t\t\tdelete stateMap[ wireframe ];\n\n\t\t\t}\n\n\t\t\tdelete programMap[ program.id ];\n\n\t\t}\n\n\t}\n\n\tfunction reset() {\n\n\t\tresetDefaultState();\n\n\t\tif ( currentState === defaultState ) return;\n\n\t\tcurrentState = defaultState;\n\t\tbindVertexArrayObject( currentState.object );\n\n\t}\n\n\t// for backward-compatilibity\n\n\tfunction resetDefaultState() {\n\n\t\tdefaultState.geometry = null;\n\t\tdefaultState.program = null;\n\t\tdefaultState.wireframe = false;\n\n\t}\n\n\treturn {\n\n\t\tsetup: setup,\n\t\treset: reset,\n\t\tresetDefaultState: resetDefaultState,\n\t\tdispose: dispose,\n\t\treleaseStatesOfGeometry: releaseStatesOfGeometry,\n\t\treleaseStatesOfProgram: releaseStatesOfProgram,\n\n\t\tinitAttributes: initAttributes,\n\t\tenableAttribute: enableAttribute,\n\t\tdisableUnusedAttributes: disableUnusedAttributes\n\n\t};\n\n}\n\n\nexport { WebGLBindingStates };\n","function WebGLBufferRenderer( gl, extensions, info, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tlet mode;\n\n\tfunction setMode( value ) {\n\n\t\tmode = value;\n\n\t}\n\n\tfunction render( start, count ) {\n\n\t\tgl.drawArrays( mode, start, count );\n\n\t\tinfo.update( count, mode, 1 );\n\n\t}\n\n\tfunction renderInstances( start, count, primcount ) {\n\n\t\tif ( primcount === 0 ) return;\n\n\t\tlet extension, methodName;\n\n\t\tif ( isWebGL2 ) {\n\n\t\t\textension = gl;\n\t\t\tmethodName = 'drawArraysInstanced';\n\n\t\t} else {\n\n\t\t\textension = extensions.get( 'ANGLE_instanced_arrays' );\n\t\t\tmethodName = 'drawArraysInstancedANGLE';\n\n\t\t\tif ( extension === null ) {\n\n\t\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\textension[ methodName ]( mode, start, count, primcount );\n\n\t\tinfo.update( count, mode, primcount );\n\n\t}\n\n\t//\n\n\tthis.setMode = setMode;\n\tthis.render = render;\n\tthis.renderInstances = renderInstances;\n\n}\n\n\nexport { WebGLBufferRenderer };\n","function WebGLCapabilities( gl, extensions, parameters ) {\n\n\tlet maxAnisotropy;\n\n\tfunction getMaxAnisotropy() {\n\n\t\tif ( maxAnisotropy !== undefined ) return maxAnisotropy;\n\n\t\tif ( extensions.has( 'EXT_texture_filter_anisotropic' ) === true ) {\n\n\t\t\tconst extension = extensions.get( 'EXT_texture_filter_anisotropic' );\n\n\t\t\tmaxAnisotropy = gl.getParameter( extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT );\n\n\t\t} else {\n\n\t\t\tmaxAnisotropy = 0;\n\n\t\t}\n\n\t\treturn maxAnisotropy;\n\n\t}\n\n\tfunction getMaxPrecision( precision ) {\n\n\t\tif ( precision === 'highp' ) {\n\n\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.HIGH_FLOAT ).precision > 0 &&\n\t\t\t\tgl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.HIGH_FLOAT ).precision > 0 ) {\n\n\t\t\t\treturn 'highp';\n\n\t\t\t}\n\n\t\t\tprecision = 'mediump';\n\n\t\t}\n\n\t\tif ( precision === 'mediump' ) {\n\n\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.MEDIUM_FLOAT ).precision > 0 &&\n\t\t\t\tgl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.MEDIUM_FLOAT ).precision > 0 ) {\n\n\t\t\t\treturn 'mediump';\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn 'lowp';\n\n\t}\n\n\t/* eslint-disable no-undef */\n\tconst isWebGL2 = ( typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext ) ||\n\t\t( typeof WebGL2ComputeRenderingContext !== 'undefined' && gl instanceof WebGL2ComputeRenderingContext );\n\t/* eslint-enable no-undef */\n\n\tlet precision = parameters.precision !== undefined ? parameters.precision : 'highp';\n\tconst maxPrecision = getMaxPrecision( precision );\n\n\tif ( maxPrecision !== precision ) {\n\n\t\tconsole.warn( 'THREE.WebGLRenderer:', precision, 'not supported, using', maxPrecision, 'instead.' );\n\t\tprecision = maxPrecision;\n\n\t}\n\n\tconst drawBuffers = isWebGL2 || extensions.has( 'WEBGL_draw_buffers' );\n\n\tconst logarithmicDepthBuffer = parameters.logarithmicDepthBuffer === true;\n\n\tconst maxTextures = gl.getParameter( gl.MAX_TEXTURE_IMAGE_UNITS );\n\tconst maxVertexTextures = gl.getParameter( gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS );\n\tconst maxTextureSize = gl.getParameter( gl.MAX_TEXTURE_SIZE );\n\tconst maxCubemapSize = gl.getParameter( gl.MAX_CUBE_MAP_TEXTURE_SIZE );\n\n\tconst maxAttributes = gl.getParameter( gl.MAX_VERTEX_ATTRIBS );\n\tconst maxVertexUniforms = gl.getParameter( gl.MAX_VERTEX_UNIFORM_VECTORS );\n\tconst maxVaryings = gl.getParameter( gl.MAX_VARYING_VECTORS );\n\tconst maxFragmentUniforms = gl.getParameter( gl.MAX_FRAGMENT_UNIFORM_VECTORS );\n\n\tconst vertexTextures = maxVertexTextures > 0;\n\tconst floatFragmentTextures = isWebGL2 || extensions.has( 'OES_texture_float' );\n\tconst floatVertexTextures = vertexTextures && floatFragmentTextures;\n\n\tconst maxSamples = isWebGL2 ? gl.getParameter( gl.MAX_SAMPLES ) : 0;\n\n\treturn {\n\n\t\tisWebGL2: isWebGL2,\n\n\t\tdrawBuffers: drawBuffers,\n\n\t\tgetMaxAnisotropy: getMaxAnisotropy,\n\t\tgetMaxPrecision: getMaxPrecision,\n\n\t\tprecision: precision,\n\t\tlogarithmicDepthBuffer: logarithmicDepthBuffer,\n\n\t\tmaxTextures: maxTextures,\n\t\tmaxVertexTextures: maxVertexTextures,\n\t\tmaxTextureSize: maxTextureSize,\n\t\tmaxCubemapSize: maxCubemapSize,\n\n\t\tmaxAttributes: maxAttributes,\n\t\tmaxVertexUniforms: maxVertexUniforms,\n\t\tmaxVaryings: maxVaryings,\n\t\tmaxFragmentUniforms: maxFragmentUniforms,\n\n\t\tvertexTextures: vertexTextures,\n\t\tfloatFragmentTextures: floatFragmentTextures,\n\t\tfloatVertexTextures: floatVertexTextures,\n\n\t\tmaxSamples: maxSamples\n\n\t};\n\n}\n\n\nexport { WebGLCapabilities };\n","import { Matrix3 } from '../../math/Matrix3.js';\nimport { Plane } from '../../math/Plane.js';\n\nfunction WebGLClipping( properties ) {\n\n\tconst scope = this;\n\n\tlet globalState = null,\n\t\tnumGlobalPlanes = 0,\n\t\tlocalClippingEnabled = false,\n\t\trenderingShadows = false;\n\n\tconst plane = new Plane(),\n\t\tviewNormalMatrix = new Matrix3(),\n\n\t\tuniform = { value: null, needsUpdate: false };\n\n\tthis.uniform = uniform;\n\tthis.numPlanes = 0;\n\tthis.numIntersection = 0;\n\n\tthis.init = function ( planes, enableLocalClipping, camera ) {\n\n\t\tconst enabled =\n\t\t\tplanes.length !== 0 ||\n\t\t\tenableLocalClipping ||\n\t\t\t// enable state of previous frame - the clipping code has to\n\t\t\t// run another frame in order to reset the state:\n\t\t\tnumGlobalPlanes !== 0 ||\n\t\t\tlocalClippingEnabled;\n\n\t\tlocalClippingEnabled = enableLocalClipping;\n\n\t\tglobalState = projectPlanes( planes, camera, 0 );\n\t\tnumGlobalPlanes = planes.length;\n\n\t\treturn enabled;\n\n\t};\n\n\tthis.beginShadows = function () {\n\n\t\trenderingShadows = true;\n\t\tprojectPlanes( null );\n\n\t};\n\n\tthis.endShadows = function () {\n\n\t\trenderingShadows = false;\n\t\tresetGlobalState();\n\n\t};\n\n\tthis.setState = function ( material, camera, useCache ) {\n\n\t\tconst planes = material.clippingPlanes,\n\t\t\tclipIntersection = material.clipIntersection,\n\t\t\tclipShadows = material.clipShadows;\n\n\t\tconst materialProperties = properties.get( material );\n\n\t\tif ( ! localClippingEnabled || planes === null || planes.length === 0 || renderingShadows && ! clipShadows ) {\n\n\t\t\t// there's no local clipping\n\n\t\t\tif ( renderingShadows ) {\n\n\t\t\t\t// there's no global clipping\n\n\t\t\t\tprojectPlanes( null );\n\n\t\t\t} else {\n\n\t\t\t\tresetGlobalState();\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst nGlobal = renderingShadows ? 0 : numGlobalPlanes,\n\t\t\t\tlGlobal = nGlobal * 4;\n\n\t\t\tlet dstArray = materialProperties.clippingState || null;\n\n\t\t\tuniform.value = dstArray; // ensure unique state\n\n\t\t\tdstArray = projectPlanes( planes, camera, lGlobal, useCache );\n\n\t\t\tfor ( let i = 0; i !== lGlobal; ++ i ) {\n\n\t\t\t\tdstArray[ i ] = globalState[ i ];\n\n\t\t\t}\n\n\t\t\tmaterialProperties.clippingState = dstArray;\n\t\t\tthis.numIntersection = clipIntersection ? this.numPlanes : 0;\n\t\t\tthis.numPlanes += nGlobal;\n\n\t\t}\n\n\n\t};\n\n\tfunction resetGlobalState() {\n\n\t\tif ( uniform.value !== globalState ) {\n\n\t\t\tuniform.value = globalState;\n\t\t\tuniform.needsUpdate = numGlobalPlanes > 0;\n\n\t\t}\n\n\t\tscope.numPlanes = numGlobalPlanes;\n\t\tscope.numIntersection = 0;\n\n\t}\n\n\tfunction projectPlanes( planes, camera, dstOffset, skipTransform ) {\n\n\t\tconst nPlanes = planes !== null ? planes.length : 0;\n\t\tlet dstArray = null;\n\n\t\tif ( nPlanes !== 0 ) {\n\n\t\t\tdstArray = uniform.value;\n\n\t\t\tif ( skipTransform !== true || dstArray === null ) {\n\n\t\t\t\tconst flatSize = dstOffset + nPlanes * 4,\n\t\t\t\t\tviewMatrix = camera.matrixWorldInverse;\n\n\t\t\t\tviewNormalMatrix.getNormalMatrix( viewMatrix );\n\n\t\t\t\tif ( dstArray === null || dstArray.length < flatSize ) {\n\n\t\t\t\t\tdstArray = new Float32Array( flatSize );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0, i4 = dstOffset; i !== nPlanes; ++ i, i4 += 4 ) {\n\n\t\t\t\t\tplane.copy( planes[ i ] ).applyMatrix4( viewMatrix, viewNormalMatrix );\n\n\t\t\t\t\tplane.normal.toArray( dstArray, i4 );\n\t\t\t\t\tdstArray[ i4 + 3 ] = plane.constant;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tuniform.value = dstArray;\n\t\t\tuniform.needsUpdate = true;\n\n\t\t}\n\n\t\tscope.numPlanes = nPlanes;\n\t\tscope.numIntersection = 0;\n\n\t\treturn dstArray;\n\n\t}\n\n}\n\n\nexport { WebGLClipping };\n","import { EventDispatcher } from '../core/EventDispatcher.js';\nimport { Texture } from '../textures/Texture.js';\nimport { LinearFilter } from '../constants.js';\nimport { Vector4 } from '../math/Vector4.js';\n\n/*\n In options, we can specify:\n * Texture parameters for an auto-generated target texture\n * depthBuffer/stencilBuffer: Booleans to indicate if we should generate these buffers\n*/\nclass WebGLRenderTarget extends EventDispatcher {\n\n\tconstructor( width, height, options = {} ) {\n\n\t\tsuper();\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.depth = 1;\n\n\t\tthis.scissor = new Vector4( 0, 0, width, height );\n\t\tthis.scissorTest = false;\n\n\t\tthis.viewport = new Vector4( 0, 0, width, height );\n\n\t\tthis.texture = new Texture( undefined, options.mapping, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy, options.encoding );\n\t\tthis.texture.isRenderTargetTexture = true;\n\n\t\tthis.texture.image = { width: width, height: height, depth: 1 };\n\n\t\tthis.texture.generateMipmaps = options.generateMipmaps !== undefined ? options.generateMipmaps : false;\n\t\tthis.texture.internalFormat = options.internalFormat !== undefined ? options.internalFormat : null;\n\t\tthis.texture.minFilter = options.minFilter !== undefined ? options.minFilter : LinearFilter;\n\n\t\tthis.depthBuffer = options.depthBuffer !== undefined ? options.depthBuffer : true;\n\t\tthis.stencilBuffer = options.stencilBuffer !== undefined ? options.stencilBuffer : false;\n\t\tthis.depthTexture = options.depthTexture !== undefined ? options.depthTexture : null;\n\n\t}\n\n\tsetTexture( texture ) {\n\n\t\ttexture.image = {\n\t\t\twidth: this.width,\n\t\t\theight: this.height,\n\t\t\tdepth: this.depth\n\t\t};\n\n\t\tthis.texture = texture;\n\n\t}\n\n\tsetSize( width, height, depth = 1 ) {\n\n\t\tif ( this.width !== width || this.height !== height || this.depth !== depth ) {\n\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\t\t\tthis.depth = depth;\n\n\t\t\tthis.texture.image.width = width;\n\t\t\tthis.texture.image.height = height;\n\t\t\tthis.texture.image.depth = depth;\n\n\t\t\tthis.dispose();\n\n\t\t}\n\n\t\tthis.viewport.set( 0, 0, width, height );\n\t\tthis.scissor.set( 0, 0, width, height );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.width = source.width;\n\t\tthis.height = source.height;\n\t\tthis.depth = source.depth;\n\n\t\tthis.viewport.copy( source.viewport );\n\n\t\tthis.texture = source.texture.clone();\n\t\tthis.texture.image = { ...this.texture.image }; // See #20328.\n\n\t\tthis.depthBuffer = source.depthBuffer;\n\t\tthis.stencilBuffer = source.stencilBuffer;\n\t\tthis.depthTexture = source.depthTexture;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n}\n\nWebGLRenderTarget.prototype.isWebGLRenderTarget = true;\n\nexport { WebGLRenderTarget };\n","import { Matrix4 } from '../math/Matrix4.js';\nimport { Object3D } from '../core/Object3D.js';\n\nclass Camera extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'Camera';\n\n\t\tthis.matrixWorldInverse = new Matrix4();\n\n\t\tthis.projectionMatrix = new Matrix4();\n\t\tthis.projectionMatrixInverse = new Matrix4();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.matrixWorldInverse.copy( source.matrixWorldInverse );\n\n\t\tthis.projectionMatrix.copy( source.projectionMatrix );\n\t\tthis.projectionMatrixInverse.copy( source.projectionMatrixInverse );\n\n\t\treturn this;\n\n\t}\n\n\tgetWorldDirection( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tconst e = this.matrixWorld.elements;\n\n\t\treturn target.set( - e[ 8 ], - e[ 9 ], - e[ 10 ] ).normalize();\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tthis.matrixWorldInverse.copy( this.matrixWorld ).invert();\n\n\t}\n\n\tupdateWorldMatrix( updateParents, updateChildren ) {\n\n\t\tsuper.updateWorldMatrix( updateParents, updateChildren );\n\n\t\tthis.matrixWorldInverse.copy( this.matrixWorld ).invert();\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nCamera.prototype.isCamera = true;\n\nexport { Camera };\n","import { Camera } from './Camera.js';\nimport * as MathUtils from '../math/MathUtils.js';\n\nclass PerspectiveCamera extends Camera {\n\n\tconstructor( fov = 50, aspect = 1, near = 0.1, far = 2000 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'PerspectiveCamera';\n\n\t\tthis.fov = fov;\n\t\tthis.zoom = 1;\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\t\tthis.focus = 10;\n\n\t\tthis.aspect = aspect;\n\t\tthis.view = null;\n\n\t\tthis.filmGauge = 35;\t// width of the film (default in millimeters)\n\t\tthis.filmOffset = 0;\t// horizontal film offset (same unit as gauge)\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.fov = source.fov;\n\t\tthis.zoom = source.zoom;\n\n\t\tthis.near = source.near;\n\t\tthis.far = source.far;\n\t\tthis.focus = source.focus;\n\n\t\tthis.aspect = source.aspect;\n\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\n\t\tthis.filmGauge = source.filmGauge;\n\t\tthis.filmOffset = source.filmOffset;\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Sets the FOV by focal length in respect to the current .filmGauge.\n\t *\n\t * The default film gauge is 35, so that the focal length can be specified for\n\t * a 35mm (full frame) camera.\n\t *\n\t * Values for focal length and film gauge must have the same unit.\n\t */\n\tsetFocalLength( focalLength ) {\n\n\t\t/** see {@link http://www.bobatkins.com/photography/technical/field_of_view.html} */\n\t\tconst vExtentSlope = 0.5 * this.getFilmHeight() / focalLength;\n\n\t\tthis.fov = MathUtils.RAD2DEG * 2 * Math.atan( vExtentSlope );\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\t/**\n\t * Calculates the focal length from the current .fov and .filmGauge.\n\t */\n\tgetFocalLength() {\n\n\t\tconst vExtentSlope = Math.tan( MathUtils.DEG2RAD * 0.5 * this.fov );\n\n\t\treturn 0.5 * this.getFilmHeight() / vExtentSlope;\n\n\t}\n\n\tgetEffectiveFOV() {\n\n\t\treturn MathUtils.RAD2DEG * 2 * Math.atan(\n\t\t\tMath.tan( MathUtils.DEG2RAD * 0.5 * this.fov ) / this.zoom );\n\n\t}\n\n\tgetFilmWidth() {\n\n\t\t// film not completely covered in portrait format (aspect < 1)\n\t\treturn this.filmGauge * Math.min( this.aspect, 1 );\n\n\t}\n\n\tgetFilmHeight() {\n\n\t\t// film not completely covered in landscape format (aspect > 1)\n\t\treturn this.filmGauge / Math.max( this.aspect, 1 );\n\n\t}\n\n\t/**\n\t * Sets an offset in a larger frustum. This is useful for multi-window or\n\t * multi-monitor/multi-machine setups.\n\t *\n\t * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\n\t * the monitors are in grid like this\n\t *\n\t *   +---+---+---+\n\t *   | A | B | C |\n\t *   +---+---+---+\n\t *   | D | E | F |\n\t *   +---+---+---+\n\t *\n\t * then for each monitor you would call it like this\n\t *\n\t *   const w = 1920;\n\t *   const h = 1080;\n\t *   const fullWidth = w * 3;\n\t *   const fullHeight = h * 2;\n\t *\n\t *   --A--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\n\t *   --B--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\n\t *   --C--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\n\t *   --D--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\n\t *   --E--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\n\t *   --F--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\n\t *\n\t *   Note there is no reason monitors have to be the same size or in a grid.\n\t */\n\tsetViewOffset( fullWidth, fullHeight, x, y, width, height ) {\n\n\t\tthis.aspect = fullWidth / fullHeight;\n\n\t\tif ( this.view === null ) {\n\n\t\t\tthis.view = {\n\t\t\t\tenabled: true,\n\t\t\t\tfullWidth: 1,\n\t\t\t\tfullHeight: 1,\n\t\t\t\toffsetX: 0,\n\t\t\t\toffsetY: 0,\n\t\t\t\twidth: 1,\n\t\t\t\theight: 1\n\t\t\t};\n\n\t\t}\n\n\t\tthis.view.enabled = true;\n\t\tthis.view.fullWidth = fullWidth;\n\t\tthis.view.fullHeight = fullHeight;\n\t\tthis.view.offsetX = x;\n\t\tthis.view.offsetY = y;\n\t\tthis.view.width = width;\n\t\tthis.view.height = height;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tclearViewOffset() {\n\n\t\tif ( this.view !== null ) {\n\n\t\t\tthis.view.enabled = false;\n\n\t\t}\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tupdateProjectionMatrix() {\n\n\t\tconst near = this.near;\n\t\tlet top = near * Math.tan( MathUtils.DEG2RAD * 0.5 * this.fov ) / this.zoom;\n\t\tlet height = 2 * top;\n\t\tlet width = this.aspect * height;\n\t\tlet left = - 0.5 * width;\n\t\tconst view = this.view;\n\n\t\tif ( this.view !== null && this.view.enabled ) {\n\n\t\t\tconst fullWidth = view.fullWidth,\n\t\t\t\tfullHeight = view.fullHeight;\n\n\t\t\tleft += view.offsetX * width / fullWidth;\n\t\t\ttop -= view.offsetY * height / fullHeight;\n\t\t\twidth *= view.width / fullWidth;\n\t\t\theight *= view.height / fullHeight;\n\n\t\t}\n\n\t\tconst skew = this.filmOffset;\n\t\tif ( skew !== 0 ) left += near * skew / this.getFilmWidth();\n\n\t\tthis.projectionMatrix.makePerspective( left, left + width, top, top - height, near, this.far );\n\n\t\tthis.projectionMatrixInverse.copy( this.projectionMatrix ).invert();\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.fov = this.fov;\n\t\tdata.object.zoom = this.zoom;\n\n\t\tdata.object.near = this.near;\n\t\tdata.object.far = this.far;\n\t\tdata.object.focus = this.focus;\n\n\t\tdata.object.aspect = this.aspect;\n\n\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\n\n\t\tdata.object.filmGauge = this.filmGauge;\n\t\tdata.object.filmOffset = this.filmOffset;\n\n\t\treturn data;\n\n\t}\n\n}\n\nPerspectiveCamera.prototype.isPerspectiveCamera = true;\n\nexport { PerspectiveCamera };\n","import { Object3D } from '../core/Object3D.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { PerspectiveCamera } from './PerspectiveCamera.js';\n\nconst fov = 90, aspect = 1;\n\nclass CubeCamera extends Object3D {\n\n\tconstructor( near, far, renderTarget ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CubeCamera';\n\n\t\tif ( renderTarget.isWebGLCubeRenderTarget !== true ) {\n\n\t\t\tconsole.error( 'THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.renderTarget = renderTarget;\n\n\t\tconst cameraPX = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPX.layers = this.layers;\n\t\tcameraPX.up.set( 0, - 1, 0 );\n\t\tcameraPX.lookAt( new Vector3( 1, 0, 0 ) );\n\t\tthis.add( cameraPX );\n\n\t\tconst cameraNX = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNX.layers = this.layers;\n\t\tcameraNX.up.set( 0, - 1, 0 );\n\t\tcameraNX.lookAt( new Vector3( - 1, 0, 0 ) );\n\t\tthis.add( cameraNX );\n\n\t\tconst cameraPY = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPY.layers = this.layers;\n\t\tcameraPY.up.set( 0, 0, 1 );\n\t\tcameraPY.lookAt( new Vector3( 0, 1, 0 ) );\n\t\tthis.add( cameraPY );\n\n\t\tconst cameraNY = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNY.layers = this.layers;\n\t\tcameraNY.up.set( 0, 0, - 1 );\n\t\tcameraNY.lookAt( new Vector3( 0, - 1, 0 ) );\n\t\tthis.add( cameraNY );\n\n\t\tconst cameraPZ = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPZ.layers = this.layers;\n\t\tcameraPZ.up.set( 0, - 1, 0 );\n\t\tcameraPZ.lookAt( new Vector3( 0, 0, 1 ) );\n\t\tthis.add( cameraPZ );\n\n\t\tconst cameraNZ = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNZ.layers = this.layers;\n\t\tcameraNZ.up.set( 0, - 1, 0 );\n\t\tcameraNZ.lookAt( new Vector3( 0, 0, - 1 ) );\n\t\tthis.add( cameraNZ );\n\n\t}\n\n\tupdate( renderer, scene ) {\n\n\t\tif ( this.parent === null ) this.updateMatrixWorld();\n\n\t\tconst renderTarget = this.renderTarget;\n\n\t\tconst [ cameraPX, cameraNX, cameraPY, cameraNY, cameraPZ, cameraNZ ] = this.children;\n\n\t\tconst currentXrEnabled = renderer.xr.enabled;\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\trenderer.xr.enabled = false;\n\n\t\tconst generateMipmaps = renderTarget.texture.generateMipmaps;\n\n\t\trenderTarget.texture.generateMipmaps = false;\n\n\t\trenderer.setRenderTarget( renderTarget, 0 );\n\t\trenderer.render( scene, cameraPX );\n\n\t\trenderer.setRenderTarget( renderTarget, 1 );\n\t\trenderer.render( scene, cameraNX );\n\n\t\trenderer.setRenderTarget( renderTarget, 2 );\n\t\trenderer.render( scene, cameraPY );\n\n\t\trenderer.setRenderTarget( renderTarget, 3 );\n\t\trenderer.render( scene, cameraNY );\n\n\t\trenderer.setRenderTarget( renderTarget, 4 );\n\t\trenderer.render( scene, cameraPZ );\n\n\t\trenderTarget.texture.generateMipmaps = generateMipmaps;\n\n\t\trenderer.setRenderTarget( renderTarget, 5 );\n\t\trenderer.render( scene, cameraNZ );\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t\trenderer.xr.enabled = currentXrEnabled;\n\n\t}\n\n}\n\nexport { CubeCamera };\n","import { Texture } from './Texture.js';\nimport { CubeReflectionMapping } from '../constants.js';\n\nclass CubeTexture extends Texture {\n\n\tconstructor( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding ) {\n\n\t\timages = images !== undefined ? images : [];\n\t\tmapping = mapping !== undefined ? mapping : CubeReflectionMapping;\n\n\t\tsuper( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\n\n\t\tthis.flipY = false;\n\n\t}\n\n\tget images() {\n\n\t\treturn this.image;\n\n\t}\n\n\tset images( value ) {\n\n\t\tthis.image = value;\n\n\t}\n\n}\n\nCubeTexture.prototype.isCubeTexture = true;\n\nexport { CubeTexture };\n","import { BackSide, LinearFilter, LinearMipmapLinearFilter, NoBlending, RGBAFormat } from '../constants.js';\nimport { Mesh } from '../objects/Mesh.js';\nimport { BoxGeometry } from '../geometries/BoxGeometry.js';\nimport { ShaderMaterial } from '../materials/ShaderMaterial.js';\nimport { cloneUniforms } from './shaders/UniformsUtils.js';\nimport { WebGLRenderTarget } from './WebGLRenderTarget.js';\nimport { CubeCamera } from '../cameras/CubeCamera.js';\nimport { CubeTexture } from '../textures/CubeTexture.js';\n\nclass WebGLCubeRenderTarget extends WebGLRenderTarget {\n\n\tconstructor( size, options, dummy ) {\n\n\t\tif ( Number.isInteger( options ) ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )' );\n\n\t\t\toptions = dummy;\n\n\t\t}\n\n\t\tsuper( size, size, options );\n\n\t\toptions = options || {};\n\n\t\t// By convention -- likely based on the RenderMan spec from the 1990's -- cube maps are specified by WebGL (and three.js)\n\t\t// in a coordinate system in which positive-x is to the right when looking up the positive-z axis -- in other words,\n\t\t// in a left-handed coordinate system. By continuing this convention, preexisting cube maps continued to render correctly.\n\n\t\t// three.js uses a right-handed coordinate system. So environment maps used in three.js appear to have px and nx swapped\n\t\t// and the flag isRenderTargetTexture controls this conversion. The flip is not required when using WebGLCubeRenderTarget.texture\n\t\t// as a cube texture (this is detected when isRenderTargetTexture is set to true for cube textures).\n\n\t\tthis.texture = new CubeTexture( undefined, options.mapping, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy, options.encoding );\n\t\tthis.texture.isRenderTargetTexture = true;\n\n\t\tthis.texture.generateMipmaps = options.generateMipmaps !== undefined ? options.generateMipmaps : false;\n\t\tthis.texture.minFilter = options.minFilter !== undefined ? options.minFilter : LinearFilter;\n\n\t\tthis.texture._needsFlipEnvMap = false;\n\n\t}\n\n\tfromEquirectangularTexture( renderer, texture ) {\n\n\t\tthis.texture.type = texture.type;\n\t\tthis.texture.format = RGBAFormat; // see #18859\n\t\tthis.texture.encoding = texture.encoding;\n\n\t\tthis.texture.generateMipmaps = texture.generateMipmaps;\n\t\tthis.texture.minFilter = texture.minFilter;\n\t\tthis.texture.magFilter = texture.magFilter;\n\n\t\tconst shader = {\n\n\t\t\tuniforms: {\n\t\t\t\ttEquirect: { value: null },\n\t\t\t},\n\n\t\t\tvertexShader: /* glsl */`\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t`,\n\n\t\t\tfragmentShader: /* glsl */`\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t`\n\t\t};\n\n\t\tconst geometry = new BoxGeometry( 5, 5, 5 );\n\n\t\tconst material = new ShaderMaterial( {\n\n\t\t\tname: 'CubemapFromEquirect',\n\n\t\t\tuniforms: cloneUniforms( shader.uniforms ),\n\t\t\tvertexShader: shader.vertexShader,\n\t\t\tfragmentShader: shader.fragmentShader,\n\t\t\tside: BackSide,\n\t\t\tblending: NoBlending\n\n\t\t} );\n\n\t\tmaterial.uniforms.tEquirect.value = texture;\n\n\t\tconst mesh = new Mesh( geometry, material );\n\n\t\tconst currentMinFilter = texture.minFilter;\n\n\t\t// Avoid blurred poles\n\t\tif ( texture.minFilter === LinearMipmapLinearFilter ) texture.minFilter = LinearFilter;\n\n\t\tconst camera = new CubeCamera( 1, 10, this );\n\t\tcamera.update( renderer, mesh );\n\n\t\ttexture.minFilter = currentMinFilter;\n\n\t\tmesh.geometry.dispose();\n\t\tmesh.material.dispose();\n\n\t\treturn this;\n\n\t}\n\n\tclear( renderer, color, depth, stencil ) {\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\trenderer.setRenderTarget( this, i );\n\n\t\t\trenderer.clear( color, depth, stencil );\n\n\t\t}\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t}\n\n}\n\nWebGLCubeRenderTarget.prototype.isWebGLCubeRenderTarget = true;\n\nexport { WebGLCubeRenderTarget };\n","import { CubeReflectionMapping, CubeRefractionMapping, EquirectangularReflectionMapping, EquirectangularRefractionMapping } from '../../constants.js';\nimport { WebGLCubeRenderTarget } from '../WebGLCubeRenderTarget.js';\n\nfunction WebGLCubeMaps( renderer ) {\n\n\tlet cubemaps = new WeakMap();\n\n\tfunction mapTextureMapping( texture, mapping ) {\n\n\t\tif ( mapping === EquirectangularReflectionMapping ) {\n\n\t\t\ttexture.mapping = CubeReflectionMapping;\n\n\t\t} else if ( mapping === EquirectangularRefractionMapping ) {\n\n\t\t\ttexture.mapping = CubeRefractionMapping;\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tfunction get( texture ) {\n\n\t\tif ( texture && texture.isTexture && texture.isRenderTargetTexture === false ) {\n\n\t\t\tconst mapping = texture.mapping;\n\n\t\t\tif ( mapping === EquirectangularReflectionMapping || mapping === EquirectangularRefractionMapping ) {\n\n\t\t\t\tif ( cubemaps.has( texture ) ) {\n\n\t\t\t\t\tconst cubemap = cubemaps.get( texture ).texture;\n\t\t\t\t\treturn mapTextureMapping( cubemap, texture.mapping );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst image = texture.image;\n\n\t\t\t\t\tif ( image && image.height > 0 ) {\n\n\t\t\t\t\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\t\t\t\t\tconst renderTarget = new WebGLCubeRenderTarget( image.height / 2 );\n\t\t\t\t\t\trenderTarget.fromEquirectangularTexture( renderer, texture );\n\t\t\t\t\t\tcubemaps.set( texture, renderTarget );\n\n\t\t\t\t\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t\t\t\t\treturn mapTextureMapping( renderTarget.texture, texture.mapping );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// image not yet ready. try the conversion next frame\n\n\t\t\t\t\t\treturn null;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tfunction onTextureDispose( event ) {\n\n\t\tconst texture = event.target;\n\n\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\n\n\t\tconst cubemap = cubemaps.get( texture );\n\n\t\tif ( cubemap !== undefined ) {\n\n\t\t\tcubemaps.delete( texture );\n\t\t\tcubemap.dispose();\n\n\t\t}\n\n\t}\n\n\tfunction dispose() {\n\n\t\tcubemaps = new WeakMap();\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tdispose: dispose\n\t};\n\n}\n\nexport { WebGLCubeMaps };\n","import { Camera } from './Camera.js';\n\nclass OrthographicCamera extends Camera {\n\n\tconstructor( left = - 1, right = 1, top = 1, bottom = - 1, near = 0.1, far = 2000 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'OrthographicCamera';\n\n\t\tthis.zoom = 1;\n\t\tthis.view = null;\n\n\t\tthis.left = left;\n\t\tthis.right = right;\n\t\tthis.top = top;\n\t\tthis.bottom = bottom;\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.left = source.left;\n\t\tthis.right = source.right;\n\t\tthis.top = source.top;\n\t\tthis.bottom = source.bottom;\n\t\tthis.near = source.near;\n\t\tthis.far = source.far;\n\n\t\tthis.zoom = source.zoom;\n\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\n\t\treturn this;\n\n\t}\n\n\tsetViewOffset( fullWidth, fullHeight, x, y, width, height ) {\n\n\t\tif ( this.view === null ) {\n\n\t\t\tthis.view = {\n\t\t\t\tenabled: true,\n\t\t\t\tfullWidth: 1,\n\t\t\t\tfullHeight: 1,\n\t\t\t\toffsetX: 0,\n\t\t\t\toffsetY: 0,\n\t\t\t\twidth: 1,\n\t\t\t\theight: 1\n\t\t\t};\n\n\t\t}\n\n\t\tthis.view.enabled = true;\n\t\tthis.view.fullWidth = fullWidth;\n\t\tthis.view.fullHeight = fullHeight;\n\t\tthis.view.offsetX = x;\n\t\tthis.view.offsetY = y;\n\t\tthis.view.width = width;\n\t\tthis.view.height = height;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tclearViewOffset() {\n\n\t\tif ( this.view !== null ) {\n\n\t\t\tthis.view.enabled = false;\n\n\t\t}\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tupdateProjectionMatrix() {\n\n\t\tconst dx = ( this.right - this.left ) / ( 2 * this.zoom );\n\t\tconst dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\n\t\tconst cx = ( this.right + this.left ) / 2;\n\t\tconst cy = ( this.top + this.bottom ) / 2;\n\n\t\tlet left = cx - dx;\n\t\tlet right = cx + dx;\n\t\tlet top = cy + dy;\n\t\tlet bottom = cy - dy;\n\n\t\tif ( this.view !== null && this.view.enabled ) {\n\n\t\t\tconst scaleW = ( this.right - this.left ) / this.view.fullWidth / this.zoom;\n\t\t\tconst scaleH = ( this.top - this.bottom ) / this.view.fullHeight / this.zoom;\n\n\t\t\tleft += scaleW * this.view.offsetX;\n\t\t\tright = left + scaleW * this.view.width;\n\t\t\ttop -= scaleH * this.view.offsetY;\n\t\t\tbottom = top - scaleH * this.view.height;\n\n\t\t}\n\n\t\tthis.projectionMatrix.makeOrthographic( left, right, top, bottom, this.near, this.far );\n\n\t\tthis.projectionMatrixInverse.copy( this.projectionMatrix ).invert();\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.zoom = this.zoom;\n\t\tdata.object.left = this.left;\n\t\tdata.object.right = this.right;\n\t\tdata.object.top = this.top;\n\t\tdata.object.bottom = this.bottom;\n\t\tdata.object.near = this.near;\n\t\tdata.object.far = this.far;\n\n\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\n\n\t\treturn data;\n\n\t}\n\n}\n\nOrthographicCamera.prototype.isOrthographicCamera = true;\n\nexport { OrthographicCamera };\n","import { ShaderMaterial } from './ShaderMaterial.js';\n\nclass RawShaderMaterial extends ShaderMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper( parameters );\n\n\t\tthis.type = 'RawShaderMaterial';\n\n\t}\n\n}\n\nRawShaderMaterial.prototype.isRawShaderMaterial = true;\n\nexport { RawShaderMaterial };\n","import {\n\tCubeReflectionMapping,\n\tCubeRefractionMapping,\n\tCubeUVReflectionMapping,\n\tGammaEncoding,\n\tLinearEncoding,\n\tNoToneMapping,\n\tNearestFilter,\n\tNoBlending,\n\tRGBDEncoding,\n\tRGBEEncoding,\n\tRGBEFormat,\n\tRGBAFormat,\n\tRGBM16Encoding,\n\tRGBM7Encoding,\n\tUnsignedByteType,\n\tsRGBEncoding\n} from '../constants.js';\n\nimport { BufferAttribute } from '../core/BufferAttribute.js';\nimport { BufferGeometry } from '../core/BufferGeometry.js';\nimport { Mesh } from '../objects/Mesh.js';\nimport { OrthographicCamera } from '../cameras/OrthographicCamera.js';\nimport { PerspectiveCamera } from '../cameras/PerspectiveCamera.js';\nimport { RawShaderMaterial } from '../materials/RawShaderMaterial.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Color } from '../math/Color.js';\nimport { WebGLRenderTarget } from '../renderers/WebGLRenderTarget.js';\nimport { MeshBasicMaterial } from '../materials/MeshBasicMaterial.js';\nimport { BoxGeometry } from '../geometries/BoxGeometry.js';\nimport { BackSide } from '../constants.js';\n\nconst LOD_MIN = 4;\nconst LOD_MAX = 8;\nconst SIZE_MAX = Math.pow( 2, LOD_MAX );\n\n// The standard deviations (radians) associated with the extra mips. These are\n// chosen to approximate a Trowbridge-Reitz distribution function times the\n// geometric shadowing function. These sigma values squared must match the\n// variance #defines in cube_uv_reflection_fragment.glsl.js.\nconst EXTRA_LOD_SIGMA = [ 0.125, 0.215, 0.35, 0.446, 0.526, 0.582 ];\n\nconst TOTAL_LODS = LOD_MAX - LOD_MIN + 1 + EXTRA_LOD_SIGMA.length;\n\n// The maximum length of the blur for loop. Smaller sigmas will use fewer\n// samples and exit early, but not recompile the shader.\nconst MAX_SAMPLES = 20;\n\nconst ENCODINGS = {\n\t[ LinearEncoding ]: 0,\n\t[ sRGBEncoding ]: 1,\n\t[ RGBEEncoding ]: 2,\n\t[ RGBM7Encoding ]: 3,\n\t[ RGBM16Encoding ]: 4,\n\t[ RGBDEncoding ]: 5,\n\t[ GammaEncoding ]: 6\n};\n\nconst _flatCamera = /*@__PURE__*/ new OrthographicCamera();\nconst { _lodPlanes, _sizeLods, _sigmas } = /*@__PURE__*/ _createPlanes();\nconst _clearColor = /*@__PURE__*/ new Color();\nlet _oldTarget = null;\n\n// Golden Ratio\nconst PHI = ( 1 + Math.sqrt( 5 ) ) / 2;\nconst INV_PHI = 1 / PHI;\n\n// Vertices of a dodecahedron (except the opposites, which represent the\n// same axis), used as axis directions evenly spread on a sphere.\nconst _axisDirections = [\n\t/*@__PURE__*/ new Vector3( 1, 1, 1 ),\n\t/*@__PURE__*/ new Vector3( - 1, 1, 1 ),\n\t/*@__PURE__*/ new Vector3( 1, 1, - 1 ),\n\t/*@__PURE__*/ new Vector3( - 1, 1, - 1 ),\n\t/*@__PURE__*/ new Vector3( 0, PHI, INV_PHI ),\n\t/*@__PURE__*/ new Vector3( 0, PHI, - INV_PHI ),\n\t/*@__PURE__*/ new Vector3( INV_PHI, 0, PHI ),\n\t/*@__PURE__*/ new Vector3( - INV_PHI, 0, PHI ),\n\t/*@__PURE__*/ new Vector3( PHI, INV_PHI, 0 ),\n\t/*@__PURE__*/ new Vector3( - PHI, INV_PHI, 0 ) ];\n\n/**\n * This class generates a Prefiltered, Mipmapped Radiance Environment Map\n * (PMREM) from a cubeMap environment texture. This allows different levels of\n * blur to be quickly accessed based on material roughness. It is packed into a\n * special CubeUV format that allows us to perform custom interpolation so that\n * we can support nonlinear formats such as RGBE. Unlike a traditional mipmap\n * chain, it only goes down to the LOD_MIN level (above), and then creates extra\n * even more filtered 'mips' at the same LOD_MIN resolution, associated with\n * higher roughness levels. In this way we maintain resolution to smoothly\n * interpolate diffuse lighting while limiting sampling computation.\n *\n * Paper: Fast, Accurate Image-Based Lighting\n * https://drive.google.com/file/d/15y8r_UpKlU9SvV4ILb0C3qCPecS8pvLz/view\n*/\n\nclass PMREMGenerator {\n\n\tconstructor( renderer ) {\n\n\t\tthis._renderer = renderer;\n\t\tthis._pingPongRenderTarget = null;\n\n\t\tthis._blurMaterial = _getBlurShader( MAX_SAMPLES );\n\t\tthis._equirectShader = null;\n\t\tthis._cubemapShader = null;\n\n\t\tthis._compileMaterial( this._blurMaterial );\n\n\t}\n\n\t/**\n\t * Generates a PMREM from a supplied Scene, which can be faster than using an\n\t * image if networking bandwidth is low. Optional sigma specifies a blur radius\n\t * in radians to be applied to the scene before PMREM generation. Optional near\n\t * and far planes ensure the scene is rendered in its entirety (the cubeCamera\n\t * is placed at the origin).\n\t */\n\tfromScene( scene, sigma = 0, near = 0.1, far = 100 ) {\n\n\t\t_oldTarget = this._renderer.getRenderTarget();\n\t\tconst cubeUVRenderTarget = this._allocateTargets();\n\n\t\tthis._sceneToCubeUV( scene, near, far, cubeUVRenderTarget );\n\t\tif ( sigma > 0 ) {\n\n\t\t\tthis._blur( cubeUVRenderTarget, 0, 0, sigma );\n\n\t\t}\n\n\t\tthis._applyPMREM( cubeUVRenderTarget );\n\t\tthis._cleanup( cubeUVRenderTarget );\n\n\t\treturn cubeUVRenderTarget;\n\n\t}\n\n\t/**\n\t * Generates a PMREM from an equirectangular texture, which can be either LDR\n\t * (RGBFormat) or HDR (RGBEFormat). The ideal input image size is 1k (1024 x 512),\n\t * as this matches best with the 256 x 256 cubemap output.\n\t */\n\tfromEquirectangular( equirectangular ) {\n\n\t\treturn this._fromTexture( equirectangular );\n\n\t}\n\n\t/**\n\t * Generates a PMREM from an cubemap texture, which can be either LDR\n\t * (RGBFormat) or HDR (RGBEFormat). The ideal input cube size is 256 x 256,\n\t * as this matches best with the 256 x 256 cubemap output.\n\t */\n\tfromCubemap( cubemap ) {\n\n\t\treturn this._fromTexture( cubemap );\n\n\t}\n\n\t/**\n\t * Pre-compiles the cubemap shader. You can get faster start-up by invoking this method during\n\t * your texture's network fetch for increased concurrency.\n\t */\n\tcompileCubemapShader() {\n\n\t\tif ( this._cubemapShader === null ) {\n\n\t\t\tthis._cubemapShader = _getCubemapShader();\n\t\t\tthis._compileMaterial( this._cubemapShader );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Pre-compiles the equirectangular shader. You can get faster start-up by invoking this method during\n\t * your texture's network fetch for increased concurrency.\n\t */\n\tcompileEquirectangularShader() {\n\n\t\tif ( this._equirectShader === null ) {\n\n\t\t\tthis._equirectShader = _getEquirectShader();\n\t\t\tthis._compileMaterial( this._equirectShader );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Disposes of the PMREMGenerator's internal memory. Note that PMREMGenerator is a static class,\n\t * so you should not need more than one PMREMGenerator object. If you do, calling dispose() on\n\t * one of them will cause any others to also become unusable.\n\t */\n\tdispose() {\n\n\t\tthis._blurMaterial.dispose();\n\n\t\tif ( this._cubemapShader !== null ) this._cubemapShader.dispose();\n\t\tif ( this._equirectShader !== null ) this._equirectShader.dispose();\n\n\t\tfor ( let i = 0; i < _lodPlanes.length; i ++ ) {\n\n\t\t\t_lodPlanes[ i ].dispose();\n\n\t\t}\n\n\t}\n\n\t// private interface\n\n\t_cleanup( outputTarget ) {\n\n\t\tthis._pingPongRenderTarget.dispose();\n\t\tthis._renderer.setRenderTarget( _oldTarget );\n\t\toutputTarget.scissorTest = false;\n\t\t_setViewport( outputTarget, 0, 0, outputTarget.width, outputTarget.height );\n\n\t}\n\n\t_fromTexture( texture ) {\n\n\t\t_oldTarget = this._renderer.getRenderTarget();\n\t\tconst cubeUVRenderTarget = this._allocateTargets( texture );\n\t\tthis._textureToCubeUV( texture, cubeUVRenderTarget );\n\t\tthis._applyPMREM( cubeUVRenderTarget );\n\t\tthis._cleanup( cubeUVRenderTarget );\n\n\t\treturn cubeUVRenderTarget;\n\n\t}\n\n\t_allocateTargets( texture ) { // warning: null texture is valid\n\n\t\tconst params = {\n\t\t\tmagFilter: NearestFilter,\n\t\t\tminFilter: NearestFilter,\n\t\t\tgenerateMipmaps: false,\n\t\t\ttype: UnsignedByteType,\n\t\t\tformat: RGBEFormat,\n\t\t\tencoding: _isLDR( texture ) ? texture.encoding : RGBEEncoding,\n\t\t\tdepthBuffer: false\n\t\t};\n\n\t\tconst cubeUVRenderTarget = _createRenderTarget( params );\n\t\tcubeUVRenderTarget.depthBuffer = texture ? false : true;\n\t\tthis._pingPongRenderTarget = _createRenderTarget( params );\n\t\treturn cubeUVRenderTarget;\n\n\t}\n\n\t_compileMaterial( material ) {\n\n\t\tconst tmpMesh = new Mesh( _lodPlanes[ 0 ], material );\n\t\tthis._renderer.compile( tmpMesh, _flatCamera );\n\n\t}\n\n\t_sceneToCubeUV( scene, near, far, cubeUVRenderTarget ) {\n\n\t\tconst fov = 90;\n\t\tconst aspect = 1;\n\t\tconst cubeCamera = new PerspectiveCamera( fov, aspect, near, far );\n\t\tconst upSign = [ 1, - 1, 1, 1, 1, 1 ];\n\t\tconst forwardSign = [ 1, 1, 1, - 1, - 1, - 1 ];\n\t\tconst renderer = this._renderer;\n\n\t\tconst originalAutoClear = renderer.autoClear;\n\t\tconst outputEncoding = renderer.outputEncoding;\n\t\tconst toneMapping = renderer.toneMapping;\n\t\trenderer.getClearColor( _clearColor );\n\n\t\trenderer.toneMapping = NoToneMapping;\n\t\trenderer.outputEncoding = LinearEncoding;\n\t\trenderer.autoClear = false;\n\n\t\tconst backgroundMaterial = new MeshBasicMaterial( {\n\t\t\tname: 'PMREM.Background',\n\t\t\tside: BackSide,\n\t\t\tdepthWrite: false,\n\t\t\tdepthTest: false,\n\t\t} );\n\n\t\tconst backgroundBox = new Mesh( new BoxGeometry(), backgroundMaterial );\n\n\t\tlet useSolidColor = false;\n\t\tconst background = scene.background;\n\n\t\tif ( background ) {\n\n\t\t\tif ( background.isColor ) {\n\n\t\t\t\tbackgroundMaterial.color.copy( background );\n\t\t\t\tscene.background = null;\n\t\t\t\tuseSolidColor = true;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tbackgroundMaterial.color.copy( _clearColor );\n\t\t\tuseSolidColor = true;\n\n\t\t}\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst col = i % 3;\n\t\t\tif ( col == 0 ) {\n\n\t\t\t\tcubeCamera.up.set( 0, upSign[ i ], 0 );\n\t\t\t\tcubeCamera.lookAt( forwardSign[ i ], 0, 0 );\n\n\t\t\t} else if ( col == 1 ) {\n\n\t\t\t\tcubeCamera.up.set( 0, 0, upSign[ i ] );\n\t\t\t\tcubeCamera.lookAt( 0, forwardSign[ i ], 0 );\n\n\t\t\t} else {\n\n\t\t\t\tcubeCamera.up.set( 0, upSign[ i ], 0 );\n\t\t\t\tcubeCamera.lookAt( 0, 0, forwardSign[ i ] );\n\n\t\t\t}\n\n\t\t\t_setViewport( cubeUVRenderTarget,\n\t\t\t\tcol * SIZE_MAX, i > 2 ? SIZE_MAX : 0, SIZE_MAX, SIZE_MAX );\n\t\t\trenderer.setRenderTarget( cubeUVRenderTarget );\n\n\t\t\tif ( useSolidColor ) {\n\n\t\t\t\trenderer.render( backgroundBox, cubeCamera );\n\n\t\t\t}\n\n\t\t\trenderer.render( scene, cubeCamera );\n\n\t\t}\n\n\t\tbackgroundBox.geometry.dispose();\n\t\tbackgroundBox.material.dispose();\n\n\t\trenderer.toneMapping = toneMapping;\n\t\trenderer.outputEncoding = outputEncoding;\n\t\trenderer.autoClear = originalAutoClear;\n\t\tscene.background = background;\n\n\t}\n\n\t_setEncoding( uniform, texture ) {\n\n\t\tif ( this._renderer.capabilities.isWebGL2 === true && texture.format === RGBAFormat && texture.type === UnsignedByteType && texture.encoding === sRGBEncoding ) {\n\n\t\t\tuniform.value = ENCODINGS[ LinearEncoding ];\n\n\t\t} else {\n\n\t\t\tuniform.value = ENCODINGS[ texture.encoding ];\n\n\t\t}\n\n\t}\n\n\t_textureToCubeUV( texture, cubeUVRenderTarget ) {\n\n\t\tconst renderer = this._renderer;\n\n\t\tconst isCubeTexture = ( texture.mapping === CubeReflectionMapping || texture.mapping === CubeRefractionMapping );\n\n\t\tif ( isCubeTexture ) {\n\n\t\t\tif ( this._cubemapShader == null ) {\n\n\t\t\t\tthis._cubemapShader = _getCubemapShader();\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( this._equirectShader == null ) {\n\n\t\t\t\tthis._equirectShader = _getEquirectShader();\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst material = isCubeTexture ? this._cubemapShader : this._equirectShader;\n\t\tconst mesh = new Mesh( _lodPlanes[ 0 ], material );\n\n\t\tconst uniforms = material.uniforms;\n\n\t\tuniforms[ 'envMap' ].value = texture;\n\n\t\tif ( ! isCubeTexture ) {\n\n\t\t\tuniforms[ 'texelSize' ].value.set( 1.0 / texture.image.width, 1.0 / texture.image.height );\n\n\t\t}\n\n\t\tthis._setEncoding( uniforms[ 'inputEncoding' ], texture );\n\t\tthis._setEncoding( uniforms[ 'outputEncoding' ], cubeUVRenderTarget.texture );\n\n\t\t_setViewport( cubeUVRenderTarget, 0, 0, 3 * SIZE_MAX, 2 * SIZE_MAX );\n\n\t\trenderer.setRenderTarget( cubeUVRenderTarget );\n\t\trenderer.render( mesh, _flatCamera );\n\n\t}\n\n\t_applyPMREM( cubeUVRenderTarget ) {\n\n\t\tconst renderer = this._renderer;\n\t\tconst autoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\tfor ( let i = 1; i < TOTAL_LODS; i ++ ) {\n\n\t\t\tconst sigma = Math.sqrt( _sigmas[ i ] * _sigmas[ i ] - _sigmas[ i - 1 ] * _sigmas[ i - 1 ] );\n\n\t\t\tconst poleAxis = _axisDirections[ ( i - 1 ) % _axisDirections.length ];\n\n\t\t\tthis._blur( cubeUVRenderTarget, i - 1, i, sigma, poleAxis );\n\n\t\t}\n\n\t\trenderer.autoClear = autoClear;\n\n\t}\n\n\t/**\n\t * This is a two-pass Gaussian blur for a cubemap. Normally this is done\n\t * vertically and horizontally, but this breaks down on a cube. Here we apply\n\t * the blur latitudinally (around the poles), and then longitudinally (towards\n\t * the poles) to approximate the orthogonally-separable blur. It is least\n\t * accurate at the poles, but still does a decent job.\n\t */\n\t_blur( cubeUVRenderTarget, lodIn, lodOut, sigma, poleAxis ) {\n\n\t\tconst pingPongRenderTarget = this._pingPongRenderTarget;\n\n\t\tthis._halfBlur(\n\t\t\tcubeUVRenderTarget,\n\t\t\tpingPongRenderTarget,\n\t\t\tlodIn,\n\t\t\tlodOut,\n\t\t\tsigma,\n\t\t\t'latitudinal',\n\t\t\tpoleAxis );\n\n\t\tthis._halfBlur(\n\t\t\tpingPongRenderTarget,\n\t\t\tcubeUVRenderTarget,\n\t\t\tlodOut,\n\t\t\tlodOut,\n\t\t\tsigma,\n\t\t\t'longitudinal',\n\t\t\tpoleAxis );\n\n\t}\n\n\t_halfBlur( targetIn, targetOut, lodIn, lodOut, sigmaRadians, direction, poleAxis ) {\n\n\t\tconst renderer = this._renderer;\n\t\tconst blurMaterial = this._blurMaterial;\n\n\t\tif ( direction !== 'latitudinal' && direction !== 'longitudinal' ) {\n\n\t\t\tconsole.error(\n\t\t\t\t'blur direction must be either latitudinal or longitudinal!' );\n\n\t\t}\n\n\t\t// Number of standard deviations at which to cut off the discrete approximation.\n\t\tconst STANDARD_DEVIATIONS = 3;\n\n\t\tconst blurMesh = new Mesh( _lodPlanes[ lodOut ], blurMaterial );\n\t\tconst blurUniforms = blurMaterial.uniforms;\n\n\t\tconst pixels = _sizeLods[ lodIn ] - 1;\n\t\tconst radiansPerPixel = isFinite( sigmaRadians ) ? Math.PI / ( 2 * pixels ) : 2 * Math.PI / ( 2 * MAX_SAMPLES - 1 );\n\t\tconst sigmaPixels = sigmaRadians / radiansPerPixel;\n\t\tconst samples = isFinite( sigmaRadians ) ? 1 + Math.floor( STANDARD_DEVIATIONS * sigmaPixels ) : MAX_SAMPLES;\n\n\t\tif ( samples > MAX_SAMPLES ) {\n\n\t\t\tconsole.warn( `sigmaRadians, ${\n\t\t\t\tsigmaRadians}, is too large and will clip, as it requested ${\n\t\t\t\tsamples} samples when the maximum is set to ${MAX_SAMPLES}` );\n\n\t\t}\n\n\t\tconst weights = [];\n\t\tlet sum = 0;\n\n\t\tfor ( let i = 0; i < MAX_SAMPLES; ++ i ) {\n\n\t\t\tconst x = i / sigmaPixels;\n\t\t\tconst weight = Math.exp( - x * x / 2 );\n\t\t\tweights.push( weight );\n\n\t\t\tif ( i == 0 ) {\n\n\t\t\t\tsum += weight;\n\n\t\t\t} else if ( i < samples ) {\n\n\t\t\t\tsum += 2 * weight;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( let i = 0; i < weights.length; i ++ ) {\n\n\t\t\tweights[ i ] = weights[ i ] / sum;\n\n\t\t}\n\n\t\tblurUniforms[ 'envMap' ].value = targetIn.texture;\n\t\tblurUniforms[ 'samples' ].value = samples;\n\t\tblurUniforms[ 'weights' ].value = weights;\n\t\tblurUniforms[ 'latitudinal' ].value = direction === 'latitudinal';\n\n\t\tif ( poleAxis ) {\n\n\t\t\tblurUniforms[ 'poleAxis' ].value = poleAxis;\n\n\t\t}\n\n\t\tblurUniforms[ 'dTheta' ].value = radiansPerPixel;\n\t\tblurUniforms[ 'mipInt' ].value = LOD_MAX - lodIn;\n\n\t\tthis._setEncoding( blurUniforms[ 'inputEncoding' ], targetIn.texture );\n\t\tthis._setEncoding( blurUniforms[ 'outputEncoding' ], targetIn.texture );\n\n\t\tconst outputSize = _sizeLods[ lodOut ];\n\t\tconst x = 3 * Math.max( 0, SIZE_MAX - 2 * outputSize );\n\t\tconst y = ( lodOut === 0 ? 0 : 2 * SIZE_MAX ) + 2 * outputSize * ( lodOut > LOD_MAX - LOD_MIN ? lodOut - LOD_MAX + LOD_MIN : 0 );\n\n\t\t_setViewport( targetOut, x, y, 3 * outputSize, 2 * outputSize );\n\t\trenderer.setRenderTarget( targetOut );\n\t\trenderer.render( blurMesh, _flatCamera );\n\n\t}\n\n}\n\nfunction _isLDR( texture ) {\n\n\tif ( texture === undefined || texture.type !== UnsignedByteType ) return false;\n\n\treturn texture.encoding === LinearEncoding || texture.encoding === sRGBEncoding || texture.encoding === GammaEncoding;\n\n}\n\nfunction _createPlanes() {\n\n\tconst _lodPlanes = [];\n\tconst _sizeLods = [];\n\tconst _sigmas = [];\n\n\tlet lod = LOD_MAX;\n\n\tfor ( let i = 0; i < TOTAL_LODS; i ++ ) {\n\n\t\tconst sizeLod = Math.pow( 2, lod );\n\t\t_sizeLods.push( sizeLod );\n\t\tlet sigma = 1.0 / sizeLod;\n\n\t\tif ( i > LOD_MAX - LOD_MIN ) {\n\n\t\t\tsigma = EXTRA_LOD_SIGMA[ i - LOD_MAX + LOD_MIN - 1 ];\n\n\t\t} else if ( i == 0 ) {\n\n\t\t\tsigma = 0;\n\n\t\t}\n\n\t\t_sigmas.push( sigma );\n\n\t\tconst texelSize = 1.0 / ( sizeLod - 1 );\n\t\tconst min = - texelSize / 2;\n\t\tconst max = 1 + texelSize / 2;\n\t\tconst uv1 = [ min, min, max, min, max, max, min, min, max, max, min, max ];\n\n\t\tconst cubeFaces = 6;\n\t\tconst vertices = 6;\n\t\tconst positionSize = 3;\n\t\tconst uvSize = 2;\n\t\tconst faceIndexSize = 1;\n\n\t\tconst position = new Float32Array( positionSize * vertices * cubeFaces );\n\t\tconst uv = new Float32Array( uvSize * vertices * cubeFaces );\n\t\tconst faceIndex = new Float32Array( faceIndexSize * vertices * cubeFaces );\n\n\t\tfor ( let face = 0; face < cubeFaces; face ++ ) {\n\n\t\t\tconst x = ( face % 3 ) * 2 / 3 - 1;\n\t\t\tconst y = face > 2 ? 0 : - 1;\n\t\t\tconst coordinates = [\n\t\t\t\tx, y, 0,\n\t\t\t\tx + 2 / 3, y, 0,\n\t\t\t\tx + 2 / 3, y + 1, 0,\n\t\t\t\tx, y, 0,\n\t\t\t\tx + 2 / 3, y + 1, 0,\n\t\t\t\tx, y + 1, 0\n\t\t\t];\n\t\t\tposition.set( coordinates, positionSize * vertices * face );\n\t\t\tuv.set( uv1, uvSize * vertices * face );\n\t\t\tconst fill = [ face, face, face, face, face, face ];\n\t\t\tfaceIndex.set( fill, faceIndexSize * vertices * face );\n\n\t\t}\n\n\t\tconst planes = new BufferGeometry();\n\t\tplanes.setAttribute( 'position', new BufferAttribute( position, positionSize ) );\n\t\tplanes.setAttribute( 'uv', new BufferAttribute( uv, uvSize ) );\n\t\tplanes.setAttribute( 'faceIndex', new BufferAttribute( faceIndex, faceIndexSize ) );\n\t\t_lodPlanes.push( planes );\n\n\t\tif ( lod > LOD_MIN ) {\n\n\t\t\tlod --;\n\n\t\t}\n\n\t}\n\n\treturn { _lodPlanes, _sizeLods, _sigmas };\n\n}\n\nfunction _createRenderTarget( params ) {\n\n\tconst cubeUVRenderTarget = new WebGLRenderTarget( 3 * SIZE_MAX, 3 * SIZE_MAX, params );\n\tcubeUVRenderTarget.texture.mapping = CubeUVReflectionMapping;\n\tcubeUVRenderTarget.texture.name = 'PMREM.cubeUv';\n\tcubeUVRenderTarget.scissorTest = true;\n\treturn cubeUVRenderTarget;\n\n}\n\nfunction _setViewport( target, x, y, width, height ) {\n\n\ttarget.viewport.set( x, y, width, height );\n\ttarget.scissor.set( x, y, width, height );\n\n}\n\nfunction _getBlurShader( maxSamples ) {\n\n\tconst weights = new Float32Array( maxSamples );\n\tconst poleAxis = new Vector3( 0, 1, 0 );\n\tconst shaderMaterial = new RawShaderMaterial( {\n\n\t\tname: 'SphericalGaussianBlur',\n\n\t\tdefines: { 'n': maxSamples },\n\n\t\tuniforms: {\n\t\t\t'envMap': { value: null },\n\t\t\t'samples': { value: 1 },\n\t\t\t'weights': { value: weights },\n\t\t\t'latitudinal': { value: false },\n\t\t\t'dTheta': { value: 0 },\n\t\t\t'mipInt': { value: 0 },\n\t\t\t'poleAxis': { value: poleAxis },\n\t\t\t'inputEncoding': { value: ENCODINGS[ LinearEncoding ] },\n\t\t\t'outputEncoding': { value: ENCODINGS[ LinearEncoding ] }\n\t\t},\n\n\t\tvertexShader: _getCommonVertexShader(),\n\n\t\tfragmentShader: /* glsl */`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t${ _getEncodings() }\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t`,\n\n\t\tblending: NoBlending,\n\t\tdepthTest: false,\n\t\tdepthWrite: false\n\n\t} );\n\n\treturn shaderMaterial;\n\n}\n\nfunction _getEquirectShader() {\n\n\tconst texelSize = new Vector2( 1, 1 );\n\tconst shaderMaterial = new RawShaderMaterial( {\n\n\t\tname: 'EquirectangularToCubeUV',\n\n\t\tuniforms: {\n\t\t\t'envMap': { value: null },\n\t\t\t'texelSize': { value: texelSize },\n\t\t\t'inputEncoding': { value: ENCODINGS[ LinearEncoding ] },\n\t\t\t'outputEncoding': { value: ENCODINGS[ LinearEncoding ] }\n\t\t},\n\n\t\tvertexShader: _getCommonVertexShader(),\n\n\t\tfragmentShader: /* glsl */`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t${ _getEncodings() }\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t`,\n\n\t\tblending: NoBlending,\n\t\tdepthTest: false,\n\t\tdepthWrite: false\n\n\t} );\n\n\treturn shaderMaterial;\n\n}\n\nfunction _getCubemapShader() {\n\n\tconst shaderMaterial = new RawShaderMaterial( {\n\n\t\tname: 'CubemapToCubeUV',\n\n\t\tuniforms: {\n\t\t\t'envMap': { value: null },\n\t\t\t'inputEncoding': { value: ENCODINGS[ LinearEncoding ] },\n\t\t\t'outputEncoding': { value: ENCODINGS[ LinearEncoding ] }\n\t\t},\n\n\t\tvertexShader: _getCommonVertexShader(),\n\n\t\tfragmentShader: /* glsl */`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t${ _getEncodings() }\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t`,\n\n\t\tblending: NoBlending,\n\t\tdepthTest: false,\n\t\tdepthWrite: false\n\n\t} );\n\n\treturn shaderMaterial;\n\n}\n\nfunction _getCommonVertexShader() {\n\n\treturn /* glsl */`\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t`;\n\n}\n\nfunction _getEncodings() {\n\n\treturn /* glsl */`\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t`;\n\n}\n\nexport { PMREMGenerator };\n","import { CubeReflectionMapping, CubeRefractionMapping, EquirectangularReflectionMapping, EquirectangularRefractionMapping } from '../../constants.js';\nimport { PMREMGenerator } from '../../extras/PMREMGenerator.js';\n\nfunction WebGLCubeUVMaps( renderer ) {\n\n\tlet cubeUVmaps = new WeakMap();\n\n\tlet pmremGenerator = null;\n\n\tfunction get( texture ) {\n\n\t\tif ( texture && texture.isTexture && texture.isRenderTargetTexture === false ) {\n\n\t\t\tconst mapping = texture.mapping;\n\n\t\t\tconst isEquirectMap = ( mapping === EquirectangularReflectionMapping || mapping === EquirectangularRefractionMapping );\n\t\t\tconst isCubeMap = ( mapping === CubeReflectionMapping || mapping === CubeRefractionMapping );\n\n\t\t\tif ( isEquirectMap || isCubeMap ) {\n\n\t\t\t\t// equirect/cube map to cubeUV conversion\n\n\t\t\t\tif ( cubeUVmaps.has( texture ) ) {\n\n\t\t\t\t\treturn cubeUVmaps.get( texture ).texture;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst image = texture.image;\n\n\t\t\t\t\tif ( ( isEquirectMap && image && image.height > 0 ) || ( isCubeMap && image && isCubeTextureComplete( image ) ) ) {\n\n\t\t\t\t\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\t\t\t\t\tif ( pmremGenerator === null ) pmremGenerator = new PMREMGenerator( renderer );\n\n\t\t\t\t\t\tconst renderTarget = isEquirectMap ? pmremGenerator.fromEquirectangular( texture ) : pmremGenerator.fromCubemap( texture );\n\t\t\t\t\t\tcubeUVmaps.set( texture, renderTarget );\n\n\t\t\t\t\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t\t\t\t\treturn renderTarget.texture;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// image not yet ready. try the conversion next frame\n\n\t\t\t\t\t\treturn null;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tfunction isCubeTextureComplete( image ) {\n\n\t\tlet count = 0;\n\t\tconst length = 6;\n\n\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\tif ( image[ i ] !== undefined ) count ++;\n\n\t\t}\n\n\t\treturn count === length;\n\n\n\t}\n\n\tfunction onTextureDispose( event ) {\n\n\t\tconst texture = event.target;\n\n\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\n\n\t\tconst cubemapUV = cubeUVmaps.get( texture );\n\n\t\tif ( cubemapUV !== undefined ) {\n\n\t\t\tcubeUVmaps.delete( texture );\n\t\t\tcubemapUV.dispose();\n\n\t\t}\n\n\t}\n\n\tfunction dispose() {\n\n\t\tcubeUVmaps = new WeakMap();\n\n\t\tif ( pmremGenerator !== null ) {\n\n\t\t\tpmremGenerator.dispose();\n\t\t\tpmremGenerator = null;\n\n\t\t}\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tdispose: dispose\n\t};\n\n}\n\nexport { WebGLCubeUVMaps };\n","function WebGLExtensions( gl ) {\n\n\tconst extensions = {};\n\n\tfunction getExtension( name ) {\n\n\t\tif ( extensions[ name ] !== undefined ) {\n\n\t\t\treturn extensions[ name ];\n\n\t\t}\n\n\t\tlet extension;\n\n\t\tswitch ( name ) {\n\n\t\t\tcase 'WEBGL_depth_texture':\n\t\t\t\textension = gl.getExtension( 'WEBGL_depth_texture' ) || gl.getExtension( 'MOZ_WEBGL_depth_texture' ) || gl.getExtension( 'WEBKIT_WEBGL_depth_texture' );\n\t\t\t\tbreak;\n\n\t\t\tcase 'EXT_texture_filter_anisotropic':\n\t\t\t\textension = gl.getExtension( 'EXT_texture_filter_anisotropic' ) || gl.getExtension( 'MOZ_EXT_texture_filter_anisotropic' ) || gl.getExtension( 'WEBKIT_EXT_texture_filter_anisotropic' );\n\t\t\t\tbreak;\n\n\t\t\tcase 'WEBGL_compressed_texture_s3tc':\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'MOZ_WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_s3tc' );\n\t\t\t\tbreak;\n\n\t\t\tcase 'WEBGL_compressed_texture_pvrtc':\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_pvrtc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_pvrtc' );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\textension = gl.getExtension( name );\n\n\t\t}\n\n\t\textensions[ name ] = extension;\n\n\t\treturn extension;\n\n\t}\n\n\treturn {\n\n\t\thas: function ( name ) {\n\n\t\t\treturn getExtension( name ) !== null;\n\n\t\t},\n\n\t\tinit: function ( capabilities ) {\n\n\t\t\tif ( capabilities.isWebGL2 ) {\n\n\t\t\t\tgetExtension( 'EXT_color_buffer_float' );\n\n\t\t\t} else {\n\n\t\t\t\tgetExtension( 'WEBGL_depth_texture' );\n\t\t\t\tgetExtension( 'OES_texture_float' );\n\t\t\t\tgetExtension( 'OES_texture_half_float' );\n\t\t\t\tgetExtension( 'OES_texture_half_float_linear' );\n\t\t\t\tgetExtension( 'OES_standard_derivatives' );\n\t\t\t\tgetExtension( 'OES_element_index_uint' );\n\t\t\t\tgetExtension( 'OES_vertex_array_object' );\n\t\t\t\tgetExtension( 'ANGLE_instanced_arrays' );\n\n\t\t\t}\n\n\t\t\tgetExtension( 'OES_texture_float_linear' );\n\t\t\tgetExtension( 'EXT_color_buffer_half_float' );\n\n\t\t},\n\n\t\tget: function ( name ) {\n\n\t\t\tconst extension = getExtension( name );\n\n\t\t\tif ( extension === null ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: ' + name + ' extension not supported.' );\n\n\t\t\t}\n\n\t\t\treturn extension;\n\n\t\t}\n\n\t};\n\n}\n\n\nexport { WebGLExtensions };\n","import { Uint16BufferAttribute, Uint32BufferAttribute } from '../../core/BufferAttribute.js';\nimport { arrayMax } from '../../utils.js';\n\nfunction WebGLGeometries( gl, attributes, info, bindingStates ) {\n\n\tconst geometries = {};\n\tconst wireframeAttributes = new WeakMap();\n\n\tfunction onGeometryDispose( event ) {\n\n\t\tconst geometry = event.target;\n\n\t\tif ( geometry.index !== null ) {\n\n\t\t\tattributes.remove( geometry.index );\n\n\t\t}\n\n\t\tfor ( const name in geometry.attributes ) {\n\n\t\t\tattributes.remove( geometry.attributes[ name ] );\n\n\t\t}\n\n\t\tgeometry.removeEventListener( 'dispose', onGeometryDispose );\n\n\t\tdelete geometries[ geometry.id ];\n\n\t\tconst attribute = wireframeAttributes.get( geometry );\n\n\t\tif ( attribute ) {\n\n\t\t\tattributes.remove( attribute );\n\t\t\twireframeAttributes.delete( geometry );\n\n\t\t}\n\n\t\tbindingStates.releaseStatesOfGeometry( geometry );\n\n\t\tif ( geometry.isInstancedBufferGeometry === true ) {\n\n\t\t\tdelete geometry._maxInstanceCount;\n\n\t\t}\n\n\t\t//\n\n\t\tinfo.memory.geometries --;\n\n\t}\n\n\tfunction get( object, geometry ) {\n\n\t\tif ( geometries[ geometry.id ] === true ) return geometry;\n\n\t\tgeometry.addEventListener( 'dispose', onGeometryDispose );\n\n\t\tgeometries[ geometry.id ] = true;\n\n\t\tinfo.memory.geometries ++;\n\n\t\treturn geometry;\n\n\t}\n\n\tfunction update( geometry ) {\n\n\t\tconst geometryAttributes = geometry.attributes;\n\n\t\t// Updating index buffer in VAO now. See WebGLBindingStates.\n\n\t\tfor ( const name in geometryAttributes ) {\n\n\t\t\tattributes.update( geometryAttributes[ name ], gl.ARRAY_BUFFER );\n\n\t\t}\n\n\t\t// morph targets\n\n\t\tconst morphAttributes = geometry.morphAttributes;\n\n\t\tfor ( const name in morphAttributes ) {\n\n\t\t\tconst array = morphAttributes[ name ];\n\n\t\t\tfor ( let i = 0, l = array.length; i < l; i ++ ) {\n\n\t\t\t\tattributes.update( array[ i ], gl.ARRAY_BUFFER );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction updateWireframeAttribute( geometry ) {\n\n\t\tconst indices = [];\n\n\t\tconst geometryIndex = geometry.index;\n\t\tconst geometryPosition = geometry.attributes.position;\n\t\tlet version = 0;\n\n\t\tif ( geometryIndex !== null ) {\n\n\t\t\tconst array = geometryIndex.array;\n\t\t\tversion = geometryIndex.version;\n\n\t\t\tfor ( let i = 0, l = array.length; i < l; i += 3 ) {\n\n\t\t\t\tconst a = array[ i + 0 ];\n\t\t\t\tconst b = array[ i + 1 ];\n\t\t\t\tconst c = array[ i + 2 ];\n\n\t\t\t\tindices.push( a, b, b, c, c, a );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst array = geometryPosition.array;\n\t\t\tversion = geometryPosition.version;\n\n\t\t\tfor ( let i = 0, l = ( array.length / 3 ) - 1; i < l; i += 3 ) {\n\n\t\t\t\tconst a = i + 0;\n\t\t\t\tconst b = i + 1;\n\t\t\t\tconst c = i + 2;\n\n\t\t\t\tindices.push( a, b, b, c, c, a );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst attribute = new ( arrayMax( indices ) > 65535 ? Uint32BufferAttribute : Uint16BufferAttribute )( indices, 1 );\n\t\tattribute.version = version;\n\n\t\t// Updating index buffer in VAO now. See WebGLBindingStates\n\n\t\t//\n\n\t\tconst previousAttribute = wireframeAttributes.get( geometry );\n\n\t\tif ( previousAttribute ) attributes.remove( previousAttribute );\n\n\t\t//\n\n\t\twireframeAttributes.set( geometry, attribute );\n\n\t}\n\n\tfunction getWireframeAttribute( geometry ) {\n\n\t\tconst currentAttribute = wireframeAttributes.get( geometry );\n\n\t\tif ( currentAttribute ) {\n\n\t\t\tconst geometryIndex = geometry.index;\n\n\t\t\tif ( geometryIndex !== null ) {\n\n\t\t\t\t// if the attribute is obsolete, create a new one\n\n\t\t\t\tif ( currentAttribute.version < geometryIndex.version ) {\n\n\t\t\t\t\tupdateWireframeAttribute( geometry );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tupdateWireframeAttribute( geometry );\n\n\t\t}\n\n\t\treturn wireframeAttributes.get( geometry );\n\n\t}\n\n\treturn {\n\n\t\tget: get,\n\t\tupdate: update,\n\n\t\tgetWireframeAttribute: getWireframeAttribute\n\n\t};\n\n}\n\n\nexport { WebGLGeometries };\n","function WebGLIndexedBufferRenderer( gl, extensions, info, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tlet mode;\n\n\tfunction setMode( value ) {\n\n\t\tmode = value;\n\n\t}\n\n\tlet type, bytesPerElement;\n\n\tfunction setIndex( value ) {\n\n\t\ttype = value.type;\n\t\tbytesPerElement = value.bytesPerElement;\n\n\t}\n\n\tfunction render( start, count ) {\n\n\t\tgl.drawElements( mode, count, type, start * bytesPerElement );\n\n\t\tinfo.update( count, mode, 1 );\n\n\t}\n\n\tfunction renderInstances( start, count, primcount ) {\n\n\t\tif ( primcount === 0 ) return;\n\n\t\tlet extension, methodName;\n\n\t\tif ( isWebGL2 ) {\n\n\t\t\textension = gl;\n\t\t\tmethodName = 'drawElementsInstanced';\n\n\t\t} else {\n\n\t\t\textension = extensions.get( 'ANGLE_instanced_arrays' );\n\t\t\tmethodName = 'drawElementsInstancedANGLE';\n\n\t\t\tif ( extension === null ) {\n\n\t\t\t\tconsole.error( 'THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\textension[ methodName ]( mode, count, type, start * bytesPerElement, primcount );\n\n\t\tinfo.update( count, mode, primcount );\n\n\t}\n\n\t//\n\n\tthis.setMode = setMode;\n\tthis.setIndex = setIndex;\n\tthis.render = render;\n\tthis.renderInstances = renderInstances;\n\n}\n\n\nexport { WebGLIndexedBufferRenderer };\n","function WebGLInfo( gl ) {\n\n\tconst memory = {\n\t\tgeometries: 0,\n\t\ttextures: 0\n\t};\n\n\tconst render = {\n\t\tframe: 0,\n\t\tcalls: 0,\n\t\ttriangles: 0,\n\t\tpoints: 0,\n\t\tlines: 0\n\t};\n\n\tfunction update( count, mode, instanceCount ) {\n\n\t\trender.calls ++;\n\n\t\tswitch ( mode ) {\n\n\t\t\tcase gl.TRIANGLES:\n\t\t\t\trender.triangles += instanceCount * ( count / 3 );\n\t\t\t\tbreak;\n\n\t\t\tcase gl.LINES:\n\t\t\t\trender.lines += instanceCount * ( count / 2 );\n\t\t\t\tbreak;\n\n\t\t\tcase gl.LINE_STRIP:\n\t\t\t\trender.lines += instanceCount * ( count - 1 );\n\t\t\t\tbreak;\n\n\t\t\tcase gl.LINE_LOOP:\n\t\t\t\trender.lines += instanceCount * count;\n\t\t\t\tbreak;\n\n\t\t\tcase gl.POINTS:\n\t\t\t\trender.points += instanceCount * count;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'THREE.WebGLInfo: Unknown draw mode:', mode );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction reset() {\n\n\t\trender.frame ++;\n\t\trender.calls = 0;\n\t\trender.triangles = 0;\n\t\trender.points = 0;\n\t\trender.lines = 0;\n\n\t}\n\n\treturn {\n\t\tmemory: memory,\n\t\trender: render,\n\t\tprograms: null,\n\t\tautoReset: true,\n\t\treset: reset,\n\t\tupdate: update\n\t};\n\n}\n\n\nexport { WebGLInfo };\n","import { Texture } from './Texture.js';\nimport { ClampToEdgeWrapping, NearestFilter } from '../constants.js';\n\nclass DataTexture2DArray extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, depth = 1 ) {\n\n\t\tsuper( null );\n\n\t\tthis.image = { data, width, height, depth };\n\n\t\tthis.magFilter = NearestFilter;\n\t\tthis.minFilter = NearestFilter;\n\n\t\tthis.wrapR = ClampToEdgeWrapping;\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t\tthis.needsUpdate = true;\n\n\t}\n\n}\n\nDataTexture2DArray.prototype.isDataTexture2DArray = true;\n\nexport { DataTexture2DArray };\n","import { FloatType, RGBAFormat } from '../../constants.js';\nimport { DataTexture2DArray } from '../../textures/DataTexture2DArray.js';\nimport { Vector3 } from '../../math/Vector3.js';\nimport { Vector2 } from '../../math/Vector2.js';\n\nfunction numericalSort( a, b ) {\n\n\treturn a[ 0 ] - b[ 0 ];\n\n}\n\nfunction absNumericalSort( a, b ) {\n\n\treturn Math.abs( b[ 1 ] ) - Math.abs( a[ 1 ] );\n\n}\n\nfunction denormalize( morph, attribute ) {\n\n\tlet denominator = 1;\n\tconst array = attribute.isInterleavedBufferAttribute ? attribute.data.array : attribute.array;\n\n\tif ( array instanceof Int8Array ) denominator = 127;\n\telse if ( array instanceof Int16Array ) denominator = 32767;\n\telse if ( array instanceof Int32Array ) denominator = 2147483647;\n\telse console.error( 'THREE.WebGLMorphtargets: Unsupported morph attribute data type: ', array );\n\n\tmorph.divideScalar( denominator );\n\n}\n\nfunction WebGLMorphtargets( gl, capabilities, textures ) {\n\n\tconst influencesList = {};\n\tconst morphInfluences = new Float32Array( 8 );\n\tconst morphTextures = new WeakMap();\n\tconst morph = new Vector3();\n\n\tconst workInfluences = [];\n\n\tfor ( let i = 0; i < 8; i ++ ) {\n\n\t\tworkInfluences[ i ] = [ i, 0 ];\n\n\t}\n\n\tfunction update( object, geometry, material, program ) {\n\n\t\tconst objectInfluences = object.morphTargetInfluences;\n\n\t\tif ( capabilities.isWebGL2 === true ) {\n\n\t\t\t// instead of using attributes, the WebGL 2 code path encodes morph targets\n\t\t\t// into an array of data textures. Each layer represents a single morph target.\n\n\t\t\tconst numberOfMorphTargets = geometry.morphAttributes.position.length;\n\n\t\t\tlet entry = morphTextures.get( geometry );\n\n\t\t\tif ( entry === undefined || entry.count !== numberOfMorphTargets ) {\n\n\t\t\t\tif ( entry !== undefined ) entry.texture.dispose();\n\n\t\t\t\tconst hasMorphNormals = geometry.morphAttributes.normal !== undefined;\n\n\t\t\t\tconst morphTargets = geometry.morphAttributes.position;\n\t\t\t\tconst morphNormals = geometry.morphAttributes.normal || [];\n\n\t\t\t\tconst numberOfVertices = geometry.attributes.position.count;\n\t\t\t\tconst numberOfVertexData = ( hasMorphNormals === true ) ? 2 : 1; // (v,n) vs. (v)\n\n\t\t\t\tlet width = numberOfVertices * numberOfVertexData;\n\t\t\t\tlet height = 1;\n\n\t\t\t\tif ( width > capabilities.maxTextureSize ) {\n\n\t\t\t\t\theight = Math.ceil( width / capabilities.maxTextureSize );\n\t\t\t\t\twidth = capabilities.maxTextureSize;\n\n\t\t\t\t}\n\n\t\t\t\tconst buffer = new Float32Array( width * height * 4 * numberOfMorphTargets );\n\n\t\t\t\tconst texture = new DataTexture2DArray( buffer, width, height, numberOfMorphTargets );\n\t\t\t\ttexture.format = RGBAFormat; // using RGBA since RGB might be emulated (and is thus slower)\n\t\t\t\ttexture.type = FloatType;\n\n\t\t\t\t// fill buffer\n\n\t\t\t\tconst vertexDataStride = numberOfVertexData * 4;\n\n\t\t\t\tfor ( let i = 0; i < numberOfMorphTargets; i ++ ) {\n\n\t\t\t\t\tconst morphTarget = morphTargets[ i ];\n\t\t\t\t\tconst morphNormal = morphNormals[ i ];\n\n\t\t\t\t\tconst offset = width * height * 4 * i;\n\n\t\t\t\t\tfor ( let j = 0; j < morphTarget.count; j ++ ) {\n\n\t\t\t\t\t\tmorph.fromBufferAttribute( morphTarget, j );\n\n\t\t\t\t\t\tif ( morphTarget.normalized === true ) denormalize( morph, morphTarget );\n\n\t\t\t\t\t\tconst stride = j * vertexDataStride;\n\n\t\t\t\t\t\tbuffer[ offset + stride + 0 ] = morph.x;\n\t\t\t\t\t\tbuffer[ offset + stride + 1 ] = morph.y;\n\t\t\t\t\t\tbuffer[ offset + stride + 2 ] = morph.z;\n\t\t\t\t\t\tbuffer[ offset + stride + 3 ] = 0;\n\n\t\t\t\t\t\tif ( hasMorphNormals === true ) {\n\n\t\t\t\t\t\t\tmorph.fromBufferAttribute( morphNormal, j );\n\n\t\t\t\t\t\t\tif ( morphNormal.normalized === true ) denormalize( morph, morphNormal );\n\n\t\t\t\t\t\t\tbuffer[ offset + stride + 4 ] = morph.x;\n\t\t\t\t\t\t\tbuffer[ offset + stride + 5 ] = morph.y;\n\t\t\t\t\t\t\tbuffer[ offset + stride + 6 ] = morph.z;\n\t\t\t\t\t\t\tbuffer[ offset + stride + 7 ] = 0;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tentry = {\n\t\t\t\t\tcount: numberOfMorphTargets,\n\t\t\t\t\ttexture: texture,\n\t\t\t\t\tsize: new Vector2( width, height )\n\t\t\t\t};\n\n\t\t\t\tmorphTextures.set( geometry, entry );\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tlet morphInfluencesSum = 0;\n\n\t\t\tfor ( let i = 0; i < objectInfluences.length; i ++ ) {\n\n\t\t\t\tmorphInfluencesSum += objectInfluences[ i ];\n\n\t\t\t}\n\n\t\t\tconst morphBaseInfluence = geometry.morphTargetsRelative ? 1 : 1 - morphInfluencesSum;\n\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetBaseInfluence', morphBaseInfluence );\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetInfluences', objectInfluences );\n\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetsTexture', entry.texture, textures );\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetsTextureSize', entry.size );\n\n\n\t\t} else {\n\n\t\t\t// When object doesn't have morph target influences defined, we treat it as a 0-length array\n\t\t\t// This is important to make sure we set up morphTargetBaseInfluence / morphTargetInfluences\n\n\t\t\tconst length = objectInfluences === undefined ? 0 : objectInfluences.length;\n\n\t\t\tlet influences = influencesList[ geometry.id ];\n\n\t\t\tif ( influences === undefined || influences.length !== length ) {\n\n\t\t\t\t// initialise list\n\n\t\t\t\tinfluences = [];\n\n\t\t\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\t\t\tinfluences[ i ] = [ i, 0 ];\n\n\t\t\t\t}\n\n\t\t\t\tinfluencesList[ geometry.id ] = influences;\n\n\t\t\t}\n\n\t\t\t// Collect influences\n\n\t\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\t\tconst influence = influences[ i ];\n\n\t\t\t\tinfluence[ 0 ] = i;\n\t\t\t\tinfluence[ 1 ] = objectInfluences[ i ];\n\n\t\t\t}\n\n\t\t\tinfluences.sort( absNumericalSort );\n\n\t\t\tfor ( let i = 0; i < 8; i ++ ) {\n\n\t\t\t\tif ( i < length && influences[ i ][ 1 ] ) {\n\n\t\t\t\t\tworkInfluences[ i ][ 0 ] = influences[ i ][ 0 ];\n\t\t\t\t\tworkInfluences[ i ][ 1 ] = influences[ i ][ 1 ];\n\n\t\t\t\t} else {\n\n\t\t\t\t\tworkInfluences[ i ][ 0 ] = Number.MAX_SAFE_INTEGER;\n\t\t\t\t\tworkInfluences[ i ][ 1 ] = 0;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tworkInfluences.sort( numericalSort );\n\n\t\t\tconst morphTargets = geometry.morphAttributes.position;\n\t\t\tconst morphNormals = geometry.morphAttributes.normal;\n\n\t\t\tlet morphInfluencesSum = 0;\n\n\t\t\tfor ( let i = 0; i < 8; i ++ ) {\n\n\t\t\t\tconst influence = workInfluences[ i ];\n\t\t\t\tconst index = influence[ 0 ];\n\t\t\t\tconst value = influence[ 1 ];\n\n\t\t\t\tif ( index !== Number.MAX_SAFE_INTEGER && value ) {\n\n\t\t\t\t\tif ( morphTargets && geometry.getAttribute( 'morphTarget' + i ) !== morphTargets[ index ] ) {\n\n\t\t\t\t\t\tgeometry.setAttribute( 'morphTarget' + i, morphTargets[ index ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( morphNormals && geometry.getAttribute( 'morphNormal' + i ) !== morphNormals[ index ] ) {\n\n\t\t\t\t\t\tgeometry.setAttribute( 'morphNormal' + i, morphNormals[ index ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmorphInfluences[ i ] = value;\n\t\t\t\t\tmorphInfluencesSum += value;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( morphTargets && geometry.hasAttribute( 'morphTarget' + i ) === true ) {\n\n\t\t\t\t\t\tgeometry.deleteAttribute( 'morphTarget' + i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( morphNormals && geometry.hasAttribute( 'morphNormal' + i ) === true ) {\n\n\t\t\t\t\t\tgeometry.deleteAttribute( 'morphNormal' + i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmorphInfluences[ i ] = 0;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// GLSL shader uses formula baseinfluence * base + sum(target * influence)\n\t\t\t// This allows us to switch between absolute morphs and relative morphs without changing shader code\n\t\t\t// When baseinfluence = 1 - sum(influence), the above is equivalent to sum((target - base) * influence)\n\t\t\tconst morphBaseInfluence = geometry.morphTargetsRelative ? 1 : 1 - morphInfluencesSum;\n\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetBaseInfluence', morphBaseInfluence );\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetInfluences', morphInfluences );\n\n\t\t}\n\n\t}\n\n\treturn {\n\n\t\tupdate: update\n\n\t};\n\n}\n\n\nexport { WebGLMorphtargets };\n","import { WebGLRenderTarget } from './WebGLRenderTarget.js';\n\nclass WebGLMultisampleRenderTarget extends WebGLRenderTarget {\n\n\tconstructor( width, height, options ) {\n\n\t\tsuper( width, height, options );\n\n\t\tthis.samples = 4;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy.call( this, source );\n\n\t\tthis.samples = source.samples;\n\n\t\treturn this;\n\n\t}\n\n}\n\nWebGLMultisampleRenderTarget.prototype.isWebGLMultisampleRenderTarget = true;\n\nexport { WebGLMultisampleRenderTarget };\n","function WebGLObjects( gl, geometries, attributes, info ) {\n\n\tlet updateMap = new WeakMap();\n\n\tfunction update( object ) {\n\n\t\tconst frame = info.render.frame;\n\n\t\tconst geometry = object.geometry;\n\t\tconst buffergeometry = geometries.get( object, geometry );\n\n\t\t// Update once per frame\n\n\t\tif ( updateMap.get( buffergeometry ) !== frame ) {\n\n\t\t\tgeometries.update( buffergeometry );\n\n\t\t\tupdateMap.set( buffergeometry, frame );\n\n\t\t}\n\n\t\tif ( object.isInstancedMesh ) {\n\n\t\t\tif ( object.hasEventListener( 'dispose', onInstancedMeshDispose ) === false ) {\n\n\t\t\t\tobject.addEventListener( 'dispose', onInstancedMeshDispose );\n\n\t\t\t}\n\n\t\t\tattributes.update( object.instanceMatrix, gl.ARRAY_BUFFER );\n\n\t\t\tif ( object.instanceColor !== null ) {\n\n\t\t\t\tattributes.update( object.instanceColor, gl.ARRAY_BUFFER );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn buffergeometry;\n\n\t}\n\n\tfunction dispose() {\n\n\t\tupdateMap = new WeakMap();\n\n\t}\n\n\tfunction onInstancedMeshDispose( event ) {\n\n\t\tconst instancedMesh = event.target;\n\n\t\tinstancedMesh.removeEventListener( 'dispose', onInstancedMeshDispose );\n\n\t\tattributes.remove( instancedMesh.instanceMatrix );\n\n\t\tif ( instancedMesh.instanceColor !== null ) attributes.remove( instancedMesh.instanceColor );\n\n\t}\n\n\treturn {\n\n\t\tupdate: update,\n\t\tdispose: dispose\n\n\t};\n\n}\n\n\nexport { WebGLObjects };\n","import { Texture } from './Texture.js';\nimport { ClampToEdgeWrapping, NearestFilter } from '../constants.js';\n\nclass DataTexture3D extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, depth = 1 ) {\n\n\t\t// We're going to add .setXXX() methods for setting properties later.\n\t\t// Users can still set in DataTexture3D directly.\n\t\t//\n\t\t//\tconst texture = new THREE.DataTexture3D( data, width, height, depth );\n\t\t// \ttexture.anisotropy = 16;\n\t\t//\n\t\t// See #14839\n\n\t\tsuper( null );\n\n\t\tthis.image = { data, width, height, depth };\n\n\t\tthis.magFilter = NearestFilter;\n\t\tthis.minFilter = NearestFilter;\n\n\t\tthis.wrapR = ClampToEdgeWrapping;\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t\tthis.needsUpdate = true;\n\n\t}\n\n}\n\nDataTexture3D.prototype.isDataTexture3D = true;\n\nexport { DataTexture3D };\n","/**\n * Uniforms of a program.\n * Those form a tree structure with a special top-level container for the root,\n * which you get by calling 'new WebGLUniforms( gl, program )'.\n *\n *\n * Properties of inner nodes including the top-level container:\n *\n * .seq - array of nested uniforms\n * .map - nested uniforms by name\n *\n *\n * Methods of all nodes except the top-level container:\n *\n * .setValue( gl, value, [textures] )\n *\n * \t\tuploads a uniform value(s)\n *  \tthe 'textures' parameter is needed for sampler uniforms\n *\n *\n * Static methods of the top-level container (textures factorizations):\n *\n * .upload( gl, seq, values, textures )\n *\n * \t\tsets uniforms in 'seq' to 'values[id].value'\n *\n * .seqWithValue( seq, values ) : filteredSeq\n *\n * \t\tfilters 'seq' entries with corresponding entry in values\n *\n *\n * Methods of the top-level container (textures factorizations):\n *\n * .setValue( gl, name, value, textures )\n *\n * \t\tsets uniform with  name 'name' to 'value'\n *\n * .setOptional( gl, obj, prop )\n *\n * \t\tlike .set for an optional property of the object\n *\n */\n\nimport { CubeTexture } from '../../textures/CubeTexture.js';\nimport { Texture } from '../../textures/Texture.js';\nimport { DataTexture2DArray } from '../../textures/DataTexture2DArray.js';\nimport { DataTexture3D } from '../../textures/DataTexture3D.js';\n\nconst emptyTexture = new Texture();\nconst emptyTexture2dArray = new DataTexture2DArray();\nconst emptyTexture3d = new DataTexture3D();\nconst emptyCubeTexture = new CubeTexture();\n\n// --- Utilities ---\n\n// Array Caches (provide typed arrays for temporary by size)\n\nconst arrayCacheF32 = [];\nconst arrayCacheI32 = [];\n\n// Float32Array caches used for uploading Matrix uniforms\n\nconst mat4array = new Float32Array( 16 );\nconst mat3array = new Float32Array( 9 );\nconst mat2array = new Float32Array( 4 );\n\n// Flattening for arrays of vectors and matrices\n\nfunction flatten( array, nBlocks, blockSize ) {\n\n\tconst firstElem = array[ 0 ];\n\n\tif ( firstElem <= 0 || firstElem > 0 ) return array;\n\t// unoptimized: ! isNaN( firstElem )\n\t// see http://jacksondunstan.com/articles/983\n\n\tconst n = nBlocks * blockSize;\n\tlet r = arrayCacheF32[ n ];\n\n\tif ( r === undefined ) {\n\n\t\tr = new Float32Array( n );\n\t\tarrayCacheF32[ n ] = r;\n\n\t}\n\n\tif ( nBlocks !== 0 ) {\n\n\t\tfirstElem.toArray( r, 0 );\n\n\t\tfor ( let i = 1, offset = 0; i !== nBlocks; ++ i ) {\n\n\t\t\toffset += blockSize;\n\t\t\tarray[ i ].toArray( r, offset );\n\n\t\t}\n\n\t}\n\n\treturn r;\n\n}\n\nfunction arraysEqual( a, b ) {\n\n\tif ( a.length !== b.length ) return false;\n\n\tfor ( let i = 0, l = a.length; i < l; i ++ ) {\n\n\t\tif ( a[ i ] !== b[ i ] ) return false;\n\n\t}\n\n\treturn true;\n\n}\n\nfunction copyArray( a, b ) {\n\n\tfor ( let i = 0, l = b.length; i < l; i ++ ) {\n\n\t\ta[ i ] = b[ i ];\n\n\t}\n\n}\n\n// Texture unit allocation\n\nfunction allocTexUnits( textures, n ) {\n\n\tlet r = arrayCacheI32[ n ];\n\n\tif ( r === undefined ) {\n\n\t\tr = new Int32Array( n );\n\t\tarrayCacheI32[ n ] = r;\n\n\t}\n\n\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\tr[ i ] = textures.allocateTextureUnit();\n\n\t}\n\n\treturn r;\n\n}\n\n// --- Setters ---\n\n// Note: Defining these methods externally, because they come in a bunch\n// and this way their names minify.\n\n// Single scalar\n\nfunction setValueV1f( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( cache[ 0 ] === v ) return;\n\n\tgl.uniform1f( this.addr, v );\n\n\tcache[ 0 ] = v;\n\n}\n\n// Single float vector (from flat array or THREE.VectorN)\n\nfunction setValueV2f( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( v.x !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y ) {\n\n\t\t\tgl.uniform2f( this.addr, v.x, v.y );\n\n\t\t\tcache[ 0 ] = v.x;\n\t\t\tcache[ 1 ] = v.y;\n\n\t\t}\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniform2fv( this.addr, v );\n\n\t\tcopyArray( cache, v );\n\n\t}\n\n}\n\nfunction setValueV3f( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( v.x !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y || cache[ 2 ] !== v.z ) {\n\n\t\t\tgl.uniform3f( this.addr, v.x, v.y, v.z );\n\n\t\t\tcache[ 0 ] = v.x;\n\t\t\tcache[ 1 ] = v.y;\n\t\t\tcache[ 2 ] = v.z;\n\n\t\t}\n\n\t} else if ( v.r !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.r || cache[ 1 ] !== v.g || cache[ 2 ] !== v.b ) {\n\n\t\t\tgl.uniform3f( this.addr, v.r, v.g, v.b );\n\n\t\t\tcache[ 0 ] = v.r;\n\t\t\tcache[ 1 ] = v.g;\n\t\t\tcache[ 2 ] = v.b;\n\n\t\t}\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniform3fv( this.addr, v );\n\n\t\tcopyArray( cache, v );\n\n\t}\n\n}\n\nfunction setValueV4f( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( v.x !== undefined ) {\n\n\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y || cache[ 2 ] !== v.z || cache[ 3 ] !== v.w ) {\n\n\t\t\tgl.uniform4f( this.addr, v.x, v.y, v.z, v.w );\n\n\t\t\tcache[ 0 ] = v.x;\n\t\t\tcache[ 1 ] = v.y;\n\t\t\tcache[ 2 ] = v.z;\n\t\t\tcache[ 3 ] = v.w;\n\n\t\t}\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniform4fv( this.addr, v );\n\n\t\tcopyArray( cache, v );\n\n\t}\n\n}\n\n// Single matrix (from flat array or THREE.MatrixN)\n\nfunction setValueM2( gl, v ) {\n\n\tconst cache = this.cache;\n\tconst elements = v.elements;\n\n\tif ( elements === undefined ) {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniformMatrix2fv( this.addr, false, v );\n\n\t\tcopyArray( cache, v );\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, elements ) ) return;\n\n\t\tmat2array.set( elements );\n\n\t\tgl.uniformMatrix2fv( this.addr, false, mat2array );\n\n\t\tcopyArray( cache, elements );\n\n\t}\n\n}\n\nfunction setValueM3( gl, v ) {\n\n\tconst cache = this.cache;\n\tconst elements = v.elements;\n\n\tif ( elements === undefined ) {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniformMatrix3fv( this.addr, false, v );\n\n\t\tcopyArray( cache, v );\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, elements ) ) return;\n\n\t\tmat3array.set( elements );\n\n\t\tgl.uniformMatrix3fv( this.addr, false, mat3array );\n\n\t\tcopyArray( cache, elements );\n\n\t}\n\n}\n\nfunction setValueM4( gl, v ) {\n\n\tconst cache = this.cache;\n\tconst elements = v.elements;\n\n\tif ( elements === undefined ) {\n\n\t\tif ( arraysEqual( cache, v ) ) return;\n\n\t\tgl.uniformMatrix4fv( this.addr, false, v );\n\n\t\tcopyArray( cache, v );\n\n\t} else {\n\n\t\tif ( arraysEqual( cache, elements ) ) return;\n\n\t\tmat4array.set( elements );\n\n\t\tgl.uniformMatrix4fv( this.addr, false, mat4array );\n\n\t\tcopyArray( cache, elements );\n\n\t}\n\n}\n\n// Single integer / boolean\n\nfunction setValueV1i( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( cache[ 0 ] === v ) return;\n\n\tgl.uniform1i( this.addr, v );\n\n\tcache[ 0 ] = v;\n\n}\n\n// Single integer / boolean vector (from flat array)\n\nfunction setValueV2i( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( arraysEqual( cache, v ) ) return;\n\n\tgl.uniform2iv( this.addr, v );\n\n\tcopyArray( cache, v );\n\n}\n\nfunction setValueV3i( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( arraysEqual( cache, v ) ) return;\n\n\tgl.uniform3iv( this.addr, v );\n\n\tcopyArray( cache, v );\n\n}\n\nfunction setValueV4i( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( arraysEqual( cache, v ) ) return;\n\n\tgl.uniform4iv( this.addr, v );\n\n\tcopyArray( cache, v );\n\n}\n\n// Single unsigned integer\n\nfunction setValueV1ui( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( cache[ 0 ] === v ) return;\n\n\tgl.uniform1ui( this.addr, v );\n\n\tcache[ 0 ] = v;\n\n}\n\n// Single unsigned integer vector (from flat array)\n\nfunction setValueV2ui( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( arraysEqual( cache, v ) ) return;\n\n\tgl.uniform2uiv( this.addr, v );\n\n\tcopyArray( cache, v );\n\n}\n\nfunction setValueV3ui( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( arraysEqual( cache, v ) ) return;\n\n\tgl.uniform3uiv( this.addr, v );\n\n\tcopyArray( cache, v );\n\n}\n\nfunction setValueV4ui( gl, v ) {\n\n\tconst cache = this.cache;\n\n\tif ( arraysEqual( cache, v ) ) return;\n\n\tgl.uniform4uiv( this.addr, v );\n\n\tcopyArray( cache, v );\n\n}\n\n\n// Single texture (2D / Cube)\n\nfunction setValueT1( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\tconst unit = textures.allocateTextureUnit();\n\n\tif ( cache[ 0 ] !== unit ) {\n\n\t\tgl.uniform1i( this.addr, unit );\n\t\tcache[ 0 ] = unit;\n\n\t}\n\n\ttextures.safeSetTexture2D( v || emptyTexture, unit );\n\n}\n\nfunction setValueT3D1( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\tconst unit = textures.allocateTextureUnit();\n\n\tif ( cache[ 0 ] !== unit ) {\n\n\t\tgl.uniform1i( this.addr, unit );\n\t\tcache[ 0 ] = unit;\n\n\t}\n\n\ttextures.setTexture3D( v || emptyTexture3d, unit );\n\n}\n\nfunction setValueT6( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\tconst unit = textures.allocateTextureUnit();\n\n\tif ( cache[ 0 ] !== unit ) {\n\n\t\tgl.uniform1i( this.addr, unit );\n\t\tcache[ 0 ] = unit;\n\n\t}\n\n\ttextures.safeSetTextureCube( v || emptyCubeTexture, unit );\n\n}\n\nfunction setValueT2DArray1( gl, v, textures ) {\n\n\tconst cache = this.cache;\n\tconst unit = textures.allocateTextureUnit();\n\n\tif ( cache[ 0 ] !== unit ) {\n\n\t\tgl.uniform1i( this.addr, unit );\n\t\tcache[ 0 ] = unit;\n\n\t}\n\n\ttextures.setTexture2DArray( v || emptyTexture2dArray, unit );\n\n}\n\n// Helper to pick the right setter for the singular case\n\nfunction getSingularSetter( type ) {\n\n\tswitch ( type ) {\n\n\t\tcase 0x1406: return setValueV1f; // FLOAT\n\t\tcase 0x8b50: return setValueV2f; // _VEC2\n\t\tcase 0x8b51: return setValueV3f; // _VEC3\n\t\tcase 0x8b52: return setValueV4f; // _VEC4\n\n\t\tcase 0x8b5a: return setValueM2; // _MAT2\n\t\tcase 0x8b5b: return setValueM3; // _MAT3\n\t\tcase 0x8b5c: return setValueM4; // _MAT4\n\n\t\tcase 0x1404: case 0x8b56: return setValueV1i; // INT, BOOL\n\t\tcase 0x8b53: case 0x8b57: return setValueV2i; // _VEC2\n\t\tcase 0x8b54: case 0x8b58: return setValueV3i; // _VEC3\n\t\tcase 0x8b55: case 0x8b59: return setValueV4i; // _VEC4\n\n\t\tcase 0x1405: return setValueV1ui; // UINT\n\t\tcase 0x8dc6: return setValueV2ui; // _VEC2\n\t\tcase 0x8dc7: return setValueV3ui; // _VEC3\n\t\tcase 0x8dc8: return setValueV4ui; // _VEC4\n\n\t\tcase 0x8b5e: // SAMPLER_2D\n\t\tcase 0x8d66: // SAMPLER_EXTERNAL_OES\n\t\tcase 0x8dca: // INT_SAMPLER_2D\n\t\tcase 0x8dd2: // UNSIGNED_INT_SAMPLER_2D\n\t\tcase 0x8b62: // SAMPLER_2D_SHADOW\n\t\t\treturn setValueT1;\n\n\t\tcase 0x8b5f: // SAMPLER_3D\n\t\tcase 0x8dcb: // INT_SAMPLER_3D\n\t\tcase 0x8dd3: // UNSIGNED_INT_SAMPLER_3D\n\t\t\treturn setValueT3D1;\n\n\t\tcase 0x8b60: // SAMPLER_CUBE\n\t\tcase 0x8dcc: // INT_SAMPLER_CUBE\n\t\tcase 0x8dd4: // UNSIGNED_INT_SAMPLER_CUBE\n\t\tcase 0x8dc5: // SAMPLER_CUBE_SHADOW\n\t\t\treturn setValueT6;\n\n\t\tcase 0x8dc1: // SAMPLER_2D_ARRAY\n\t\tcase 0x8dcf: // INT_SAMPLER_2D_ARRAY\n\t\tcase 0x8dd7: // UNSIGNED_INT_SAMPLER_2D_ARRAY\n\t\tcase 0x8dc4: // SAMPLER_2D_ARRAY_SHADOW\n\t\t\treturn setValueT2DArray1;\n\n\t}\n\n}\n\n\n// Array of scalars\n\nfunction setValueV1fArray( gl, v ) {\n\n\tgl.uniform1fv( this.addr, v );\n\n}\n\n// Array of vectors (from flat array or array of THREE.VectorN)\n\nfunction setValueV2fArray( gl, v ) {\n\n\tconst data = flatten( v, this.size, 2 );\n\n\tgl.uniform2fv( this.addr, data );\n\n}\n\nfunction setValueV3fArray( gl, v ) {\n\n\tconst data = flatten( v, this.size, 3 );\n\n\tgl.uniform3fv( this.addr, data );\n\n}\n\nfunction setValueV4fArray( gl, v ) {\n\n\tconst data = flatten( v, this.size, 4 );\n\n\tgl.uniform4fv( this.addr, data );\n\n}\n\n// Array of matrices (from flat array or array of THREE.MatrixN)\n\nfunction setValueM2Array( gl, v ) {\n\n\tconst data = flatten( v, this.size, 4 );\n\n\tgl.uniformMatrix2fv( this.addr, false, data );\n\n}\n\nfunction setValueM3Array( gl, v ) {\n\n\tconst data = flatten( v, this.size, 9 );\n\n\tgl.uniformMatrix3fv( this.addr, false, data );\n\n}\n\nfunction setValueM4Array( gl, v ) {\n\n\tconst data = flatten( v, this.size, 16 );\n\n\tgl.uniformMatrix4fv( this.addr, false, data );\n\n}\n\n// Array of integer / boolean\n\nfunction setValueV1iArray( gl, v ) {\n\n\tgl.uniform1iv( this.addr, v );\n\n}\n\n// Array of integer / boolean vectors (from flat array)\n\nfunction setValueV2iArray( gl, v ) {\n\n\tgl.uniform2iv( this.addr, v );\n\n}\n\nfunction setValueV3iArray( gl, v ) {\n\n\tgl.uniform3iv( this.addr, v );\n\n}\n\nfunction setValueV4iArray( gl, v ) {\n\n\tgl.uniform4iv( this.addr, v );\n\n}\n\n// Array of unsigned integer\n\nfunction setValueV1uiArray( gl, v ) {\n\n\tgl.uniform1uiv( this.addr, v );\n\n}\n\n// Array of unsigned integer vectors (from flat array)\n\nfunction setValueV2uiArray( gl, v ) {\n\n\tgl.uniform2uiv( this.addr, v );\n\n}\n\nfunction setValueV3uiArray( gl, v ) {\n\n\tgl.uniform3uiv( this.addr, v );\n\n}\n\nfunction setValueV4uiArray( gl, v ) {\n\n\tgl.uniform4uiv( this.addr, v );\n\n}\n\n\n// Array of textures (2D / Cube)\n\nfunction setValueT1Array( gl, v, textures ) {\n\n\tconst n = v.length;\n\n\tconst units = allocTexUnits( textures, n );\n\n\tgl.uniform1iv( this.addr, units );\n\n\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\ttextures.safeSetTexture2D( v[ i ] || emptyTexture, units[ i ] );\n\n\t}\n\n}\n\nfunction setValueT6Array( gl, v, textures ) {\n\n\tconst n = v.length;\n\n\tconst units = allocTexUnits( textures, n );\n\n\tgl.uniform1iv( this.addr, units );\n\n\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\ttextures.safeSetTextureCube( v[ i ] || emptyCubeTexture, units[ i ] );\n\n\t}\n\n}\n\n// Helper to pick the right setter for a pure (bottom-level) array\n\nfunction getPureArraySetter( type ) {\n\n\tswitch ( type ) {\n\n\t\tcase 0x1406: return setValueV1fArray; // FLOAT\n\t\tcase 0x8b50: return setValueV2fArray; // _VEC2\n\t\tcase 0x8b51: return setValueV3fArray; // _VEC3\n\t\tcase 0x8b52: return setValueV4fArray; // _VEC4\n\n\t\tcase 0x8b5a: return setValueM2Array; // _MAT2\n\t\tcase 0x8b5b: return setValueM3Array; // _MAT3\n\t\tcase 0x8b5c: return setValueM4Array; // _MAT4\n\n\t\tcase 0x1404: case 0x8b56: return setValueV1iArray; // INT, BOOL\n\t\tcase 0x8b53: case 0x8b57: return setValueV2iArray; // _VEC2\n\t\tcase 0x8b54: case 0x8b58: return setValueV3iArray; // _VEC3\n\t\tcase 0x8b55: case 0x8b59: return setValueV4iArray; // _VEC4\n\n\t\tcase 0x1405: return setValueV1uiArray; // UINT\n\t\tcase 0x8dc6: return setValueV2uiArray; // _VEC2\n\t\tcase 0x8dc7: return setValueV3uiArray; // _VEC3\n\t\tcase 0x8dc8: return setValueV4uiArray; // _VEC4\n\n\t\tcase 0x8b5e: // SAMPLER_2D\n\t\tcase 0x8d66: // SAMPLER_EXTERNAL_OES\n\t\tcase 0x8dca: // INT_SAMPLER_2D\n\t\tcase 0x8dd2: // UNSIGNED_INT_SAMPLER_2D\n\t\tcase 0x8b62: // SAMPLER_2D_SHADOW\n\t\t\treturn setValueT1Array;\n\n\t\tcase 0x8b60: // SAMPLER_CUBE\n\t\tcase 0x8dcc: // INT_SAMPLER_CUBE\n\t\tcase 0x8dd4: // UNSIGNED_INT_SAMPLER_CUBE\n\t\tcase 0x8dc5: // SAMPLER_CUBE_SHADOW\n\t\t\treturn setValueT6Array;\n\n\t}\n\n}\n\n// --- Uniform Classes ---\n\nfunction SingleUniform( id, activeInfo, addr ) {\n\n\tthis.id = id;\n\tthis.addr = addr;\n\tthis.cache = [];\n\tthis.setValue = getSingularSetter( activeInfo.type );\n\n\t// this.path = activeInfo.name; // DEBUG\n\n}\n\nfunction PureArrayUniform( id, activeInfo, addr ) {\n\n\tthis.id = id;\n\tthis.addr = addr;\n\tthis.cache = [];\n\tthis.size = activeInfo.size;\n\tthis.setValue = getPureArraySetter( activeInfo.type );\n\n\t// this.path = activeInfo.name; // DEBUG\n\n}\n\nPureArrayUniform.prototype.updateCache = function ( data ) {\n\n\tconst cache = this.cache;\n\n\tif ( data instanceof Float32Array && cache.length !== data.length ) {\n\n\t\tthis.cache = new Float32Array( data.length );\n\n\t}\n\n\tcopyArray( cache, data );\n\n};\n\nfunction StructuredUniform( id ) {\n\n\tthis.id = id;\n\n\tthis.seq = [];\n\tthis.map = {};\n\n}\n\nStructuredUniform.prototype.setValue = function ( gl, value, textures ) {\n\n\tconst seq = this.seq;\n\n\tfor ( let i = 0, n = seq.length; i !== n; ++ i ) {\n\n\t\tconst u = seq[ i ];\n\t\tu.setValue( gl, value[ u.id ], textures );\n\n\t}\n\n};\n\n// --- Top-level ---\n\n// Parser - builds up the property tree from the path strings\n\nconst RePathPart = /(\\w+)(\\])?(\\[|\\.)?/g;\n\n// extracts\n// \t- the identifier (member name or array index)\n//  - followed by an optional right bracket (found when array index)\n//  - followed by an optional left bracket or dot (type of subscript)\n//\n// Note: These portions can be read in a non-overlapping fashion and\n// allow straightforward parsing of the hierarchy that WebGL encodes\n// in the uniform names.\n\nfunction addUniform( container, uniformObject ) {\n\n\tcontainer.seq.push( uniformObject );\n\tcontainer.map[ uniformObject.id ] = uniformObject;\n\n}\n\nfunction parseUniform( activeInfo, addr, container ) {\n\n\tconst path = activeInfo.name,\n\t\tpathLength = path.length;\n\n\t// reset RegExp object, because of the early exit of a previous run\n\tRePathPart.lastIndex = 0;\n\n\twhile ( true ) {\n\n\t\tconst match = RePathPart.exec( path ),\n\t\t\tmatchEnd = RePathPart.lastIndex;\n\n\t\tlet id = match[ 1 ];\n\t\tconst idIsIndex = match[ 2 ] === ']',\n\t\t\tsubscript = match[ 3 ];\n\n\t\tif ( idIsIndex ) id = id | 0; // convert to integer\n\n\t\tif ( subscript === undefined || subscript === '[' && matchEnd + 2 === pathLength ) {\n\n\t\t\t// bare name or \"pure\" bottom-level array \"[0]\" suffix\n\n\t\t\taddUniform( container, subscript === undefined ?\n\t\t\t\tnew SingleUniform( id, activeInfo, addr ) :\n\t\t\t\tnew PureArrayUniform( id, activeInfo, addr ) );\n\n\t\t\tbreak;\n\n\t\t} else {\n\n\t\t\t// step into inner node / create it in case it doesn't exist\n\n\t\t\tconst map = container.map;\n\t\t\tlet next = map[ id ];\n\n\t\t\tif ( next === undefined ) {\n\n\t\t\t\tnext = new StructuredUniform( id );\n\t\t\t\taddUniform( container, next );\n\n\t\t\t}\n\n\t\t\tcontainer = next;\n\n\t\t}\n\n\t}\n\n}\n\n// Root Container\n\nfunction WebGLUniforms( gl, program ) {\n\n\tthis.seq = [];\n\tthis.map = {};\n\n\tconst n = gl.getProgramParameter( program, gl.ACTIVE_UNIFORMS );\n\n\tfor ( let i = 0; i < n; ++ i ) {\n\n\t\tconst info = gl.getActiveUniform( program, i ),\n\t\t\taddr = gl.getUniformLocation( program, info.name );\n\n\t\tparseUniform( info, addr, this );\n\n\t}\n\n}\n\nWebGLUniforms.prototype.setValue = function ( gl, name, value, textures ) {\n\n\tconst u = this.map[ name ];\n\n\tif ( u !== undefined ) u.setValue( gl, value, textures );\n\n};\n\nWebGLUniforms.prototype.setOptional = function ( gl, object, name ) {\n\n\tconst v = object[ name ];\n\n\tif ( v !== undefined ) this.setValue( gl, name, v );\n\n};\n\n\n// Static interface\n\nWebGLUniforms.upload = function ( gl, seq, values, textures ) {\n\n\tfor ( let i = 0, n = seq.length; i !== n; ++ i ) {\n\n\t\tconst u = seq[ i ],\n\t\t\tv = values[ u.id ];\n\n\t\tif ( v.needsUpdate !== false ) {\n\n\t\t\t// note: always updating when .needsUpdate is undefined\n\t\t\tu.setValue( gl, v.value, textures );\n\n\t\t}\n\n\t}\n\n};\n\nWebGLUniforms.seqWithValue = function ( seq, values ) {\n\n\tconst r = [];\n\n\tfor ( let i = 0, n = seq.length; i !== n; ++ i ) {\n\n\t\tconst u = seq[ i ];\n\t\tif ( u.id in values ) r.push( u );\n\n\t}\n\n\treturn r;\n\n};\n\nexport { WebGLUniforms };\n","function WebGLShader( gl, type, string ) {\n\n\tconst shader = gl.createShader( type );\n\n\tgl.shaderSource( shader, string );\n\tgl.compileShader( shader );\n\n\treturn shader;\n\n}\n\nexport { WebGLShader };\n","import { WebGLUniforms } from './WebGLUniforms.js';\nimport { WebGLShader } from './WebGLShader.js';\nimport { ShaderChunk } from '../shaders/ShaderChunk.js';\nimport { RGBFormat, NoToneMapping, AddOperation, MixOperation, MultiplyOperation, CubeRefractionMapping, CubeUVRefractionMapping, CubeUVReflectionMapping, CubeReflectionMapping, PCFSoftShadowMap, PCFShadowMap, VSMShadowMap, ACESFilmicToneMapping, CineonToneMapping, CustomToneMapping, ReinhardToneMapping, LinearToneMapping, GammaEncoding, RGBDEncoding, RGBM16Encoding, RGBM7Encoding, RGBEEncoding, sRGBEncoding, LinearEncoding, LogLuvEncoding, GLSL3 } from '../../constants.js';\n\nlet programIdCount = 0;\n\nfunction addLineNumbers( string ) {\n\n\tconst lines = string.split( '\\n' );\n\n\tfor ( let i = 0; i < lines.length; i ++ ) {\n\n\t\tlines[ i ] = ( i + 1 ) + ': ' + lines[ i ];\n\n\t}\n\n\treturn lines.join( '\\n' );\n\n}\n\nfunction getEncodingComponents( encoding ) {\n\n\tswitch ( encoding ) {\n\n\t\tcase LinearEncoding:\n\t\t\treturn [ 'Linear', '( value )' ];\n\t\tcase sRGBEncoding:\n\t\t\treturn [ 'sRGB', '( value )' ];\n\t\tcase RGBEEncoding:\n\t\t\treturn [ 'RGBE', '( value )' ];\n\t\tcase RGBM7Encoding:\n\t\t\treturn [ 'RGBM', '( value, 7.0 )' ];\n\t\tcase RGBM16Encoding:\n\t\t\treturn [ 'RGBM', '( value, 16.0 )' ];\n\t\tcase RGBDEncoding:\n\t\t\treturn [ 'RGBD', '( value, 256.0 )' ];\n\t\tcase GammaEncoding:\n\t\t\treturn [ 'Gamma', '( value, float( GAMMA_FACTOR ) )' ];\n\t\tcase LogLuvEncoding:\n\t\t\treturn [ 'LogLuv', '( value )' ];\n\t\tdefault:\n\t\t\tconsole.warn( 'THREE.WebGLProgram: Unsupported encoding:', encoding );\n\t\t\treturn [ 'Linear', '( value )' ];\n\n\t}\n\n}\n\nfunction getShaderErrors( gl, shader, type ) {\n\n\tconst status = gl.getShaderParameter( shader, gl.COMPILE_STATUS );\n\tconst errors = gl.getShaderInfoLog( shader ).trim();\n\n\tif ( status && errors === '' ) return '';\n\n\t// --enable-privileged-webgl-extension\n\t// console.log( '**' + type + '**', gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\n\n\treturn type.toUpperCase() + '\\n\\n' + errors + '\\n\\n' + addLineNumbers( gl.getShaderSource( shader ) );\n\n}\n\nfunction getTexelDecodingFunction( functionName, encoding ) {\n\n\tconst components = getEncodingComponents( encoding );\n\treturn 'vec4 ' + functionName + '( vec4 value ) { return ' + components[ 0 ] + 'ToLinear' + components[ 1 ] + '; }';\n\n}\n\nfunction getTexelEncodingFunction( functionName, encoding ) {\n\n\tconst components = getEncodingComponents( encoding );\n\treturn 'vec4 ' + functionName + '( vec4 value ) { return LinearTo' + components[ 0 ] + components[ 1 ] + '; }';\n\n}\n\nfunction getToneMappingFunction( functionName, toneMapping ) {\n\n\tlet toneMappingName;\n\n\tswitch ( toneMapping ) {\n\n\t\tcase LinearToneMapping:\n\t\t\ttoneMappingName = 'Linear';\n\t\t\tbreak;\n\n\t\tcase ReinhardToneMapping:\n\t\t\ttoneMappingName = 'Reinhard';\n\t\t\tbreak;\n\n\t\tcase CineonToneMapping:\n\t\t\ttoneMappingName = 'OptimizedCineon';\n\t\t\tbreak;\n\n\t\tcase ACESFilmicToneMapping:\n\t\t\ttoneMappingName = 'ACESFilmic';\n\t\t\tbreak;\n\n\t\tcase CustomToneMapping:\n\t\t\ttoneMappingName = 'Custom';\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tconsole.warn( 'THREE.WebGLProgram: Unsupported toneMapping:', toneMapping );\n\t\t\ttoneMappingName = 'Linear';\n\n\t}\n\n\treturn 'vec3 ' + functionName + '( vec3 color ) { return ' + toneMappingName + 'ToneMapping( color ); }';\n\n}\n\nfunction generateExtensions( parameters ) {\n\n\tconst chunks = [\n\t\t( parameters.extensionDerivatives || parameters.envMapCubeUV || parameters.bumpMap || parameters.tangentSpaceNormalMap || parameters.clearcoatNormalMap || parameters.flatShading || parameters.shaderID === 'physical' ) ? '#extension GL_OES_standard_derivatives : enable' : '',\n\t\t( parameters.extensionFragDepth || parameters.logarithmicDepthBuffer ) && parameters.rendererExtensionFragDepth ? '#extension GL_EXT_frag_depth : enable' : '',\n\t\t( parameters.extensionDrawBuffers && parameters.rendererExtensionDrawBuffers ) ? '#extension GL_EXT_draw_buffers : require' : '',\n\t\t( parameters.extensionShaderTextureLOD || parameters.envMap || parameters.transmission ) && parameters.rendererExtensionShaderTextureLod ? '#extension GL_EXT_shader_texture_lod : enable' : ''\n\t];\n\n\treturn chunks.filter( filterEmptyLine ).join( '\\n' );\n\n}\n\nfunction generateDefines( defines ) {\n\n\tconst chunks = [];\n\n\tfor ( const name in defines ) {\n\n\t\tconst value = defines[ name ];\n\n\t\tif ( value === false ) continue;\n\n\t\tchunks.push( '#define ' + name + ' ' + value );\n\n\t}\n\n\treturn chunks.join( '\\n' );\n\n}\n\nfunction fetchAttributeLocations( gl, program ) {\n\n\tconst attributes = {};\n\n\tconst n = gl.getProgramParameter( program, gl.ACTIVE_ATTRIBUTES );\n\n\tfor ( let i = 0; i < n; i ++ ) {\n\n\t\tconst info = gl.getActiveAttrib( program, i );\n\t\tconst name = info.name;\n\n\t\tlet locationSize = 1;\n\t\tif ( info.type === gl.FLOAT_MAT2 ) locationSize = 2;\n\t\tif ( info.type === gl.FLOAT_MAT3 ) locationSize = 3;\n\t\tif ( info.type === gl.FLOAT_MAT4 ) locationSize = 4;\n\n\t\t// console.log( 'THREE.WebGLProgram: ACTIVE VERTEX ATTRIBUTE:', name, i );\n\n\t\tattributes[ name ] = {\n\t\t\ttype: info.type,\n\t\t\tlocation: gl.getAttribLocation( program, name ),\n\t\t\tlocationSize: locationSize\n\t\t};\n\n\t}\n\n\treturn attributes;\n\n}\n\nfunction filterEmptyLine( string ) {\n\n\treturn string !== '';\n\n}\n\nfunction replaceLightNums( string, parameters ) {\n\n\treturn string\n\t\t.replace( /NUM_DIR_LIGHTS/g, parameters.numDirLights )\n\t\t.replace( /NUM_SPOT_LIGHTS/g, parameters.numSpotLights )\n\t\t.replace( /NUM_RECT_AREA_LIGHTS/g, parameters.numRectAreaLights )\n\t\t.replace( /NUM_POINT_LIGHTS/g, parameters.numPointLights )\n\t\t.replace( /NUM_HEMI_LIGHTS/g, parameters.numHemiLights )\n\t\t.replace( /NUM_DIR_LIGHT_SHADOWS/g, parameters.numDirLightShadows )\n\t\t.replace( /NUM_SPOT_LIGHT_SHADOWS/g, parameters.numSpotLightShadows )\n\t\t.replace( /NUM_POINT_LIGHT_SHADOWS/g, parameters.numPointLightShadows );\n\n}\n\nfunction replaceClippingPlaneNums( string, parameters ) {\n\n\treturn string\n\t\t.replace( /NUM_CLIPPING_PLANES/g, parameters.numClippingPlanes )\n\t\t.replace( /UNION_CLIPPING_PLANES/g, ( parameters.numClippingPlanes - parameters.numClipIntersection ) );\n\n}\n\n// Resolve Includes\n\nconst includePattern = /^[ \\t]*#include +<([\\w\\d./]+)>/gm;\n\nfunction resolveIncludes( string ) {\n\n\treturn string.replace( includePattern, includeReplacer );\n\n}\n\nfunction includeReplacer( match, include ) {\n\n\tconst string = ShaderChunk[ include ];\n\n\tif ( string === undefined ) {\n\n\t\tthrow new Error( 'Can not resolve #include <' + include + '>' );\n\n\t}\n\n\treturn resolveIncludes( string );\n\n}\n\n// Unroll Loops\n\nconst deprecatedUnrollLoopPattern = /#pragma unroll_loop[\\s]+?for \\( int i \\= (\\d+)\\; i < (\\d+)\\; i \\+\\+ \\) \\{([\\s\\S]+?)(?=\\})\\}/g;\nconst unrollLoopPattern = /#pragma unroll_loop_start\\s+for\\s*\\(\\s*int\\s+i\\s*=\\s*(\\d+)\\s*;\\s*i\\s*<\\s*(\\d+)\\s*;\\s*i\\s*\\+\\+\\s*\\)\\s*{([\\s\\S]+?)}\\s+#pragma unroll_loop_end/g;\n\nfunction unrollLoops( string ) {\n\n\treturn string\n\t\t.replace( unrollLoopPattern, loopReplacer )\n\t\t.replace( deprecatedUnrollLoopPattern, deprecatedLoopReplacer );\n\n}\n\nfunction deprecatedLoopReplacer( match, start, end, snippet ) {\n\n\tconsole.warn( 'WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead.' );\n\treturn loopReplacer( match, start, end, snippet );\n\n}\n\nfunction loopReplacer( match, start, end, snippet ) {\n\n\tlet string = '';\n\n\tfor ( let i = parseInt( start ); i < parseInt( end ); i ++ ) {\n\n\t\tstring += snippet\n\t\t\t.replace( /\\[\\s*i\\s*\\]/g, '[ ' + i + ' ]' )\n\t\t\t.replace( /UNROLLED_LOOP_INDEX/g, i );\n\n\t}\n\n\treturn string;\n\n}\n\n//\n\nfunction generatePrecision( parameters ) {\n\n\tlet precisionstring = 'precision ' + parameters.precision + ' float;\\nprecision ' + parameters.precision + ' int;';\n\n\tif ( parameters.precision === 'highp' ) {\n\n\t\tprecisionstring += '\\n#define HIGH_PRECISION';\n\n\t} else if ( parameters.precision === 'mediump' ) {\n\n\t\tprecisionstring += '\\n#define MEDIUM_PRECISION';\n\n\t} else if ( parameters.precision === 'lowp' ) {\n\n\t\tprecisionstring += '\\n#define LOW_PRECISION';\n\n\t}\n\n\treturn precisionstring;\n\n}\n\nfunction generateShadowMapTypeDefine( parameters ) {\n\n\tlet shadowMapTypeDefine = 'SHADOWMAP_TYPE_BASIC';\n\n\tif ( parameters.shadowMapType === PCFShadowMap ) {\n\n\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';\n\n\t} else if ( parameters.shadowMapType === PCFSoftShadowMap ) {\n\n\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';\n\n\t} else if ( parameters.shadowMapType === VSMShadowMap ) {\n\n\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_VSM';\n\n\t}\n\n\treturn shadowMapTypeDefine;\n\n}\n\nfunction generateEnvMapTypeDefine( parameters ) {\n\n\tlet envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\n\n\tif ( parameters.envMap ) {\n\n\t\tswitch ( parameters.envMapMode ) {\n\n\t\t\tcase CubeReflectionMapping:\n\t\t\tcase CubeRefractionMapping:\n\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE';\n\t\t\t\tbreak;\n\n\t\t\tcase CubeUVReflectionMapping:\n\t\t\tcase CubeUVRefractionMapping:\n\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE_UV';\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn envMapTypeDefine;\n\n}\n\nfunction generateEnvMapModeDefine( parameters ) {\n\n\tlet envMapModeDefine = 'ENVMAP_MODE_REFLECTION';\n\n\tif ( parameters.envMap ) {\n\n\t\tswitch ( parameters.envMapMode ) {\n\n\t\t\tcase CubeRefractionMapping:\n\t\t\tcase CubeUVRefractionMapping:\n\n\t\t\t\tenvMapModeDefine = 'ENVMAP_MODE_REFRACTION';\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn envMapModeDefine;\n\n}\n\nfunction generateEnvMapBlendingDefine( parameters ) {\n\n\tlet envMapBlendingDefine = 'ENVMAP_BLENDING_NONE';\n\n\tif ( parameters.envMap ) {\n\n\t\tswitch ( parameters.combine ) {\n\n\t\t\tcase MultiplyOperation:\n\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\n\t\t\t\tbreak;\n\n\t\t\tcase MixOperation:\n\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MIX';\n\t\t\t\tbreak;\n\n\t\t\tcase AddOperation:\n\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_ADD';\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn envMapBlendingDefine;\n\n}\n\nfunction WebGLProgram( renderer, cacheKey, parameters, bindingStates ) {\n\n\t// TODO Send this event to Three.js DevTools\n\t// console.log( 'WebGLProgram', cacheKey );\n\n\tconst gl = renderer.getContext();\n\n\tconst defines = parameters.defines;\n\n\tlet vertexShader = parameters.vertexShader;\n\tlet fragmentShader = parameters.fragmentShader;\n\n\tconst shadowMapTypeDefine = generateShadowMapTypeDefine( parameters );\n\tconst envMapTypeDefine = generateEnvMapTypeDefine( parameters );\n\tconst envMapModeDefine = generateEnvMapModeDefine( parameters );\n\tconst envMapBlendingDefine = generateEnvMapBlendingDefine( parameters );\n\n\n\tconst gammaFactorDefine = ( renderer.gammaFactor > 0 ) ? renderer.gammaFactor : 1.0;\n\n\tconst customExtensions = parameters.isWebGL2 ? '' : generateExtensions( parameters );\n\n\tconst customDefines = generateDefines( defines );\n\n\tconst program = gl.createProgram();\n\n\tlet prefixVertex, prefixFragment;\n\tlet versionString = parameters.glslVersion ? '#version ' + parameters.glslVersion + '\\n' : '';\n\n\tif ( parameters.isRawShaderMaterial ) {\n\n\t\tprefixVertex = [\n\n\t\t\tcustomDefines\n\n\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t\tif ( prefixVertex.length > 0 ) {\n\n\t\t\tprefixVertex += '\\n';\n\n\t\t}\n\n\t\tprefixFragment = [\n\n\t\t\tcustomExtensions,\n\t\t\tcustomDefines\n\n\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t\tif ( prefixFragment.length > 0 ) {\n\n\t\t\tprefixFragment += '\\n';\n\n\t\t}\n\n\t} else {\n\n\t\tprefixVertex = [\n\n\t\t\tgeneratePrecision( parameters ),\n\n\t\t\t'#define SHADER_NAME ' + parameters.shaderName,\n\n\t\t\tcustomDefines,\n\n\t\t\tparameters.instancing ? '#define USE_INSTANCING' : '',\n\t\t\tparameters.instancingColor ? '#define USE_INSTANCING_COLOR' : '',\n\n\t\t\tparameters.supportsVertexTextures ? '#define VERTEX_TEXTURES' : '',\n\n\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\n\n\t\t\t'#define MAX_BONES ' + parameters.maxBones,\n\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\n\t\t\t( parameters.useFog && parameters.fogExp2 ) ? '#define FOG_EXP2' : '',\n\n\t\t\tparameters.map ? '#define USE_MAP' : '',\n\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\n\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\n\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\n\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\n\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\n\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\n\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\n\t\t\t( parameters.normalMap && parameters.objectSpaceNormalMap ) ? '#define OBJECTSPACE_NORMALMAP' : '',\n\t\t\t( parameters.normalMap && parameters.tangentSpaceNormalMap ) ? '#define TANGENTSPACE_NORMALMAP' : '',\n\n\t\t\tparameters.clearcoatMap ? '#define USE_CLEARCOATMAP' : '',\n\t\t\tparameters.clearcoatRoughnessMap ? '#define USE_CLEARCOAT_ROUGHNESSMAP' : '',\n\t\t\tparameters.clearcoatNormalMap ? '#define USE_CLEARCOAT_NORMALMAP' : '',\n\n\t\t\tparameters.displacementMap && parameters.supportsVertexTextures ? '#define USE_DISPLACEMENTMAP' : '',\n\n\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\n\t\t\tparameters.specularIntensityMap ? '#define USE_SPECULARINTENSITYMAP' : '',\n\t\t\tparameters.specularColorMap ? '#define USE_SPECULARCOLORMAP' : '',\n\n\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\n\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\n\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\n\n\t\t\tparameters.transmission ? '#define USE_TRANSMISSION' : '',\n\t\t\tparameters.transmissionMap ? '#define USE_TRANSMISSIONMAP' : '',\n\t\t\tparameters.thicknessMap ? '#define USE_THICKNESSMAP' : '',\n\n\t\t\tparameters.sheenColorMap ? '#define USE_SHEENCOLORMAP' : '',\n\t\t\tparameters.sheenRoughnessMap ? '#define USE_SHEENROUGHNESSMAP' : '',\n\n\t\t\tparameters.vertexTangents ? '#define USE_TANGENT' : '',\n\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\n\t\t\tparameters.vertexAlphas ? '#define USE_COLOR_ALPHA' : '',\n\t\t\tparameters.vertexUvs ? '#define USE_UV' : '',\n\t\t\tparameters.uvsVertexOnly ? '#define UVS_VERTEX_ONLY' : '',\n\n\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\n\n\t\t\tparameters.skinning ? '#define USE_SKINNING' : '',\n\t\t\tparameters.useVertexTexture ? '#define BONE_TEXTURE' : '',\n\n\t\t\tparameters.morphTargets ? '#define USE_MORPHTARGETS' : '',\n\t\t\tparameters.morphNormals && parameters.flatShading === false ? '#define USE_MORPHNORMALS' : '',\n\t\t\t( parameters.morphTargets && parameters.isWebGL2 ) ? '#define MORPHTARGETS_TEXTURE' : '',\n\t\t\t( parameters.morphTargets && parameters.isWebGL2 ) ? '#define MORPHTARGETS_COUNT ' + parameters.morphTargetsCount : '',\n\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\n\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\n\n\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\n\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\n\n\t\t\tparameters.sizeAttenuation ? '#define USE_SIZEATTENUATION' : '',\n\n\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\n\t\t\t( parameters.logarithmicDepthBuffer && parameters.rendererExtensionFragDepth ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\n\n\t\t\t'uniform mat4 modelMatrix;',\n\t\t\t'uniform mat4 modelViewMatrix;',\n\t\t\t'uniform mat4 projectionMatrix;',\n\t\t\t'uniform mat4 viewMatrix;',\n\t\t\t'uniform mat3 normalMatrix;',\n\t\t\t'uniform vec3 cameraPosition;',\n\t\t\t'uniform bool isOrthographic;',\n\n\t\t\t'#ifdef USE_INSTANCING',\n\n\t\t\t'\tattribute mat4 instanceMatrix;',\n\n\t\t\t'#endif',\n\n\t\t\t'#ifdef USE_INSTANCING_COLOR',\n\n\t\t\t'\tattribute vec3 instanceColor;',\n\n\t\t\t'#endif',\n\n\t\t\t'attribute vec3 position;',\n\t\t\t'attribute vec3 normal;',\n\t\t\t'attribute vec2 uv;',\n\n\t\t\t'#ifdef USE_TANGENT',\n\n\t\t\t'\tattribute vec4 tangent;',\n\n\t\t\t'#endif',\n\n\t\t\t'#if defined( USE_COLOR_ALPHA )',\n\n\t\t\t'\tattribute vec4 color;',\n\n\t\t\t'#elif defined( USE_COLOR )',\n\n\t\t\t'\tattribute vec3 color;',\n\n\t\t\t'#endif',\n\n\t\t\t'#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )',\n\n\t\t\t'\tattribute vec3 morphTarget0;',\n\t\t\t'\tattribute vec3 morphTarget1;',\n\t\t\t'\tattribute vec3 morphTarget2;',\n\t\t\t'\tattribute vec3 morphTarget3;',\n\n\t\t\t'\t#ifdef USE_MORPHNORMALS',\n\n\t\t\t'\t\tattribute vec3 morphNormal0;',\n\t\t\t'\t\tattribute vec3 morphNormal1;',\n\t\t\t'\t\tattribute vec3 morphNormal2;',\n\t\t\t'\t\tattribute vec3 morphNormal3;',\n\n\t\t\t'\t#else',\n\n\t\t\t'\t\tattribute vec3 morphTarget4;',\n\t\t\t'\t\tattribute vec3 morphTarget5;',\n\t\t\t'\t\tattribute vec3 morphTarget6;',\n\t\t\t'\t\tattribute vec3 morphTarget7;',\n\n\t\t\t'\t#endif',\n\n\t\t\t'#endif',\n\n\t\t\t'#ifdef USE_SKINNING',\n\n\t\t\t'\tattribute vec4 skinIndex;',\n\t\t\t'\tattribute vec4 skinWeight;',\n\n\t\t\t'#endif',\n\n\t\t\t'\\n'\n\n\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t\tprefixFragment = [\n\n\t\t\tcustomExtensions,\n\n\t\t\tgeneratePrecision( parameters ),\n\n\t\t\t'#define SHADER_NAME ' + parameters.shaderName,\n\n\t\t\tcustomDefines,\n\n\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\n\n\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\n\t\t\t( parameters.useFog && parameters.fogExp2 ) ? '#define FOG_EXP2' : '',\n\n\t\t\tparameters.map ? '#define USE_MAP' : '',\n\t\t\tparameters.matcap ? '#define USE_MATCAP' : '',\n\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\n\t\t\tparameters.envMap ? '#define ' + envMapTypeDefine : '',\n\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\n\t\t\tparameters.envMap ? '#define ' + envMapBlendingDefine : '',\n\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\n\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\n\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\n\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\n\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\n\t\t\t( parameters.normalMap && parameters.objectSpaceNormalMap ) ? '#define OBJECTSPACE_NORMALMAP' : '',\n\t\t\t( parameters.normalMap && parameters.tangentSpaceNormalMap ) ? '#define TANGENTSPACE_NORMALMAP' : '',\n\n\t\t\tparameters.clearcoat ? '#define USE_CLEARCOAT' : '',\n\t\t\tparameters.clearcoatMap ? '#define USE_CLEARCOATMAP' : '',\n\t\t\tparameters.clearcoatRoughnessMap ? '#define USE_CLEARCOAT_ROUGHNESSMAP' : '',\n\t\t\tparameters.clearcoatNormalMap ? '#define USE_CLEARCOAT_NORMALMAP' : '',\n\n\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\n\t\t\tparameters.specularIntensityMap ? '#define USE_SPECULARINTENSITYMAP' : '',\n\t\t\tparameters.specularColorMap ? '#define USE_SPECULARCOLORMAP' : '',\n\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\n\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\n\n\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\n\t\t\tparameters.alphaTest ? '#define USE_ALPHATEST' : '',\n\n\t\t\tparameters.sheen ? '#define USE_SHEEN' : '',\n\t\t\tparameters.sheenColorMap ? '#define USE_SHEENCOLORMAP' : '',\n\t\t\tparameters.sheenRoughnessMap ? '#define USE_SHEENROUGHNESSMAP' : '',\n\n\t\t\tparameters.transmission ? '#define USE_TRANSMISSION' : '',\n\t\t\tparameters.transmissionMap ? '#define USE_TRANSMISSIONMAP' : '',\n\t\t\tparameters.thicknessMap ? '#define USE_THICKNESSMAP' : '',\n\n\t\t\tparameters.vertexTangents ? '#define USE_TANGENT' : '',\n\t\t\tparameters.vertexColors || parameters.instancingColor ? '#define USE_COLOR' : '',\n\t\t\tparameters.vertexAlphas ? '#define USE_COLOR_ALPHA' : '',\n\t\t\tparameters.vertexUvs ? '#define USE_UV' : '',\n\t\t\tparameters.uvsVertexOnly ? '#define UVS_VERTEX_ONLY' : '',\n\n\t\t\tparameters.gradientMap ? '#define USE_GRADIENTMAP' : '',\n\n\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\n\n\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\n\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\n\n\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\n\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\n\n\t\t\tparameters.premultipliedAlpha ? '#define PREMULTIPLIED_ALPHA' : '',\n\n\t\t\tparameters.physicallyCorrectLights ? '#define PHYSICALLY_CORRECT_LIGHTS' : '',\n\n\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\n\t\t\t( parameters.logarithmicDepthBuffer && parameters.rendererExtensionFragDepth ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\n\n\t\t\t( ( parameters.extensionShaderTextureLOD || parameters.envMap ) && parameters.rendererExtensionShaderTextureLod ) ? '#define TEXTURE_LOD_EXT' : '',\n\n\t\t\t'uniform mat4 viewMatrix;',\n\t\t\t'uniform vec3 cameraPosition;',\n\t\t\t'uniform bool isOrthographic;',\n\n\t\t\t( parameters.toneMapping !== NoToneMapping ) ? '#define TONE_MAPPING' : '',\n\t\t\t( parameters.toneMapping !== NoToneMapping ) ? ShaderChunk[ 'tonemapping_pars_fragment' ] : '', // this code is required here because it is used by the toneMapping() function defined below\n\t\t\t( parameters.toneMapping !== NoToneMapping ) ? getToneMappingFunction( 'toneMapping', parameters.toneMapping ) : '',\n\n\t\t\tparameters.dithering ? '#define DITHERING' : '',\n\t\t\tparameters.format === RGBFormat ? '#define OPAQUE' : '',\n\n\t\t\tShaderChunk[ 'encodings_pars_fragment' ], // this code is required here because it is used by the various encoding/decoding function defined below\n\t\t\tparameters.map ? getTexelDecodingFunction( 'mapTexelToLinear', parameters.mapEncoding ) : '',\n\t\t\tparameters.matcap ? getTexelDecodingFunction( 'matcapTexelToLinear', parameters.matcapEncoding ) : '',\n\t\t\tparameters.envMap ? getTexelDecodingFunction( 'envMapTexelToLinear', parameters.envMapEncoding ) : '',\n\t\t\tparameters.emissiveMap ? getTexelDecodingFunction( 'emissiveMapTexelToLinear', parameters.emissiveMapEncoding ) : '',\n\t\t\tparameters.specularColorMap ? getTexelDecodingFunction( 'specularColorMapTexelToLinear', parameters.specularColorMapEncoding ) : '',\n\t\t\tparameters.sheenColorMap ? getTexelDecodingFunction( 'sheenColorMapTexelToLinear', parameters.sheenColorMapEncoding ) : '',\n\t\t\tparameters.lightMap ? getTexelDecodingFunction( 'lightMapTexelToLinear', parameters.lightMapEncoding ) : '',\n\t\t\tgetTexelEncodingFunction( 'linearToOutputTexel', parameters.outputEncoding ),\n\n\t\t\tparameters.depthPacking ? '#define DEPTH_PACKING ' + parameters.depthPacking : '',\n\n\t\t\t'\\n'\n\n\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t}\n\n\tvertexShader = resolveIncludes( vertexShader );\n\tvertexShader = replaceLightNums( vertexShader, parameters );\n\tvertexShader = replaceClippingPlaneNums( vertexShader, parameters );\n\n\tfragmentShader = resolveIncludes( fragmentShader );\n\tfragmentShader = replaceLightNums( fragmentShader, parameters );\n\tfragmentShader = replaceClippingPlaneNums( fragmentShader, parameters );\n\n\tvertexShader = unrollLoops( vertexShader );\n\tfragmentShader = unrollLoops( fragmentShader );\n\n\tif ( parameters.isWebGL2 && parameters.isRawShaderMaterial !== true ) {\n\n\t\t// GLSL 3.0 conversion for built-in materials and ShaderMaterial\n\n\t\tversionString = '#version 300 es\\n';\n\n\t\tprefixVertex = [\n\t\t\t'precision mediump sampler2DArray;',\n\t\t\t'#define attribute in',\n\t\t\t'#define varying out',\n\t\t\t'#define texture2D texture'\n\t\t].join( '\\n' ) + '\\n' + prefixVertex;\n\n\t\tprefixFragment = [\n\t\t\t'#define varying in',\n\t\t\t( parameters.glslVersion === GLSL3 ) ? '' : 'out highp vec4 pc_fragColor;',\n\t\t\t( parameters.glslVersion === GLSL3 ) ? '' : '#define gl_FragColor pc_fragColor',\n\t\t\t'#define gl_FragDepthEXT gl_FragDepth',\n\t\t\t'#define texture2D texture',\n\t\t\t'#define textureCube texture',\n\t\t\t'#define texture2DProj textureProj',\n\t\t\t'#define texture2DLodEXT textureLod',\n\t\t\t'#define texture2DProjLodEXT textureProjLod',\n\t\t\t'#define textureCubeLodEXT textureLod',\n\t\t\t'#define texture2DGradEXT textureGrad',\n\t\t\t'#define texture2DProjGradEXT textureProjGrad',\n\t\t\t'#define textureCubeGradEXT textureGrad'\n\t\t].join( '\\n' ) + '\\n' + prefixFragment;\n\n\t}\n\n\tconst vertexGlsl = versionString + prefixVertex + vertexShader;\n\tconst fragmentGlsl = versionString + prefixFragment + fragmentShader;\n\n\t// console.log( '*VERTEX*', vertexGlsl );\n\t// console.log( '*FRAGMENT*', fragmentGlsl );\n\n\tconst glVertexShader = WebGLShader( gl, gl.VERTEX_SHADER, vertexGlsl );\n\tconst glFragmentShader = WebGLShader( gl, gl.FRAGMENT_SHADER, fragmentGlsl );\n\n\tgl.attachShader( program, glVertexShader );\n\tgl.attachShader( program, glFragmentShader );\n\n\t// Force a particular attribute to index 0.\n\n\tif ( parameters.index0AttributeName !== undefined ) {\n\n\t\tgl.bindAttribLocation( program, 0, parameters.index0AttributeName );\n\n\t} else if ( parameters.morphTargets === true ) {\n\n\t\t// programs with morphTargets displace position out of attribute 0\n\t\tgl.bindAttribLocation( program, 0, 'position' );\n\n\t}\n\n\tgl.linkProgram( program );\n\n\t// check for link errors\n\tif ( renderer.debug.checkShaderErrors ) {\n\n\t\tconst programLog = gl.getProgramInfoLog( program ).trim();\n\t\tconst vertexLog = gl.getShaderInfoLog( glVertexShader ).trim();\n\t\tconst fragmentLog = gl.getShaderInfoLog( glFragmentShader ).trim();\n\n\t\tlet runnable = true;\n\t\tlet haveDiagnostics = true;\n\n\t\tif ( gl.getProgramParameter( program, gl.LINK_STATUS ) === false ) {\n\n\t\t\trunnable = false;\n\n\t\t\tconst vertexErrors = getShaderErrors( gl, glVertexShader, 'vertex' );\n\t\t\tconst fragmentErrors = getShaderErrors( gl, glFragmentShader, 'fragment' );\n\n\t\t\tconsole.error(\n\t\t\t\t'THREE.WebGLProgram: Shader Error ' + gl.getError() + ' - ' +\n\t\t\t\t'VALIDATE_STATUS ' + gl.getProgramParameter( program, gl.VALIDATE_STATUS ) + '\\n\\n' +\n\t\t\t\t'Program Info Log: ' + programLog + '\\n' +\n\t\t\t\tvertexErrors + '\\n' +\n\t\t\t\tfragmentErrors\n\t\t\t);\n\n\t\t} else if ( programLog !== '' ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLProgram: Program Info Log:', programLog );\n\n\t\t} else if ( vertexLog === '' || fragmentLog === '' ) {\n\n\t\t\thaveDiagnostics = false;\n\n\t\t}\n\n\t\tif ( haveDiagnostics ) {\n\n\t\t\tthis.diagnostics = {\n\n\t\t\t\trunnable: runnable,\n\n\t\t\t\tprogramLog: programLog,\n\n\t\t\t\tvertexShader: {\n\n\t\t\t\t\tlog: vertexLog,\n\t\t\t\t\tprefix: prefixVertex\n\n\t\t\t\t},\n\n\t\t\t\tfragmentShader: {\n\n\t\t\t\t\tlog: fragmentLog,\n\t\t\t\t\tprefix: prefixFragment\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t}\n\n\t// Clean up\n\n\t// Crashes in iOS9 and iOS10. #18402\n\t// gl.detachShader( program, glVertexShader );\n\t// gl.detachShader( program, glFragmentShader );\n\n\tgl.deleteShader( glVertexShader );\n\tgl.deleteShader( glFragmentShader );\n\n\t// set up caching for uniform locations\n\n\tlet cachedUniforms;\n\n\tthis.getUniforms = function () {\n\n\t\tif ( cachedUniforms === undefined ) {\n\n\t\t\tcachedUniforms = new WebGLUniforms( gl, program );\n\n\t\t}\n\n\t\treturn cachedUniforms;\n\n\t};\n\n\t// set up caching for attribute locations\n\n\tlet cachedAttributes;\n\n\tthis.getAttributes = function () {\n\n\t\tif ( cachedAttributes === undefined ) {\n\n\t\t\tcachedAttributes = fetchAttributeLocations( gl, program );\n\n\t\t}\n\n\t\treturn cachedAttributes;\n\n\t};\n\n\t// free resource\n\n\tthis.destroy = function () {\n\n\t\tbindingStates.releaseStatesOfProgram( this );\n\n\t\tgl.deleteProgram( program );\n\t\tthis.program = undefined;\n\n\t};\n\n\t//\n\n\tthis.name = parameters.shaderName;\n\tthis.id = programIdCount ++;\n\tthis.cacheKey = cacheKey;\n\tthis.usedTimes = 1;\n\tthis.program = program;\n\tthis.vertexShader = glVertexShader;\n\tthis.fragmentShader = glFragmentShader;\n\n\treturn this;\n\n}\n\nexport { WebGLProgram };\n","import { BackSide, DoubleSide, CubeUVRefractionMapping, CubeUVReflectionMapping, LinearEncoding, sRGBEncoding, ObjectSpaceNormalMap, TangentSpaceNormalMap, NoToneMapping, RGBAFormat, UnsignedByteType } from '../../constants.js';\nimport { WebGLProgram } from './WebGLProgram.js';\nimport { ShaderLib } from '../shaders/ShaderLib.js';\nimport { UniformsUtils } from '../shaders/UniformsUtils.js';\nimport { hashString } from '../../utils.js';\n\nfunction WebGLPrograms( renderer, cubemaps, cubeuvmaps, extensions, capabilities, bindingStates, clipping ) {\n\n\tconst programs = [];\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\tconst logarithmicDepthBuffer = capabilities.logarithmicDepthBuffer;\n\tconst floatVertexTextures = capabilities.floatVertexTextures;\n\tconst maxVertexUniforms = capabilities.maxVertexUniforms;\n\tconst vertexTextures = capabilities.vertexTextures;\n\n\tlet precision = capabilities.precision;\n\n\tconst shaderIDs = {\n\t\tMeshDepthMaterial: 'depth',\n\t\tMeshDistanceMaterial: 'distanceRGBA',\n\t\tMeshNormalMaterial: 'normal',\n\t\tMeshBasicMaterial: 'basic',\n\t\tMeshLambertMaterial: 'lambert',\n\t\tMeshPhongMaterial: 'phong',\n\t\tMeshToonMaterial: 'toon',\n\t\tMeshStandardMaterial: 'physical',\n\t\tMeshPhysicalMaterial: 'physical',\n\t\tMeshMatcapMaterial: 'matcap',\n\t\tLineBasicMaterial: 'basic',\n\t\tLineDashedMaterial: 'dashed',\n\t\tPointsMaterial: 'points',\n\t\tShadowMaterial: 'shadow',\n\t\tSpriteMaterial: 'sprite'\n\t};\n\n\tconst parameterNames = [\n\t\t'precision', 'isWebGL2', 'supportsVertexTextures', 'outputEncoding', 'instancing', 'instancingColor',\n\t\t'map', 'mapEncoding', 'matcap', 'matcapEncoding', 'envMap', 'envMapMode', 'envMapEncoding', 'envMapCubeUV',\n\t\t'lightMap', 'lightMapEncoding', 'aoMap', 'emissiveMap', 'emissiveMapEncoding', 'bumpMap', 'normalMap',\n\t\t'objectSpaceNormalMap', 'tangentSpaceNormalMap',\n\t\t'clearcoat', 'clearcoatMap', 'clearcoatRoughnessMap', 'clearcoatNormalMap',\n\t\t'displacementMap', 'specularMap', , 'roughnessMap', 'metalnessMap', 'gradientMap',\n\t\t'alphaMap', 'alphaTest', 'combine', 'vertexColors', 'vertexAlphas', 'vertexTangents', 'vertexUvs', 'uvsVertexOnly', 'fog', 'useFog', 'fogExp2',\n\t\t'flatShading', 'sizeAttenuation', 'logarithmicDepthBuffer', 'skinning',\n\t\t'maxBones', 'useVertexTexture', 'morphTargets', 'morphNormals', 'morphTargetsCount', 'premultipliedAlpha',\n\t\t'numDirLights', 'numPointLights', 'numSpotLights', 'numHemiLights', 'numRectAreaLights',\n\t\t'numDirLightShadows', 'numPointLightShadows', 'numSpotLightShadows',\n\t\t'shadowMapEnabled', 'shadowMapType', 'toneMapping', 'physicallyCorrectLights',\n\t\t'doubleSided', 'flipSided', 'numClippingPlanes', 'numClipIntersection', 'depthPacking', 'dithering', 'format',\n\t\t'specularIntensityMap', 'specularColorMap', 'specularColorMapEncoding',\n\t\t'transmission', 'transmissionMap', 'thicknessMap',\n\t\t'sheen', 'sheenColorMap', 'sheenColorMapEncoding', 'sheenRoughnessMap'\n\t];\n\n\tfunction getMaxBones( object ) {\n\n\t\tconst skeleton = object.skeleton;\n\t\tconst bones = skeleton.bones;\n\n\t\tif ( floatVertexTextures ) {\n\n\t\t\treturn 1024;\n\n\t\t} else {\n\n\t\t\t// default for when object is not specified\n\t\t\t// ( for example when prebuilding shader to be used with multiple objects )\n\t\t\t//\n\t\t\t//  - leave some extra space for other uniforms\n\t\t\t//  - limit here is ANGLE's 254 max uniform vectors\n\t\t\t//    (up to 54 should be safe)\n\n\t\t\tconst nVertexUniforms = maxVertexUniforms;\n\t\t\tconst nVertexMatrices = Math.floor( ( nVertexUniforms - 20 ) / 4 );\n\n\t\t\tconst maxBones = Math.min( nVertexMatrices, bones.length );\n\n\t\t\tif ( maxBones < bones.length ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Skeleton has ' + bones.length + ' bones. This GPU supports ' + maxBones + '.' );\n\t\t\t\treturn 0;\n\n\t\t\t}\n\n\t\t\treturn maxBones;\n\n\t\t}\n\n\t}\n\n\tfunction getTextureEncodingFromMap( map ) {\n\n\t\tlet encoding;\n\n\t\tif ( map && map.isTexture ) {\n\n\t\t\tencoding = map.encoding;\n\n\t\t} else if ( map && map.isWebGLRenderTarget ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLPrograms.getTextureEncodingFromMap: don\\'t use render targets as textures. Use their .texture property instead.' );\n\t\t\tencoding = map.texture.encoding;\n\n\t\t} else {\n\n\t\t\tencoding = LinearEncoding;\n\n\t\t}\n\n\t\tif ( isWebGL2 && map && map.isTexture && map.format === RGBAFormat && map.type === UnsignedByteType && map.encoding === sRGBEncoding ) {\n\n\t\t\tencoding = LinearEncoding; // disable inline decode for sRGB textures in WebGL 2\n\n\t\t}\n\n\t\treturn encoding;\n\n\t}\n\n\tfunction getParameters( material, lights, shadows, scene, object ) {\n\n\t\tconst fog = scene.fog;\n\t\tconst environment = material.isMeshStandardMaterial ? scene.environment : null;\n\n\t\tconst envMap = ( material.isMeshStandardMaterial ? cubeuvmaps : cubemaps ).get( material.envMap || environment );\n\n\t\tconst shaderID = shaderIDs[ material.type ];\n\n\t\t// heuristics to create shader parameters according to lights in the scene\n\t\t// (not to blow over maxLights budget)\n\n\t\tconst maxBones = object.isSkinnedMesh ? getMaxBones( object ) : 0;\n\n\t\tif ( material.precision !== null ) {\n\n\t\t\tprecision = capabilities.getMaxPrecision( material.precision );\n\n\t\t\tif ( precision !== material.precision ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLProgram.getParameters:', material.precision, 'not supported, using', precision, 'instead.' );\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet vertexShader, fragmentShader;\n\n\t\tif ( shaderID ) {\n\n\t\t\tconst shader = ShaderLib[ shaderID ];\n\n\t\t\tvertexShader = shader.vertexShader;\n\t\t\tfragmentShader = shader.fragmentShader;\n\n\t\t} else {\n\n\t\t\tvertexShader = material.vertexShader;\n\t\t\tfragmentShader = material.fragmentShader;\n\n\t\t}\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\tconst useAlphaTest = material.alphaTest > 0;\n\t\tconst useClearcoat = material.clearcoat > 0;\n\n\t\tconst parameters = {\n\n\t\t\tisWebGL2: isWebGL2,\n\n\t\t\tshaderID: shaderID,\n\t\t\tshaderName: material.type,\n\n\t\t\tvertexShader: vertexShader,\n\t\t\tfragmentShader: fragmentShader,\n\t\t\tdefines: material.defines,\n\n\t\t\tisRawShaderMaterial: material.isRawShaderMaterial === true,\n\t\t\tglslVersion: material.glslVersion,\n\n\t\t\tprecision: precision,\n\n\t\t\tinstancing: object.isInstancedMesh === true,\n\t\t\tinstancingColor: object.isInstancedMesh === true && object.instanceColor !== null,\n\n\t\t\tsupportsVertexTextures: vertexTextures,\n\t\t\toutputEncoding: ( currentRenderTarget !== null ) ? getTextureEncodingFromMap( currentRenderTarget.texture ) : renderer.outputEncoding,\n\t\t\tmap: !! material.map,\n\t\t\tmapEncoding: getTextureEncodingFromMap( material.map ),\n\t\t\tmatcap: !! material.matcap,\n\t\t\tmatcapEncoding: getTextureEncodingFromMap( material.matcap ),\n\t\t\tenvMap: !! envMap,\n\t\t\tenvMapMode: envMap && envMap.mapping,\n\t\t\tenvMapEncoding: getTextureEncodingFromMap( envMap ),\n\t\t\tenvMapCubeUV: ( !! envMap ) && ( ( envMap.mapping === CubeUVReflectionMapping ) || ( envMap.mapping === CubeUVRefractionMapping ) ),\n\t\t\tlightMap: !! material.lightMap,\n\t\t\tlightMapEncoding: getTextureEncodingFromMap( material.lightMap ),\n\t\t\taoMap: !! material.aoMap,\n\t\t\temissiveMap: !! material.emissiveMap,\n\t\t\temissiveMapEncoding: getTextureEncodingFromMap( material.emissiveMap ),\n\t\t\tbumpMap: !! material.bumpMap,\n\t\t\tnormalMap: !! material.normalMap,\n\t\t\tobjectSpaceNormalMap: material.normalMapType === ObjectSpaceNormalMap,\n\t\t\ttangentSpaceNormalMap: material.normalMapType === TangentSpaceNormalMap,\n\n\t\t\tclearcoat: useClearcoat,\n\t\t\tclearcoatMap: useClearcoat && !! material.clearcoatMap,\n\t\t\tclearcoatRoughnessMap: useClearcoat && !! material.clearcoatRoughnessMap,\n\t\t\tclearcoatNormalMap: useClearcoat && !! material.clearcoatNormalMap,\n\n\t\t\tdisplacementMap: !! material.displacementMap,\n\t\t\troughnessMap: !! material.roughnessMap,\n\t\t\tmetalnessMap: !! material.metalnessMap,\n\t\t\tspecularMap: !! material.specularMap,\n\t\t\tspecularIntensityMap: !! material.specularIntensityMap,\n\t\t\tspecularColorMap: !! material.specularColorMap,\n\t\t\tspecularColorMapEncoding: getTextureEncodingFromMap( material.specularColorMap ),\n\n\t\t\talphaMap: !! material.alphaMap,\n\t\t\talphaTest: useAlphaTest,\n\n\t\t\tgradientMap: !! material.gradientMap,\n\n\t\t\tsheen: material.sheen > 0,\n\t\t\tsheenColorMap: !! material.sheenColorMap,\n\t\t\tsheenColorMapEncoding: getTextureEncodingFromMap( material.sheenColorMap ),\n\t\t\tsheenRoughnessMap: !! material.sheenRoughnessMap,\n\n\t\t\ttransmission: material.transmission > 0,\n\t\t\ttransmissionMap: !! material.transmissionMap,\n\t\t\tthicknessMap: !! material.thicknessMap,\n\n\t\t\tcombine: material.combine,\n\n\t\t\tvertexTangents: ( !! material.normalMap && !! object.geometry && !! object.geometry.attributes.tangent ),\n\t\t\tvertexColors: material.vertexColors,\n\t\t\tvertexAlphas: material.vertexColors === true && !! object.geometry && !! object.geometry.attributes.color && object.geometry.attributes.color.itemSize === 4,\n\t\t\tvertexUvs: !! material.map || !! material.bumpMap || !! material.normalMap || !! material.specularMap || !! material.alphaMap || !! material.emissiveMap || !! material.roughnessMap || !! material.metalnessMap || !! material.clearcoatMap || !! material.clearcoatRoughnessMap || !! material.clearcoatNormalMap || !! material.displacementMap || !! material.transmissionMap || !! material.thicknessMap || !! material.specularIntensityMap || !! material.specularColorMap || !! material.sheenColorMap || material.sheenRoughnessMap,\n\t\t\tuvsVertexOnly: ! ( !! material.map || !! material.bumpMap || !! material.normalMap || !! material.specularMap || !! material.alphaMap || !! material.emissiveMap || !! material.roughnessMap || !! material.metalnessMap || !! material.clearcoatNormalMap || material.transmission > 0 || !! material.transmissionMap || !! material.thicknessMap || !! material.specularIntensityMap || !! material.specularColorMap || !! material.sheen > 0 || !! material.sheenColorMap || !! material.sheenRoughnessMap ) && !! material.displacementMap,\n\n\t\t\tfog: !! fog,\n\t\t\tuseFog: material.fog,\n\t\t\tfogExp2: ( fog && fog.isFogExp2 ),\n\n\t\t\tflatShading: !! material.flatShading,\n\n\t\t\tsizeAttenuation: material.sizeAttenuation,\n\t\t\tlogarithmicDepthBuffer: logarithmicDepthBuffer,\n\n\t\t\tskinning: object.isSkinnedMesh === true && maxBones > 0,\n\t\t\tmaxBones: maxBones,\n\t\t\tuseVertexTexture: floatVertexTextures,\n\n\t\t\tmorphTargets: !! object.geometry && !! object.geometry.morphAttributes.position,\n\t\t\tmorphNormals: !! object.geometry && !! object.geometry.morphAttributes.normal,\n\t\t\tmorphTargetsCount: ( !! object.geometry && !! object.geometry.morphAttributes.position ) ? object.geometry.morphAttributes.position.length : 0,\n\n\t\t\tnumDirLights: lights.directional.length,\n\t\t\tnumPointLights: lights.point.length,\n\t\t\tnumSpotLights: lights.spot.length,\n\t\t\tnumRectAreaLights: lights.rectArea.length,\n\t\t\tnumHemiLights: lights.hemi.length,\n\n\t\t\tnumDirLightShadows: lights.directionalShadowMap.length,\n\t\t\tnumPointLightShadows: lights.pointShadowMap.length,\n\t\t\tnumSpotLightShadows: lights.spotShadowMap.length,\n\n\t\t\tnumClippingPlanes: clipping.numPlanes,\n\t\t\tnumClipIntersection: clipping.numIntersection,\n\n\t\t\tformat: material.format,\n\t\t\tdithering: material.dithering,\n\n\t\t\tshadowMapEnabled: renderer.shadowMap.enabled && shadows.length > 0,\n\t\t\tshadowMapType: renderer.shadowMap.type,\n\n\t\t\ttoneMapping: material.toneMapped ? renderer.toneMapping : NoToneMapping,\n\t\t\tphysicallyCorrectLights: renderer.physicallyCorrectLights,\n\n\t\t\tpremultipliedAlpha: material.premultipliedAlpha,\n\n\t\t\tdoubleSided: material.side === DoubleSide,\n\t\t\tflipSided: material.side === BackSide,\n\n\t\t\tdepthPacking: ( material.depthPacking !== undefined ) ? material.depthPacking : false,\n\n\t\t\tindex0AttributeName: material.index0AttributeName,\n\n\t\t\textensionDerivatives: material.extensions && material.extensions.derivatives,\n\t\t\textensionFragDepth: material.extensions && material.extensions.fragDepth,\n\t\t\textensionDrawBuffers: material.extensions && material.extensions.drawBuffers,\n\t\t\textensionShaderTextureLOD: material.extensions && material.extensions.shaderTextureLOD,\n\n\t\t\trendererExtensionFragDepth: isWebGL2 || extensions.has( 'EXT_frag_depth' ),\n\t\t\trendererExtensionDrawBuffers: isWebGL2 || extensions.has( 'WEBGL_draw_buffers' ),\n\t\t\trendererExtensionShaderTextureLod: isWebGL2 || extensions.has( 'EXT_shader_texture_lod' ),\n\n\t\t\tcustomProgramCacheKey: material.customProgramCacheKey()\n\n\t\t};\n\n\t\treturn parameters;\n\n\t}\n\n\tfunction getProgramCacheKey( parameters ) {\n\n\t\tconst array = [];\n\n\t\tif ( parameters.shaderID ) {\n\n\t\t\tarray.push( parameters.shaderID );\n\n\t\t} else {\n\n\t\t\tarray.push( hashString( parameters.fragmentShader ) );\n\t\t\tarray.push( hashString( parameters.vertexShader ) );\n\n\t\t}\n\n\t\tif ( parameters.defines !== undefined ) {\n\n\t\t\tfor ( const name in parameters.defines ) {\n\n\t\t\t\tarray.push( name );\n\t\t\t\tarray.push( parameters.defines[ name ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( parameters.isRawShaderMaterial === false ) {\n\n\t\t\tfor ( let i = 0; i < parameterNames.length; i ++ ) {\n\n\t\t\t\tarray.push( parameters[ parameterNames[ i ] ] );\n\n\t\t\t}\n\n\t\t\tarray.push( renderer.outputEncoding );\n\t\t\tarray.push( renderer.gammaFactor );\n\n\t\t}\n\n\t\tarray.push( parameters.customProgramCacheKey );\n\n\t\treturn array.join();\n\n\t}\n\n\tfunction getUniforms( material ) {\n\n\t\tconst shaderID = shaderIDs[ material.type ];\n\t\tlet uniforms;\n\n\t\tif ( shaderID ) {\n\n\t\t\tconst shader = ShaderLib[ shaderID ];\n\t\t\tuniforms = UniformsUtils.clone( shader.uniforms );\n\n\t\t} else {\n\n\t\t\tuniforms = material.uniforms;\n\n\t\t}\n\n\t\treturn uniforms;\n\n\t}\n\n\tfunction acquireProgram( parameters, cacheKey ) {\n\n\t\tlet program;\n\n\t\t// Check if code has been already compiled\n\t\tfor ( let p = 0, pl = programs.length; p < pl; p ++ ) {\n\n\t\t\tconst preexistingProgram = programs[ p ];\n\n\t\t\tif ( preexistingProgram.cacheKey === cacheKey ) {\n\n\t\t\t\tprogram = preexistingProgram;\n\t\t\t\t++ program.usedTimes;\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( program === undefined ) {\n\n\t\t\tprogram = new WebGLProgram( renderer, cacheKey, parameters, bindingStates );\n\t\t\tprograms.push( program );\n\n\t\t}\n\n\t\treturn program;\n\n\t}\n\n\tfunction releaseProgram( program ) {\n\n\t\tif ( -- program.usedTimes === 0 ) {\n\n\t\t\t// Remove from unordered set\n\t\t\tconst i = programs.indexOf( program );\n\t\t\tprograms[ i ] = programs[ programs.length - 1 ];\n\t\t\tprograms.pop();\n\n\t\t\t// Free WebGL resources\n\t\t\tprogram.destroy();\n\n\t\t}\n\n\t}\n\n\treturn {\n\t\tgetParameters: getParameters,\n\t\tgetProgramCacheKey: getProgramCacheKey,\n\t\tgetUniforms: getUniforms,\n\t\tacquireProgram: acquireProgram,\n\t\treleaseProgram: releaseProgram,\n\t\t// Exposed for resource monitoring & error feedback via renderer.info:\n\t\tprograms: programs\n\t};\n\n}\n\n\nexport { WebGLPrograms };\n","function WebGLProperties() {\n\n\tlet properties = new WeakMap();\n\n\tfunction get( object ) {\n\n\t\tlet map = properties.get( object );\n\n\t\tif ( map === undefined ) {\n\n\t\t\tmap = {};\n\t\t\tproperties.set( object, map );\n\n\t\t}\n\n\t\treturn map;\n\n\t}\n\n\tfunction remove( object ) {\n\n\t\tproperties.delete( object );\n\n\t}\n\n\tfunction update( object, key, value ) {\n\n\t\tproperties.get( object )[ key ] = value;\n\n\t}\n\n\tfunction dispose() {\n\n\t\tproperties = new WeakMap();\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tremove: remove,\n\t\tupdate: update,\n\t\tdispose: dispose\n\t};\n\n}\n\n\nexport { WebGLProperties };\n","function painterSortStable( a, b ) {\n\n\tif ( a.groupOrder !== b.groupOrder ) {\n\n\t\treturn a.groupOrder - b.groupOrder;\n\n\t} else if ( a.renderOrder !== b.renderOrder ) {\n\n\t\treturn a.renderOrder - b.renderOrder;\n\n\t} else if ( a.program !== b.program ) {\n\n\t\treturn a.program.id - b.program.id;\n\n\t} else if ( a.material.id !== b.material.id ) {\n\n\t\treturn a.material.id - b.material.id;\n\n\t} else if ( a.z !== b.z ) {\n\n\t\treturn a.z - b.z;\n\n\t} else {\n\n\t\treturn a.id - b.id;\n\n\t}\n\n}\n\nfunction reversePainterSortStable( a, b ) {\n\n\tif ( a.groupOrder !== b.groupOrder ) {\n\n\t\treturn a.groupOrder - b.groupOrder;\n\n\t} else if ( a.renderOrder !== b.renderOrder ) {\n\n\t\treturn a.renderOrder - b.renderOrder;\n\n\t} else if ( a.z !== b.z ) {\n\n\t\treturn b.z - a.z;\n\n\t} else {\n\n\t\treturn a.id - b.id;\n\n\t}\n\n}\n\n\nfunction WebGLRenderList( properties ) {\n\n\tconst renderItems = [];\n\tlet renderItemsIndex = 0;\n\n\tconst opaque = [];\n\tconst transmissive = [];\n\tconst transparent = [];\n\n\tconst defaultProgram = { id: - 1 };\n\n\tfunction init() {\n\n\t\trenderItemsIndex = 0;\n\n\t\topaque.length = 0;\n\t\ttransmissive.length = 0;\n\t\ttransparent.length = 0;\n\n\t}\n\n\tfunction getNextRenderItem( object, geometry, material, groupOrder, z, group ) {\n\n\t\tlet renderItem = renderItems[ renderItemsIndex ];\n\t\tconst materialProperties = properties.get( material );\n\n\t\tif ( renderItem === undefined ) {\n\n\t\t\trenderItem = {\n\t\t\t\tid: object.id,\n\t\t\t\tobject: object,\n\t\t\t\tgeometry: geometry,\n\t\t\t\tmaterial: material,\n\t\t\t\tprogram: materialProperties.program || defaultProgram,\n\t\t\t\tgroupOrder: groupOrder,\n\t\t\t\trenderOrder: object.renderOrder,\n\t\t\t\tz: z,\n\t\t\t\tgroup: group\n\t\t\t};\n\n\t\t\trenderItems[ renderItemsIndex ] = renderItem;\n\n\t\t} else {\n\n\t\t\trenderItem.id = object.id;\n\t\t\trenderItem.object = object;\n\t\t\trenderItem.geometry = geometry;\n\t\t\trenderItem.material = material;\n\t\t\trenderItem.program = materialProperties.program || defaultProgram;\n\t\t\trenderItem.groupOrder = groupOrder;\n\t\t\trenderItem.renderOrder = object.renderOrder;\n\t\t\trenderItem.z = z;\n\t\t\trenderItem.group = group;\n\n\t\t}\n\n\t\trenderItemsIndex ++;\n\n\t\treturn renderItem;\n\n\t}\n\n\tfunction push( object, geometry, material, groupOrder, z, group ) {\n\n\t\tconst renderItem = getNextRenderItem( object, geometry, material, groupOrder, z, group );\n\n\t\tif ( material.transmission > 0.0 ) {\n\n\t\t\ttransmissive.push( renderItem );\n\n\t\t} else if ( material.transparent === true ) {\n\n\t\t\ttransparent.push( renderItem );\n\n\t\t} else {\n\n\t\t\topaque.push( renderItem );\n\n\t\t}\n\n\t}\n\n\tfunction unshift( object, geometry, material, groupOrder, z, group ) {\n\n\t\tconst renderItem = getNextRenderItem( object, geometry, material, groupOrder, z, group );\n\n\t\tif ( material.transmission > 0.0 ) {\n\n\t\t\ttransmissive.unshift( renderItem );\n\n\t\t} else if ( material.transparent === true ) {\n\n\t\t\ttransparent.unshift( renderItem );\n\n\t\t} else {\n\n\t\t\topaque.unshift( renderItem );\n\n\t\t}\n\n\t}\n\n\tfunction sort( customOpaqueSort, customTransparentSort ) {\n\n\t\tif ( opaque.length > 1 ) opaque.sort( customOpaqueSort || painterSortStable );\n\t\tif ( transmissive.length > 1 ) transmissive.sort( customTransparentSort || reversePainterSortStable );\n\t\tif ( transparent.length > 1 ) transparent.sort( customTransparentSort || reversePainterSortStable );\n\n\t}\n\n\tfunction finish() {\n\n\t\t// Clear references from inactive renderItems in the list\n\n\t\tfor ( let i = renderItemsIndex, il = renderItems.length; i < il; i ++ ) {\n\n\t\t\tconst renderItem = renderItems[ i ];\n\n\t\t\tif ( renderItem.id === null ) break;\n\n\t\t\trenderItem.id = null;\n\t\t\trenderItem.object = null;\n\t\t\trenderItem.geometry = null;\n\t\t\trenderItem.material = null;\n\t\t\trenderItem.program = null;\n\t\t\trenderItem.group = null;\n\n\t\t}\n\n\t}\n\n\treturn {\n\n\t\topaque: opaque,\n\t\ttransmissive: transmissive,\n\t\ttransparent: transparent,\n\n\t\tinit: init,\n\t\tpush: push,\n\t\tunshift: unshift,\n\t\tfinish: finish,\n\n\t\tsort: sort\n\t};\n\n}\n\nfunction WebGLRenderLists( properties ) {\n\n\tlet lists = new WeakMap();\n\n\tfunction get( scene, renderCallDepth ) {\n\n\t\tlet list;\n\n\t\tif ( lists.has( scene ) === false ) {\n\n\t\t\tlist = new WebGLRenderList( properties );\n\t\t\tlists.set( scene, [ list ] );\n\n\t\t} else {\n\n\t\t\tif ( renderCallDepth >= lists.get( scene ).length ) {\n\n\t\t\t\tlist = new WebGLRenderList( properties );\n\t\t\t\tlists.get( scene ).push( list );\n\n\t\t\t} else {\n\n\t\t\t\tlist = lists.get( scene )[ renderCallDepth ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn list;\n\n\t}\n\n\tfunction dispose() {\n\n\t\tlists = new WeakMap();\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tdispose: dispose\n\t};\n\n}\n\n\nexport { WebGLRenderLists, WebGLRenderList };\n","import { Color } from '../../math/Color.js';\nimport { Matrix4 } from '../../math/Matrix4.js';\nimport { Vector2 } from '../../math/Vector2.js';\nimport { Vector3 } from '../../math/Vector3.js';\nimport { UniformsLib } from '../shaders/UniformsLib.js';\n\nfunction UniformsCache() {\n\n\tconst lights = {};\n\n\treturn {\n\n\t\tget: function ( light ) {\n\n\t\t\tif ( lights[ light.id ] !== undefined ) {\n\n\t\t\t\treturn lights[ light.id ];\n\n\t\t\t}\n\n\t\t\tlet uniforms;\n\n\t\t\tswitch ( light.type ) {\n\n\t\t\t\tcase 'DirectionalLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tdirection: new Vector3(),\n\t\t\t\t\t\tcolor: new Color()\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'SpotLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tposition: new Vector3(),\n\t\t\t\t\t\tdirection: new Vector3(),\n\t\t\t\t\t\tcolor: new Color(),\n\t\t\t\t\t\tdistance: 0,\n\t\t\t\t\t\tconeCos: 0,\n\t\t\t\t\t\tpenumbraCos: 0,\n\t\t\t\t\t\tdecay: 0\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'PointLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tposition: new Vector3(),\n\t\t\t\t\t\tcolor: new Color(),\n\t\t\t\t\t\tdistance: 0,\n\t\t\t\t\t\tdecay: 0\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'HemisphereLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tdirection: new Vector3(),\n\t\t\t\t\t\tskyColor: new Color(),\n\t\t\t\t\t\tgroundColor: new Color()\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'RectAreaLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tcolor: new Color(),\n\t\t\t\t\t\tposition: new Vector3(),\n\t\t\t\t\t\thalfWidth: new Vector3(),\n\t\t\t\t\t\thalfHeight: new Vector3()\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tlights[ light.id ] = uniforms;\n\n\t\t\treturn uniforms;\n\n\t\t}\n\n\t};\n\n}\n\nfunction ShadowUniformsCache() {\n\n\tconst lights = {};\n\n\treturn {\n\n\t\tget: function ( light ) {\n\n\t\t\tif ( lights[ light.id ] !== undefined ) {\n\n\t\t\t\treturn lights[ light.id ];\n\n\t\t\t}\n\n\t\t\tlet uniforms;\n\n\t\t\tswitch ( light.type ) {\n\n\t\t\t\tcase 'DirectionalLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tshadowBias: 0,\n\t\t\t\t\t\tshadowNormalBias: 0,\n\t\t\t\t\t\tshadowRadius: 1,\n\t\t\t\t\t\tshadowMapSize: new Vector2()\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'SpotLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tshadowBias: 0,\n\t\t\t\t\t\tshadowNormalBias: 0,\n\t\t\t\t\t\tshadowRadius: 1,\n\t\t\t\t\t\tshadowMapSize: new Vector2()\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'PointLight':\n\t\t\t\t\tuniforms = {\n\t\t\t\t\t\tshadowBias: 0,\n\t\t\t\t\t\tshadowNormalBias: 0,\n\t\t\t\t\t\tshadowRadius: 1,\n\t\t\t\t\t\tshadowMapSize: new Vector2(),\n\t\t\t\t\t\tshadowCameraNear: 1,\n\t\t\t\t\t\tshadowCameraFar: 1000\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\t// TODO (abelnation): set RectAreaLight shadow uniforms\n\n\t\t\t}\n\n\t\t\tlights[ light.id ] = uniforms;\n\n\t\t\treturn uniforms;\n\n\t\t}\n\n\t};\n\n}\n\n\n\nlet nextVersion = 0;\n\nfunction shadowCastingLightsFirst( lightA, lightB ) {\n\n\treturn ( lightB.castShadow ? 1 : 0 ) - ( lightA.castShadow ? 1 : 0 );\n\n}\n\nfunction WebGLLights( extensions, capabilities ) {\n\n\tconst cache = new UniformsCache();\n\n\tconst shadowCache = ShadowUniformsCache();\n\n\tconst state = {\n\n\t\tversion: 0,\n\n\t\thash: {\n\t\t\tdirectionalLength: - 1,\n\t\t\tpointLength: - 1,\n\t\t\tspotLength: - 1,\n\t\t\trectAreaLength: - 1,\n\t\t\themiLength: - 1,\n\n\t\t\tnumDirectionalShadows: - 1,\n\t\t\tnumPointShadows: - 1,\n\t\t\tnumSpotShadows: - 1\n\t\t},\n\n\t\tambient: [ 0, 0, 0 ],\n\t\tprobe: [],\n\t\tdirectional: [],\n\t\tdirectionalShadow: [],\n\t\tdirectionalShadowMap: [],\n\t\tdirectionalShadowMatrix: [],\n\t\tspot: [],\n\t\tspotShadow: [],\n\t\tspotShadowMap: [],\n\t\tspotShadowMatrix: [],\n\t\trectArea: [],\n\t\trectAreaLTC1: null,\n\t\trectAreaLTC2: null,\n\t\tpoint: [],\n\t\tpointShadow: [],\n\t\tpointShadowMap: [],\n\t\tpointShadowMatrix: [],\n\t\themi: []\n\n\t};\n\n\tfor ( let i = 0; i < 9; i ++ ) state.probe.push( new Vector3() );\n\n\tconst vector3 = new Vector3();\n\tconst matrix4 = new Matrix4();\n\tconst matrix42 = new Matrix4();\n\n\tfunction setup( lights, physicallyCorrectLights ) {\n\n\t\tlet r = 0, g = 0, b = 0;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) state.probe[ i ].set( 0, 0, 0 );\n\n\t\tlet directionalLength = 0;\n\t\tlet pointLength = 0;\n\t\tlet spotLength = 0;\n\t\tlet rectAreaLength = 0;\n\t\tlet hemiLength = 0;\n\n\t\tlet numDirectionalShadows = 0;\n\t\tlet numPointShadows = 0;\n\t\tlet numSpotShadows = 0;\n\n\t\tlights.sort( shadowCastingLightsFirst );\n\n\t\t// artist-friendly light intensity scaling factor\n\t\tconst scaleFactor = ( physicallyCorrectLights !== true ) ? Math.PI : 1;\n\n\t\tfor ( let i = 0, l = lights.length; i < l; i ++ ) {\n\n\t\t\tconst light = lights[ i ];\n\n\t\t\tconst color = light.color;\n\t\t\tconst intensity = light.intensity;\n\t\t\tconst distance = light.distance;\n\n\t\t\tconst shadowMap = ( light.shadow && light.shadow.map ) ? light.shadow.map.texture : null;\n\n\t\t\tif ( light.isAmbientLight ) {\n\n\t\t\t\tr += color.r * intensity * scaleFactor;\n\t\t\t\tg += color.g * intensity * scaleFactor;\n\t\t\t\tb += color.b * intensity * scaleFactor;\n\n\t\t\t} else if ( light.isLightProbe ) {\n\n\t\t\t\tfor ( let j = 0; j < 9; j ++ ) {\n\n\t\t\t\t\tstate.probe[ j ].addScaledVector( light.sh.coefficients[ j ], intensity );\n\n\t\t\t\t}\n\n\t\t\t} else if ( light.isDirectionalLight ) {\n\n\t\t\t\tconst uniforms = cache.get( light );\n\n\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity * scaleFactor );\n\n\t\t\t\tif ( light.castShadow ) {\n\n\t\t\t\t\tconst shadow = light.shadow;\n\n\t\t\t\t\tconst shadowUniforms = shadowCache.get( light );\n\n\t\t\t\t\tshadowUniforms.shadowBias = shadow.bias;\n\t\t\t\t\tshadowUniforms.shadowNormalBias = shadow.normalBias;\n\t\t\t\t\tshadowUniforms.shadowRadius = shadow.radius;\n\t\t\t\t\tshadowUniforms.shadowMapSize = shadow.mapSize;\n\n\t\t\t\t\tstate.directionalShadow[ directionalLength ] = shadowUniforms;\n\t\t\t\t\tstate.directionalShadowMap[ directionalLength ] = shadowMap;\n\t\t\t\t\tstate.directionalShadowMatrix[ directionalLength ] = light.shadow.matrix;\n\n\t\t\t\t\tnumDirectionalShadows ++;\n\n\t\t\t\t}\n\n\t\t\t\tstate.directional[ directionalLength ] = uniforms;\n\n\t\t\t\tdirectionalLength ++;\n\n\t\t\t} else if ( light.isSpotLight ) {\n\n\t\t\t\tconst uniforms = cache.get( light );\n\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\n\n\t\t\t\tuniforms.color.copy( color ).multiplyScalar( intensity * scaleFactor );\n\t\t\t\tuniforms.distance = distance;\n\n\t\t\t\tuniforms.coneCos = Math.cos( light.angle );\n\t\t\t\tuniforms.penumbraCos = Math.cos( light.angle * ( 1 - light.penumbra ) );\n\t\t\t\tuniforms.decay = light.decay;\n\n\t\t\t\tif ( light.castShadow ) {\n\n\t\t\t\t\tconst shadow = light.shadow;\n\n\t\t\t\t\tconst shadowUniforms = shadowCache.get( light );\n\n\t\t\t\t\tshadowUniforms.shadowBias = shadow.bias;\n\t\t\t\t\tshadowUniforms.shadowNormalBias = shadow.normalBias;\n\t\t\t\t\tshadowUniforms.shadowRadius = shadow.radius;\n\t\t\t\t\tshadowUniforms.shadowMapSize = shadow.mapSize;\n\n\t\t\t\t\tstate.spotShadow[ spotLength ] = shadowUniforms;\n\t\t\t\t\tstate.spotShadowMap[ spotLength ] = shadowMap;\n\t\t\t\t\tstate.spotShadowMatrix[ spotLength ] = light.shadow.matrix;\n\n\t\t\t\t\tnumSpotShadows ++;\n\n\t\t\t\t}\n\n\t\t\t\tstate.spot[ spotLength ] = uniforms;\n\n\t\t\t\tspotLength ++;\n\n\t\t\t} else if ( light.isRectAreaLight ) {\n\n\t\t\t\tconst uniforms = cache.get( light );\n\n\t\t\t\t// (a) intensity is the total visible light emitted\n\t\t\t\t//uniforms.color.copy( color ).multiplyScalar( intensity / ( light.width * light.height * Math.PI ) );\n\n\t\t\t\t// (b) intensity is the brightness of the light\n\t\t\t\tuniforms.color.copy( color ).multiplyScalar( intensity );\n\n\t\t\t\tuniforms.halfWidth.set( light.width * 0.5, 0.0, 0.0 );\n\t\t\t\tuniforms.halfHeight.set( 0.0, light.height * 0.5, 0.0 );\n\n\t\t\t\tstate.rectArea[ rectAreaLength ] = uniforms;\n\n\t\t\t\trectAreaLength ++;\n\n\t\t\t} else if ( light.isPointLight ) {\n\n\t\t\t\tconst uniforms = cache.get( light );\n\n\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity * scaleFactor );\n\t\t\t\tuniforms.distance = light.distance;\n\t\t\t\tuniforms.decay = light.decay;\n\n\t\t\t\tif ( light.castShadow ) {\n\n\t\t\t\t\tconst shadow = light.shadow;\n\n\t\t\t\t\tconst shadowUniforms = shadowCache.get( light );\n\n\t\t\t\t\tshadowUniforms.shadowBias = shadow.bias;\n\t\t\t\t\tshadowUniforms.shadowNormalBias = shadow.normalBias;\n\t\t\t\t\tshadowUniforms.shadowRadius = shadow.radius;\n\t\t\t\t\tshadowUniforms.shadowMapSize = shadow.mapSize;\n\t\t\t\t\tshadowUniforms.shadowCameraNear = shadow.camera.near;\n\t\t\t\t\tshadowUniforms.shadowCameraFar = shadow.camera.far;\n\n\t\t\t\t\tstate.pointShadow[ pointLength ] = shadowUniforms;\n\t\t\t\t\tstate.pointShadowMap[ pointLength ] = shadowMap;\n\t\t\t\t\tstate.pointShadowMatrix[ pointLength ] = light.shadow.matrix;\n\n\t\t\t\t\tnumPointShadows ++;\n\n\t\t\t\t}\n\n\t\t\t\tstate.point[ pointLength ] = uniforms;\n\n\t\t\t\tpointLength ++;\n\n\t\t\t} else if ( light.isHemisphereLight ) {\n\n\t\t\t\tconst uniforms = cache.get( light );\n\n\t\t\t\tuniforms.skyColor.copy( light.color ).multiplyScalar( intensity * scaleFactor );\n\t\t\t\tuniforms.groundColor.copy( light.groundColor ).multiplyScalar( intensity * scaleFactor );\n\n\t\t\t\tstate.hemi[ hemiLength ] = uniforms;\n\n\t\t\t\themiLength ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( rectAreaLength > 0 ) {\n\n\t\t\tif ( capabilities.isWebGL2 ) {\n\n\t\t\t\t// WebGL 2\n\n\t\t\t\tstate.rectAreaLTC1 = UniformsLib.LTC_FLOAT_1;\n\t\t\t\tstate.rectAreaLTC2 = UniformsLib.LTC_FLOAT_2;\n\n\t\t\t} else {\n\n\t\t\t\t// WebGL 1\n\n\t\t\t\tif ( extensions.has( 'OES_texture_float_linear' ) === true ) {\n\n\t\t\t\t\tstate.rectAreaLTC1 = UniformsLib.LTC_FLOAT_1;\n\t\t\t\t\tstate.rectAreaLTC2 = UniformsLib.LTC_FLOAT_2;\n\n\t\t\t\t} else if ( extensions.has( 'OES_texture_half_float_linear' ) === true ) {\n\n\t\t\t\t\tstate.rectAreaLTC1 = UniformsLib.LTC_HALF_1;\n\t\t\t\t\tstate.rectAreaLTC2 = UniformsLib.LTC_HALF_2;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.ambient[ 0 ] = r;\n\t\tstate.ambient[ 1 ] = g;\n\t\tstate.ambient[ 2 ] = b;\n\n\t\tconst hash = state.hash;\n\n\t\tif ( hash.directionalLength !== directionalLength ||\n\t\t\thash.pointLength !== pointLength ||\n\t\t\thash.spotLength !== spotLength ||\n\t\t\thash.rectAreaLength !== rectAreaLength ||\n\t\t\thash.hemiLength !== hemiLength ||\n\t\t\thash.numDirectionalShadows !== numDirectionalShadows ||\n\t\t\thash.numPointShadows !== numPointShadows ||\n\t\t\thash.numSpotShadows !== numSpotShadows ) {\n\n\t\t\tstate.directional.length = directionalLength;\n\t\t\tstate.spot.length = spotLength;\n\t\t\tstate.rectArea.length = rectAreaLength;\n\t\t\tstate.point.length = pointLength;\n\t\t\tstate.hemi.length = hemiLength;\n\n\t\t\tstate.directionalShadow.length = numDirectionalShadows;\n\t\t\tstate.directionalShadowMap.length = numDirectionalShadows;\n\t\t\tstate.pointShadow.length = numPointShadows;\n\t\t\tstate.pointShadowMap.length = numPointShadows;\n\t\t\tstate.spotShadow.length = numSpotShadows;\n\t\t\tstate.spotShadowMap.length = numSpotShadows;\n\t\t\tstate.directionalShadowMatrix.length = numDirectionalShadows;\n\t\t\tstate.pointShadowMatrix.length = numPointShadows;\n\t\t\tstate.spotShadowMatrix.length = numSpotShadows;\n\n\t\t\thash.directionalLength = directionalLength;\n\t\t\thash.pointLength = pointLength;\n\t\t\thash.spotLength = spotLength;\n\t\t\thash.rectAreaLength = rectAreaLength;\n\t\t\thash.hemiLength = hemiLength;\n\n\t\t\thash.numDirectionalShadows = numDirectionalShadows;\n\t\t\thash.numPointShadows = numPointShadows;\n\t\t\thash.numSpotShadows = numSpotShadows;\n\n\t\t\tstate.version = nextVersion ++;\n\n\t\t}\n\n\t}\n\n\tfunction setupView( lights, camera ) {\n\n\t\tlet directionalLength = 0;\n\t\tlet pointLength = 0;\n\t\tlet spotLength = 0;\n\t\tlet rectAreaLength = 0;\n\t\tlet hemiLength = 0;\n\n\t\tconst viewMatrix = camera.matrixWorldInverse;\n\n\t\tfor ( let i = 0, l = lights.length; i < l; i ++ ) {\n\n\t\t\tconst light = lights[ i ];\n\n\t\t\tif ( light.isDirectionalLight ) {\n\n\t\t\t\tconst uniforms = state.directional[ directionalLength ];\n\n\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tvector3.setFromMatrixPosition( light.target.matrixWorld );\n\t\t\t\tuniforms.direction.sub( vector3 );\n\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\n\n\t\t\t\tdirectionalLength ++;\n\n\t\t\t} else if ( light.isSpotLight ) {\n\n\t\t\t\tconst uniforms = state.spot[ spotLength ];\n\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\n\n\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tvector3.setFromMatrixPosition( light.target.matrixWorld );\n\t\t\t\tuniforms.direction.sub( vector3 );\n\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\n\n\t\t\t\tspotLength ++;\n\n\t\t\t} else if ( light.isRectAreaLight ) {\n\n\t\t\t\tconst uniforms = state.rectArea[ rectAreaLength ];\n\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\n\n\t\t\t\t// extract local rotation of light to derive width/height half vectors\n\t\t\t\tmatrix42.identity();\n\t\t\t\tmatrix4.copy( light.matrixWorld );\n\t\t\t\tmatrix4.premultiply( viewMatrix );\n\t\t\t\tmatrix42.extractRotation( matrix4 );\n\n\t\t\t\tuniforms.halfWidth.set( light.width * 0.5, 0.0, 0.0 );\n\t\t\t\tuniforms.halfHeight.set( 0.0, light.height * 0.5, 0.0 );\n\n\t\t\t\tuniforms.halfWidth.applyMatrix4( matrix42 );\n\t\t\t\tuniforms.halfHeight.applyMatrix4( matrix42 );\n\n\t\t\t\trectAreaLength ++;\n\n\t\t\t} else if ( light.isPointLight ) {\n\n\t\t\t\tconst uniforms = state.point[ pointLength ];\n\n\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\n\n\t\t\t\tpointLength ++;\n\n\t\t\t} else if ( light.isHemisphereLight ) {\n\n\t\t\t\tconst uniforms = state.hemi[ hemiLength ];\n\n\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\n\t\t\t\tuniforms.direction.normalize();\n\n\t\t\t\themiLength ++;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn {\n\t\tsetup: setup,\n\t\tsetupView: setupView,\n\t\tstate: state\n\t};\n\n}\n\n\nexport { WebGLLights };\n","import { WebGLLights } from './WebGLLights.js';\n\nfunction WebGLRenderState( extensions, capabilities ) {\n\n\tconst lights = new WebGLLights( extensions, capabilities );\n\n\tconst lightsArray = [];\n\tconst shadowsArray = [];\n\n\tfunction init() {\n\n\t\tlightsArray.length = 0;\n\t\tshadowsArray.length = 0;\n\n\t}\n\n\tfunction pushLight( light ) {\n\n\t\tlightsArray.push( light );\n\n\t}\n\n\tfunction pushShadow( shadowLight ) {\n\n\t\tshadowsArray.push( shadowLight );\n\n\t}\n\n\tfunction setupLights( physicallyCorrectLights ) {\n\n\t\tlights.setup( lightsArray, physicallyCorrectLights );\n\n\t}\n\n\tfunction setupLightsView( camera ) {\n\n\t\tlights.setupView( lightsArray, camera );\n\n\t}\n\n\tconst state = {\n\t\tlightsArray: lightsArray,\n\t\tshadowsArray: shadowsArray,\n\n\t\tlights: lights\n\t};\n\n\treturn {\n\t\tinit: init,\n\t\tstate: state,\n\t\tsetupLights: setupLights,\n\t\tsetupLightsView: setupLightsView,\n\n\t\tpushLight: pushLight,\n\t\tpushShadow: pushShadow\n\t};\n\n}\n\nfunction WebGLRenderStates( extensions, capabilities ) {\n\n\tlet renderStates = new WeakMap();\n\n\tfunction get( scene, renderCallDepth = 0 ) {\n\n\t\tlet renderState;\n\n\t\tif ( renderStates.has( scene ) === false ) {\n\n\t\t\trenderState = new WebGLRenderState( extensions, capabilities );\n\t\t\trenderStates.set( scene, [ renderState ] );\n\n\t\t} else {\n\n\t\t\tif ( renderCallDepth >= renderStates.get( scene ).length ) {\n\n\t\t\t\trenderState = new WebGLRenderState( extensions, capabilities );\n\t\t\t\trenderStates.get( scene ).push( renderState );\n\n\t\t\t} else {\n\n\t\t\t\trenderState = renderStates.get( scene )[ renderCallDepth ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn renderState;\n\n\t}\n\n\tfunction dispose() {\n\n\t\trenderStates = new WeakMap();\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tdispose: dispose\n\t};\n\n}\n\n\nexport { WebGLRenderStates };\n","import { Material } from './Material.js';\nimport { BasicDepthPacking } from '../constants.js';\n\n/**\n * parameters = {\n *\n *  opacity: <float>,\n *\n *  map: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  displacementMap: new THREE.Texture( <Image> ),\n *  displacementScale: <float>,\n *  displacementBias: <float>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>\n * }\n */\n\nclass MeshDepthMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshDepthMaterial';\n\n\t\tthis.depthPacking = BasicDepthPacking;\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.fog = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.depthPacking = source.depthPacking;\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshDepthMaterial.prototype.isMeshDepthMaterial = true;\n\nexport { MeshDepthMaterial };\n","import { Material } from './Material.js';\nimport { Vector3 } from '../math/Vector3.js';\n\n/**\n * parameters = {\n *\n *  referencePosition: <float>,\n *  nearDistance: <float>,\n *  farDistance: <float>,\n *\n *  map: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  displacementMap: new THREE.Texture( <Image> ),\n *  displacementScale: <float>,\n *  displacementBias: <float>\n *\n * }\n */\n\nclass MeshDistanceMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshDistanceMaterial';\n\n\t\tthis.referencePosition = new Vector3();\n\t\tthis.nearDistance = 1;\n\t\tthis.farDistance = 1000;\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.fog = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.referencePosition.copy( source.referencePosition );\n\t\tthis.nearDistance = source.nearDistance;\n\t\tthis.farDistance = source.farDistance;\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshDistanceMaterial.prototype.isMeshDistanceMaterial = true;\n\nexport { MeshDistanceMaterial };\n","import { FrontSide, BackSide, DoubleSide, RGBAFormat, NearestFilter, LinearFilter, PCFShadowMap, VSMShadowMap, RGBADepthPacking, NoBlending } from '../../constants.js';\nimport { WebGLRenderTarget } from '../WebGLRenderTarget.js';\nimport { MeshDepthMaterial } from '../../materials/MeshDepthMaterial.js';\nimport { MeshDistanceMaterial } from '../../materials/MeshDistanceMaterial.js';\nimport { ShaderMaterial } from '../../materials/ShaderMaterial.js';\nimport { BufferAttribute } from '../../core/BufferAttribute.js';\nimport { BufferGeometry } from '../../core/BufferGeometry.js';\nimport { Mesh } from '../../objects/Mesh.js';\nimport { Vector4 } from '../../math/Vector4.js';\nimport { Vector2 } from '../../math/Vector2.js';\nimport { Frustum } from '../../math/Frustum.js';\n\nimport * as vsm from '../shaders/ShaderLib/vsm.glsl.js';\n\nfunction WebGLShadowMap( _renderer, _objects, _capabilities ) {\n\n\tlet _frustum = new Frustum();\n\n\tconst _shadowMapSize = new Vector2(),\n\t\t_viewportSize = new Vector2(),\n\n\t\t_viewport = new Vector4(),\n\n\t\t_depthMaterial = new MeshDepthMaterial( { depthPacking: RGBADepthPacking } ),\n\t\t_distanceMaterial = new MeshDistanceMaterial(),\n\n\t\t_materialCache = {},\n\n\t\t_maxTextureSize = _capabilities.maxTextureSize;\n\n\tconst shadowSide = { 0: BackSide, 1: FrontSide, 2: DoubleSide };\n\n\tconst shadowMaterialVertical = new ShaderMaterial( {\n\t\tdefines: {\n\t\t\tVSM_SAMPLES: 8\n\t\t},\n\t\tuniforms: {\n\t\t\tshadow_pass: { value: null },\n\t\t\tresolution: { value: new Vector2() },\n\t\t\tradius: { value: 4.0 }\n\t\t},\n\n\t\tvertexShader: vsm.vertex,\n\t\tfragmentShader: vsm.fragment\n\n\t} );\n\n\tconst shadowMaterialHorizontal = shadowMaterialVertical.clone();\n\tshadowMaterialHorizontal.defines.HORIZONTAL_PASS = 1;\n\n\tconst fullScreenTri = new BufferGeometry();\n\tfullScreenTri.setAttribute(\n\t\t'position',\n\t\tnew BufferAttribute(\n\t\t\tnew Float32Array( [ - 1, - 1, 0.5, 3, - 1, 0.5, - 1, 3, 0.5 ] ),\n\t\t\t3\n\t\t)\n\t);\n\n\tconst fullScreenMesh = new Mesh( fullScreenTri, shadowMaterialVertical );\n\n\tconst scope = this;\n\n\tthis.enabled = false;\n\n\tthis.autoUpdate = true;\n\tthis.needsUpdate = false;\n\n\tthis.type = PCFShadowMap;\n\n\tthis.render = function ( lights, scene, camera ) {\n\n\t\tif ( scope.enabled === false ) return;\n\t\tif ( scope.autoUpdate === false && scope.needsUpdate === false ) return;\n\n\t\tif ( lights.length === 0 ) return;\n\n\t\tconst currentRenderTarget = _renderer.getRenderTarget();\n\t\tconst activeCubeFace = _renderer.getActiveCubeFace();\n\t\tconst activeMipmapLevel = _renderer.getActiveMipmapLevel();\n\n\t\tconst _state = _renderer.state;\n\n\t\t// Set GL state for depth map.\n\t\t_state.setBlending( NoBlending );\n\t\t_state.buffers.color.setClear( 1, 1, 1, 1 );\n\t\t_state.buffers.depth.setTest( true );\n\t\t_state.setScissorTest( false );\n\n\t\t// render depth map\n\n\t\tfor ( let i = 0, il = lights.length; i < il; i ++ ) {\n\n\t\t\tconst light = lights[ i ];\n\t\t\tconst shadow = light.shadow;\n\n\t\t\tif ( shadow === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLShadowMap:', light, 'has no shadow.' );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tif ( shadow.autoUpdate === false && shadow.needsUpdate === false ) continue;\n\n\t\t\t_shadowMapSize.copy( shadow.mapSize );\n\n\t\t\tconst shadowFrameExtents = shadow.getFrameExtents();\n\n\t\t\t_shadowMapSize.multiply( shadowFrameExtents );\n\n\t\t\t_viewportSize.copy( shadow.mapSize );\n\n\t\t\tif ( _shadowMapSize.x > _maxTextureSize || _shadowMapSize.y > _maxTextureSize ) {\n\n\t\t\t\tif ( _shadowMapSize.x > _maxTextureSize ) {\n\n\t\t\t\t\t_viewportSize.x = Math.floor( _maxTextureSize / shadowFrameExtents.x );\n\t\t\t\t\t_shadowMapSize.x = _viewportSize.x * shadowFrameExtents.x;\n\t\t\t\t\tshadow.mapSize.x = _viewportSize.x;\n\n\t\t\t\t}\n\n\t\t\t\tif ( _shadowMapSize.y > _maxTextureSize ) {\n\n\t\t\t\t\t_viewportSize.y = Math.floor( _maxTextureSize / shadowFrameExtents.y );\n\t\t\t\t\t_shadowMapSize.y = _viewportSize.y * shadowFrameExtents.y;\n\t\t\t\t\tshadow.mapSize.y = _viewportSize.y;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( shadow.map === null && ! shadow.isPointLightShadow && this.type === VSMShadowMap ) {\n\n\t\t\t\tconst pars = { minFilter: LinearFilter, magFilter: LinearFilter, format: RGBAFormat };\n\n\t\t\t\tshadow.map = new WebGLRenderTarget( _shadowMapSize.x, _shadowMapSize.y, pars );\n\t\t\t\tshadow.map.texture.name = light.name + '.shadowMap';\n\n\t\t\t\tshadow.mapPass = new WebGLRenderTarget( _shadowMapSize.x, _shadowMapSize.y, pars );\n\n\t\t\t\tshadow.camera.updateProjectionMatrix();\n\n\t\t\t}\n\n\t\t\tif ( shadow.map === null ) {\n\n\t\t\t\tconst pars = { minFilter: NearestFilter, magFilter: NearestFilter, format: RGBAFormat };\n\n\t\t\t\tshadow.map = new WebGLRenderTarget( _shadowMapSize.x, _shadowMapSize.y, pars );\n\t\t\t\tshadow.map.texture.name = light.name + '.shadowMap';\n\n\t\t\t\tshadow.camera.updateProjectionMatrix();\n\n\t\t\t}\n\n\t\t\t_renderer.setRenderTarget( shadow.map );\n\t\t\t_renderer.clear();\n\n\t\t\tconst viewportCount = shadow.getViewportCount();\n\n\t\t\tfor ( let vp = 0; vp < viewportCount; vp ++ ) {\n\n\t\t\t\tconst viewport = shadow.getViewport( vp );\n\n\t\t\t\t_viewport.set(\n\t\t\t\t\t_viewportSize.x * viewport.x,\n\t\t\t\t\t_viewportSize.y * viewport.y,\n\t\t\t\t\t_viewportSize.x * viewport.z,\n\t\t\t\t\t_viewportSize.y * viewport.w\n\t\t\t\t);\n\n\t\t\t\t_state.viewport( _viewport );\n\n\t\t\t\tshadow.updateMatrices( light, vp );\n\n\t\t\t\t_frustum = shadow.getFrustum();\n\n\t\t\t\trenderObject( scene, camera, shadow.camera, light, this.type );\n\n\t\t\t}\n\n\t\t\t// do blur pass for VSM\n\n\t\t\tif ( ! shadow.isPointLightShadow && this.type === VSMShadowMap ) {\n\n\t\t\t\tVSMPass( shadow, camera );\n\n\t\t\t}\n\n\t\t\tshadow.needsUpdate = false;\n\n\t\t}\n\n\t\tscope.needsUpdate = false;\n\n\t\t_renderer.setRenderTarget( currentRenderTarget, activeCubeFace, activeMipmapLevel );\n\n\t};\n\n\tfunction VSMPass( shadow, camera ) {\n\n\t\tconst geometry = _objects.update( fullScreenMesh );\n\n\t\tif ( shadowMaterialVertical.defines.VSM_SAMPLES !== shadow.blurSamples ) {\n\n\t\t\tshadowMaterialVertical.defines.VSM_SAMPLES = shadow.blurSamples;\n\t\t\tshadowMaterialHorizontal.defines.VSM_SAMPLES = shadow.blurSamples;\n\n\t\t\tshadowMaterialVertical.needsUpdate = true;\n\t\t\tshadowMaterialHorizontal.needsUpdate = true;\n\n\t\t}\n\n\t\t// vertical pass\n\n\t\tshadowMaterialVertical.uniforms.shadow_pass.value = shadow.map.texture;\n\t\tshadowMaterialVertical.uniforms.resolution.value = shadow.mapSize;\n\t\tshadowMaterialVertical.uniforms.radius.value = shadow.radius;\n\t\t_renderer.setRenderTarget( shadow.mapPass );\n\t\t_renderer.clear();\n\t\t_renderer.renderBufferDirect( camera, null, geometry, shadowMaterialVertical, fullScreenMesh, null );\n\n\t\t// horizontal pass\n\n\t\tshadowMaterialHorizontal.uniforms.shadow_pass.value = shadow.mapPass.texture;\n\t\tshadowMaterialHorizontal.uniforms.resolution.value = shadow.mapSize;\n\t\tshadowMaterialHorizontal.uniforms.radius.value = shadow.radius;\n\t\t_renderer.setRenderTarget( shadow.map );\n\t\t_renderer.clear();\n\t\t_renderer.renderBufferDirect( camera, null, geometry, shadowMaterialHorizontal, fullScreenMesh, null );\n\n\t}\n\n\tfunction getDepthMaterial( object, geometry, material, light, shadowCameraNear, shadowCameraFar, type ) {\n\n\t\tlet result = null;\n\n\t\tconst customMaterial = ( light.isPointLight === true ) ? object.customDistanceMaterial : object.customDepthMaterial;\n\n\t\tif ( customMaterial !== undefined ) {\n\n\t\t\tresult = customMaterial;\n\n\t\t} else {\n\n\t\t\tresult = ( light.isPointLight === true ) ? _distanceMaterial : _depthMaterial;\n\n\t\t}\n\n\t\tif ( ( _renderer.localClippingEnabled && material.clipShadows === true && material.clippingPlanes.length !== 0 ) ||\n\t\t\t( material.displacementMap && material.displacementScale !== 0 ) ||\n\t\t\t( material.alphaMap && material.alphaTest > 0 ) ) {\n\n\t\t\t// in this case we need a unique material instance reflecting the\n\t\t\t// appropriate state\n\n\t\t\tconst keyA = result.uuid, keyB = material.uuid;\n\n\t\t\tlet materialsForVariant = _materialCache[ keyA ];\n\n\t\t\tif ( materialsForVariant === undefined ) {\n\n\t\t\t\tmaterialsForVariant = {};\n\t\t\t\t_materialCache[ keyA ] = materialsForVariant;\n\n\t\t\t}\n\n\t\t\tlet cachedMaterial = materialsForVariant[ keyB ];\n\n\t\t\tif ( cachedMaterial === undefined ) {\n\n\t\t\t\tcachedMaterial = result.clone();\n\t\t\t\tmaterialsForVariant[ keyB ] = cachedMaterial;\n\n\t\t\t}\n\n\t\t\tresult = cachedMaterial;\n\n\t\t}\n\n\t\tresult.visible = material.visible;\n\t\tresult.wireframe = material.wireframe;\n\n\t\tif ( type === VSMShadowMap ) {\n\n\t\t\tresult.side = ( material.shadowSide !== null ) ? material.shadowSide : material.side;\n\n\t\t} else {\n\n\t\t\tresult.side = ( material.shadowSide !== null ) ? material.shadowSide : shadowSide[ material.side ];\n\n\t\t}\n\n\t\tresult.alphaMap = material.alphaMap;\n\t\tresult.alphaTest = material.alphaTest;\n\n\t\tresult.clipShadows = material.clipShadows;\n\t\tresult.clippingPlanes = material.clippingPlanes;\n\t\tresult.clipIntersection = material.clipIntersection;\n\n\t\tresult.displacementMap = material.displacementMap;\n\t\tresult.displacementScale = material.displacementScale;\n\t\tresult.displacementBias = material.displacementBias;\n\n\t\tresult.wireframeLinewidth = material.wireframeLinewidth;\n\t\tresult.linewidth = material.linewidth;\n\n\t\tif ( light.isPointLight === true && result.isMeshDistanceMaterial === true ) {\n\n\t\t\tresult.referencePosition.setFromMatrixPosition( light.matrixWorld );\n\t\t\tresult.nearDistance = shadowCameraNear;\n\t\t\tresult.farDistance = shadowCameraFar;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tfunction renderObject( object, camera, shadowCamera, light, type ) {\n\n\t\tif ( object.visible === false ) return;\n\n\t\tconst visible = object.layers.test( camera.layers );\n\n\t\tif ( visible && ( object.isMesh || object.isLine || object.isPoints ) ) {\n\n\t\t\tif ( ( object.castShadow || ( object.receiveShadow && type === VSMShadowMap ) ) && ( ! object.frustumCulled || _frustum.intersectsObject( object ) ) ) {\n\n\t\t\t\tobject.modelViewMatrix.multiplyMatrices( shadowCamera.matrixWorldInverse, object.matrixWorld );\n\n\t\t\t\tconst geometry = _objects.update( object );\n\t\t\t\tconst material = object.material;\n\n\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\tconst groups = geometry.groups;\n\n\t\t\t\t\tfor ( let k = 0, kl = groups.length; k < kl; k ++ ) {\n\n\t\t\t\t\t\tconst group = groups[ k ];\n\t\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\t\tif ( groupMaterial && groupMaterial.visible ) {\n\n\t\t\t\t\t\t\tconst depthMaterial = getDepthMaterial( object, geometry, groupMaterial, light, shadowCamera.near, shadowCamera.far, type );\n\n\t\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, group );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( material.visible ) {\n\n\t\t\t\t\tconst depthMaterial = getDepthMaterial( object, geometry, material, light, shadowCamera.near, shadowCamera.far, type );\n\n\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, null );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\trenderObject( children[ i ], camera, shadowCamera, light, type );\n\n\t\t}\n\n\t}\n\n}\n\n\nexport { WebGLShadowMap };\n","export const vertex = /* glsl */`\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n`;\n\nexport const fragment = /* glsl */`\nuniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n\n#include <packing>\n\nvoid main() {\n\n\tconst float samples = float( VSM_SAMPLES );\n\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\n\t// This seems totally useless but it's a crazy work around for a Adreno compiler bug\n\t// float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\n\t\t#ifdef HORIZONTAL_PASS\n\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\n\t\t#else\n\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\n\t\t#endif\n\n\t}\n\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n\n}\n`;\n","import { NotEqualDepth, GreaterDepth, GreaterEqualDepth, EqualDepth, LessEqualDepth, LessDepth, AlwaysDepth, NeverDepth, CullFaceFront, CullFaceBack, CullFaceNone, DoubleSide, BackSide, CustomBlending, MultiplyBlending, SubtractiveBlending, AdditiveBlending, NoBlending, NormalBlending, AddEquation, SubtractEquation, ReverseSubtractEquation, MinEquation, MaxEquation, ZeroFactor, OneFactor, SrcColorFactor, SrcAlphaFactor, SrcAlphaSaturateFactor, DstColorFactor, DstAlphaFactor, OneMinusSrcColorFactor, OneMinusSrcAlphaFactor, OneMinusDstColorFactor, OneMinusDstAlphaFactor } from '../../constants.js';\nimport { Vector4 } from '../../math/Vector4.js';\n\nfunction WebGLState( gl, extensions, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tfunction ColorBuffer() {\n\n\t\tlet locked = false;\n\n\t\tconst color = new Vector4();\n\t\tlet currentColorMask = null;\n\t\tconst currentColorClear = new Vector4( 0, 0, 0, 0 );\n\n\t\treturn {\n\n\t\t\tsetMask: function ( colorMask ) {\n\n\t\t\t\tif ( currentColorMask !== colorMask && ! locked ) {\n\n\t\t\t\t\tgl.colorMask( colorMask, colorMask, colorMask, colorMask );\n\t\t\t\t\tcurrentColorMask = colorMask;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetLocked: function ( lock ) {\n\n\t\t\t\tlocked = lock;\n\n\t\t\t},\n\n\t\t\tsetClear: function ( r, g, b, a, premultipliedAlpha ) {\n\n\t\t\t\tif ( premultipliedAlpha === true ) {\n\n\t\t\t\t\tr *= a; g *= a; b *= a;\n\n\t\t\t\t}\n\n\t\t\t\tcolor.set( r, g, b, a );\n\n\t\t\t\tif ( currentColorClear.equals( color ) === false ) {\n\n\t\t\t\t\tgl.clearColor( r, g, b, a );\n\t\t\t\t\tcurrentColorClear.copy( color );\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\treset: function () {\n\n\t\t\t\tlocked = false;\n\n\t\t\t\tcurrentColorMask = null;\n\t\t\t\tcurrentColorClear.set( - 1, 0, 0, 0 ); // set to invalid state\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\tfunction DepthBuffer() {\n\n\t\tlet locked = false;\n\n\t\tlet currentDepthMask = null;\n\t\tlet currentDepthFunc = null;\n\t\tlet currentDepthClear = null;\n\n\t\treturn {\n\n\t\t\tsetTest: function ( depthTest ) {\n\n\t\t\t\tif ( depthTest ) {\n\n\t\t\t\t\tenable( gl.DEPTH_TEST );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdisable( gl.DEPTH_TEST );\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetMask: function ( depthMask ) {\n\n\t\t\t\tif ( currentDepthMask !== depthMask && ! locked ) {\n\n\t\t\t\t\tgl.depthMask( depthMask );\n\t\t\t\t\tcurrentDepthMask = depthMask;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetFunc: function ( depthFunc ) {\n\n\t\t\t\tif ( currentDepthFunc !== depthFunc ) {\n\n\t\t\t\t\tif ( depthFunc ) {\n\n\t\t\t\t\t\tswitch ( depthFunc ) {\n\n\t\t\t\t\t\t\tcase NeverDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( gl.NEVER );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase AlwaysDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( gl.ALWAYS );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase LessDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( gl.LESS );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase LessEqualDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase EqualDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( gl.EQUAL );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase GreaterEqualDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( gl.GEQUAL );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase GreaterDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( gl.GREATER );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase NotEqualDepth:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( gl.NOTEQUAL );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrentDepthFunc = depthFunc;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetLocked: function ( lock ) {\n\n\t\t\t\tlocked = lock;\n\n\t\t\t},\n\n\t\t\tsetClear: function ( depth ) {\n\n\t\t\t\tif ( currentDepthClear !== depth ) {\n\n\t\t\t\t\tgl.clearDepth( depth );\n\t\t\t\t\tcurrentDepthClear = depth;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\treset: function () {\n\n\t\t\t\tlocked = false;\n\n\t\t\t\tcurrentDepthMask = null;\n\t\t\t\tcurrentDepthFunc = null;\n\t\t\t\tcurrentDepthClear = null;\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\tfunction StencilBuffer() {\n\n\t\tlet locked = false;\n\n\t\tlet currentStencilMask = null;\n\t\tlet currentStencilFunc = null;\n\t\tlet currentStencilRef = null;\n\t\tlet currentStencilFuncMask = null;\n\t\tlet currentStencilFail = null;\n\t\tlet currentStencilZFail = null;\n\t\tlet currentStencilZPass = null;\n\t\tlet currentStencilClear = null;\n\n\t\treturn {\n\n\t\t\tsetTest: function ( stencilTest ) {\n\n\t\t\t\tif ( ! locked ) {\n\n\t\t\t\t\tif ( stencilTest ) {\n\n\t\t\t\t\t\tenable( gl.STENCIL_TEST );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tdisable( gl.STENCIL_TEST );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetMask: function ( stencilMask ) {\n\n\t\t\t\tif ( currentStencilMask !== stencilMask && ! locked ) {\n\n\t\t\t\t\tgl.stencilMask( stencilMask );\n\t\t\t\t\tcurrentStencilMask = stencilMask;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetFunc: function ( stencilFunc, stencilRef, stencilMask ) {\n\n\t\t\t\tif ( currentStencilFunc !== stencilFunc ||\n\t\t\t\t     currentStencilRef !== stencilRef ||\n\t\t\t\t     currentStencilFuncMask !== stencilMask ) {\n\n\t\t\t\t\tgl.stencilFunc( stencilFunc, stencilRef, stencilMask );\n\n\t\t\t\t\tcurrentStencilFunc = stencilFunc;\n\t\t\t\t\tcurrentStencilRef = stencilRef;\n\t\t\t\t\tcurrentStencilFuncMask = stencilMask;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetOp: function ( stencilFail, stencilZFail, stencilZPass ) {\n\n\t\t\t\tif ( currentStencilFail !== stencilFail ||\n\t\t\t\t     currentStencilZFail !== stencilZFail ||\n\t\t\t\t     currentStencilZPass !== stencilZPass ) {\n\n\t\t\t\t\tgl.stencilOp( stencilFail, stencilZFail, stencilZPass );\n\n\t\t\t\t\tcurrentStencilFail = stencilFail;\n\t\t\t\t\tcurrentStencilZFail = stencilZFail;\n\t\t\t\t\tcurrentStencilZPass = stencilZPass;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tsetLocked: function ( lock ) {\n\n\t\t\t\tlocked = lock;\n\n\t\t\t},\n\n\t\t\tsetClear: function ( stencil ) {\n\n\t\t\t\tif ( currentStencilClear !== stencil ) {\n\n\t\t\t\t\tgl.clearStencil( stencil );\n\t\t\t\t\tcurrentStencilClear = stencil;\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\treset: function () {\n\n\t\t\t\tlocked = false;\n\n\t\t\t\tcurrentStencilMask = null;\n\t\t\t\tcurrentStencilFunc = null;\n\t\t\t\tcurrentStencilRef = null;\n\t\t\t\tcurrentStencilFuncMask = null;\n\t\t\t\tcurrentStencilFail = null;\n\t\t\t\tcurrentStencilZFail = null;\n\t\t\t\tcurrentStencilZPass = null;\n\t\t\t\tcurrentStencilClear = null;\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t//\n\n\tconst colorBuffer = new ColorBuffer();\n\tconst depthBuffer = new DepthBuffer();\n\tconst stencilBuffer = new StencilBuffer();\n\n\tlet enabledCapabilities = {};\n\n\tlet xrFramebuffer = null;\n\tlet currentBoundFramebuffers = {};\n\n\tlet currentProgram = null;\n\n\tlet currentBlendingEnabled = false;\n\tlet currentBlending = null;\n\tlet currentBlendEquation = null;\n\tlet currentBlendSrc = null;\n\tlet currentBlendDst = null;\n\tlet currentBlendEquationAlpha = null;\n\tlet currentBlendSrcAlpha = null;\n\tlet currentBlendDstAlpha = null;\n\tlet currentPremultipledAlpha = false;\n\n\tlet currentFlipSided = null;\n\tlet currentCullFace = null;\n\n\tlet currentLineWidth = null;\n\n\tlet currentPolygonOffsetFactor = null;\n\tlet currentPolygonOffsetUnits = null;\n\n\tconst maxTextures = gl.getParameter( gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS );\n\n\tlet lineWidthAvailable = false;\n\tlet version = 0;\n\tconst glVersion = gl.getParameter( gl.VERSION );\n\n\tif ( glVersion.indexOf( 'WebGL' ) !== - 1 ) {\n\n\t\tversion = parseFloat( /^WebGL (\\d)/.exec( glVersion )[ 1 ] );\n\t\tlineWidthAvailable = ( version >= 1.0 );\n\n\t} else if ( glVersion.indexOf( 'OpenGL ES' ) !== - 1 ) {\n\n\t\tversion = parseFloat( /^OpenGL ES (\\d)/.exec( glVersion )[ 1 ] );\n\t\tlineWidthAvailable = ( version >= 2.0 );\n\n\t}\n\n\tlet currentTextureSlot = null;\n\tlet currentBoundTextures = {};\n\n\tconst scissorParam = gl.getParameter( gl.SCISSOR_BOX );\n\tconst viewportParam = gl.getParameter( gl.VIEWPORT );\n\n\tconst currentScissor = new Vector4().fromArray( scissorParam );\n\tconst currentViewport = new Vector4().fromArray( viewportParam );\n\n\tfunction createTexture( type, target, count ) {\n\n\t\tconst data = new Uint8Array( 4 ); // 4 is required to match default unpack alignment of 4.\n\t\tconst texture = gl.createTexture();\n\n\t\tgl.bindTexture( type, texture );\n\t\tgl.texParameteri( type, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\n\t\tgl.texParameteri( type, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\n\n\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\tgl.texImage2D( target + i, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, data );\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tconst emptyTextures = {};\n\temptyTextures[ gl.TEXTURE_2D ] = createTexture( gl.TEXTURE_2D, gl.TEXTURE_2D, 1 );\n\temptyTextures[ gl.TEXTURE_CUBE_MAP ] = createTexture( gl.TEXTURE_CUBE_MAP, gl.TEXTURE_CUBE_MAP_POSITIVE_X, 6 );\n\n\t// init\n\n\tcolorBuffer.setClear( 0, 0, 0, 1 );\n\tdepthBuffer.setClear( 1 );\n\tstencilBuffer.setClear( 0 );\n\n\tenable( gl.DEPTH_TEST );\n\tdepthBuffer.setFunc( LessEqualDepth );\n\n\tsetFlipSided( false );\n\tsetCullFace( CullFaceBack );\n\tenable( gl.CULL_FACE );\n\n\tsetBlending( NoBlending );\n\n\t//\n\n\tfunction enable( id ) {\n\n\t\tif ( enabledCapabilities[ id ] !== true ) {\n\n\t\t\tgl.enable( id );\n\t\t\tenabledCapabilities[ id ] = true;\n\n\t\t}\n\n\t}\n\n\tfunction disable( id ) {\n\n\t\tif ( enabledCapabilities[ id ] !== false ) {\n\n\t\t\tgl.disable( id );\n\t\t\tenabledCapabilities[ id ] = false;\n\n\t\t}\n\n\t}\n\n\tfunction bindXRFramebuffer( framebuffer ) {\n\n\t\tif ( framebuffer !== xrFramebuffer ) {\n\n\t\t\tgl.bindFramebuffer( gl.FRAMEBUFFER, framebuffer );\n\n\t\t\txrFramebuffer = framebuffer;\n\n\t\t}\n\n\t}\n\n\tfunction bindFramebuffer( target, framebuffer ) {\n\n\t\tif ( framebuffer === null && xrFramebuffer !== null ) framebuffer = xrFramebuffer; // use active XR framebuffer if available\n\n\t\tif ( currentBoundFramebuffers[ target ] !== framebuffer ) {\n\n\t\t\tgl.bindFramebuffer( target, framebuffer );\n\n\t\t\tcurrentBoundFramebuffers[ target ] = framebuffer;\n\n\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\t// gl.DRAW_FRAMEBUFFER is equivalent to gl.FRAMEBUFFER\n\n\t\t\t\tif ( target === gl.DRAW_FRAMEBUFFER ) {\n\n\t\t\t\t\tcurrentBoundFramebuffers[ gl.FRAMEBUFFER ] = framebuffer;\n\n\t\t\t\t}\n\n\t\t\t\tif ( target === gl.FRAMEBUFFER ) {\n\n\t\t\t\t\tcurrentBoundFramebuffers[ gl.DRAW_FRAMEBUFFER ] = framebuffer;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tfunction useProgram( program ) {\n\n\t\tif ( currentProgram !== program ) {\n\n\t\t\tgl.useProgram( program );\n\n\t\t\tcurrentProgram = program;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tconst equationToGL = {\n\t\t[ AddEquation ]: gl.FUNC_ADD,\n\t\t[ SubtractEquation ]: gl.FUNC_SUBTRACT,\n\t\t[ ReverseSubtractEquation ]: gl.FUNC_REVERSE_SUBTRACT\n\t};\n\n\tif ( isWebGL2 ) {\n\n\t\tequationToGL[ MinEquation ] = gl.MIN;\n\t\tequationToGL[ MaxEquation ] = gl.MAX;\n\n\t} else {\n\n\t\tconst extension = extensions.get( 'EXT_blend_minmax' );\n\n\t\tif ( extension !== null ) {\n\n\t\t\tequationToGL[ MinEquation ] = extension.MIN_EXT;\n\t\t\tequationToGL[ MaxEquation ] = extension.MAX_EXT;\n\n\t\t}\n\n\t}\n\n\tconst factorToGL = {\n\t\t[ ZeroFactor ]: gl.ZERO,\n\t\t[ OneFactor ]: gl.ONE,\n\t\t[ SrcColorFactor ]: gl.SRC_COLOR,\n\t\t[ SrcAlphaFactor ]: gl.SRC_ALPHA,\n\t\t[ SrcAlphaSaturateFactor ]: gl.SRC_ALPHA_SATURATE,\n\t\t[ DstColorFactor ]: gl.DST_COLOR,\n\t\t[ DstAlphaFactor ]: gl.DST_ALPHA,\n\t\t[ OneMinusSrcColorFactor ]: gl.ONE_MINUS_SRC_COLOR,\n\t\t[ OneMinusSrcAlphaFactor ]: gl.ONE_MINUS_SRC_ALPHA,\n\t\t[ OneMinusDstColorFactor ]: gl.ONE_MINUS_DST_COLOR,\n\t\t[ OneMinusDstAlphaFactor ]: gl.ONE_MINUS_DST_ALPHA\n\t};\n\n\tfunction setBlending( blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha, premultipliedAlpha ) {\n\n\t\tif ( blending === NoBlending ) {\n\n\t\t\tif ( currentBlendingEnabled === true ) {\n\n\t\t\t\tdisable( gl.BLEND );\n\t\t\t\tcurrentBlendingEnabled = false;\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( currentBlendingEnabled === false ) {\n\n\t\t\tenable( gl.BLEND );\n\t\t\tcurrentBlendingEnabled = true;\n\n\t\t}\n\n\t\tif ( blending !== CustomBlending ) {\n\n\t\t\tif ( blending !== currentBlending || premultipliedAlpha !== currentPremultipledAlpha ) {\n\n\t\t\t\tif ( currentBlendEquation !== AddEquation || currentBlendEquationAlpha !== AddEquation ) {\n\n\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\n\n\t\t\t\t\tcurrentBlendEquation = AddEquation;\n\t\t\t\t\tcurrentBlendEquationAlpha = AddEquation;\n\n\t\t\t\t}\n\n\t\t\t\tif ( premultipliedAlpha ) {\n\n\t\t\t\t\tswitch ( blending ) {\n\n\t\t\t\t\t\tcase NormalBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.ONE, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase AdditiveBlending:\n\t\t\t\t\t\t\tgl.blendFunc( gl.ONE, gl.ONE );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase SubtractiveBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.ZERO, gl.ONE_MINUS_SRC_COLOR, gl.ONE_MINUS_SRC_ALPHA );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase MultiplyBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.SRC_COLOR, gl.ZERO, gl.SRC_ALPHA );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLState: Invalid blending: ', blending );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tswitch ( blending ) {\n\n\t\t\t\t\t\tcase NormalBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase AdditiveBlending:\n\t\t\t\t\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase SubtractiveBlending:\n\t\t\t\t\t\t\tgl.blendFunc( gl.ZERO, gl.ONE_MINUS_SRC_COLOR );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase MultiplyBlending:\n\t\t\t\t\t\t\tgl.blendFunc( gl.ZERO, gl.SRC_COLOR );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLState: Invalid blending: ', blending );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tcurrentBlendSrc = null;\n\t\t\t\tcurrentBlendDst = null;\n\t\t\t\tcurrentBlendSrcAlpha = null;\n\t\t\t\tcurrentBlendDstAlpha = null;\n\n\t\t\t\tcurrentBlending = blending;\n\t\t\t\tcurrentPremultipledAlpha = premultipliedAlpha;\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// custom blending\n\n\t\tblendEquationAlpha = blendEquationAlpha || blendEquation;\n\t\tblendSrcAlpha = blendSrcAlpha || blendSrc;\n\t\tblendDstAlpha = blendDstAlpha || blendDst;\n\n\t\tif ( blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha ) {\n\n\t\t\tgl.blendEquationSeparate( equationToGL[ blendEquation ], equationToGL[ blendEquationAlpha ] );\n\n\t\t\tcurrentBlendEquation = blendEquation;\n\t\t\tcurrentBlendEquationAlpha = blendEquationAlpha;\n\n\t\t}\n\n\t\tif ( blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha ) {\n\n\t\t\tgl.blendFuncSeparate( factorToGL[ blendSrc ], factorToGL[ blendDst ], factorToGL[ blendSrcAlpha ], factorToGL[ blendDstAlpha ] );\n\n\t\t\tcurrentBlendSrc = blendSrc;\n\t\t\tcurrentBlendDst = blendDst;\n\t\t\tcurrentBlendSrcAlpha = blendSrcAlpha;\n\t\t\tcurrentBlendDstAlpha = blendDstAlpha;\n\n\t\t}\n\n\t\tcurrentBlending = blending;\n\t\tcurrentPremultipledAlpha = null;\n\n\t}\n\n\tfunction setMaterial( material, frontFaceCW ) {\n\n\t\tmaterial.side === DoubleSide\n\t\t\t? disable( gl.CULL_FACE )\n\t\t\t: enable( gl.CULL_FACE );\n\n\t\tlet flipSided = ( material.side === BackSide );\n\t\tif ( frontFaceCW ) flipSided = ! flipSided;\n\n\t\tsetFlipSided( flipSided );\n\n\t\t( material.blending === NormalBlending && material.transparent === false )\n\t\t\t? setBlending( NoBlending )\n\t\t\t: setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha, material.premultipliedAlpha );\n\n\t\tdepthBuffer.setFunc( material.depthFunc );\n\t\tdepthBuffer.setTest( material.depthTest );\n\t\tdepthBuffer.setMask( material.depthWrite );\n\t\tcolorBuffer.setMask( material.colorWrite );\n\n\t\tconst stencilWrite = material.stencilWrite;\n\t\tstencilBuffer.setTest( stencilWrite );\n\t\tif ( stencilWrite ) {\n\n\t\t\tstencilBuffer.setMask( material.stencilWriteMask );\n\t\t\tstencilBuffer.setFunc( material.stencilFunc, material.stencilRef, material.stencilFuncMask );\n\t\t\tstencilBuffer.setOp( material.stencilFail, material.stencilZFail, material.stencilZPass );\n\n\t\t}\n\n\t\tsetPolygonOffset( material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits );\n\n\t\tmaterial.alphaToCoverage === true\n\t\t\t? enable( gl.SAMPLE_ALPHA_TO_COVERAGE )\n\t\t\t: disable( gl.SAMPLE_ALPHA_TO_COVERAGE );\n\n\t}\n\n\t//\n\n\tfunction setFlipSided( flipSided ) {\n\n\t\tif ( currentFlipSided !== flipSided ) {\n\n\t\t\tif ( flipSided ) {\n\n\t\t\t\tgl.frontFace( gl.CW );\n\n\t\t\t} else {\n\n\t\t\t\tgl.frontFace( gl.CCW );\n\n\t\t\t}\n\n\t\t\tcurrentFlipSided = flipSided;\n\n\t\t}\n\n\t}\n\n\tfunction setCullFace( cullFace ) {\n\n\t\tif ( cullFace !== CullFaceNone ) {\n\n\t\t\tenable( gl.CULL_FACE );\n\n\t\t\tif ( cullFace !== currentCullFace ) {\n\n\t\t\t\tif ( cullFace === CullFaceBack ) {\n\n\t\t\t\t\tgl.cullFace( gl.BACK );\n\n\t\t\t\t} else if ( cullFace === CullFaceFront ) {\n\n\t\t\t\t\tgl.cullFace( gl.FRONT );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tgl.cullFace( gl.FRONT_AND_BACK );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tdisable( gl.CULL_FACE );\n\n\t\t}\n\n\t\tcurrentCullFace = cullFace;\n\n\t}\n\n\tfunction setLineWidth( width ) {\n\n\t\tif ( width !== currentLineWidth ) {\n\n\t\t\tif ( lineWidthAvailable ) gl.lineWidth( width );\n\n\t\t\tcurrentLineWidth = width;\n\n\t\t}\n\n\t}\n\n\tfunction setPolygonOffset( polygonOffset, factor, units ) {\n\n\t\tif ( polygonOffset ) {\n\n\t\t\tenable( gl.POLYGON_OFFSET_FILL );\n\n\t\t\tif ( currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units ) {\n\n\t\t\t\tgl.polygonOffset( factor, units );\n\n\t\t\t\tcurrentPolygonOffsetFactor = factor;\n\t\t\t\tcurrentPolygonOffsetUnits = units;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tdisable( gl.POLYGON_OFFSET_FILL );\n\n\t\t}\n\n\t}\n\n\tfunction setScissorTest( scissorTest ) {\n\n\t\tif ( scissorTest ) {\n\n\t\t\tenable( gl.SCISSOR_TEST );\n\n\t\t} else {\n\n\t\t\tdisable( gl.SCISSOR_TEST );\n\n\t\t}\n\n\t}\n\n\t// texture\n\n\tfunction activeTexture( webglSlot ) {\n\n\t\tif ( webglSlot === undefined ) webglSlot = gl.TEXTURE0 + maxTextures - 1;\n\n\t\tif ( currentTextureSlot !== webglSlot ) {\n\n\t\t\tgl.activeTexture( webglSlot );\n\t\t\tcurrentTextureSlot = webglSlot;\n\n\t\t}\n\n\t}\n\n\tfunction bindTexture( webglType, webglTexture ) {\n\n\t\tif ( currentTextureSlot === null ) {\n\n\t\t\tactiveTexture();\n\n\t\t}\n\n\t\tlet boundTexture = currentBoundTextures[ currentTextureSlot ];\n\n\t\tif ( boundTexture === undefined ) {\n\n\t\t\tboundTexture = { type: undefined, texture: undefined };\n\t\t\tcurrentBoundTextures[ currentTextureSlot ] = boundTexture;\n\n\t\t}\n\n\t\tif ( boundTexture.type !== webglType || boundTexture.texture !== webglTexture ) {\n\n\t\t\tgl.bindTexture( webglType, webglTexture || emptyTextures[ webglType ] );\n\n\t\t\tboundTexture.type = webglType;\n\t\t\tboundTexture.texture = webglTexture;\n\n\t\t}\n\n\t}\n\n\tfunction unbindTexture() {\n\n\t\tconst boundTexture = currentBoundTextures[ currentTextureSlot ];\n\n\t\tif ( boundTexture !== undefined && boundTexture.type !== undefined ) {\n\n\t\t\tgl.bindTexture( boundTexture.type, null );\n\n\t\t\tboundTexture.type = undefined;\n\t\t\tboundTexture.texture = undefined;\n\n\t\t}\n\n\t}\n\n\tfunction compressedTexImage2D() {\n\n\t\ttry {\n\n\t\t\tgl.compressedTexImage2D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction texImage2D() {\n\n\t\ttry {\n\n\t\t\tgl.texImage2D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\tfunction texImage3D() {\n\n\t\ttry {\n\n\t\t\tgl.texImage3D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( 'THREE.WebGLState:', error );\n\n\t\t}\n\n\t}\n\n\t//\n\n\tfunction scissor( scissor ) {\n\n\t\tif ( currentScissor.equals( scissor ) === false ) {\n\n\t\t\tgl.scissor( scissor.x, scissor.y, scissor.z, scissor.w );\n\t\t\tcurrentScissor.copy( scissor );\n\n\t\t}\n\n\t}\n\n\tfunction viewport( viewport ) {\n\n\t\tif ( currentViewport.equals( viewport ) === false ) {\n\n\t\t\tgl.viewport( viewport.x, viewport.y, viewport.z, viewport.w );\n\t\t\tcurrentViewport.copy( viewport );\n\n\t\t}\n\n\t}\n\n\t//\n\n\tfunction reset() {\n\n\t\t// reset state\n\n\t\tgl.disable( gl.BLEND );\n\t\tgl.disable( gl.CULL_FACE );\n\t\tgl.disable( gl.DEPTH_TEST );\n\t\tgl.disable( gl.POLYGON_OFFSET_FILL );\n\t\tgl.disable( gl.SCISSOR_TEST );\n\t\tgl.disable( gl.STENCIL_TEST );\n\t\tgl.disable( gl.SAMPLE_ALPHA_TO_COVERAGE );\n\n\t\tgl.blendEquation( gl.FUNC_ADD );\n\t\tgl.blendFunc( gl.ONE, gl.ZERO );\n\t\tgl.blendFuncSeparate( gl.ONE, gl.ZERO, gl.ONE, gl.ZERO );\n\n\t\tgl.colorMask( true, true, true, true );\n\t\tgl.clearColor( 0, 0, 0, 0 );\n\n\t\tgl.depthMask( true );\n\t\tgl.depthFunc( gl.LESS );\n\t\tgl.clearDepth( 1 );\n\n\t\tgl.stencilMask( 0xffffffff );\n\t\tgl.stencilFunc( gl.ALWAYS, 0, 0xffffffff );\n\t\tgl.stencilOp( gl.KEEP, gl.KEEP, gl.KEEP );\n\t\tgl.clearStencil( 0 );\n\n\t\tgl.cullFace( gl.BACK );\n\t\tgl.frontFace( gl.CCW );\n\n\t\tgl.polygonOffset( 0, 0 );\n\n\t\tgl.activeTexture( gl.TEXTURE0 );\n\n\t\tgl.bindFramebuffer( gl.FRAMEBUFFER, null );\n\n\t\tif ( isWebGL2 === true ) {\n\n\t\t\tgl.bindFramebuffer( gl.DRAW_FRAMEBUFFER, null );\n\t\t\tgl.bindFramebuffer( gl.READ_FRAMEBUFFER, null );\n\n\t\t}\n\n\t\tgl.useProgram( null );\n\n\t\tgl.lineWidth( 1 );\n\n\t\tgl.scissor( 0, 0, gl.canvas.width, gl.canvas.height );\n\t\tgl.viewport( 0, 0, gl.canvas.width, gl.canvas.height );\n\n\t\t// reset internals\n\n\t\tenabledCapabilities = {};\n\n\t\tcurrentTextureSlot = null;\n\t\tcurrentBoundTextures = {};\n\n\t\txrFramebuffer = null;\n\t\tcurrentBoundFramebuffers = {};\n\n\t\tcurrentProgram = null;\n\n\t\tcurrentBlendingEnabled = false;\n\t\tcurrentBlending = null;\n\t\tcurrentBlendEquation = null;\n\t\tcurrentBlendSrc = null;\n\t\tcurrentBlendDst = null;\n\t\tcurrentBlendEquationAlpha = null;\n\t\tcurrentBlendSrcAlpha = null;\n\t\tcurrentBlendDstAlpha = null;\n\t\tcurrentPremultipledAlpha = false;\n\n\t\tcurrentFlipSided = null;\n\t\tcurrentCullFace = null;\n\n\t\tcurrentLineWidth = null;\n\n\t\tcurrentPolygonOffsetFactor = null;\n\t\tcurrentPolygonOffsetUnits = null;\n\n\t\tcurrentScissor.set( 0, 0, gl.canvas.width, gl.canvas.height );\n\t\tcurrentViewport.set( 0, 0, gl.canvas.width, gl.canvas.height );\n\n\t\tcolorBuffer.reset();\n\t\tdepthBuffer.reset();\n\t\tstencilBuffer.reset();\n\n\t}\n\n\treturn {\n\n\t\tbuffers: {\n\t\t\tcolor: colorBuffer,\n\t\t\tdepth: depthBuffer,\n\t\t\tstencil: stencilBuffer\n\t\t},\n\n\t\tenable: enable,\n\t\tdisable: disable,\n\n\t\tbindFramebuffer: bindFramebuffer,\n\t\tbindXRFramebuffer: bindXRFramebuffer,\n\n\t\tuseProgram: useProgram,\n\n\t\tsetBlending: setBlending,\n\t\tsetMaterial: setMaterial,\n\n\t\tsetFlipSided: setFlipSided,\n\t\tsetCullFace: setCullFace,\n\n\t\tsetLineWidth: setLineWidth,\n\t\tsetPolygonOffset: setPolygonOffset,\n\n\t\tsetScissorTest: setScissorTest,\n\n\t\tactiveTexture: activeTexture,\n\t\tbindTexture: bindTexture,\n\t\tunbindTexture: unbindTexture,\n\t\tcompressedTexImage2D: compressedTexImage2D,\n\t\ttexImage2D: texImage2D,\n\t\ttexImage3D: texImage3D,\n\n\t\tscissor: scissor,\n\t\tviewport: viewport,\n\n\t\treset: reset\n\n\t};\n\n}\n\nexport { WebGLState };\n","import { LinearFilter, LinearMipmapLinearFilter, LinearMipmapNearestFilter, NearestFilter, NearestMipmapLinearFilter, NearestMipmapNearestFilter, RGBFormat, RGBAFormat, DepthFormat, DepthStencilFormat, UnsignedShortType, UnsignedIntType, UnsignedInt248Type, FloatType, HalfFloatType, MirroredRepeatWrapping, ClampToEdgeWrapping, RepeatWrapping, sRGBEncoding } from '../../constants.js';\nimport * as MathUtils from '../../math/MathUtils.js';\nimport { createElementNS } from '../../utils.js';\n\nfunction WebGLTextures( _gl, extensions, state, properties, capabilities, utils, info ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\tconst maxTextures = capabilities.maxTextures;\n\tconst maxCubemapSize = capabilities.maxCubemapSize;\n\tconst maxTextureSize = capabilities.maxTextureSize;\n\tconst maxSamples = capabilities.maxSamples;\n\n\tconst _videoTextures = new WeakMap();\n\tlet _canvas;\n\n\t// cordova iOS (as of 5.0) still uses UIWebView, which provides OffscreenCanvas,\n\t// also OffscreenCanvas.getContext(\"webgl\"), but not OffscreenCanvas.getContext(\"2d\")!\n\t// Some implementations may only implement OffscreenCanvas partially (e.g. lacking 2d).\n\n\tlet useOffscreenCanvas = false;\n\n\ttry {\n\n\t\tuseOffscreenCanvas = typeof OffscreenCanvas !== 'undefined'\n\t\t\t&& ( new OffscreenCanvas( 1, 1 ).getContext( '2d' ) ) !== null;\n\n\t} catch ( err ) {\n\n\t\t// Ignore any errors\n\n\t}\n\n\tfunction createCanvas( width, height ) {\n\n\t\t// Use OffscreenCanvas when available. Specially needed in web workers\n\n\t\treturn useOffscreenCanvas ?\n\t\t\tnew OffscreenCanvas( width, height ) : createElementNS( 'canvas' );\n\n\t}\n\n\tfunction resizeImage( image, needsPowerOfTwo, needsNewCanvas, maxSize ) {\n\n\t\tlet scale = 1;\n\n\t\t// handle case if texture exceeds max size\n\n\t\tif ( image.width > maxSize || image.height > maxSize ) {\n\n\t\t\tscale = maxSize / Math.max( image.width, image.height );\n\n\t\t}\n\n\t\t// only perform resize if necessary\n\n\t\tif ( scale < 1 || needsPowerOfTwo === true ) {\n\n\t\t\t// only perform resize for certain image types\n\n\t\t\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\t\t\tconst floor = needsPowerOfTwo ? MathUtils.floorPowerOfTwo : Math.floor;\n\n\t\t\t\tconst width = floor( scale * image.width );\n\t\t\t\tconst height = floor( scale * image.height );\n\n\t\t\t\tif ( _canvas === undefined ) _canvas = createCanvas( width, height );\n\n\t\t\t\t// cube textures can't reuse the same canvas\n\n\t\t\t\tconst canvas = needsNewCanvas ? createCanvas( width, height ) : _canvas;\n\n\t\t\t\tcanvas.width = width;\n\t\t\t\tcanvas.height = height;\n\n\t\t\t\tconst context = canvas.getContext( '2d' );\n\t\t\t\tcontext.drawImage( image, 0, 0, width, height );\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture has been resized from (' + image.width + 'x' + image.height + ') to (' + width + 'x' + height + ').' );\n\n\t\t\t\treturn canvas;\n\n\t\t\t} else {\n\n\t\t\t\tif ( 'data' in image ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Image in DataTexture is too big (' + image.width + 'x' + image.height + ').' );\n\n\t\t\t\t}\n\n\t\t\t\treturn image;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn image;\n\n\t}\n\n\tfunction isPowerOfTwo( image ) {\n\n\t\treturn MathUtils.isPowerOfTwo( image.width ) && MathUtils.isPowerOfTwo( image.height );\n\n\t}\n\n\tfunction textureNeedsPowerOfTwo( texture ) {\n\n\t\tif ( isWebGL2 ) return false;\n\n\t\treturn ( texture.wrapS !== ClampToEdgeWrapping || texture.wrapT !== ClampToEdgeWrapping ) ||\n\t\t\t( texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter );\n\n\t}\n\n\tfunction textureNeedsGenerateMipmaps( texture, supportsMips ) {\n\n\t\treturn texture.generateMipmaps && supportsMips &&\n\t\t\ttexture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter;\n\n\t}\n\n\tfunction generateMipmap( target, texture, width, height, depth = 1 ) {\n\n\t\t_gl.generateMipmap( target );\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\ttextureProperties.__maxMipLevel = Math.log2( Math.max( width, height, depth ) );\n\n\t}\n\n\tfunction getInternalFormat( internalFormatName, glFormat, glType, encoding ) {\n\n\t\tif ( isWebGL2 === false ) return glFormat;\n\n\t\tif ( internalFormatName !== null ) {\n\n\t\t\tif ( _gl[ internalFormatName ] !== undefined ) return _gl[ internalFormatName ];\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format \\'' + internalFormatName + '\\'' );\n\n\t\t}\n\n\t\tlet internalFormat = glFormat;\n\n\t\tif ( glFormat === _gl.RED ) {\n\n\t\t\tif ( glType === _gl.FLOAT ) internalFormat = _gl.R32F;\n\t\t\tif ( glType === _gl.HALF_FLOAT ) internalFormat = _gl.R16F;\n\t\t\tif ( glType === _gl.UNSIGNED_BYTE ) internalFormat = _gl.R8;\n\n\t\t}\n\n\t\tif ( glFormat === _gl.RGB ) {\n\n\t\t\tif ( glType === _gl.FLOAT ) internalFormat = _gl.RGB32F;\n\t\t\tif ( glType === _gl.HALF_FLOAT ) internalFormat = _gl.RGB16F;\n\t\t\tif ( glType === _gl.UNSIGNED_BYTE ) internalFormat = _gl.RGB8;\n\n\t\t}\n\n\t\tif ( glFormat === _gl.RGBA ) {\n\n\t\t\tif ( glType === _gl.FLOAT ) internalFormat = _gl.RGBA32F;\n\t\t\tif ( glType === _gl.HALF_FLOAT ) internalFormat = _gl.RGBA16F;\n\t\t\tif ( glType === _gl.UNSIGNED_BYTE ) internalFormat = ( encoding === sRGBEncoding ) ? _gl.SRGB8_ALPHA8 : _gl.RGBA8;\n\n\t\t}\n\n\t\tif ( internalFormat === _gl.R16F || internalFormat === _gl.R32F ||\n\t\t\tinternalFormat === _gl.RGBA16F || internalFormat === _gl.RGBA32F ) {\n\n\t\t\textensions.get( 'EXT_color_buffer_float' );\n\n\t\t}\n\n\t\treturn internalFormat;\n\n\t}\n\n\t// Fallback filters for non-power-of-2 textures\n\n\tfunction filterFallback( f ) {\n\n\t\tif ( f === NearestFilter || f === NearestMipmapNearestFilter || f === NearestMipmapLinearFilter ) {\n\n\t\t\treturn _gl.NEAREST;\n\n\t\t}\n\n\t\treturn _gl.LINEAR;\n\n\t}\n\n\t//\n\n\tfunction onTextureDispose( event ) {\n\n\t\tconst texture = event.target;\n\n\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\n\n\t\tdeallocateTexture( texture );\n\n\t\tif ( texture.isVideoTexture ) {\n\n\t\t\t_videoTextures.delete( texture );\n\n\t\t}\n\n\t\tinfo.memory.textures --;\n\n\t}\n\n\tfunction onRenderTargetDispose( event ) {\n\n\t\tconst renderTarget = event.target;\n\n\t\trenderTarget.removeEventListener( 'dispose', onRenderTargetDispose );\n\n\t\tdeallocateRenderTarget( renderTarget );\n\n\t}\n\n\t//\n\n\tfunction deallocateTexture( texture ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( textureProperties.__webglInit === undefined ) return;\n\n\t\t_gl.deleteTexture( textureProperties.__webglTexture );\n\n\t\tproperties.remove( texture );\n\n\t}\n\n\tfunction deallocateRenderTarget( renderTarget ) {\n\n\t\tconst texture = renderTarget.texture;\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( ! renderTarget ) return;\n\n\t\tif ( textureProperties.__webglTexture !== undefined ) {\n\n\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\n\n\t\t\tinfo.memory.textures --;\n\n\t\t}\n\n\t\tif ( renderTarget.depthTexture ) {\n\n\t\t\trenderTarget.depthTexture.dispose();\n\n\t\t}\n\n\t\tif ( renderTarget.isWebGLCubeRenderTarget ) {\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer[ i ] );\n\t\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer[ i ] );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer );\n\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer );\n\t\t\tif ( renderTargetProperties.__webglMultisampledFramebuffer ) _gl.deleteFramebuffer( renderTargetProperties.__webglMultisampledFramebuffer );\n\t\t\tif ( renderTargetProperties.__webglColorRenderbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglColorRenderbuffer );\n\t\t\tif ( renderTargetProperties.__webglDepthRenderbuffer ) _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthRenderbuffer );\n\n\t\t}\n\n\t\tif ( renderTarget.isWebGLMultipleRenderTargets ) {\n\n\t\t\tfor ( let i = 0, il = texture.length; i < il; i ++ ) {\n\n\t\t\t\tconst attachmentProperties = properties.get( texture[ i ] );\n\n\t\t\t\tif ( attachmentProperties.__webglTexture ) {\n\n\t\t\t\t\t_gl.deleteTexture( attachmentProperties.__webglTexture );\n\n\t\t\t\t\tinfo.memory.textures --;\n\n\t\t\t\t}\n\n\t\t\t\tproperties.remove( texture[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tproperties.remove( texture );\n\t\tproperties.remove( renderTarget );\n\n\t}\n\n\t//\n\n\tlet textureUnits = 0;\n\n\tfunction resetTextureUnits() {\n\n\t\ttextureUnits = 0;\n\n\t}\n\n\tfunction allocateTextureUnit() {\n\n\t\tconst textureUnit = textureUnits;\n\n\t\tif ( textureUnit >= maxTextures ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLTextures: Trying to use ' + textureUnit + ' texture units while this GPU supports only ' + maxTextures );\n\n\t\t}\n\n\t\ttextureUnits += 1;\n\n\t\treturn textureUnit;\n\n\t}\n\n\t//\n\n\tfunction setTexture2D( texture, slot ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( texture.isVideoTexture ) updateVideoTexture( texture );\n\n\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\tconst image = texture.image;\n\n\t\t\tif ( image === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is undefined' );\n\n\t\t\t} else if ( image.complete === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is incomplete' );\n\n\t\t\t} else {\n\n\t\t\t\tuploadTexture( textureProperties, texture, slot );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\n\n\t}\n\n\tfunction setTexture2DArray( texture, slot ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\tuploadTexture( textureProperties, texture, slot );\n\t\t\treturn;\n\n\t\t}\n\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\tstate.bindTexture( _gl.TEXTURE_2D_ARRAY, textureProperties.__webglTexture );\n\n\t}\n\n\tfunction setTexture3D( texture, slot ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\tuploadTexture( textureProperties, texture, slot );\n\t\t\treturn;\n\n\t\t}\n\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\tstate.bindTexture( _gl.TEXTURE_3D, textureProperties.__webglTexture );\n\n\t}\n\n\tfunction setTextureCube( texture, slot ) {\n\n\t\tconst textureProperties = properties.get( texture );\n\n\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\tuploadCubeTexture( textureProperties, texture, slot );\n\t\t\treturn;\n\n\t\t}\n\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__webglTexture );\n\n\t}\n\n\tconst wrappingToGL = {\n\t\t[ RepeatWrapping ]: _gl.REPEAT,\n\t\t[ ClampToEdgeWrapping ]: _gl.CLAMP_TO_EDGE,\n\t\t[ MirroredRepeatWrapping ]: _gl.MIRRORED_REPEAT\n\t};\n\n\tconst filterToGL = {\n\t\t[ NearestFilter ]: _gl.NEAREST,\n\t\t[ NearestMipmapNearestFilter ]: _gl.NEAREST_MIPMAP_NEAREST,\n\t\t[ NearestMipmapLinearFilter ]: _gl.NEAREST_MIPMAP_LINEAR,\n\n\t\t[ LinearFilter ]: _gl.LINEAR,\n\t\t[ LinearMipmapNearestFilter ]: _gl.LINEAR_MIPMAP_NEAREST,\n\t\t[ LinearMipmapLinearFilter ]: _gl.LINEAR_MIPMAP_LINEAR\n\t};\n\n\tfunction setTextureParameters( textureType, texture, supportsMips ) {\n\n\t\tif ( supportsMips ) {\n\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, wrappingToGL[ texture.wrapS ] );\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, wrappingToGL[ texture.wrapT ] );\n\n\t\t\tif ( textureType === _gl.TEXTURE_3D || textureType === _gl.TEXTURE_2D_ARRAY ) {\n\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_R, wrappingToGL[ texture.wrapR ] );\n\n\t\t\t}\n\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, filterToGL[ texture.magFilter ] );\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, filterToGL[ texture.minFilter ] );\n\n\t\t} else {\n\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, _gl.CLAMP_TO_EDGE );\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, _gl.CLAMP_TO_EDGE );\n\n\t\t\tif ( textureType === _gl.TEXTURE_3D || textureType === _gl.TEXTURE_2D_ARRAY ) {\n\n\t\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_R, _gl.CLAMP_TO_EDGE );\n\n\t\t\t}\n\n\t\t\tif ( texture.wrapS !== ClampToEdgeWrapping || texture.wrapT !== ClampToEdgeWrapping ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.' );\n\n\t\t\t}\n\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, filterFallback( texture.magFilter ) );\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, filterFallback( texture.minFilter ) );\n\n\t\t\tif ( texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.' );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( extensions.has( 'EXT_texture_filter_anisotropic' ) === true ) {\n\n\t\t\tconst extension = extensions.get( 'EXT_texture_filter_anisotropic' );\n\n\t\t\tif ( texture.type === FloatType && extensions.has( 'OES_texture_float_linear' ) === false ) return; // verify extension for WebGL 1 and WebGL 2\n\t\t\tif ( isWebGL2 === false && ( texture.type === HalfFloatType && extensions.has( 'OES_texture_half_float_linear' ) === false ) ) return; // verify extension for WebGL 1 only\n\n\t\t\tif ( texture.anisotropy > 1 || properties.get( texture ).__currentAnisotropy ) {\n\n\t\t\t\t_gl.texParameterf( textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min( texture.anisotropy, capabilities.getMaxAnisotropy() ) );\n\t\t\t\tproperties.get( texture ).__currentAnisotropy = texture.anisotropy;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction initTexture( textureProperties, texture ) {\n\n\t\tif ( textureProperties.__webglInit === undefined ) {\n\n\t\t\ttextureProperties.__webglInit = true;\n\n\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\n\n\t\t\tinfo.memory.textures ++;\n\n\t\t}\n\n\t}\n\n\tfunction uploadTexture( textureProperties, texture, slot ) {\n\n\t\tlet textureType = _gl.TEXTURE_2D;\n\n\t\tif ( texture.isDataTexture2DArray ) textureType = _gl.TEXTURE_2D_ARRAY;\n\t\tif ( texture.isDataTexture3D ) textureType = _gl.TEXTURE_3D;\n\n\t\tinitTexture( textureProperties, texture );\n\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\tstate.bindTexture( textureType, textureProperties.__webglTexture );\n\n\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\n\t\t_gl.pixelStorei( _gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha );\n\t\t_gl.pixelStorei( _gl.UNPACK_ALIGNMENT, texture.unpackAlignment );\n\t\t_gl.pixelStorei( _gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, _gl.NONE );\n\n\t\tconst needsPowerOfTwo = textureNeedsPowerOfTwo( texture ) && isPowerOfTwo( texture.image ) === false;\n\t\tconst image = resizeImage( texture.image, needsPowerOfTwo, false, maxTextureSize );\n\n\t\tconst supportsMips = isPowerOfTwo( image ) || isWebGL2,\n\t\t\tglFormat = utils.convert( texture.format );\n\n\t\tlet glType = utils.convert( texture.type ),\n\t\t\tglInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType, texture.encoding );\n\n\t\tsetTextureParameters( textureType, texture, supportsMips );\n\n\t\tlet mipmap;\n\t\tconst mipmaps = texture.mipmaps;\n\n\t\tif ( texture.isDepthTexture ) {\n\n\t\t\t// populate depth texture with dummy data\n\n\t\t\tglInternalFormat = _gl.DEPTH_COMPONENT;\n\n\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\tif ( texture.type === FloatType ) {\n\n\t\t\t\t\tglInternalFormat = _gl.DEPTH_COMPONENT32F;\n\n\t\t\t\t} else if ( texture.type === UnsignedIntType ) {\n\n\t\t\t\t\tglInternalFormat = _gl.DEPTH_COMPONENT24;\n\n\t\t\t\t} else if ( texture.type === UnsignedInt248Type ) {\n\n\t\t\t\t\tglInternalFormat = _gl.DEPTH24_STENCIL8;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tglInternalFormat = _gl.DEPTH_COMPONENT16; // WebGL2 requires sized internalformat for glTexImage2D\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( texture.type === FloatType ) {\n\n\t\t\t\t\tconsole.error( 'WebGLRenderer: Floating point depth texture requires WebGL2.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// validation checks for WebGL 1\n\n\t\t\tif ( texture.format === DepthFormat && glInternalFormat === _gl.DEPTH_COMPONENT ) {\n\n\t\t\t\t// The error INVALID_OPERATION is generated by texImage2D if format and internalformat are\n\t\t\t\t// DEPTH_COMPONENT and type is not UNSIGNED_SHORT or UNSIGNED_INT\n\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\n\t\t\t\tif ( texture.type !== UnsignedShortType && texture.type !== UnsignedIntType ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture.' );\n\n\t\t\t\t\ttexture.type = UnsignedShortType;\n\t\t\t\t\tglType = utils.convert( texture.type );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( texture.format === DepthStencilFormat && glInternalFormat === _gl.DEPTH_COMPONENT ) {\n\n\t\t\t\t// Depth stencil textures need the DEPTH_STENCIL internal format\n\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\n\t\t\t\tglInternalFormat = _gl.DEPTH_STENCIL;\n\n\t\t\t\t// The error INVALID_OPERATION is generated by texImage2D if format and internalformat are\n\t\t\t\t// DEPTH_STENCIL and type is not UNSIGNED_INT_24_8_WEBGL.\n\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\n\t\t\t\tif ( texture.type !== UnsignedInt248Type ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture.' );\n\n\t\t\t\t\ttexture.type = UnsignedInt248Type;\n\t\t\t\t\tglType = utils.convert( texture.type );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glInternalFormat, image.width, image.height, 0, glFormat, glType, null );\n\n\t\t} else if ( texture.isDataTexture ) {\n\n\t\t\t// use manually created mipmaps if available\n\t\t\t// if there are no manual mipmaps\n\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\n\n\t\t\tif ( mipmaps.length > 0 && supportsMips ) {\n\n\t\t\t\tfor ( let i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\t\tmipmap = mipmaps[ i ];\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glInternalFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t}\n\n\t\t\t\ttexture.generateMipmaps = false;\n\t\t\t\ttextureProperties.__maxMipLevel = mipmaps.length - 1;\n\n\t\t\t} else {\n\n\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glInternalFormat, image.width, image.height, 0, glFormat, glType, image.data );\n\t\t\t\ttextureProperties.__maxMipLevel = 0;\n\n\t\t\t}\n\n\t\t} else if ( texture.isCompressedTexture ) {\n\n\t\t\tfor ( let i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\tmipmap = mipmaps[ i ];\n\n\t\t\t\tif ( texture.format !== RGBAFormat && texture.format !== RGBFormat ) {\n\n\t\t\t\t\tif ( glFormat !== null ) {\n\n\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_2D, i, glInternalFormat, mipmap.width, mipmap.height, 0, mipmap.data );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()' );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glInternalFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttextureProperties.__maxMipLevel = mipmaps.length - 1;\n\n\t\t} else if ( texture.isDataTexture2DArray ) {\n\n\t\t\tstate.texImage3D( _gl.TEXTURE_2D_ARRAY, 0, glInternalFormat, image.width, image.height, image.depth, 0, glFormat, glType, image.data );\n\t\t\ttextureProperties.__maxMipLevel = 0;\n\n\t\t} else if ( texture.isDataTexture3D ) {\n\n\t\t\tstate.texImage3D( _gl.TEXTURE_3D, 0, glInternalFormat, image.width, image.height, image.depth, 0, glFormat, glType, image.data );\n\t\t\ttextureProperties.__maxMipLevel = 0;\n\n\t\t} else {\n\n\t\t\t// regular Texture (image, video, canvas)\n\n\t\t\t// use manually created mipmaps if available\n\t\t\t// if there are no manual mipmaps\n\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\n\n\t\t\tif ( mipmaps.length > 0 && supportsMips ) {\n\n\t\t\t\tfor ( let i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\t\tmipmap = mipmaps[ i ];\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glInternalFormat, glFormat, glType, mipmap );\n\n\t\t\t\t}\n\n\t\t\t\ttexture.generateMipmaps = false;\n\t\t\t\ttextureProperties.__maxMipLevel = mipmaps.length - 1;\n\n\t\t\t} else {\n\n\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glInternalFormat, glFormat, glType, image );\n\t\t\t\ttextureProperties.__maxMipLevel = 0;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\n\n\t\t\tgenerateMipmap( textureType, texture, image.width, image.height );\n\n\t\t}\n\n\t\ttextureProperties.__version = texture.version;\n\n\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\n\n\t}\n\n\tfunction uploadCubeTexture( textureProperties, texture, slot ) {\n\n\t\tif ( texture.image.length !== 6 ) return;\n\n\t\tinitTexture( textureProperties, texture );\n\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__webglTexture );\n\n\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\n\t\t_gl.pixelStorei( _gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha );\n\t\t_gl.pixelStorei( _gl.UNPACK_ALIGNMENT, texture.unpackAlignment );\n\t\t_gl.pixelStorei( _gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, _gl.NONE );\n\n\t\tconst isCompressed = ( texture && ( texture.isCompressedTexture || texture.image[ 0 ].isCompressedTexture ) );\n\t\tconst isDataTexture = ( texture.image[ 0 ] && texture.image[ 0 ].isDataTexture );\n\n\t\tconst cubeImage = [];\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tif ( ! isCompressed && ! isDataTexture ) {\n\n\t\t\t\tcubeImage[ i ] = resizeImage( texture.image[ i ], false, true, maxCubemapSize );\n\n\t\t\t} else {\n\n\t\t\t\tcubeImage[ i ] = isDataTexture ? texture.image[ i ].image : texture.image[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst image = cubeImage[ 0 ],\n\t\t\tsupportsMips = isPowerOfTwo( image ) || isWebGL2,\n\t\t\tglFormat = utils.convert( texture.format ),\n\t\t\tglType = utils.convert( texture.type ),\n\t\t\tglInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType, texture.encoding );\n\n\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, texture, supportsMips );\n\n\t\tlet mipmaps;\n\n\t\tif ( isCompressed ) {\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\tmipmaps = cubeImage[ i ].mipmaps;\n\n\t\t\t\tfor ( let j = 0; j < mipmaps.length; j ++ ) {\n\n\t\t\t\t\tconst mipmap = mipmaps[ j ];\n\n\t\t\t\t\tif ( texture.format !== RGBAFormat && texture.format !== RGBFormat ) {\n\n\t\t\t\t\t\tif ( glFormat !== null ) {\n\n\t\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glInternalFormat, mipmap.width, mipmap.height, 0, mipmap.data );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glInternalFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttextureProperties.__maxMipLevel = mipmaps.length - 1;\n\n\t\t} else {\n\n\t\t\tmipmaps = texture.mipmaps;\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\tif ( isDataTexture ) {\n\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glInternalFormat, cubeImage[ i ].width, cubeImage[ i ].height, 0, glFormat, glType, cubeImage[ i ].data );\n\n\t\t\t\t\tfor ( let j = 0; j < mipmaps.length; j ++ ) {\n\n\t\t\t\t\t\tconst mipmap = mipmaps[ j ];\n\t\t\t\t\t\tconst mipmapImage = mipmap.image[ i ].image;\n\n\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j + 1, glInternalFormat, mipmapImage.width, mipmapImage.height, 0, glFormat, glType, mipmapImage.data );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glInternalFormat, glFormat, glType, cubeImage[ i ] );\n\n\t\t\t\t\tfor ( let j = 0; j < mipmaps.length; j ++ ) {\n\n\t\t\t\t\t\tconst mipmap = mipmaps[ j ];\n\n\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j + 1, glInternalFormat, glFormat, glType, mipmap.image[ i ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttextureProperties.__maxMipLevel = mipmaps.length;\n\n\t\t}\n\n\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\n\n\t\t\t// We assume images for cube map have the same size.\n\t\t\tgenerateMipmap( _gl.TEXTURE_CUBE_MAP, texture, image.width, image.height );\n\n\t\t}\n\n\t\ttextureProperties.__version = texture.version;\n\n\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\n\n\t}\n\n\t// Render targets\n\n\t// Setup storage for target texture and bind it to correct framebuffer\n\tfunction setupFrameBufferTexture( framebuffer, renderTarget, texture, attachment, textureTarget ) {\n\n\t\tconst glFormat = utils.convert( texture.format );\n\t\tconst glType = utils.convert( texture.type );\n\t\tconst glInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType, texture.encoding );\n\n\t\tif ( textureTarget === _gl.TEXTURE_3D || textureTarget === _gl.TEXTURE_2D_ARRAY ) {\n\n\t\t\tstate.texImage3D( textureTarget, 0, glInternalFormat, renderTarget.width, renderTarget.height, renderTarget.depth, 0, glFormat, glType, null );\n\n\t\t} else {\n\n\t\t\tstate.texImage2D( textureTarget, 0, glInternalFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\n\n\t\t}\n\n\t\tstate.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\n\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, attachment, textureTarget, properties.get( texture ).__webglTexture, 0 );\n\t\tstate.bindFramebuffer( _gl.FRAMEBUFFER, null );\n\n\t}\n\n\t// Setup storage for internal depth/stencil buffers and bind to correct framebuffer\n\tfunction setupRenderBufferStorage( renderbuffer, renderTarget, isMultisample ) {\n\n\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, renderbuffer );\n\n\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\n\n\t\t\tlet glInternalFormat = _gl.DEPTH_COMPONENT16;\n\n\t\t\tif ( isMultisample ) {\n\n\t\t\t\tconst depthTexture = renderTarget.depthTexture;\n\n\t\t\t\tif ( depthTexture && depthTexture.isDepthTexture ) {\n\n\t\t\t\t\tif ( depthTexture.type === FloatType ) {\n\n\t\t\t\t\t\tglInternalFormat = _gl.DEPTH_COMPONENT32F;\n\n\t\t\t\t\t} else if ( depthTexture.type === UnsignedIntType ) {\n\n\t\t\t\t\t\tglInternalFormat = _gl.DEPTH_COMPONENT24;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tconst samples = getRenderTargetSamples( renderTarget );\n\n\t\t\t\t_gl.renderbufferStorageMultisample( _gl.RENDERBUFFER, samples, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t}\n\n\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\n\n\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\n\n\t\t\tif ( isMultisample ) {\n\n\t\t\t\tconst samples = getRenderTargetSamples( renderTarget );\n\n\t\t\t\t_gl.renderbufferStorageMultisample( _gl.RENDERBUFFER, samples, _gl.DEPTH24_STENCIL8, renderTarget.width, renderTarget.height );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_STENCIL, renderTarget.width, renderTarget.height );\n\n\t\t\t}\n\n\n\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\n\n\t\t} else {\n\n\t\t\t// Use the first texture for MRT so far\n\t\t\tconst texture = renderTarget.isWebGLMultipleRenderTargets === true ? renderTarget.texture[ 0 ] : renderTarget.texture;\n\n\t\t\tconst glFormat = utils.convert( texture.format );\n\t\t\tconst glType = utils.convert( texture.type );\n\t\t\tconst glInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType, texture.encoding );\n\n\t\t\tif ( isMultisample ) {\n\n\t\t\t\tconst samples = getRenderTargetSamples( renderTarget );\n\n\t\t\t\t_gl.renderbufferStorageMultisample( _gl.RENDERBUFFER, samples, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t}\n\n\t\t}\n\n\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, null );\n\n\t}\n\n\t// Setup resources for a Depth Texture for a FBO (needs an extension)\n\tfunction setupDepthTexture( framebuffer, renderTarget ) {\n\n\t\tconst isCube = ( renderTarget && renderTarget.isWebGLCubeRenderTarget );\n\t\tif ( isCube ) throw new Error( 'Depth Texture with cube render targets is not supported' );\n\n\t\tstate.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\n\n\t\tif ( ! ( renderTarget.depthTexture && renderTarget.depthTexture.isDepthTexture ) ) {\n\n\t\t\tthrow new Error( 'renderTarget.depthTexture must be an instance of THREE.DepthTexture' );\n\n\t\t}\n\n\t\t// upload an empty depth texture with framebuffer size\n\t\tif ( ! properties.get( renderTarget.depthTexture ).__webglTexture ||\n\t\t\t\trenderTarget.depthTexture.image.width !== renderTarget.width ||\n\t\t\t\trenderTarget.depthTexture.image.height !== renderTarget.height ) {\n\n\t\t\trenderTarget.depthTexture.image.width = renderTarget.width;\n\t\t\trenderTarget.depthTexture.image.height = renderTarget.height;\n\t\t\trenderTarget.depthTexture.needsUpdate = true;\n\n\t\t}\n\n\t\tsetTexture2D( renderTarget.depthTexture, 0 );\n\n\t\tconst webglDepthTexture = properties.get( renderTarget.depthTexture ).__webglTexture;\n\n\t\tif ( renderTarget.depthTexture.format === DepthFormat ) {\n\n\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.TEXTURE_2D, webglDepthTexture, 0 );\n\n\t\t} else if ( renderTarget.depthTexture.format === DepthStencilFormat ) {\n\n\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.TEXTURE_2D, webglDepthTexture, 0 );\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'Unknown depthTexture format' );\n\n\t\t}\n\n\t}\n\n\t// Setup GL resources for a non-texture depth buffer\n\tfunction setupDepthRenderbuffer( renderTarget ) {\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\n\t\tconst isCube = ( renderTarget.isWebGLCubeRenderTarget === true );\n\n\t\tif ( renderTarget.depthTexture ) {\n\n\t\t\tif ( isCube ) throw new Error( 'target.depthTexture not supported in Cube render targets' );\n\n\t\t\tsetupDepthTexture( renderTargetProperties.__webglFramebuffer, renderTarget );\n\n\t\t} else {\n\n\t\t\tif ( isCube ) {\n\n\t\t\t\trenderTargetProperties.__webglDepthbuffer = [];\n\n\t\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\t\tstate.bindFramebuffer( _gl.FRAMEBUFFER, renderTargetProperties.__webglFramebuffer[ i ] );\n\t\t\t\t\trenderTargetProperties.__webglDepthbuffer[ i ] = _gl.createRenderbuffer();\n\t\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer[ i ], renderTarget, false );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tstate.bindFramebuffer( _gl.FRAMEBUFFER, renderTargetProperties.__webglFramebuffer );\n\t\t\t\trenderTargetProperties.__webglDepthbuffer = _gl.createRenderbuffer();\n\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer, renderTarget, false );\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.bindFramebuffer( _gl.FRAMEBUFFER, null );\n\n\t}\n\n\t// Set up GL resources for the render target\n\tfunction setupRenderTarget( renderTarget ) {\n\n\t\tconst texture = renderTarget.texture;\n\n\t\tconst renderTargetProperties = properties.get( renderTarget );\n\t\tconst textureProperties = properties.get( texture );\n\n\t\trenderTarget.addEventListener( 'dispose', onRenderTargetDispose );\n\n\t\tif ( renderTarget.isWebGLMultipleRenderTargets !== true ) {\n\n\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\n\t\t\ttextureProperties.__version = texture.version;\n\t\t\tinfo.memory.textures ++;\n\n\t\t}\n\n\t\tconst isCube = ( renderTarget.isWebGLCubeRenderTarget === true );\n\t\tconst isMultipleRenderTargets = ( renderTarget.isWebGLMultipleRenderTargets === true );\n\t\tconst isMultisample = ( renderTarget.isWebGLMultisampleRenderTarget === true );\n\t\tconst isRenderTarget3D = texture.isDataTexture3D || texture.isDataTexture2DArray;\n\t\tconst supportsMips = isPowerOfTwo( renderTarget ) || isWebGL2;\n\n\t\t// Handles WebGL2 RGBFormat fallback - #18858\n\n\t\tif ( isWebGL2 && texture.format === RGBFormat && ( texture.type === FloatType || texture.type === HalfFloatType ) ) {\n\n\t\t\ttexture.format = RGBAFormat;\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.' );\n\n\t\t}\n\n\t\t// Setup framebuffer\n\n\t\tif ( isCube ) {\n\n\t\t\trenderTargetProperties.__webglFramebuffer = [];\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\trenderTargetProperties.__webglFramebuffer[ i ] = _gl.createFramebuffer();\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\trenderTargetProperties.__webglFramebuffer = _gl.createFramebuffer();\n\n\t\t\tif ( isMultipleRenderTargets ) {\n\n\t\t\t\tif ( capabilities.drawBuffers ) {\n\n\t\t\t\t\tconst textures = renderTarget.texture;\n\n\t\t\t\t\tfor ( let i = 0, il = textures.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst attachmentProperties = properties.get( textures[ i ] );\n\n\t\t\t\t\t\tif ( attachmentProperties.__webglTexture === undefined ) {\n\n\t\t\t\t\t\t\tattachmentProperties.__webglTexture = _gl.createTexture();\n\n\t\t\t\t\t\t\tinfo.memory.textures ++;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.' );\n\n\t\t\t\t}\n\n\t\t\t} else if ( isMultisample ) {\n\n\t\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\t\trenderTargetProperties.__webglMultisampledFramebuffer = _gl.createFramebuffer();\n\t\t\t\t\trenderTargetProperties.__webglColorRenderbuffer = _gl.createRenderbuffer();\n\n\t\t\t\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, renderTargetProperties.__webglColorRenderbuffer );\n\n\t\t\t\t\tconst glFormat = utils.convert( texture.format );\n\t\t\t\t\tconst glType = utils.convert( texture.type );\n\t\t\t\t\tconst glInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType, texture.encoding );\n\t\t\t\t\tconst samples = getRenderTargetSamples( renderTarget );\n\t\t\t\t\t_gl.renderbufferStorageMultisample( _gl.RENDERBUFFER, samples, glInternalFormat, renderTarget.width, renderTarget.height );\n\n\t\t\t\t\tstate.bindFramebuffer( _gl.FRAMEBUFFER, renderTargetProperties.__webglMultisampledFramebuffer );\n\t\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, _gl.RENDERBUFFER, renderTargetProperties.__webglColorRenderbuffer );\n\t\t\t\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, null );\n\n\t\t\t\t\tif ( renderTarget.depthBuffer ) {\n\n\t\t\t\t\t\trenderTargetProperties.__webglDepthRenderbuffer = _gl.createRenderbuffer();\n\t\t\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthRenderbuffer, renderTarget, true );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.bindFramebuffer( _gl.FRAMEBUFFER, null );\n\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Setup color buffer\n\n\t\tif ( isCube ) {\n\n\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__webglTexture );\n\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, texture, supportsMips );\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer[ i ], renderTarget, texture, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i );\n\n\t\t\t}\n\n\t\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\n\n\t\t\t\tgenerateMipmap( _gl.TEXTURE_CUBE_MAP, texture, renderTarget.width, renderTarget.height );\n\n\t\t\t}\n\n\t\t\tstate.unbindTexture();\n\n\t\t} else if ( isMultipleRenderTargets ) {\n\n\t\t\tconst textures = renderTarget.texture;\n\n\t\t\tfor ( let i = 0, il = textures.length; i < il; i ++ ) {\n\n\t\t\t\tconst attachment = textures[ i ];\n\t\t\t\tconst attachmentProperties = properties.get( attachment );\n\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_2D, attachmentProperties.__webglTexture );\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_2D, attachment, supportsMips );\n\t\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer, renderTarget, attachment, _gl.COLOR_ATTACHMENT0 + i, _gl.TEXTURE_2D );\n\n\t\t\t\tif ( textureNeedsGenerateMipmaps( attachment, supportsMips ) ) {\n\n\t\t\t\t\tgenerateMipmap( _gl.TEXTURE_2D, attachment, renderTarget.width, renderTarget.height );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tstate.unbindTexture();\n\n\t\t} else {\n\n\t\t\tlet glTextureType = _gl.TEXTURE_2D;\n\n\t\t\tif ( isRenderTarget3D ) {\n\n\t\t\t\t// Render targets containing layers, i.e: Texture 3D and 2d arrays\n\n\t\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\t\tconst isTexture3D = texture.isDataTexture3D;\n\t\t\t\t\tglTextureType = isTexture3D ? _gl.TEXTURE_3D : _gl.TEXTURE_2D_ARRAY;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tstate.bindTexture( glTextureType, textureProperties.__webglTexture );\n\t\t\tsetTextureParameters( glTextureType, texture, supportsMips );\n\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer, renderTarget, texture, _gl.COLOR_ATTACHMENT0, glTextureType );\n\n\t\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\n\n\t\t\t\tgenerateMipmap( glTextureType, texture, renderTarget.width, renderTarget.height, renderTarget.depth );\n\n\t\t\t}\n\n\t\t\tstate.unbindTexture();\n\n\t\t}\n\n\t\t// Setup depth and stencil buffers\n\n\t\tif ( renderTarget.depthBuffer ) {\n\n\t\t\tsetupDepthRenderbuffer( renderTarget );\n\n\t\t}\n\n\t}\n\n\tfunction updateRenderTargetMipmap( renderTarget ) {\n\n\t\tconst supportsMips = isPowerOfTwo( renderTarget ) || isWebGL2;\n\n\t\tconst textures = renderTarget.isWebGLMultipleRenderTargets === true ? renderTarget.texture : [ renderTarget.texture ];\n\n\t\tfor ( let i = 0, il = textures.length; i < il; i ++ ) {\n\n\t\t\tconst texture = textures[ i ];\n\n\t\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\n\n\t\t\t\tconst target = renderTarget.isWebGLCubeRenderTarget ? _gl.TEXTURE_CUBE_MAP : _gl.TEXTURE_2D;\n\t\t\t\tconst webglTexture = properties.get( texture ).__webglTexture;\n\n\t\t\t\tstate.bindTexture( target, webglTexture );\n\t\t\t\tgenerateMipmap( target, texture, renderTarget.width, renderTarget.height );\n\t\t\t\tstate.unbindTexture();\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction updateMultisampleRenderTarget( renderTarget ) {\n\n\t\tif ( renderTarget.isWebGLMultisampleRenderTarget ) {\n\n\t\t\tif ( isWebGL2 ) {\n\n\t\t\t\tconst width = renderTarget.width;\n\t\t\t\tconst height = renderTarget.height;\n\t\t\t\tlet mask = _gl.COLOR_BUFFER_BIT;\n\n\t\t\t\tif ( renderTarget.depthBuffer ) mask |= _gl.DEPTH_BUFFER_BIT;\n\t\t\t\tif ( renderTarget.stencilBuffer ) mask |= _gl.STENCIL_BUFFER_BIT;\n\n\t\t\t\tconst renderTargetProperties = properties.get( renderTarget );\n\n\t\t\t\tstate.bindFramebuffer( _gl.READ_FRAMEBUFFER, renderTargetProperties.__webglMultisampledFramebuffer );\n\t\t\t\tstate.bindFramebuffer( _gl.DRAW_FRAMEBUFFER, renderTargetProperties.__webglFramebuffer );\n\n\t\t\t\t_gl.blitFramebuffer( 0, 0, width, height, 0, 0, width, height, mask, _gl.NEAREST );\n\n\t\t\t\tstate.bindFramebuffer( _gl.READ_FRAMEBUFFER, null );\n\t\t\t\tstate.bindFramebuffer( _gl.DRAW_FRAMEBUFFER, renderTargetProperties.__webglMultisampledFramebuffer );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction getRenderTargetSamples( renderTarget ) {\n\n\t\treturn ( isWebGL2 && renderTarget.isWebGLMultisampleRenderTarget ) ?\n\t\t\tMath.min( maxSamples, renderTarget.samples ) : 0;\n\n\t}\n\n\tfunction updateVideoTexture( texture ) {\n\n\t\tconst frame = info.render.frame;\n\n\t\t// Check the last frame we updated the VideoTexture\n\n\t\tif ( _videoTextures.get( texture ) !== frame ) {\n\n\t\t\t_videoTextures.set( texture, frame );\n\t\t\ttexture.update();\n\n\t\t}\n\n\t}\n\n\t// backwards compatibility\n\n\tlet warnedTexture2D = false;\n\tlet warnedTextureCube = false;\n\n\tfunction safeSetTexture2D( texture, slot ) {\n\n\t\tif ( texture && texture.isWebGLRenderTarget ) {\n\n\t\t\tif ( warnedTexture2D === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLTextures.safeSetTexture2D: don\\'t use render targets as textures. Use their .texture property instead.' );\n\t\t\t\twarnedTexture2D = true;\n\n\t\t\t}\n\n\t\t\ttexture = texture.texture;\n\n\t\t}\n\n\t\tsetTexture2D( texture, slot );\n\n\t}\n\n\tfunction safeSetTextureCube( texture, slot ) {\n\n\t\tif ( texture && texture.isWebGLCubeRenderTarget ) {\n\n\t\t\tif ( warnedTextureCube === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLTextures.safeSetTextureCube: don\\'t use cube render targets as textures. Use their .texture property instead.' );\n\t\t\t\twarnedTextureCube = true;\n\n\t\t\t}\n\n\t\t\ttexture = texture.texture;\n\n\t\t}\n\n\n\t\tsetTextureCube( texture, slot );\n\n\t}\n\n\t//\n\n\tthis.allocateTextureUnit = allocateTextureUnit;\n\tthis.resetTextureUnits = resetTextureUnits;\n\n\tthis.setTexture2D = setTexture2D;\n\tthis.setTexture2DArray = setTexture2DArray;\n\tthis.setTexture3D = setTexture3D;\n\tthis.setTextureCube = setTextureCube;\n\tthis.setupRenderTarget = setupRenderTarget;\n\tthis.updateRenderTargetMipmap = updateRenderTargetMipmap;\n\tthis.updateMultisampleRenderTarget = updateMultisampleRenderTarget;\n\n\tthis.safeSetTexture2D = safeSetTexture2D;\n\tthis.safeSetTextureCube = safeSetTextureCube;\n\n}\n\nexport { WebGLTextures };\n","import { RGBA_ASTC_4x4_Format, RGBA_ASTC_5x4_Format, RGBA_ASTC_5x5_Format, RGBA_ASTC_6x5_Format, RGBA_ASTC_6x6_Format, RGBA_ASTC_8x5_Format, RGBA_ASTC_8x6_Format, RGBA_ASTC_8x8_Format, RGBA_ASTC_10x5_Format, RGBA_ASTC_10x6_Format, RGBA_ASTC_10x8_Format, RGBA_ASTC_10x10_Format, RGBA_ASTC_12x10_Format, RGBA_ASTC_12x12_Format, RGB_ETC1_Format, RGB_ETC2_Format, RGBA_ETC2_EAC_Format, RGBA_PVRTC_2BPPV1_Format, RGBA_PVRTC_4BPPV1_Format, RGB_PVRTC_2BPPV1_Format, RGB_PVRTC_4BPPV1_Format, RGBA_S3TC_DXT5_Format, RGBA_S3TC_DXT3_Format, RGBA_S3TC_DXT1_Format, RGB_S3TC_DXT1_Format, DepthFormat, DepthStencilFormat, LuminanceAlphaFormat, LuminanceFormat, RedFormat, RGBAFormat, RGBFormat, AlphaFormat, RedIntegerFormat, RGFormat, RGIntegerFormat, RGBIntegerFormat, RGBAIntegerFormat, HalfFloatType, FloatType, UnsignedIntType, IntType, UnsignedShortType, ShortType, ByteType, UnsignedInt248Type, UnsignedShort565Type, UnsignedShort5551Type, UnsignedShort4444Type, UnsignedByteType, SRGB8_ALPHA8_ASTC_4x4_Format, SRGB8_ALPHA8_ASTC_5x4_Format, SRGB8_ALPHA8_ASTC_5x5_Format, SRGB8_ALPHA8_ASTC_6x5_Format, SRGB8_ALPHA8_ASTC_6x6_Format, SRGB8_ALPHA8_ASTC_8x5_Format, SRGB8_ALPHA8_ASTC_8x6_Format, SRGB8_ALPHA8_ASTC_8x8_Format, SRGB8_ALPHA8_ASTC_10x5_Format, SRGB8_ALPHA8_ASTC_10x6_Format, SRGB8_ALPHA8_ASTC_10x8_Format, SRGB8_ALPHA8_ASTC_10x10_Format, SRGB8_ALPHA8_ASTC_12x10_Format, SRGB8_ALPHA8_ASTC_12x12_Format, RGBA_BPTC_Format } from '../../constants.js';\n\nfunction WebGLUtils( gl, extensions, capabilities ) {\n\n\tconst isWebGL2 = capabilities.isWebGL2;\n\n\tfunction convert( p ) {\n\n\t\tlet extension;\n\n\t\tif ( p === UnsignedByteType ) return gl.UNSIGNED_BYTE;\n\t\tif ( p === UnsignedShort4444Type ) return gl.UNSIGNED_SHORT_4_4_4_4;\n\t\tif ( p === UnsignedShort5551Type ) return gl.UNSIGNED_SHORT_5_5_5_1;\n\t\tif ( p === UnsignedShort565Type ) return gl.UNSIGNED_SHORT_5_6_5;\n\n\t\tif ( p === ByteType ) return gl.BYTE;\n\t\tif ( p === ShortType ) return gl.SHORT;\n\t\tif ( p === UnsignedShortType ) return gl.UNSIGNED_SHORT;\n\t\tif ( p === IntType ) return gl.INT;\n\t\tif ( p === UnsignedIntType ) return gl.UNSIGNED_INT;\n\t\tif ( p === FloatType ) return gl.FLOAT;\n\n\t\tif ( p === HalfFloatType ) {\n\n\t\t\tif ( isWebGL2 ) return gl.HALF_FLOAT;\n\n\t\t\textension = extensions.get( 'OES_texture_half_float' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\treturn extension.HALF_FLOAT_OES;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( p === AlphaFormat ) return gl.ALPHA;\n\t\tif ( p === RGBFormat ) return gl.RGB;\n\t\tif ( p === RGBAFormat ) return gl.RGBA;\n\t\tif ( p === LuminanceFormat ) return gl.LUMINANCE;\n\t\tif ( p === LuminanceAlphaFormat ) return gl.LUMINANCE_ALPHA;\n\t\tif ( p === DepthFormat ) return gl.DEPTH_COMPONENT;\n\t\tif ( p === DepthStencilFormat ) return gl.DEPTH_STENCIL;\n\t\tif ( p === RedFormat ) return gl.RED;\n\n\t\t// WebGL2 formats.\n\n\t\tif ( p === RedIntegerFormat ) return gl.RED_INTEGER;\n\t\tif ( p === RGFormat ) return gl.RG;\n\t\tif ( p === RGIntegerFormat ) return gl.RG_INTEGER;\n\t\tif ( p === RGBIntegerFormat ) return gl.RGB_INTEGER;\n\t\tif ( p === RGBAIntegerFormat ) return gl.RGBA_INTEGER;\n\n\t\tif ( p === RGB_S3TC_DXT1_Format || p === RGBA_S3TC_DXT1_Format ||\n\t\t\tp === RGBA_S3TC_DXT3_Format || p === RGBA_S3TC_DXT5_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\n\t\t\t\tif ( p === RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\n\t\t\t\tif ( p === RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\n\t\t\t\tif ( p === RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( p === RGB_PVRTC_4BPPV1_Format || p === RGB_PVRTC_2BPPV1_Format ||\n\t\t\tp === RGBA_PVRTC_4BPPV1_Format || p === RGBA_PVRTC_2BPPV1_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_pvrtc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGB_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\n\t\t\t\tif ( p === RGB_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\n\t\t\t\tif ( p === RGBA_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\n\t\t\t\tif ( p === RGBA_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( p === RGB_ETC1_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_etc1' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\treturn extension.COMPRESSED_RGB_ETC1_WEBGL;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( p === RGB_ETC2_Format || p === RGBA_ETC2_EAC_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_etc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGB_ETC2_Format ) return extension.COMPRESSED_RGB8_ETC2;\n\t\t\t\tif ( p === RGBA_ETC2_EAC_Format ) return extension.COMPRESSED_RGBA8_ETC2_EAC;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( p === RGBA_ASTC_4x4_Format || p === RGBA_ASTC_5x4_Format || p === RGBA_ASTC_5x5_Format ||\n\t\t\tp === RGBA_ASTC_6x5_Format || p === RGBA_ASTC_6x6_Format || p === RGBA_ASTC_8x5_Format ||\n\t\t\tp === RGBA_ASTC_8x6_Format || p === RGBA_ASTC_8x8_Format || p === RGBA_ASTC_10x5_Format ||\n\t\t\tp === RGBA_ASTC_10x6_Format || p === RGBA_ASTC_10x8_Format || p === RGBA_ASTC_10x10_Format ||\n\t\t\tp === RGBA_ASTC_12x10_Format || p === RGBA_ASTC_12x12_Format ||\n\t\t\tp === SRGB8_ALPHA8_ASTC_4x4_Format || p === SRGB8_ALPHA8_ASTC_5x4_Format || p === SRGB8_ALPHA8_ASTC_5x5_Format ||\n\t\t\tp === SRGB8_ALPHA8_ASTC_6x5_Format || p === SRGB8_ALPHA8_ASTC_6x6_Format || p === SRGB8_ALPHA8_ASTC_8x5_Format ||\n\t\t\tp === SRGB8_ALPHA8_ASTC_8x6_Format || p === SRGB8_ALPHA8_ASTC_8x8_Format || p === SRGB8_ALPHA8_ASTC_10x5_Format ||\n\t\t\tp === SRGB8_ALPHA8_ASTC_10x6_Format || p === SRGB8_ALPHA8_ASTC_10x8_Format || p === SRGB8_ALPHA8_ASTC_10x10_Format ||\n\t\t\tp === SRGB8_ALPHA8_ASTC_12x10_Format || p === SRGB8_ALPHA8_ASTC_12x12_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_astc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\t// TODO Complete?\n\n\t\t\t\treturn p;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( p === RGBA_BPTC_Format ) {\n\n\t\t\textension = extensions.get( 'EXT_texture_compression_bptc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\t// TODO Complete?\n\n\t\t\t\treturn p;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( p === UnsignedInt248Type ) {\n\n\t\t\tif ( isWebGL2 ) return gl.UNSIGNED_INT_24_8;\n\n\t\t\textension = extensions.get( 'WEBGL_depth_texture' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\treturn extension.UNSIGNED_INT_24_8_WEBGL;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn { convert: convert };\n\n}\n\n\nexport { WebGLUtils };\n","import { PerspectiveCamera } from './PerspectiveCamera.js';\n\nclass ArrayCamera extends PerspectiveCamera {\n\n\tconstructor( array = [] ) {\n\n\t\tsuper();\n\n\t\tthis.cameras = array;\n\n\t}\n\n}\n\nArrayCamera.prototype.isArrayCamera = true;\n\n\nexport { ArrayCamera };\n","import { Object3D } from '../core/Object3D.js';\n\nclass Group extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'Group';\n\n\t}\n\n}\n\nGroup.prototype.isGroup = true;\n\nexport { Group };\n","import { Vector3 } from '../../math/Vector3.js';\nimport { Group } from '../../objects/Group.js';\n\nconst _moveEvent = { type: 'move' };\n\nclass WebXRController {\n\n\tconstructor() {\n\n\t\tthis._targetRay = null;\n\t\tthis._grip = null;\n\t\tthis._hand = null;\n\n\t}\n\n\tgetHandSpace() {\n\n\t\tif ( this._hand === null ) {\n\n\t\t\tthis._hand = new Group();\n\t\t\tthis._hand.matrixAutoUpdate = false;\n\t\t\tthis._hand.visible = false;\n\n\t\t\tthis._hand.joints = {};\n\t\t\tthis._hand.inputState = { pinching: false };\n\n\t\t}\n\n\t\treturn this._hand;\n\n\t}\n\n\tgetTargetRaySpace() {\n\n\t\tif ( this._targetRay === null ) {\n\n\t\t\tthis._targetRay = new Group();\n\t\t\tthis._targetRay.matrixAutoUpdate = false;\n\t\t\tthis._targetRay.visible = false;\n\t\t\tthis._targetRay.hasLinearVelocity = false;\n\t\t\tthis._targetRay.linearVelocity = new Vector3();\n\t\t\tthis._targetRay.hasAngularVelocity = false;\n\t\t\tthis._targetRay.angularVelocity = new Vector3();\n\n\t\t}\n\n\t\treturn this._targetRay;\n\n\t}\n\n\tgetGripSpace() {\n\n\t\tif ( this._grip === null ) {\n\n\t\t\tthis._grip = new Group();\n\t\t\tthis._grip.matrixAutoUpdate = false;\n\t\t\tthis._grip.visible = false;\n\t\t\tthis._grip.hasLinearVelocity = false;\n\t\t\tthis._grip.linearVelocity = new Vector3();\n\t\t\tthis._grip.hasAngularVelocity = false;\n\t\t\tthis._grip.angularVelocity = new Vector3();\n\n\t\t}\n\n\t\treturn this._grip;\n\n\t}\n\n\tdispatchEvent( event ) {\n\n\t\tif ( this._targetRay !== null ) {\n\n\t\t\tthis._targetRay.dispatchEvent( event );\n\n\t\t}\n\n\t\tif ( this._grip !== null ) {\n\n\t\t\tthis._grip.dispatchEvent( event );\n\n\t\t}\n\n\t\tif ( this._hand !== null ) {\n\n\t\t\tthis._hand.dispatchEvent( event );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tdisconnect( inputSource ) {\n\n\t\tthis.dispatchEvent( { type: 'disconnected', data: inputSource } );\n\n\t\tif ( this._targetRay !== null ) {\n\n\t\t\tthis._targetRay.visible = false;\n\n\t\t}\n\n\t\tif ( this._grip !== null ) {\n\n\t\t\tthis._grip.visible = false;\n\n\t\t}\n\n\t\tif ( this._hand !== null ) {\n\n\t\t\tthis._hand.visible = false;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tupdate( inputSource, frame, referenceSpace ) {\n\n\t\tlet inputPose = null;\n\t\tlet gripPose = null;\n\t\tlet handPose = null;\n\n\t\tconst targetRay = this._targetRay;\n\t\tconst grip = this._grip;\n\t\tconst hand = this._hand;\n\n\t\tif ( inputSource && frame.session.visibilityState !== 'visible-blurred' ) {\n\n\t\t\tif ( targetRay !== null ) {\n\n\t\t\t\tinputPose = frame.getPose( inputSource.targetRaySpace, referenceSpace );\n\n\t\t\t\tif ( inputPose !== null ) {\n\n\t\t\t\t\ttargetRay.matrix.fromArray( inputPose.transform.matrix );\n\t\t\t\t\ttargetRay.matrix.decompose( targetRay.position, targetRay.rotation, targetRay.scale );\n\n\t\t\t\t\tif ( inputPose.linearVelocity ) {\n\n\t\t\t\t\t\ttargetRay.hasLinearVelocity = true;\n\t\t\t\t\t\ttargetRay.linearVelocity.copy( inputPose.linearVelocity );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttargetRay.hasLinearVelocity = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( inputPose.angularVelocity ) {\n\n\t\t\t\t\t\ttargetRay.hasAngularVelocity = true;\n\t\t\t\t\t\ttargetRay.angularVelocity.copy( inputPose.angularVelocity );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttargetRay.hasAngularVelocity = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.dispatchEvent( _moveEvent );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( hand && inputSource.hand ) {\n\n\t\t\t\thandPose = true;\n\n\t\t\t\tfor ( const inputjoint of inputSource.hand.values() ) {\n\n\t\t\t\t\t// Update the joints groups with the XRJoint poses\n\t\t\t\t\tconst jointPose = frame.getJointPose( inputjoint, referenceSpace );\n\n\t\t\t\t\tif ( hand.joints[ inputjoint.jointName ] === undefined ) {\n\n\t\t\t\t\t\t// The transform of this joint will be updated with the joint pose on each frame\n\t\t\t\t\t\tconst joint = new Group();\n\t\t\t\t\t\tjoint.matrixAutoUpdate = false;\n\t\t\t\t\t\tjoint.visible = false;\n\t\t\t\t\t\thand.joints[ inputjoint.jointName ] = joint;\n\t\t\t\t\t\t// ??\n\t\t\t\t\t\thand.add( joint );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst joint = hand.joints[ inputjoint.jointName ];\n\n\t\t\t\t\tif ( jointPose !== null ) {\n\n\t\t\t\t\t\tjoint.matrix.fromArray( jointPose.transform.matrix );\n\t\t\t\t\t\tjoint.matrix.decompose( joint.position, joint.rotation, joint.scale );\n\t\t\t\t\t\tjoint.jointRadius = jointPose.radius;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tjoint.visible = jointPose !== null;\n\n\t\t\t\t}\n\n\t\t\t\t// Custom events\n\n\t\t\t\t// Check pinchz\n\t\t\t\tconst indexTip = hand.joints[ 'index-finger-tip' ];\n\t\t\t\tconst thumbTip = hand.joints[ 'thumb-tip' ];\n\t\t\t\tconst distance = indexTip.position.distanceTo( thumbTip.position );\n\n\t\t\t\tconst distanceToPinch = 0.02;\n\t\t\t\tconst threshold = 0.005;\n\n\t\t\t\tif ( hand.inputState.pinching && distance > distanceToPinch + threshold ) {\n\n\t\t\t\t\thand.inputState.pinching = false;\n\t\t\t\t\tthis.dispatchEvent( {\n\t\t\t\t\t\ttype: 'pinchend',\n\t\t\t\t\t\thandedness: inputSource.handedness,\n\t\t\t\t\t\ttarget: this\n\t\t\t\t\t} );\n\n\t\t\t\t} else if ( ! hand.inputState.pinching && distance <= distanceToPinch - threshold ) {\n\n\t\t\t\t\thand.inputState.pinching = true;\n\t\t\t\t\tthis.dispatchEvent( {\n\t\t\t\t\t\ttype: 'pinchstart',\n\t\t\t\t\t\thandedness: inputSource.handedness,\n\t\t\t\t\t\ttarget: this\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( grip !== null && inputSource.gripSpace ) {\n\n\t\t\t\t\tgripPose = frame.getPose( inputSource.gripSpace, referenceSpace );\n\n\t\t\t\t\tif ( gripPose !== null ) {\n\n\t\t\t\t\t\tgrip.matrix.fromArray( gripPose.transform.matrix );\n\t\t\t\t\t\tgrip.matrix.decompose( grip.position, grip.rotation, grip.scale );\n\n\t\t\t\t\t\tif ( gripPose.linearVelocity ) {\n\n\t\t\t\t\t\t\tgrip.hasLinearVelocity = true;\n\t\t\t\t\t\t\tgrip.linearVelocity.copy( gripPose.linearVelocity );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tgrip.hasLinearVelocity = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( gripPose.angularVelocity ) {\n\n\t\t\t\t\t\t\tgrip.hasAngularVelocity = true;\n\t\t\t\t\t\t\tgrip.angularVelocity.copy( gripPose.angularVelocity );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tgrip.hasAngularVelocity = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( targetRay !== null ) {\n\n\t\t\ttargetRay.visible = ( inputPose !== null );\n\n\t\t}\n\n\t\tif ( grip !== null ) {\n\n\t\t\tgrip.visible = ( gripPose !== null );\n\n\t\t}\n\n\t\tif ( hand !== null ) {\n\n\t\t\thand.visible = ( handPose !== null );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\n\nexport { WebXRController };\n","import { ArrayCamera } from '../../cameras/ArrayCamera.js';\nimport { EventDispatcher } from '../../core/EventDispatcher.js';\nimport { PerspectiveCamera } from '../../cameras/PerspectiveCamera.js';\nimport { Vector3 } from '../../math/Vector3.js';\nimport { Vector4 } from '../../math/Vector4.js';\nimport { WebGLAnimation } from '../webgl/WebGLAnimation.js';\nimport { WebXRController } from './WebXRController.js';\n\nclass WebXRManager extends EventDispatcher {\n\n\tconstructor( renderer, gl ) {\n\n\t\tsuper();\n\n\t\tconst scope = this;\n\t\tconst state = renderer.state;\n\n\t\tlet session = null;\n\t\tlet framebufferScaleFactor = 1.0;\n\n\t\tlet referenceSpace = null;\n\t\tlet referenceSpaceType = 'local-floor';\n\n\t\tlet pose = null;\n\t\tlet glBinding = null;\n\t\tlet glFramebuffer = null;\n\t\tlet glProjLayer = null;\n\t\tlet glBaseLayer = null;\n\t\tlet isMultisample = false;\n\t\tlet glMultisampledFramebuffer = null;\n\t\tlet glColorRenderbuffer = null;\n\t\tlet glDepthRenderbuffer = null;\n\t\tlet xrFrame = null;\n\t\tlet depthStyle = null;\n\t\tlet clearStyle = null;\n\n\t\tconst controllers = [];\n\t\tconst inputSourcesMap = new Map();\n\n\t\t//\n\n\t\tconst cameraL = new PerspectiveCamera();\n\t\tcameraL.layers.enable( 1 );\n\t\tcameraL.viewport = new Vector4();\n\n\t\tconst cameraR = new PerspectiveCamera();\n\t\tcameraR.layers.enable( 2 );\n\t\tcameraR.viewport = new Vector4();\n\n\t\tconst cameras = [ cameraL, cameraR ];\n\n\t\tconst cameraVR = new ArrayCamera();\n\t\tcameraVR.layers.enable( 1 );\n\t\tcameraVR.layers.enable( 2 );\n\n\t\tlet _currentDepthNear = null;\n\t\tlet _currentDepthFar = null;\n\n\t\t//\n\n\t\tthis.cameraAutoUpdate = true;\n\t\tthis.enabled = false;\n\n\t\tthis.isPresenting = false;\n\n\t\tthis.getController = function ( index ) {\n\n\t\t\tlet controller = controllers[ index ];\n\n\t\t\tif ( controller === undefined ) {\n\n\t\t\t\tcontroller = new WebXRController();\n\t\t\t\tcontrollers[ index ] = controller;\n\n\t\t\t}\n\n\t\t\treturn controller.getTargetRaySpace();\n\n\t\t};\n\n\t\tthis.getControllerGrip = function ( index ) {\n\n\t\t\tlet controller = controllers[ index ];\n\n\t\t\tif ( controller === undefined ) {\n\n\t\t\t\tcontroller = new WebXRController();\n\t\t\t\tcontrollers[ index ] = controller;\n\n\t\t\t}\n\n\t\t\treturn controller.getGripSpace();\n\n\t\t};\n\n\t\tthis.getHand = function ( index ) {\n\n\t\t\tlet controller = controllers[ index ];\n\n\t\t\tif ( controller === undefined ) {\n\n\t\t\t\tcontroller = new WebXRController();\n\t\t\t\tcontrollers[ index ] = controller;\n\n\t\t\t}\n\n\t\t\treturn controller.getHandSpace();\n\n\t\t};\n\n\t\t//\n\n\t\tfunction onSessionEvent( event ) {\n\n\t\t\tconst controller = inputSourcesMap.get( event.inputSource );\n\n\t\t\tif ( controller ) {\n\n\t\t\t\tcontroller.dispatchEvent( { type: event.type, data: event.inputSource } );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onSessionEnd() {\n\n\t\t\tinputSourcesMap.forEach( function ( controller, inputSource ) {\n\n\t\t\t\tcontroller.disconnect( inputSource );\n\n\t\t\t} );\n\n\t\t\tinputSourcesMap.clear();\n\n\t\t\t_currentDepthNear = null;\n\t\t\t_currentDepthFar = null;\n\n\t\t\t// restore framebuffer/rendering state\n\n\t\t\tstate.bindXRFramebuffer( null );\n\t\t\trenderer.setRenderTarget( renderer.getRenderTarget() );\n\n\t\t\tif ( glFramebuffer ) gl.deleteFramebuffer( glFramebuffer );\n\t\t\tif ( glMultisampledFramebuffer ) gl.deleteFramebuffer( glMultisampledFramebuffer );\n\t\t\tif ( glColorRenderbuffer ) gl.deleteRenderbuffer( glColorRenderbuffer );\n\t\t\tif ( glDepthRenderbuffer ) gl.deleteRenderbuffer( glDepthRenderbuffer );\n\t\t\tglFramebuffer = null;\n\t\t\tglMultisampledFramebuffer = null;\n\t\t\tglColorRenderbuffer = null;\n\t\t\tglDepthRenderbuffer = null;\n\t\t\tglBaseLayer = null;\n\t\t\tglProjLayer = null;\n\t\t\tglBinding = null;\n\t\t\tsession = null;\n\n\t\t\t//\n\n\t\t\tanimation.stop();\n\n\t\t\tscope.isPresenting = false;\n\n\t\t\tscope.dispatchEvent( { type: 'sessionend' } );\n\n\t\t}\n\n\t\tthis.setFramebufferScaleFactor = function ( value ) {\n\n\t\t\tframebufferScaleFactor = value;\n\n\t\t\tif ( scope.isPresenting === true ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebXRManager: Cannot change framebuffer scale while presenting.' );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setReferenceSpaceType = function ( value ) {\n\n\t\t\treferenceSpaceType = value;\n\n\t\t\tif ( scope.isPresenting === true ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebXRManager: Cannot change reference space type while presenting.' );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.getReferenceSpace = function () {\n\n\t\t\treturn referenceSpace;\n\n\t\t};\n\n\t\tthis.getBaseLayer = function () {\n\n\t\t\treturn glProjLayer !== null ? glProjLayer : glBaseLayer;\n\n\t\t};\n\n\t\tthis.getBinding = function () {\n\n\t\t\treturn glBinding;\n\n\t\t};\n\n\t\tthis.getFrame = function () {\n\n\t\t\treturn xrFrame;\n\n\t\t};\n\n\t\tthis.getSession = function () {\n\n\t\t\treturn session;\n\n\t\t};\n\n\t\tthis.setSession = async function ( value ) {\n\n\t\t\tsession = value;\n\n\t\t\tif ( session !== null ) {\n\n\t\t\t\tsession.addEventListener( 'select', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'selectstart', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'selectend', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'squeeze', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'squeezestart', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'squeezeend', onSessionEvent );\n\t\t\t\tsession.addEventListener( 'end', onSessionEnd );\n\t\t\t\tsession.addEventListener( 'inputsourceschange', onInputSourcesChange );\n\n\t\t\t\tconst attributes = gl.getContextAttributes();\n\n\t\t\t\tif ( attributes.xrCompatible !== true ) {\n\n\t\t\t\t\tawait gl.makeXRCompatible();\n\n\t\t\t\t}\n\n\t\t\t\tif ( session.renderState.layers === undefined ) {\n\n\t\t\t\t\tconst layerInit = {\n\t\t\t\t\t\tantialias: attributes.antialias,\n\t\t\t\t\t\talpha: attributes.alpha,\n\t\t\t\t\t\tdepth: attributes.depth,\n\t\t\t\t\t\tstencil: attributes.stencil,\n\t\t\t\t\t\tframebufferScaleFactor: framebufferScaleFactor\n\t\t\t\t\t};\n\n\t\t\t\t\tglBaseLayer = new XRWebGLLayer( session, gl, layerInit );\n\n\t\t\t\t\tsession.updateRenderState( { baseLayer: glBaseLayer } );\n\n\t\t\t\t} else if ( gl instanceof WebGLRenderingContext ) {\n\n\t\t\t\t\t// Use old style webgl layer because we can't use MSAA\n\t\t\t\t\t// WebGL2 support.\n\n\t\t\t\t\tconst layerInit = {\n\t\t\t\t\t\tantialias: true,\n\t\t\t\t\t\talpha: attributes.alpha,\n\t\t\t\t\t\tdepth: attributes.depth,\n\t\t\t\t\t\tstencil: attributes.stencil,\n\t\t\t\t\t\tframebufferScaleFactor: framebufferScaleFactor\n\t\t\t\t\t};\n\n\t\t\t\t\tglBaseLayer = new XRWebGLLayer( session, gl, layerInit );\n\n\t\t\t\t\tsession.updateRenderState( { layers: [ glBaseLayer ] } );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tisMultisample = attributes.antialias;\n\t\t\t\t\tlet depthFormat = null;\n\n\n\t\t\t\t\tif ( attributes.depth ) {\n\n\t\t\t\t\t\tclearStyle = gl.DEPTH_BUFFER_BIT;\n\n\t\t\t\t\t\tif ( attributes.stencil ) clearStyle |= gl.STENCIL_BUFFER_BIT;\n\n\t\t\t\t\t\tdepthStyle = attributes.stencil ? gl.DEPTH_STENCIL_ATTACHMENT : gl.DEPTH_ATTACHMENT;\n\t\t\t\t\t\tdepthFormat = attributes.stencil ? gl.DEPTH24_STENCIL8 : gl.DEPTH_COMPONENT24;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst projectionlayerInit = {\n\t\t\t\t\t\tcolorFormat: attributes.alpha ? gl.RGBA8 : gl.RGB8,\n\t\t\t\t\t\tdepthFormat: depthFormat,\n\t\t\t\t\t\tscaleFactor: framebufferScaleFactor\n\t\t\t\t\t};\n\n\t\t\t\t\tglBinding = new XRWebGLBinding( session, gl );\n\n\t\t\t\t\tglProjLayer = glBinding.createProjectionLayer( projectionlayerInit );\n\n\t\t\t\t\tglFramebuffer = gl.createFramebuffer();\n\n\t\t\t\t\tsession.updateRenderState( { layers: [ glProjLayer ] } );\n\n\t\t\t\t\tif ( isMultisample ) {\n\n\t\t\t\t\t\tglMultisampledFramebuffer = gl.createFramebuffer();\n\t\t\t\t\t\tglColorRenderbuffer = gl.createRenderbuffer();\n\t\t\t\t\t\tgl.bindRenderbuffer( gl.RENDERBUFFER, glColorRenderbuffer );\n\t\t\t\t\t\tgl.renderbufferStorageMultisample(\n\t\t\t\t\t\t\tgl.RENDERBUFFER,\n\t\t\t\t\t\t\t4,\n\t\t\t\t\t\t\tgl.RGBA8,\n\t\t\t\t\t\t\tglProjLayer.textureWidth,\n\t\t\t\t\t\t\tglProjLayer.textureHeight );\n\t\t\t\t\t\tstate.bindFramebuffer( gl.FRAMEBUFFER, glMultisampledFramebuffer );\n\t\t\t\t\t\tgl.framebufferRenderbuffer( gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.RENDERBUFFER, glColorRenderbuffer );\n\t\t\t\t\t\tgl.bindRenderbuffer( gl.RENDERBUFFER, null );\n\n\t\t\t\t\t\tif ( depthFormat !== null ) {\n\n\t\t\t\t\t\t\tglDepthRenderbuffer = gl.createRenderbuffer();\n\t\t\t\t\t\t\tgl.bindRenderbuffer( gl.RENDERBUFFER, glDepthRenderbuffer );\n\t\t\t\t\t\t\tgl.renderbufferStorageMultisample( gl.RENDERBUFFER, 4, depthFormat, glProjLayer.textureWidth, glProjLayer.textureHeight );\n\t\t\t\t\t\t\tgl.framebufferRenderbuffer( gl.FRAMEBUFFER, depthStyle, gl.RENDERBUFFER, glDepthRenderbuffer );\n\t\t\t\t\t\t\tgl.bindRenderbuffer( gl.RENDERBUFFER, null );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.bindFramebuffer( gl.FRAMEBUFFER, null );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treferenceSpace = await session.requestReferenceSpace( referenceSpaceType );\n\n\t\t\t\tanimation.setContext( session );\n\t\t\t\tanimation.start();\n\n\t\t\t\tscope.isPresenting = true;\n\n\t\t\t\tscope.dispatchEvent( { type: 'sessionstart' } );\n\n\t\t\t}\n\n\t\t};\n\n\t\tfunction onInputSourcesChange( event ) {\n\n\t\t\tconst inputSources = session.inputSources;\n\n\t\t\t// Assign inputSources to available controllers\n\n\t\t\tfor ( let i = 0; i < controllers.length; i ++ ) {\n\n\t\t\t\tinputSourcesMap.set( inputSources[ i ], controllers[ i ] );\n\n\t\t\t}\n\n\t\t\t// Notify disconnected\n\n\t\t\tfor ( let i = 0; i < event.removed.length; i ++ ) {\n\n\t\t\t\tconst inputSource = event.removed[ i ];\n\t\t\t\tconst controller = inputSourcesMap.get( inputSource );\n\n\t\t\t\tif ( controller ) {\n\n\t\t\t\t\tcontroller.dispatchEvent( { type: 'disconnected', data: inputSource } );\n\t\t\t\t\tinputSourcesMap.delete( inputSource );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Notify connected\n\n\t\t\tfor ( let i = 0; i < event.added.length; i ++ ) {\n\n\t\t\t\tconst inputSource = event.added[ i ];\n\t\t\t\tconst controller = inputSourcesMap.get( inputSource );\n\n\t\t\t\tif ( controller ) {\n\n\t\t\t\t\tcontroller.dispatchEvent( { type: 'connected', data: inputSource } );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst cameraLPos = new Vector3();\n\t\tconst cameraRPos = new Vector3();\n\n\t\t/**\n\t\t * Assumes 2 cameras that are parallel and share an X-axis, and that\n\t\t * the cameras' projection and world matrices have already been set.\n\t\t * And that near and far planes are identical for both cameras.\n\t\t * Visualization of this technique: https://computergraphics.stackexchange.com/a/4765\n\t\t */\n\t\tfunction setProjectionFromUnion( camera, cameraL, cameraR ) {\n\n\t\t\tcameraLPos.setFromMatrixPosition( cameraL.matrixWorld );\n\t\t\tcameraRPos.setFromMatrixPosition( cameraR.matrixWorld );\n\n\t\t\tconst ipd = cameraLPos.distanceTo( cameraRPos );\n\n\t\t\tconst projL = cameraL.projectionMatrix.elements;\n\t\t\tconst projR = cameraR.projectionMatrix.elements;\n\n\t\t\t// VR systems will have identical far and near planes, and\n\t\t\t// most likely identical top and bottom frustum extents.\n\t\t\t// Use the left camera for these values.\n\t\t\tconst near = projL[ 14 ] / ( projL[ 10 ] - 1 );\n\t\t\tconst far = projL[ 14 ] / ( projL[ 10 ] + 1 );\n\t\t\tconst topFov = ( projL[ 9 ] + 1 ) / projL[ 5 ];\n\t\t\tconst bottomFov = ( projL[ 9 ] - 1 ) / projL[ 5 ];\n\n\t\t\tconst leftFov = ( projL[ 8 ] - 1 ) / projL[ 0 ];\n\t\t\tconst rightFov = ( projR[ 8 ] + 1 ) / projR[ 0 ];\n\t\t\tconst left = near * leftFov;\n\t\t\tconst right = near * rightFov;\n\n\t\t\t// Calculate the new camera's position offset from the\n\t\t\t// left camera. xOffset should be roughly half `ipd`.\n\t\t\tconst zOffset = ipd / ( - leftFov + rightFov );\n\t\t\tconst xOffset = zOffset * - leftFov;\n\n\t\t\t// TODO: Better way to apply this offset?\n\t\t\tcameraL.matrixWorld.decompose( camera.position, camera.quaternion, camera.scale );\n\t\t\tcamera.translateX( xOffset );\n\t\t\tcamera.translateZ( zOffset );\n\t\t\tcamera.matrixWorld.compose( camera.position, camera.quaternion, camera.scale );\n\t\t\tcamera.matrixWorldInverse.copy( camera.matrixWorld ).invert();\n\n\t\t\t// Find the union of the frustum values of the cameras and scale\n\t\t\t// the values so that the near plane's position does not change in world space,\n\t\t\t// although must now be relative to the new union camera.\n\t\t\tconst near2 = near + zOffset;\n\t\t\tconst far2 = far + zOffset;\n\t\t\tconst left2 = left - xOffset;\n\t\t\tconst right2 = right + ( ipd - xOffset );\n\t\t\tconst top2 = topFov * far / far2 * near2;\n\t\t\tconst bottom2 = bottomFov * far / far2 * near2;\n\n\t\t\tcamera.projectionMatrix.makePerspective( left2, right2, top2, bottom2, near2, far2 );\n\n\t\t}\n\n\t\tfunction updateCamera( camera, parent ) {\n\n\t\t\tif ( parent === null ) {\n\n\t\t\t\tcamera.matrixWorld.copy( camera.matrix );\n\n\t\t\t} else {\n\n\t\t\t\tcamera.matrixWorld.multiplyMatrices( parent.matrixWorld, camera.matrix );\n\n\t\t\t}\n\n\t\t\tcamera.matrixWorldInverse.copy( camera.matrixWorld ).invert();\n\n\t\t}\n\n\t\tthis.updateCamera = function ( camera ) {\n\n\t\t\tif ( session === null ) return;\n\n\t\t\tcameraVR.near = cameraR.near = cameraL.near = camera.near;\n\t\t\tcameraVR.far = cameraR.far = cameraL.far = camera.far;\n\n\t\t\tif ( _currentDepthNear !== cameraVR.near || _currentDepthFar !== cameraVR.far ) {\n\n\t\t\t\t// Note that the new renderState won't apply until the next frame. See #18320\n\n\t\t\t\tsession.updateRenderState( {\n\t\t\t\t\tdepthNear: cameraVR.near,\n\t\t\t\t\tdepthFar: cameraVR.far\n\t\t\t\t} );\n\n\t\t\t\t_currentDepthNear = cameraVR.near;\n\t\t\t\t_currentDepthFar = cameraVR.far;\n\n\t\t\t}\n\n\t\t\tconst parent = camera.parent;\n\t\t\tconst cameras = cameraVR.cameras;\n\n\t\t\tupdateCamera( cameraVR, parent );\n\n\t\t\tfor ( let i = 0; i < cameras.length; i ++ ) {\n\n\t\t\t\tupdateCamera( cameras[ i ], parent );\n\n\t\t\t}\n\n\t\t\tcameraVR.matrixWorld.decompose( cameraVR.position, cameraVR.quaternion, cameraVR.scale );\n\n\t\t\t// update user camera and its children\n\n\t\t\tcamera.position.copy( cameraVR.position );\n\t\t\tcamera.quaternion.copy( cameraVR.quaternion );\n\t\t\tcamera.scale.copy( cameraVR.scale );\n\t\t\tcamera.matrix.copy( cameraVR.matrix );\n\t\t\tcamera.matrixWorld.copy( cameraVR.matrixWorld );\n\n\t\t\tconst children = camera.children;\n\n\t\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tchildren[ i ].updateMatrixWorld( true );\n\n\t\t\t}\n\n\t\t\t// update projection matrix for proper view frustum culling\n\n\t\t\tif ( cameras.length === 2 ) {\n\n\t\t\t\tsetProjectionFromUnion( cameraVR, cameraL, cameraR );\n\n\t\t\t} else {\n\n\t\t\t\t// assume single camera setup (AR)\n\n\t\t\t\tcameraVR.projectionMatrix.copy( cameraL.projectionMatrix );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.getCamera = function () {\n\n\t\t\treturn cameraVR;\n\n\t\t};\n\n\t\tthis.getFoveation = function () {\n\n\t\t\tif ( glProjLayer !== null ) {\n\n\t\t\t\treturn glProjLayer.fixedFoveation;\n\n\t\t\t}\n\n\t\t\tif ( glBaseLayer !== null ) {\n\n\t\t\t\treturn glBaseLayer.fixedFoveation;\n\n\t\t\t}\n\n\t\t\treturn undefined;\n\n\t\t};\n\n\t\tthis.setFoveation = function ( foveation ) {\n\n\t\t\t// 0 = no foveation = full resolution\n\t\t\t// 1 = maximum foveation = the edges render at lower resolution\n\n\t\t\tif ( glProjLayer !== null ) {\n\n\t\t\t\tglProjLayer.fixedFoveation = foveation;\n\n\t\t\t}\n\n\t\t\tif ( glBaseLayer !== null && glBaseLayer.fixedFoveation !== undefined ) {\n\n\t\t\t\tglBaseLayer.fixedFoveation = foveation;\n\n\t\t\t}\n\n\t\t};\n\n\t\t// Animation Loop\n\n\t\tlet onAnimationFrameCallback = null;\n\n\t\tfunction onAnimationFrame( time, frame ) {\n\n\t\t\tpose = frame.getViewerPose( referenceSpace );\n\t\t\txrFrame = frame;\n\n\t\t\tif ( pose !== null ) {\n\n\t\t\t\tconst views = pose.views;\n\n\t\t\t\tif ( glBaseLayer !== null ) {\n\n\t\t\t\t\tstate.bindXRFramebuffer( glBaseLayer.framebuffer );\n\n\t\t\t\t}\n\n\t\t\t\tlet cameraVRNeedsUpdate = false;\n\n\t\t\t\t// check if it's necessary to rebuild cameraVR's camera list\n\n\t\t\t\tif ( views.length !== cameraVR.cameras.length ) {\n\n\t\t\t\t\tcameraVR.cameras.length = 0;\n\n\t\t\t\t\tcameraVRNeedsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0; i < views.length; i ++ ) {\n\n\t\t\t\t\tconst view = views[ i ];\n\n\t\t\t\t\tlet viewport = null;\n\n\t\t\t\t\tif ( glBaseLayer !== null ) {\n\n\t\t\t\t\t\tviewport = glBaseLayer.getViewport( view );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconst glSubImage = glBinding.getViewSubImage( glProjLayer, view );\n\n\t\t\t\t\t\tstate.bindXRFramebuffer( glFramebuffer );\n\n\t\t\t\t\t\tif ( glSubImage.depthStencilTexture !== undefined ) {\n\n\t\t\t\t\t\t\tgl.framebufferTexture2D( gl.FRAMEBUFFER, depthStyle, gl.TEXTURE_2D, glSubImage.depthStencilTexture, 0 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tgl.framebufferTexture2D( gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, glSubImage.colorTexture, 0 );\n\n\t\t\t\t\t\tviewport = glSubImage.viewport;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst camera = cameras[ i ];\n\n\t\t\t\t\tcamera.matrix.fromArray( view.transform.matrix );\n\t\t\t\t\tcamera.projectionMatrix.fromArray( view.projectionMatrix );\n\t\t\t\t\tcamera.viewport.set( viewport.x, viewport.y, viewport.width, viewport.height );\n\n\t\t\t\t\tif ( i === 0 ) {\n\n\t\t\t\t\t\tcameraVR.matrix.copy( camera.matrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( cameraVRNeedsUpdate === true ) {\n\n\t\t\t\t\t\tcameraVR.cameras.push( camera );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( isMultisample ) {\n\n\t\t\t\t\tstate.bindXRFramebuffer( glMultisampledFramebuffer );\n\n\t\t\t\t\tif ( clearStyle !== null ) gl.clear( clearStyle );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tconst inputSources = session.inputSources;\n\n\t\t\tfor ( let i = 0; i < controllers.length; i ++ ) {\n\n\t\t\t\tconst controller = controllers[ i ];\n\t\t\t\tconst inputSource = inputSources[ i ];\n\n\t\t\t\tcontroller.update( inputSource, frame, referenceSpace );\n\n\t\t\t}\n\n\t\t\tif ( onAnimationFrameCallback ) onAnimationFrameCallback( time, frame );\n\n\t\t\tif ( isMultisample ) {\n\n\t\t\t\tconst width = glProjLayer.textureWidth;\n\t\t\t\tconst height = glProjLayer.textureHeight;\n\n\t\t\t\tstate.bindFramebuffer( gl.READ_FRAMEBUFFER, glMultisampledFramebuffer );\n\t\t\t\tstate.bindFramebuffer( gl.DRAW_FRAMEBUFFER, glFramebuffer );\n\t\t\t\t// Invalidate the depth here to avoid flush of the depth data to main memory.\n\t\t\t\tgl.invalidateFramebuffer( gl.READ_FRAMEBUFFER, [ depthStyle ] );\n\t\t\t\tgl.invalidateFramebuffer( gl.DRAW_FRAMEBUFFER, [ depthStyle ] );\n\t\t\t\tgl.blitFramebuffer( 0, 0, width, height, 0, 0, width, height, gl.COLOR_BUFFER_BIT, gl.NEAREST );\n\t\t\t\t// Invalidate the MSAA buffer because it's not needed anymore.\n\t\t\t\tgl.invalidateFramebuffer( gl.READ_FRAMEBUFFER, [ gl.COLOR_ATTACHMENT0 ] );\n\t\t\t\tstate.bindFramebuffer( gl.READ_FRAMEBUFFER, null );\n\t\t\t\tstate.bindFramebuffer( gl.DRAW_FRAMEBUFFER, null );\n\n\t\t\t\tstate.bindFramebuffer( gl.FRAMEBUFFER, glMultisampledFramebuffer );\n\n\t\t\t}\n\n\t\t\txrFrame = null;\n\n\t\t}\n\n\t\tconst animation = new WebGLAnimation();\n\n\t\tanimation.setAnimationLoop( onAnimationFrame );\n\n\t\tthis.setAnimationLoop = function ( callback ) {\n\n\t\t\tonAnimationFrameCallback = callback;\n\n\t\t};\n\n\t\tthis.dispose = function () {};\n\n\t}\n\n}\n\nexport { WebXRManager };\n","import { BackSide } from '../../constants.js';\n\nfunction WebGLMaterials( properties ) {\n\n\tfunction refreshFogUniforms( uniforms, fog ) {\n\n\t\tuniforms.fogColor.value.copy( fog.color );\n\n\t\tif ( fog.isFog ) {\n\n\t\t\tuniforms.fogNear.value = fog.near;\n\t\t\tuniforms.fogFar.value = fog.far;\n\n\t\t} else if ( fog.isFogExp2 ) {\n\n\t\t\tuniforms.fogDensity.value = fog.density;\n\n\t\t}\n\n\t}\n\n\tfunction refreshMaterialUniforms( uniforms, material, pixelRatio, height, transmissionRenderTarget ) {\n\n\t\tif ( material.isMeshBasicMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\n\t\t} else if ( material.isMeshLambertMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsLambert( uniforms, material );\n\n\t\t} else if ( material.isMeshToonMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsToon( uniforms, material );\n\n\t\t} else if ( material.isMeshPhongMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsPhong( uniforms, material );\n\n\t\t} else if ( material.isMeshStandardMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\n\t\t\tif ( material.isMeshPhysicalMaterial ) {\n\n\t\t\t\trefreshUniformsPhysical( uniforms, material, transmissionRenderTarget );\n\n\t\t\t} else {\n\n\t\t\t\trefreshUniformsStandard( uniforms, material );\n\n\t\t\t}\n\n\t\t} else if ( material.isMeshMatcapMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsMatcap( uniforms, material );\n\n\t\t} else if ( material.isMeshDepthMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsDepth( uniforms, material );\n\n\t\t} else if ( material.isMeshDistanceMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsDistance( uniforms, material );\n\n\t\t} else if ( material.isMeshNormalMaterial ) {\n\n\t\t\trefreshUniformsCommon( uniforms, material );\n\t\t\trefreshUniformsNormal( uniforms, material );\n\n\t\t} else if ( material.isLineBasicMaterial ) {\n\n\t\t\trefreshUniformsLine( uniforms, material );\n\n\t\t\tif ( material.isLineDashedMaterial ) {\n\n\t\t\t\trefreshUniformsDash( uniforms, material );\n\n\t\t\t}\n\n\t\t} else if ( material.isPointsMaterial ) {\n\n\t\t\trefreshUniformsPoints( uniforms, material, pixelRatio, height );\n\n\t\t} else if ( material.isSpriteMaterial ) {\n\n\t\t\trefreshUniformsSprites( uniforms, material );\n\n\t\t} else if ( material.isShadowMaterial ) {\n\n\t\t\tuniforms.color.value.copy( material.color );\n\t\t\tuniforms.opacity.value = material.opacity;\n\n\t\t} else if ( material.isShaderMaterial ) {\n\n\t\t\tmaterial.uniformsNeedUpdate = false; // #15581\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsCommon( uniforms, material ) {\n\n\t\tuniforms.opacity.value = material.opacity;\n\n\t\tif ( material.color ) {\n\n\t\t\tuniforms.diffuse.value.copy( material.color );\n\n\t\t}\n\n\t\tif ( material.emissive ) {\n\n\t\t\tuniforms.emissive.value.copy( material.emissive ).multiplyScalar( material.emissiveIntensity );\n\n\t\t}\n\n\t\tif ( material.map ) {\n\n\t\t\tuniforms.map.value = material.map;\n\n\t\t}\n\n\t\tif ( material.alphaMap ) {\n\n\t\t\tuniforms.alphaMap.value = material.alphaMap;\n\n\t\t}\n\n\t\tif ( material.specularMap ) {\n\n\t\t\tuniforms.specularMap.value = material.specularMap;\n\n\t\t}\n\n\t\tif ( material.alphaTest > 0 ) {\n\n\t\t\tuniforms.alphaTest.value = material.alphaTest;\n\n\t\t}\n\n\t\tconst envMap = properties.get( material ).envMap;\n\n\t\tif ( envMap ) {\n\n\t\t\tuniforms.envMap.value = envMap;\n\n\t\t\tuniforms.flipEnvMap.value = ( envMap.isCubeTexture && envMap.isRenderTargetTexture === false ) ? - 1 : 1;\n\n\t\t\tuniforms.reflectivity.value = material.reflectivity;\n\t\t\tuniforms.ior.value = material.ior;\n\t\t\tuniforms.refractionRatio.value = material.refractionRatio;\n\n\t\t\tconst maxMipLevel = properties.get( envMap ).__maxMipLevel;\n\n\t\t\tif ( maxMipLevel !== undefined ) {\n\n\t\t\t\tuniforms.maxMipLevel.value = maxMipLevel;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( material.lightMap ) {\n\n\t\t\tuniforms.lightMap.value = material.lightMap;\n\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\n\n\t\t}\n\n\t\tif ( material.aoMap ) {\n\n\t\t\tuniforms.aoMap.value = material.aoMap;\n\t\t\tuniforms.aoMapIntensity.value = material.aoMapIntensity;\n\n\t\t}\n\n\t\t// uv repeat and offset setting priorities\n\t\t// 1. color map\n\t\t// 2. specular map\n\t\t// 3. displacementMap map\n\t\t// 4. normal map\n\t\t// 5. bump map\n\t\t// 6. roughnessMap map\n\t\t// 7. metalnessMap map\n\t\t// 8. alphaMap map\n\t\t// 9. emissiveMap map\n\t\t// 10. clearcoat map\n\t\t// 11. clearcoat normal map\n\t\t// 12. clearcoat roughnessMap map\n\t\t// 13. specular intensity map\n\t\t// 14. specular tint map\n\t\t// 15. transmission map\n\t\t// 16. thickness map\n\n\t\tlet uvScaleMap;\n\n\t\tif ( material.map ) {\n\n\t\t\tuvScaleMap = material.map;\n\n\t\t} else if ( material.specularMap ) {\n\n\t\t\tuvScaleMap = material.specularMap;\n\n\t\t} else if ( material.displacementMap ) {\n\n\t\t\tuvScaleMap = material.displacementMap;\n\n\t\t} else if ( material.normalMap ) {\n\n\t\t\tuvScaleMap = material.normalMap;\n\n\t\t} else if ( material.bumpMap ) {\n\n\t\t\tuvScaleMap = material.bumpMap;\n\n\t\t} else if ( material.roughnessMap ) {\n\n\t\t\tuvScaleMap = material.roughnessMap;\n\n\t\t} else if ( material.metalnessMap ) {\n\n\t\t\tuvScaleMap = material.metalnessMap;\n\n\t\t} else if ( material.alphaMap ) {\n\n\t\t\tuvScaleMap = material.alphaMap;\n\n\t\t} else if ( material.emissiveMap ) {\n\n\t\t\tuvScaleMap = material.emissiveMap;\n\n\t\t} else if ( material.clearcoatMap ) {\n\n\t\t\tuvScaleMap = material.clearcoatMap;\n\n\t\t} else if ( material.clearcoatNormalMap ) {\n\n\t\t\tuvScaleMap = material.clearcoatNormalMap;\n\n\t\t} else if ( material.clearcoatRoughnessMap ) {\n\n\t\t\tuvScaleMap = material.clearcoatRoughnessMap;\n\n\t\t} else if ( material.specularIntensityMap ) {\n\n\t\t\tuvScaleMap = material.specularIntensityMap;\n\n\t\t} else if ( material.specularColorMap ) {\n\n\t\t\tuvScaleMap = material.specularColorMap;\n\n\t\t} else if ( material.transmissionMap ) {\n\n\t\t\tuvScaleMap = material.transmissionMap;\n\n\t\t} else if ( material.thicknessMap ) {\n\n\t\t\tuvScaleMap = material.thicknessMap;\n\n\t\t} else if ( material.sheenColorMap ) {\n\n\t\t\tuvScaleMap = material.sheenColorMap;\n\n\t\t} else if ( material.sheenRoughnessMap ) {\n\n\t\t\tuvScaleMap = material.sheenRoughnessMap;\n\n\t\t}\n\n\t\tif ( uvScaleMap !== undefined ) {\n\n\t\t\t// backwards compatibility\n\t\t\tif ( uvScaleMap.isWebGLRenderTarget ) {\n\n\t\t\t\tuvScaleMap = uvScaleMap.texture;\n\n\t\t\t}\n\n\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\tuvScaleMap.updateMatrix();\n\n\t\t\t}\n\n\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\n\n\t\t}\n\n\t\t// uv repeat and offset setting priorities for uv2\n\t\t// 1. ao map\n\t\t// 2. light map\n\n\t\tlet uv2ScaleMap;\n\n\t\tif ( material.aoMap ) {\n\n\t\t\tuv2ScaleMap = material.aoMap;\n\n\t\t} else if ( material.lightMap ) {\n\n\t\t\tuv2ScaleMap = material.lightMap;\n\n\t\t}\n\n\t\tif ( uv2ScaleMap !== undefined ) {\n\n\t\t\t// backwards compatibility\n\t\t\tif ( uv2ScaleMap.isWebGLRenderTarget ) {\n\n\t\t\t\tuv2ScaleMap = uv2ScaleMap.texture;\n\n\t\t\t}\n\n\t\t\tif ( uv2ScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\tuv2ScaleMap.updateMatrix();\n\n\t\t\t}\n\n\t\t\tuniforms.uv2Transform.value.copy( uv2ScaleMap.matrix );\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsLine( uniforms, material ) {\n\n\t\tuniforms.diffuse.value.copy( material.color );\n\t\tuniforms.opacity.value = material.opacity;\n\n\t}\n\n\tfunction refreshUniformsDash( uniforms, material ) {\n\n\t\tuniforms.dashSize.value = material.dashSize;\n\t\tuniforms.totalSize.value = material.dashSize + material.gapSize;\n\t\tuniforms.scale.value = material.scale;\n\n\t}\n\n\tfunction refreshUniformsPoints( uniforms, material, pixelRatio, height ) {\n\n\t\tuniforms.diffuse.value.copy( material.color );\n\t\tuniforms.opacity.value = material.opacity;\n\t\tuniforms.size.value = material.size * pixelRatio;\n\t\tuniforms.scale.value = height * 0.5;\n\n\t\tif ( material.map ) {\n\n\t\t\tuniforms.map.value = material.map;\n\n\t\t}\n\n\t\tif ( material.alphaMap ) {\n\n\t\t\tuniforms.alphaMap.value = material.alphaMap;\n\n\t\t}\n\n\t\tif ( material.alphaTest > 0 ) {\n\n\t\t\tuniforms.alphaTest.value = material.alphaTest;\n\n\t\t}\n\n\t\t// uv repeat and offset setting priorities\n\t\t// 1. color map\n\t\t// 2. alpha map\n\n\t\tlet uvScaleMap;\n\n\t\tif ( material.map ) {\n\n\t\t\tuvScaleMap = material.map;\n\n\t\t} else if ( material.alphaMap ) {\n\n\t\t\tuvScaleMap = material.alphaMap;\n\n\t\t}\n\n\t\tif ( uvScaleMap !== undefined ) {\n\n\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\tuvScaleMap.updateMatrix();\n\n\t\t\t}\n\n\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsSprites( uniforms, material ) {\n\n\t\tuniforms.diffuse.value.copy( material.color );\n\t\tuniforms.opacity.value = material.opacity;\n\t\tuniforms.rotation.value = material.rotation;\n\n\t\tif ( material.map ) {\n\n\t\t\tuniforms.map.value = material.map;\n\n\t\t}\n\n\t\tif ( material.alphaMap ) {\n\n\t\t\tuniforms.alphaMap.value = material.alphaMap;\n\n\t\t}\n\n\t\tif ( material.alphaTest > 0 ) {\n\n\t\t\tuniforms.alphaTest.value = material.alphaTest;\n\n\t\t}\n\n\t\t// uv repeat and offset setting priorities\n\t\t// 1. color map\n\t\t// 2. alpha map\n\n\t\tlet uvScaleMap;\n\n\t\tif ( material.map ) {\n\n\t\t\tuvScaleMap = material.map;\n\n\t\t} else if ( material.alphaMap ) {\n\n\t\t\tuvScaleMap = material.alphaMap;\n\n\t\t}\n\n\t\tif ( uvScaleMap !== undefined ) {\n\n\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\tuvScaleMap.updateMatrix();\n\n\t\t\t}\n\n\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsLambert( uniforms, material ) {\n\n\t\tif ( material.emissiveMap ) {\n\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsPhong( uniforms, material ) {\n\n\t\tuniforms.specular.value.copy( material.specular );\n\t\tuniforms.shininess.value = Math.max( material.shininess, 1e-4 ); // to prevent pow( 0.0, 0.0 )\n\n\t\tif ( material.emissiveMap ) {\n\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\n\t\t}\n\n\t\tif ( material.bumpMap ) {\n\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\n\t\t\tif ( material.side === BackSide ) uniforms.bumpScale.value *= - 1;\n\n\t\t}\n\n\t\tif ( material.normalMap ) {\n\n\t\t\tuniforms.normalMap.value = material.normalMap;\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\n\t\t\tif ( material.side === BackSide ) uniforms.normalScale.value.negate();\n\n\t\t}\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsToon( uniforms, material ) {\n\n\t\tif ( material.gradientMap ) {\n\n\t\t\tuniforms.gradientMap.value = material.gradientMap;\n\n\t\t}\n\n\t\tif ( material.emissiveMap ) {\n\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\n\t\t}\n\n\t\tif ( material.bumpMap ) {\n\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\n\t\t\tif ( material.side === BackSide ) uniforms.bumpScale.value *= - 1;\n\n\t\t}\n\n\t\tif ( material.normalMap ) {\n\n\t\t\tuniforms.normalMap.value = material.normalMap;\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\n\t\t\tif ( material.side === BackSide ) uniforms.normalScale.value.negate();\n\n\t\t}\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsStandard( uniforms, material ) {\n\n\t\tuniforms.roughness.value = material.roughness;\n\t\tuniforms.metalness.value = material.metalness;\n\n\t\tif ( material.roughnessMap ) {\n\n\t\t\tuniforms.roughnessMap.value = material.roughnessMap;\n\n\t\t}\n\n\t\tif ( material.metalnessMap ) {\n\n\t\t\tuniforms.metalnessMap.value = material.metalnessMap;\n\n\t\t}\n\n\t\tif ( material.emissiveMap ) {\n\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\n\t\t}\n\n\t\tif ( material.bumpMap ) {\n\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\n\t\t\tif ( material.side === BackSide ) uniforms.bumpScale.value *= - 1;\n\n\t\t}\n\n\t\tif ( material.normalMap ) {\n\n\t\t\tuniforms.normalMap.value = material.normalMap;\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\n\t\t\tif ( material.side === BackSide ) uniforms.normalScale.value.negate();\n\n\t\t}\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t\tconst envMap = properties.get( material ).envMap;\n\n\t\tif ( envMap ) {\n\n\t\t\t//uniforms.envMap.value = material.envMap; // part of uniforms common\n\t\t\tuniforms.envMapIntensity.value = material.envMapIntensity;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsPhysical( uniforms, material, transmissionRenderTarget ) {\n\n\t\trefreshUniformsStandard( uniforms, material );\n\n\t\tuniforms.ior.value = material.ior; // also part of uniforms common\n\n\t\tif ( material.sheen > 0 ) {\n\n\t\t\tuniforms.sheenColor.value.copy( material.sheenColor ).multiplyScalar( material.sheen );\n\n\t\t\tuniforms.sheenRoughness.value = material.sheenRoughness;\n\n\t\t\tif ( material.sheenColorMap ) {\n\n\t\t\t\tuniforms.sheenColorMap.value = material.sheenColorMap;\n\n\t\t\t}\n\n\t\t\tif ( material.sheenRoughnessMap ) {\n\n\t\t\t\tuniforms.sheenRoughnessMap.value = material.sheenRoughnessMap;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( material.clearcoat > 0 ) {\n\n\t\t\tuniforms.clearcoat.value = material.clearcoat;\n\t\t\tuniforms.clearcoatRoughness.value = material.clearcoatRoughness;\n\n\t\t\tif ( material.clearcoatMap ) {\n\n\t\t\t\tuniforms.clearcoatMap.value = material.clearcoatMap;\n\n\t\t\t}\n\n\t\t\tif ( material.clearcoatRoughnessMap ) {\n\n\t\t\t\tuniforms.clearcoatRoughnessMap.value = material.clearcoatRoughnessMap;\n\n\t\t\t}\n\n\t\t\tif ( material.clearcoatNormalMap ) {\n\n\t\t\t\tuniforms.clearcoatNormalScale.value.copy( material.clearcoatNormalScale );\n\t\t\t\tuniforms.clearcoatNormalMap.value = material.clearcoatNormalMap;\n\n\t\t\t\tif ( material.side === BackSide ) {\n\n\t\t\t\t\tuniforms.clearcoatNormalScale.value.negate();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( material.transmission > 0 ) {\n\n\t\t\tuniforms.transmission.value = material.transmission;\n\t\t\tuniforms.transmissionSamplerMap.value = transmissionRenderTarget.texture;\n\t\t\tuniforms.transmissionSamplerSize.value.set( transmissionRenderTarget.width, transmissionRenderTarget.height );\n\n\t\t\tif ( material.transmissionMap ) {\n\n\t\t\t\tuniforms.transmissionMap.value = material.transmissionMap;\n\n\t\t\t}\n\n\t\t\tuniforms.thickness.value = material.thickness;\n\n\t\t\tif ( material.thicknessMap ) {\n\n\t\t\t\tuniforms.thicknessMap.value = material.thicknessMap;\n\n\t\t\t}\n\n\t\t\tuniforms.attenuationDistance.value = material.attenuationDistance;\n\t\t\tuniforms.attenuationColor.value.copy( material.attenuationColor );\n\n\t\t}\n\n\t\tuniforms.specularIntensity.value = material.specularIntensity;\n\t\tuniforms.specularColor.value.copy( material.specularColor );\n\n\t\tif ( material.specularIntensityMap ) {\n\n\t\t\tuniforms.specularIntensityMap.value = material.specularIntensityMap;\n\n\t\t}\n\n\t\tif ( material.specularColorMap ) {\n\n\t\t\tuniforms.specularColorMap.value = material.specularColorMap;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsMatcap( uniforms, material ) {\n\n\t\tif ( material.matcap ) {\n\n\t\t\tuniforms.matcap.value = material.matcap;\n\n\t\t}\n\n\t\tif ( material.bumpMap ) {\n\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\n\t\t\tif ( material.side === BackSide ) uniforms.bumpScale.value *= - 1;\n\n\t\t}\n\n\t\tif ( material.normalMap ) {\n\n\t\t\tuniforms.normalMap.value = material.normalMap;\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\n\t\t\tif ( material.side === BackSide ) uniforms.normalScale.value.negate();\n\n\t\t}\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsDepth( uniforms, material ) {\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsDistance( uniforms, material ) {\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t\tuniforms.referencePosition.value.copy( material.referencePosition );\n\t\tuniforms.nearDistance.value = material.nearDistance;\n\t\tuniforms.farDistance.value = material.farDistance;\n\n\t}\n\n\tfunction refreshUniformsNormal( uniforms, material ) {\n\n\t\tif ( material.bumpMap ) {\n\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\n\t\t\tif ( material.side === BackSide ) uniforms.bumpScale.value *= - 1;\n\n\t\t}\n\n\t\tif ( material.normalMap ) {\n\n\t\t\tuniforms.normalMap.value = material.normalMap;\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\n\t\t\tif ( material.side === BackSide ) uniforms.normalScale.value.negate();\n\n\t\t}\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t}\n\n\treturn {\n\t\trefreshFogUniforms: refreshFogUniforms,\n\t\trefreshMaterialUniforms: refreshMaterialUniforms\n\t};\n\n}\n\nexport { WebGLMaterials };\n","import {\n\tBackSide,\n\tDoubleSide,\n\tFrontSide,\n\tRGBAFormat,\n\tHalfFloatType,\n\tFloatType,\n\tUnsignedByteType,\n\tLinearEncoding,\n\tNoToneMapping,\n\tLinearMipmapLinearFilter,\n\tNearestFilter,\n\tClampToEdgeWrapping\n} from '../constants.js';\nimport { Frustum } from '../math/Frustum.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Vector4 } from '../math/Vector4.js';\nimport { WebGLAnimation } from './webgl/WebGLAnimation.js';\nimport { WebGLAttributes } from './webgl/WebGLAttributes.js';\nimport { WebGLBackground } from './webgl/WebGLBackground.js';\nimport { WebGLBindingStates } from './webgl/WebGLBindingStates.js';\nimport { WebGLBufferRenderer } from './webgl/WebGLBufferRenderer.js';\nimport { WebGLCapabilities } from './webgl/WebGLCapabilities.js';\nimport { WebGLClipping } from './webgl/WebGLClipping.js';\nimport { WebGLCubeMaps } from './webgl/WebGLCubeMaps.js';\nimport { WebGLCubeUVMaps } from './webgl/WebGLCubeUVMaps.js';\nimport { WebGLExtensions } from './webgl/WebGLExtensions.js';\nimport { WebGLGeometries } from './webgl/WebGLGeometries.js';\nimport { WebGLIndexedBufferRenderer } from './webgl/WebGLIndexedBufferRenderer.js';\nimport { WebGLInfo } from './webgl/WebGLInfo.js';\nimport { WebGLMorphtargets } from './webgl/WebGLMorphtargets.js';\nimport { WebGLMultisampleRenderTarget } from './WebGLMultisampleRenderTarget.js';\nimport { WebGLObjects } from './webgl/WebGLObjects.js';\nimport { WebGLPrograms } from './webgl/WebGLPrograms.js';\nimport { WebGLProperties } from './webgl/WebGLProperties.js';\nimport { WebGLRenderLists } from './webgl/WebGLRenderLists.js';\nimport { WebGLRenderStates } from './webgl/WebGLRenderStates.js';\nimport { WebGLRenderTarget } from './WebGLRenderTarget.js';\nimport { WebGLShadowMap } from './webgl/WebGLShadowMap.js';\nimport { WebGLState } from './webgl/WebGLState.js';\nimport { WebGLTextures } from './webgl/WebGLTextures.js';\nimport { WebGLUniforms } from './webgl/WebGLUniforms.js';\nimport { WebGLUtils } from './webgl/WebGLUtils.js';\nimport { WebXRManager } from './webxr/WebXRManager.js';\nimport { WebGLMaterials } from './webgl/WebGLMaterials.js';\nimport { createElementNS } from '../utils.js';\n\nfunction createCanvasElement() {\n\n\tconst canvas = createElementNS( 'canvas' );\n\tcanvas.style.display = 'block';\n\treturn canvas;\n\n}\n\nfunction WebGLRenderer( parameters = {} ) {\n\n\tconst _canvas = parameters.canvas !== undefined ? parameters.canvas : createCanvasElement(),\n\t\t_context = parameters.context !== undefined ? parameters.context : null,\n\n\t\t_alpha = parameters.alpha !== undefined ? parameters.alpha : false,\n\t\t_depth = parameters.depth !== undefined ? parameters.depth : true,\n\t\t_stencil = parameters.stencil !== undefined ? parameters.stencil : true,\n\t\t_antialias = parameters.antialias !== undefined ? parameters.antialias : false,\n\t\t_premultipliedAlpha = parameters.premultipliedAlpha !== undefined ? parameters.premultipliedAlpha : true,\n\t\t_preserveDrawingBuffer = parameters.preserveDrawingBuffer !== undefined ? parameters.preserveDrawingBuffer : false,\n\t\t_powerPreference = parameters.powerPreference !== undefined ? parameters.powerPreference : 'default',\n\t\t_failIfMajorPerformanceCaveat = parameters.failIfMajorPerformanceCaveat !== undefined ? parameters.failIfMajorPerformanceCaveat : false;\n\n\tlet currentRenderList = null;\n\tlet currentRenderState = null;\n\n\t// render() can be called from within a callback triggered by another render.\n\t// We track this so that the nested render call gets its list and state isolated from the parent render call.\n\n\tconst renderListStack = [];\n\tconst renderStateStack = [];\n\n\t// public properties\n\n\tthis.domElement = _canvas;\n\n\t// Debug configuration container\n\tthis.debug = {\n\n\t\t/**\n\t\t * Enables error checking and reporting when shader programs are being compiled\n\t\t * @type {boolean}\n\t\t */\n\t\tcheckShaderErrors: true\n\t};\n\n\t// clearing\n\n\tthis.autoClear = true;\n\tthis.autoClearColor = true;\n\tthis.autoClearDepth = true;\n\tthis.autoClearStencil = true;\n\n\t// scene graph\n\n\tthis.sortObjects = true;\n\n\t// user-defined clipping\n\n\tthis.clippingPlanes = [];\n\tthis.localClippingEnabled = false;\n\n\t// physically based shading\n\n\tthis.gammaFactor = 2.0;\t// for backwards compatibility\n\tthis.outputEncoding = LinearEncoding;\n\n\t// physical lights\n\n\tthis.physicallyCorrectLights = false;\n\n\t// tone mapping\n\n\tthis.toneMapping = NoToneMapping;\n\tthis.toneMappingExposure = 1.0;\n\n\t// internal properties\n\n\tconst _this = this;\n\n\tlet _isContextLost = false;\n\n\t// internal state cache\n\n\tlet _currentActiveCubeFace = 0;\n\tlet _currentActiveMipmapLevel = 0;\n\tlet _currentRenderTarget = null;\n\tlet _currentMaterialId = - 1;\n\n\tlet _currentCamera = null;\n\n\tconst _currentViewport = new Vector4();\n\tconst _currentScissor = new Vector4();\n\tlet _currentScissorTest = null;\n\n\t//\n\n\tlet _width = _canvas.width;\n\tlet _height = _canvas.height;\n\n\tlet _pixelRatio = 1;\n\tlet _opaqueSort = null;\n\tlet _transparentSort = null;\n\n\tconst _viewport = new Vector4( 0, 0, _width, _height );\n\tconst _scissor = new Vector4( 0, 0, _width, _height );\n\tlet _scissorTest = false;\n\n\t//\n\n\tconst _currentDrawBuffers = [];\n\n\t// frustum\n\n\tconst _frustum = new Frustum();\n\n\t// clipping\n\n\tlet _clippingEnabled = false;\n\tlet _localClippingEnabled = false;\n\n\t// transmission\n\n\tlet _transmissionRenderTarget = null;\n\n\t// camera matrices cache\n\n\tconst _projScreenMatrix = new Matrix4();\n\n\tconst _vector3 = new Vector3();\n\n\tconst _emptyScene = { background: null, fog: null, environment: null, overrideMaterial: null, isScene: true };\n\n\tfunction getTargetPixelRatio() {\n\n\t\treturn _currentRenderTarget === null ? _pixelRatio : 1;\n\n\t}\n\n\t// initialize\n\n\tlet _gl = _context;\n\n\tfunction getContext( contextNames, contextAttributes ) {\n\n\t\tfor ( let i = 0; i < contextNames.length; i ++ ) {\n\n\t\t\tconst contextName = contextNames[ i ];\n\t\t\tconst context = _canvas.getContext( contextName, contextAttributes );\n\t\t\tif ( context !== null ) return context;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\ttry {\n\n\t\tconst contextAttributes = {\n\t\t\talpha: _alpha,\n\t\t\tdepth: _depth,\n\t\t\tstencil: _stencil,\n\t\t\tantialias: _antialias,\n\t\t\tpremultipliedAlpha: _premultipliedAlpha,\n\t\t\tpreserveDrawingBuffer: _preserveDrawingBuffer,\n\t\t\tpowerPreference: _powerPreference,\n\t\t\tfailIfMajorPerformanceCaveat: _failIfMajorPerformanceCaveat\n\t\t};\n\n\t\t// event listeners must be registered before WebGL context is created, see #12753\n\n\t\t_canvas.addEventListener( 'webglcontextlost', onContextLost, false );\n\t\t_canvas.addEventListener( 'webglcontextrestored', onContextRestore, false );\n\n\t\tif ( _gl === null ) {\n\n\t\t\tconst contextNames = [ 'webgl2', 'webgl', 'experimental-webgl' ];\n\n\t\t\tif ( _this.isWebGL1Renderer === true ) {\n\n\t\t\t\tcontextNames.shift();\n\n\t\t\t}\n\n\t\t\t_gl = getContext( contextNames, contextAttributes );\n\n\t\t\tif ( _gl === null ) {\n\n\t\t\t\tif ( getContext( contextNames ) ) {\n\n\t\t\t\t\tthrow new Error( 'Error creating WebGL context with your selected attributes.' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( 'Error creating WebGL context.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Some experimental-webgl implementations do not have getShaderPrecisionFormat\n\n\t\tif ( _gl.getShaderPrecisionFormat === undefined ) {\n\n\t\t\t_gl.getShaderPrecisionFormat = function () {\n\n\t\t\t\treturn { 'rangeMin': 1, 'rangeMax': 1, 'precision': 1 };\n\n\t\t\t};\n\n\t\t}\n\n\t} catch ( error ) {\n\n\t\tconsole.error( 'THREE.WebGLRenderer: ' + error.message );\n\t\tthrow error;\n\n\t}\n\n\tlet extensions, capabilities, state, info;\n\tlet properties, textures, cubemaps, cubeuvmaps, attributes, geometries, objects;\n\tlet programCache, materials, renderLists, renderStates, clipping, shadowMap;\n\n\tlet background, morphtargets, bufferRenderer, indexedBufferRenderer;\n\n\tlet utils, bindingStates;\n\n\tfunction initGLContext() {\n\n\t\textensions = new WebGLExtensions( _gl );\n\n\t\tcapabilities = new WebGLCapabilities( _gl, extensions, parameters );\n\n\t\textensions.init( capabilities );\n\n\t\tutils = new WebGLUtils( _gl, extensions, capabilities );\n\n\t\tstate = new WebGLState( _gl, extensions, capabilities );\n\n\t\t_currentDrawBuffers[ 0 ] = _gl.BACK;\n\n\t\tinfo = new WebGLInfo( _gl );\n\t\tproperties = new WebGLProperties();\n\t\ttextures = new WebGLTextures( _gl, extensions, state, properties, capabilities, utils, info );\n\t\tcubemaps = new WebGLCubeMaps( _this );\n\t\tcubeuvmaps = new WebGLCubeUVMaps( _this );\n\t\tattributes = new WebGLAttributes( _gl, capabilities );\n\t\tbindingStates = new WebGLBindingStates( _gl, extensions, attributes, capabilities );\n\t\tgeometries = new WebGLGeometries( _gl, attributes, info, bindingStates );\n\t\tobjects = new WebGLObjects( _gl, geometries, attributes, info );\n\t\tmorphtargets = new WebGLMorphtargets( _gl, capabilities, textures );\n\t\tclipping = new WebGLClipping( properties );\n\t\tprogramCache = new WebGLPrograms( _this, cubemaps, cubeuvmaps, extensions, capabilities, bindingStates, clipping );\n\t\tmaterials = new WebGLMaterials( properties );\n\t\trenderLists = new WebGLRenderLists( properties );\n\t\trenderStates = new WebGLRenderStates( extensions, capabilities );\n\t\tbackground = new WebGLBackground( _this, cubemaps, state, objects, _premultipliedAlpha );\n\t\tshadowMap = new WebGLShadowMap( _this, objects, capabilities );\n\n\t\tbufferRenderer = new WebGLBufferRenderer( _gl, extensions, info, capabilities );\n\t\tindexedBufferRenderer = new WebGLIndexedBufferRenderer( _gl, extensions, info, capabilities );\n\n\t\tinfo.programs = programCache.programs;\n\n\t\t_this.capabilities = capabilities;\n\t\t_this.extensions = extensions;\n\t\t_this.properties = properties;\n\t\t_this.renderLists = renderLists;\n\t\t_this.shadowMap = shadowMap;\n\t\t_this.state = state;\n\t\t_this.info = info;\n\n\t}\n\n\tinitGLContext();\n\n\t// xr\n\n\tconst xr = new WebXRManager( _this, _gl );\n\n\tthis.xr = xr;\n\n\t// API\n\n\tthis.getContext = function () {\n\n\t\treturn _gl;\n\n\t};\n\n\tthis.getContextAttributes = function () {\n\n\t\treturn _gl.getContextAttributes();\n\n\t};\n\n\tthis.forceContextLoss = function () {\n\n\t\tconst extension = extensions.get( 'WEBGL_lose_context' );\n\t\tif ( extension ) extension.loseContext();\n\n\t};\n\n\tthis.forceContextRestore = function () {\n\n\t\tconst extension = extensions.get( 'WEBGL_lose_context' );\n\t\tif ( extension ) extension.restoreContext();\n\n\t};\n\n\tthis.getPixelRatio = function () {\n\n\t\treturn _pixelRatio;\n\n\t};\n\n\tthis.setPixelRatio = function ( value ) {\n\n\t\tif ( value === undefined ) return;\n\n\t\t_pixelRatio = value;\n\n\t\tthis.setSize( _width, _height, false );\n\n\t};\n\n\tthis.getSize = function ( target ) {\n\n\t\treturn target.set( _width, _height );\n\n\t};\n\n\tthis.setSize = function ( width, height, updateStyle ) {\n\n\t\tif ( xr.isPresenting ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: Can\\'t change size while VR device is presenting.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\t_width = width;\n\t\t_height = height;\n\n\t\t_canvas.width = Math.floor( width * _pixelRatio );\n\t\t_canvas.height = Math.floor( height * _pixelRatio );\n\n\t\tif ( updateStyle !== false ) {\n\n\t\t\t_canvas.style.width = width + 'px';\n\t\t\t_canvas.style.height = height + 'px';\n\n\t\t}\n\n\t\tthis.setViewport( 0, 0, width, height );\n\n\t};\n\n\tthis.getDrawingBufferSize = function ( target ) {\n\n\t\treturn target.set( _width * _pixelRatio, _height * _pixelRatio ).floor();\n\n\t};\n\n\tthis.setDrawingBufferSize = function ( width, height, pixelRatio ) {\n\n\t\t_width = width;\n\t\t_height = height;\n\n\t\t_pixelRatio = pixelRatio;\n\n\t\t_canvas.width = Math.floor( width * pixelRatio );\n\t\t_canvas.height = Math.floor( height * pixelRatio );\n\n\t\tthis.setViewport( 0, 0, width, height );\n\n\t};\n\n\tthis.getCurrentViewport = function ( target ) {\n\n\t\treturn target.copy( _currentViewport );\n\n\t};\n\n\tthis.getViewport = function ( target ) {\n\n\t\treturn target.copy( _viewport );\n\n\t};\n\n\tthis.setViewport = function ( x, y, width, height ) {\n\n\t\tif ( x.isVector4 ) {\n\n\t\t\t_viewport.set( x.x, x.y, x.z, x.w );\n\n\t\t} else {\n\n\t\t\t_viewport.set( x, y, width, height );\n\n\t\t}\n\n\t\tstate.viewport( _currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio ).floor() );\n\n\t};\n\n\tthis.getScissor = function ( target ) {\n\n\t\treturn target.copy( _scissor );\n\n\t};\n\n\tthis.setScissor = function ( x, y, width, height ) {\n\n\t\tif ( x.isVector4 ) {\n\n\t\t\t_scissor.set( x.x, x.y, x.z, x.w );\n\n\t\t} else {\n\n\t\t\t_scissor.set( x, y, width, height );\n\n\t\t}\n\n\t\tstate.scissor( _currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio ).floor() );\n\n\t};\n\n\tthis.getScissorTest = function () {\n\n\t\treturn _scissorTest;\n\n\t};\n\n\tthis.setScissorTest = function ( boolean ) {\n\n\t\tstate.setScissorTest( _scissorTest = boolean );\n\n\t};\n\n\tthis.setOpaqueSort = function ( method ) {\n\n\t\t_opaqueSort = method;\n\n\t};\n\n\tthis.setTransparentSort = function ( method ) {\n\n\t\t_transparentSort = method;\n\n\t};\n\n\t// Clearing\n\n\tthis.getClearColor = function ( target ) {\n\n\t\treturn target.copy( background.getClearColor() );\n\n\t};\n\n\tthis.setClearColor = function () {\n\n\t\tbackground.setClearColor.apply( background, arguments );\n\n\t};\n\n\tthis.getClearAlpha = function () {\n\n\t\treturn background.getClearAlpha();\n\n\t};\n\n\tthis.setClearAlpha = function () {\n\n\t\tbackground.setClearAlpha.apply( background, arguments );\n\n\t};\n\n\tthis.clear = function ( color, depth, stencil ) {\n\n\t\tlet bits = 0;\n\n\t\tif ( color === undefined || color ) bits |= _gl.COLOR_BUFFER_BIT;\n\t\tif ( depth === undefined || depth ) bits |= _gl.DEPTH_BUFFER_BIT;\n\t\tif ( stencil === undefined || stencil ) bits |= _gl.STENCIL_BUFFER_BIT;\n\n\t\t_gl.clear( bits );\n\n\t};\n\n\tthis.clearColor = function () {\n\n\t\tthis.clear( true, false, false );\n\n\t};\n\n\tthis.clearDepth = function () {\n\n\t\tthis.clear( false, true, false );\n\n\t};\n\n\tthis.clearStencil = function () {\n\n\t\tthis.clear( false, false, true );\n\n\t};\n\n\t//\n\n\tthis.dispose = function () {\n\n\t\t_canvas.removeEventListener( 'webglcontextlost', onContextLost, false );\n\t\t_canvas.removeEventListener( 'webglcontextrestored', onContextRestore, false );\n\n\t\trenderLists.dispose();\n\t\trenderStates.dispose();\n\t\tproperties.dispose();\n\t\tcubemaps.dispose();\n\t\tcubeuvmaps.dispose();\n\t\tobjects.dispose();\n\t\tbindingStates.dispose();\n\n\t\txr.dispose();\n\n\t\txr.removeEventListener( 'sessionstart', onXRSessionStart );\n\t\txr.removeEventListener( 'sessionend', onXRSessionEnd );\n\n\t\tif ( _transmissionRenderTarget ) {\n\n\t\t\t_transmissionRenderTarget.dispose();\n\t\t\t_transmissionRenderTarget = null;\n\n\t\t}\n\n\t\tanimation.stop();\n\n\t};\n\n\t// Events\n\n\tfunction onContextLost( event ) {\n\n\t\tevent.preventDefault();\n\n\t\tconsole.log( 'THREE.WebGLRenderer: Context Lost.' );\n\n\t\t_isContextLost = true;\n\n\t}\n\n\tfunction onContextRestore( /* event */ ) {\n\n\t\tconsole.log( 'THREE.WebGLRenderer: Context Restored.' );\n\n\t\t_isContextLost = false;\n\n\t\tconst infoAutoReset = info.autoReset;\n\t\tconst shadowMapEnabled = shadowMap.enabled;\n\t\tconst shadowMapAutoUpdate = shadowMap.autoUpdate;\n\t\tconst shadowMapNeedsUpdate = shadowMap.needsUpdate;\n\t\tconst shadowMapType = shadowMap.type;\n\n\t\tinitGLContext();\n\n\t\tinfo.autoReset = infoAutoReset;\n\t\tshadowMap.enabled = shadowMapEnabled;\n\t\tshadowMap.autoUpdate = shadowMapAutoUpdate;\n\t\tshadowMap.needsUpdate = shadowMapNeedsUpdate;\n\t\tshadowMap.type = shadowMapType;\n\n\t}\n\n\tfunction onMaterialDispose( event ) {\n\n\t\tconst material = event.target;\n\n\t\tmaterial.removeEventListener( 'dispose', onMaterialDispose );\n\n\t\tdeallocateMaterial( material );\n\n\t}\n\n\t// Buffer deallocation\n\n\tfunction deallocateMaterial( material ) {\n\n\t\treleaseMaterialProgramReferences( material );\n\n\t\tproperties.remove( material );\n\n\t}\n\n\n\tfunction releaseMaterialProgramReferences( material ) {\n\n\t\tconst programs = properties.get( material ).programs;\n\n\t\tif ( programs !== undefined ) {\n\n\t\t\tprograms.forEach( function ( program ) {\n\n\t\t\t\tprogramCache.releaseProgram( program );\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\t// Buffer rendering\n\n\tthis.renderBufferDirect = function ( camera, scene, geometry, material, object, group ) {\n\n\t\tif ( scene === null ) scene = _emptyScene; // renderBufferDirect second parameter used to be fog (could be null)\n\n\t\tconst frontFaceCW = ( object.isMesh && object.matrixWorld.determinant() < 0 );\n\n\t\tconst program = setProgram( camera, scene, geometry, material, object );\n\n\t\tstate.setMaterial( material, frontFaceCW );\n\n\t\t//\n\n\t\tlet index = geometry.index;\n\t\tconst position = geometry.attributes.position;\n\n\t\t//\n\n\t\tif ( index === null ) {\n\n\t\t\tif ( position === undefined || position.count === 0 ) return;\n\n\t\t} else if ( index.count === 0 ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t//\n\n\t\tlet rangeFactor = 1;\n\n\t\tif ( material.wireframe === true ) {\n\n\t\t\tindex = geometries.getWireframeAttribute( geometry );\n\t\t\trangeFactor = 2;\n\n\t\t}\n\n\t\tbindingStates.setup( object, material, program, geometry, index );\n\n\t\tlet attribute;\n\t\tlet renderer = bufferRenderer;\n\n\t\tif ( index !== null ) {\n\n\t\t\tattribute = attributes.get( index );\n\n\t\t\trenderer = indexedBufferRenderer;\n\t\t\trenderer.setIndex( attribute );\n\n\t\t}\n\n\t\t//\n\n\t\tconst dataCount = ( index !== null ) ? index.count : position.count;\n\n\t\tconst rangeStart = geometry.drawRange.start * rangeFactor;\n\t\tconst rangeCount = geometry.drawRange.count * rangeFactor;\n\n\t\tconst groupStart = group !== null ? group.start * rangeFactor : 0;\n\t\tconst groupCount = group !== null ? group.count * rangeFactor : Infinity;\n\n\t\tconst drawStart = Math.max( rangeStart, groupStart );\n\t\tconst drawEnd = Math.min( dataCount, rangeStart + rangeCount, groupStart + groupCount ) - 1;\n\n\t\tconst drawCount = Math.max( 0, drawEnd - drawStart + 1 );\n\n\t\tif ( drawCount === 0 ) return;\n\n\t\t//\n\n\t\tif ( object.isMesh ) {\n\n\t\t\tif ( material.wireframe === true ) {\n\n\t\t\t\tstate.setLineWidth( material.wireframeLinewidth * getTargetPixelRatio() );\n\t\t\t\trenderer.setMode( _gl.LINES );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setMode( _gl.TRIANGLES );\n\n\t\t\t}\n\n\t\t} else if ( object.isLine ) {\n\n\t\t\tlet lineWidth = material.linewidth;\n\n\t\t\tif ( lineWidth === undefined ) lineWidth = 1; // Not using Line*Material\n\n\t\t\tstate.setLineWidth( lineWidth * getTargetPixelRatio() );\n\n\t\t\tif ( object.isLineSegments ) {\n\n\t\t\t\trenderer.setMode( _gl.LINES );\n\n\t\t\t} else if ( object.isLineLoop ) {\n\n\t\t\t\trenderer.setMode( _gl.LINE_LOOP );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setMode( _gl.LINE_STRIP );\n\n\t\t\t}\n\n\t\t} else if ( object.isPoints ) {\n\n\t\t\trenderer.setMode( _gl.POINTS );\n\n\t\t} else if ( object.isSprite ) {\n\n\t\t\trenderer.setMode( _gl.TRIANGLES );\n\n\t\t}\n\n\t\tif ( object.isInstancedMesh ) {\n\n\t\t\trenderer.renderInstances( drawStart, drawCount, object.count );\n\n\t\t} else if ( geometry.isInstancedBufferGeometry ) {\n\n\t\t\tconst instanceCount = Math.min( geometry.instanceCount, geometry._maxInstanceCount );\n\n\t\t\trenderer.renderInstances( drawStart, drawCount, instanceCount );\n\n\t\t} else {\n\n\t\t\trenderer.render( drawStart, drawCount );\n\n\t\t}\n\n\t};\n\n\t// Compile\n\n\tthis.compile = function ( scene, camera ) {\n\n\t\tcurrentRenderState = renderStates.get( scene );\n\t\tcurrentRenderState.init();\n\n\t\trenderStateStack.push( currentRenderState );\n\n\t\tscene.traverseVisible( function ( object ) {\n\n\t\t\tif ( object.isLight && object.layers.test( camera.layers ) ) {\n\n\t\t\t\tcurrentRenderState.pushLight( object );\n\n\t\t\t\tif ( object.castShadow ) {\n\n\t\t\t\t\tcurrentRenderState.pushShadow( object );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t\tcurrentRenderState.setupLights( _this.physicallyCorrectLights );\n\n\t\tscene.traverse( function ( object ) {\n\n\t\t\tconst material = object.material;\n\n\t\t\tif ( material ) {\n\n\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\tfor ( let i = 0; i < material.length; i ++ ) {\n\n\t\t\t\t\t\tconst material2 = material[ i ];\n\n\t\t\t\t\t\tgetProgram( material2, scene, object );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tgetProgram( material, scene, object );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t\trenderStateStack.pop();\n\t\tcurrentRenderState = null;\n\n\t};\n\n\t// Animation Loop\n\n\tlet onAnimationFrameCallback = null;\n\n\tfunction onAnimationFrame( time ) {\n\n\t\tif ( onAnimationFrameCallback ) onAnimationFrameCallback( time );\n\n\t}\n\n\tfunction onXRSessionStart() {\n\n\t\tanimation.stop();\n\n\t}\n\n\tfunction onXRSessionEnd() {\n\n\t\tanimation.start();\n\n\t}\n\n\tconst animation = new WebGLAnimation();\n\tanimation.setAnimationLoop( onAnimationFrame );\n\n\tif ( typeof window !== 'undefined' ) animation.setContext( window );\n\n\tthis.setAnimationLoop = function ( callback ) {\n\n\t\tonAnimationFrameCallback = callback;\n\t\txr.setAnimationLoop( callback );\n\n\t\t( callback === null ) ? animation.stop() : animation.start();\n\n\t};\n\n\txr.addEventListener( 'sessionstart', onXRSessionStart );\n\txr.addEventListener( 'sessionend', onXRSessionEnd );\n\n\t// Rendering\n\n\tthis.render = function ( scene, camera ) {\n\n\t\tif ( camera !== undefined && camera.isCamera !== true ) {\n\n\t\t\tconsole.error( 'THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( _isContextLost === true ) return;\n\n\t\t// update scene graph\n\n\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\n\n\t\t// update camera matrices and frustum\n\n\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\n\n\t\tif ( xr.enabled === true && xr.isPresenting === true ) {\n\n\t\t\tif ( xr.cameraAutoUpdate === true ) xr.updateCamera( camera );\n\n\t\t\tcamera = xr.getCamera(); // use XR camera for rendering\n\n\t\t}\n\n\t\t//\n\t\tif ( scene.isScene === true ) scene.onBeforeRender( _this, scene, camera, _currentRenderTarget );\n\n\t\tcurrentRenderState = renderStates.get( scene, renderStateStack.length );\n\t\tcurrentRenderState.init();\n\n\t\trenderStateStack.push( currentRenderState );\n\n\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\n\t\t_frustum.setFromProjectionMatrix( _projScreenMatrix );\n\n\t\t_localClippingEnabled = this.localClippingEnabled;\n\t\t_clippingEnabled = clipping.init( this.clippingPlanes, _localClippingEnabled, camera );\n\n\t\tcurrentRenderList = renderLists.get( scene, renderListStack.length );\n\t\tcurrentRenderList.init();\n\n\t\trenderListStack.push( currentRenderList );\n\n\t\tprojectObject( scene, camera, 0, _this.sortObjects );\n\n\t\tcurrentRenderList.finish();\n\n\t\tif ( _this.sortObjects === true ) {\n\n\t\t\tcurrentRenderList.sort( _opaqueSort, _transparentSort );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( _clippingEnabled === true ) clipping.beginShadows();\n\n\t\tconst shadowsArray = currentRenderState.state.shadowsArray;\n\n\t\tshadowMap.render( shadowsArray, scene, camera );\n\n\t\tif ( _clippingEnabled === true ) clipping.endShadows();\n\n\t\t//\n\n\t\tif ( this.info.autoReset === true ) this.info.reset();\n\n\t\t//\n\n\t\tbackground.render( currentRenderList, scene );\n\n\t\t// render scene\n\n\t\tcurrentRenderState.setupLights( _this.physicallyCorrectLights );\n\n\t\tif ( camera.isArrayCamera ) {\n\n\t\t\tconst cameras = camera.cameras;\n\n\t\t\tfor ( let i = 0, l = cameras.length; i < l; i ++ ) {\n\n\t\t\t\tconst camera2 = cameras[ i ];\n\n\t\t\t\trenderScene( currentRenderList, scene, camera2, camera2.viewport );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\trenderScene( currentRenderList, scene, camera );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( _currentRenderTarget !== null ) {\n\n\t\t\t// resolve multisample renderbuffers to a single-sample texture if necessary\n\n\t\t\ttextures.updateMultisampleRenderTarget( _currentRenderTarget );\n\n\t\t\t// Generate mipmap if we're using any kind of mipmap filtering\n\n\t\t\ttextures.updateRenderTargetMipmap( _currentRenderTarget );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( scene.isScene === true ) scene.onAfterRender( _this, scene, camera );\n\n\t\t// Ensure depth buffer writing is enabled so it can be cleared on next render\n\n\t\tstate.buffers.depth.setTest( true );\n\t\tstate.buffers.depth.setMask( true );\n\t\tstate.buffers.color.setMask( true );\n\n\t\tstate.setPolygonOffset( false );\n\n\t\t// _gl.finish();\n\n\t\tbindingStates.resetDefaultState();\n\t\t_currentMaterialId = - 1;\n\t\t_currentCamera = null;\n\n\t\trenderStateStack.pop();\n\n\t\tif ( renderStateStack.length > 0 ) {\n\n\t\t\tcurrentRenderState = renderStateStack[ renderStateStack.length - 1 ];\n\n\t\t} else {\n\n\t\t\tcurrentRenderState = null;\n\n\t\t}\n\n\t\trenderListStack.pop();\n\n\t\tif ( renderListStack.length > 0 ) {\n\n\t\t\tcurrentRenderList = renderListStack[ renderListStack.length - 1 ];\n\n\t\t} else {\n\n\t\t\tcurrentRenderList = null;\n\n\t\t}\n\n\t};\n\n\tfunction projectObject( object, camera, groupOrder, sortObjects ) {\n\n\t\tif ( object.visible === false ) return;\n\n\t\tconst visible = object.layers.test( camera.layers );\n\n\t\tif ( visible ) {\n\n\t\t\tif ( object.isGroup ) {\n\n\t\t\t\tgroupOrder = object.renderOrder;\n\n\t\t\t} else if ( object.isLOD ) {\n\n\t\t\t\tif ( object.autoUpdate === true ) object.update( camera );\n\n\t\t\t} else if ( object.isLight ) {\n\n\t\t\t\tcurrentRenderState.pushLight( object );\n\n\t\t\t\tif ( object.castShadow ) {\n\n\t\t\t\t\tcurrentRenderState.pushShadow( object );\n\n\t\t\t\t}\n\n\t\t\t} else if ( object.isSprite ) {\n\n\t\t\t\tif ( ! object.frustumCulled || _frustum.intersectsSprite( object ) ) {\n\n\t\t\t\t\tif ( sortObjects ) {\n\n\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld )\n\t\t\t\t\t\t\t.applyMatrix4( _projScreenMatrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst geometry = objects.update( object );\n\t\t\t\t\tconst material = object.material;\n\n\t\t\t\t\tif ( material.visible ) {\n\n\t\t\t\t\t\tcurrentRenderList.push( object, geometry, material, groupOrder, _vector3.z, null );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( object.isMesh || object.isLine || object.isPoints ) {\n\n\t\t\t\tif ( object.isSkinnedMesh ) {\n\n\t\t\t\t\t// update skeleton only once in a frame\n\n\t\t\t\t\tif ( object.skeleton.frame !== info.render.frame ) {\n\n\t\t\t\t\t\tobject.skeleton.update();\n\t\t\t\t\t\tobject.skeleton.frame = info.render.frame;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( ! object.frustumCulled || _frustum.intersectsObject( object ) ) {\n\n\t\t\t\t\tif ( sortObjects ) {\n\n\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld )\n\t\t\t\t\t\t\t.applyMatrix4( _projScreenMatrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst geometry = objects.update( object );\n\t\t\t\t\tconst material = object.material;\n\n\t\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\t\tconst groups = geometry.groups;\n\n\t\t\t\t\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\t\t\tif ( groupMaterial && groupMaterial.visible ) {\n\n\t\t\t\t\t\t\t\tcurrentRenderList.push( object, geometry, groupMaterial, groupOrder, _vector3.z, group );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( material.visible ) {\n\n\t\t\t\t\t\tcurrentRenderList.push( object, geometry, material, groupOrder, _vector3.z, null );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tprojectObject( children[ i ], camera, groupOrder, sortObjects );\n\n\t\t}\n\n\t}\n\n\tfunction renderScene( currentRenderList, scene, camera, viewport ) {\n\n\t\tconst opaqueObjects = currentRenderList.opaque;\n\t\tconst transmissiveObjects = currentRenderList.transmissive;\n\t\tconst transparentObjects = currentRenderList.transparent;\n\n\t\tcurrentRenderState.setupLightsView( camera );\n\n\t\tif ( transmissiveObjects.length > 0 ) renderTransmissionPass( opaqueObjects, scene, camera );\n\n\t\tif ( viewport ) state.viewport( _currentViewport.copy( viewport ) );\n\n\t\tif ( opaqueObjects.length > 0 ) renderObjects( opaqueObjects, scene, camera );\n\t\tif ( transmissiveObjects.length > 0 ) renderObjects( transmissiveObjects, scene, camera );\n\t\tif ( transparentObjects.length > 0 ) renderObjects( transparentObjects, scene, camera );\n\n\t}\n\n\tfunction renderTransmissionPass( opaqueObjects, scene, camera ) {\n\n\t\tif ( _transmissionRenderTarget === null ) {\n\n\t\t\tconst needsAntialias = _antialias === true && capabilities.isWebGL2 === true;\n\t\t\tconst renderTargetType = needsAntialias ? WebGLMultisampleRenderTarget : WebGLRenderTarget;\n\n\t\t\t_transmissionRenderTarget = new renderTargetType( 1024, 1024, {\n\t\t\t\tgenerateMipmaps: true,\n\t\t\t\ttype: utils.convert( HalfFloatType ) !== null ? HalfFloatType : UnsignedByteType,\n\t\t\t\tminFilter: LinearMipmapLinearFilter,\n\t\t\t\tmagFilter: NearestFilter,\n\t\t\t\twrapS: ClampToEdgeWrapping,\n\t\t\t\twrapT: ClampToEdgeWrapping\n\t\t\t} );\n\n\t\t}\n\n\t\tconst currentRenderTarget = _this.getRenderTarget();\n\t\t_this.setRenderTarget( _transmissionRenderTarget );\n\t\t_this.clear();\n\n\t\t// Turn off the features which can affect the frag color for opaque objects pass.\n\t\t// Otherwise they are applied twice in opaque objects pass and transmission objects pass.\n\t\tconst currentToneMapping = _this.toneMapping;\n\t\t_this.toneMapping = NoToneMapping;\n\n\t\trenderObjects( opaqueObjects, scene, camera );\n\n\t\t_this.toneMapping = currentToneMapping;\n\n\t\ttextures.updateMultisampleRenderTarget( _transmissionRenderTarget );\n\t\ttextures.updateRenderTargetMipmap( _transmissionRenderTarget );\n\n\t\t_this.setRenderTarget( currentRenderTarget );\n\n\t}\n\n\tfunction renderObjects( renderList, scene, camera ) {\n\n\t\tconst overrideMaterial = scene.isScene === true ? scene.overrideMaterial : null;\n\n\t\tfor ( let i = 0, l = renderList.length; i < l; i ++ ) {\n\n\t\t\tconst renderItem = renderList[ i ];\n\n\t\t\tconst object = renderItem.object;\n\t\t\tconst geometry = renderItem.geometry;\n\t\t\tconst material = overrideMaterial === null ? renderItem.material : overrideMaterial;\n\t\t\tconst group = renderItem.group;\n\n\t\t\tif ( object.layers.test( camera.layers ) ) {\n\n\t\t\t\trenderObject( object, scene, camera, geometry, material, group );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction renderObject( object, scene, camera, geometry, material, group ) {\n\n\t\tobject.onBeforeRender( _this, scene, camera, geometry, material, group );\n\n\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\n\t\tobject.normalMatrix.getNormalMatrix( object.modelViewMatrix );\n\n\t\tmaterial.onBeforeRender( _this, scene, camera, geometry, object, group );\n\n\t\tif ( material.transparent === true && material.side === DoubleSide ) {\n\n\t\t\tmaterial.side = BackSide;\n\t\t\tmaterial.needsUpdate = true;\n\t\t\t_this.renderBufferDirect( camera, scene, geometry, material, object, group );\n\n\t\t\tmaterial.side = FrontSide;\n\t\t\tmaterial.needsUpdate = true;\n\t\t\t_this.renderBufferDirect( camera, scene, geometry, material, object, group );\n\n\t\t\tmaterial.side = DoubleSide;\n\n\t\t} else {\n\n\t\t\t_this.renderBufferDirect( camera, scene, geometry, material, object, group );\n\n\t\t}\n\n\t\tobject.onAfterRender( _this, scene, camera, geometry, material, group );\n\n\t}\n\n\tfunction getProgram( material, scene, object ) {\n\n\t\tif ( scene.isScene !== true ) scene = _emptyScene; // scene could be a Mesh, Line, Points, ...\n\n\t\tconst materialProperties = properties.get( material );\n\n\t\tconst lights = currentRenderState.state.lights;\n\t\tconst shadowsArray = currentRenderState.state.shadowsArray;\n\n\t\tconst lightsStateVersion = lights.state.version;\n\n\t\tconst parameters = programCache.getParameters( material, lights.state, shadowsArray, scene, object );\n\t\tconst programCacheKey = programCache.getProgramCacheKey( parameters );\n\n\t\tlet programs = materialProperties.programs;\n\n\t\t// always update environment and fog - changing these trigger an getProgram call, but it's possible that the program doesn't change\n\n\t\tmaterialProperties.environment = material.isMeshStandardMaterial ? scene.environment : null;\n\t\tmaterialProperties.fog = scene.fog;\n\t\tmaterialProperties.envMap = ( material.isMeshStandardMaterial ? cubeuvmaps : cubemaps ).get( material.envMap || materialProperties.environment );\n\n\t\tif ( programs === undefined ) {\n\n\t\t\t// new material\n\n\t\t\tmaterial.addEventListener( 'dispose', onMaterialDispose );\n\n\t\t\tprograms = new Map();\n\t\t\tmaterialProperties.programs = programs;\n\n\t\t}\n\n\t\tlet program = programs.get( programCacheKey );\n\n\t\tif ( program !== undefined ) {\n\n\t\t\t// early out if program and light state is identical\n\n\t\t\tif ( materialProperties.currentProgram === program && materialProperties.lightsStateVersion === lightsStateVersion ) {\n\n\t\t\t\tupdateCommonMaterialProperties( material, parameters );\n\n\t\t\t\treturn program;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tparameters.uniforms = programCache.getUniforms( material );\n\n\t\t\tmaterial.onBuild( object, parameters, _this );\n\n\t\t\tmaterial.onBeforeCompile( parameters, _this );\n\n\t\t\tprogram = programCache.acquireProgram( parameters, programCacheKey );\n\t\t\tprograms.set( programCacheKey, program );\n\n\t\t\tmaterialProperties.uniforms = parameters.uniforms;\n\n\t\t}\n\n\t\tconst uniforms = materialProperties.uniforms;\n\n\t\tif ( ( ! material.isShaderMaterial && ! material.isRawShaderMaterial ) || material.clipping === true ) {\n\n\t\t\tuniforms.clippingPlanes = clipping.uniform;\n\n\t\t}\n\n\t\tupdateCommonMaterialProperties( material, parameters );\n\n\t\t// store the light setup it was created for\n\n\t\tmaterialProperties.needsLights = materialNeedsLights( material );\n\t\tmaterialProperties.lightsStateVersion = lightsStateVersion;\n\n\t\tif ( materialProperties.needsLights ) {\n\n\t\t\t// wire up the material to this renderer's lighting state\n\n\t\t\tuniforms.ambientLightColor.value = lights.state.ambient;\n\t\t\tuniforms.lightProbe.value = lights.state.probe;\n\t\t\tuniforms.directionalLights.value = lights.state.directional;\n\t\t\tuniforms.directionalLightShadows.value = lights.state.directionalShadow;\n\t\t\tuniforms.spotLights.value = lights.state.spot;\n\t\t\tuniforms.spotLightShadows.value = lights.state.spotShadow;\n\t\t\tuniforms.rectAreaLights.value = lights.state.rectArea;\n\t\t\tuniforms.ltc_1.value = lights.state.rectAreaLTC1;\n\t\t\tuniforms.ltc_2.value = lights.state.rectAreaLTC2;\n\t\t\tuniforms.pointLights.value = lights.state.point;\n\t\t\tuniforms.pointLightShadows.value = lights.state.pointShadow;\n\t\t\tuniforms.hemisphereLights.value = lights.state.hemi;\n\n\t\t\tuniforms.directionalShadowMap.value = lights.state.directionalShadowMap;\n\t\t\tuniforms.directionalShadowMatrix.value = lights.state.directionalShadowMatrix;\n\t\t\tuniforms.spotShadowMap.value = lights.state.spotShadowMap;\n\t\t\tuniforms.spotShadowMatrix.value = lights.state.spotShadowMatrix;\n\t\t\tuniforms.pointShadowMap.value = lights.state.pointShadowMap;\n\t\t\tuniforms.pointShadowMatrix.value = lights.state.pointShadowMatrix;\n\t\t\t// TODO (abelnation): add area lights shadow info to uniforms\n\n\t\t}\n\n\t\tconst progUniforms = program.getUniforms();\n\t\tconst uniformsList = WebGLUniforms.seqWithValue( progUniforms.seq, uniforms );\n\n\t\tmaterialProperties.currentProgram = program;\n\t\tmaterialProperties.uniformsList = uniformsList;\n\n\t\treturn program;\n\n\t}\n\n\tfunction updateCommonMaterialProperties( material, parameters ) {\n\n\t\tconst materialProperties = properties.get( material );\n\n\t\tmaterialProperties.outputEncoding = parameters.outputEncoding;\n\t\tmaterialProperties.instancing = parameters.instancing;\n\t\tmaterialProperties.skinning = parameters.skinning;\n\t\tmaterialProperties.morphTargets = parameters.morphTargets;\n\t\tmaterialProperties.morphNormals = parameters.morphNormals;\n\t\tmaterialProperties.morphTargetsCount = parameters.morphTargetsCount;\n\t\tmaterialProperties.numClippingPlanes = parameters.numClippingPlanes;\n\t\tmaterialProperties.numIntersection = parameters.numClipIntersection;\n\t\tmaterialProperties.vertexAlphas = parameters.vertexAlphas;\n\t\tmaterialProperties.vertexTangents = parameters.vertexTangents;\n\n\t}\n\n\tfunction setProgram( camera, scene, geometry, material, object ) {\n\n\t\tif ( scene.isScene !== true ) scene = _emptyScene; // scene could be a Mesh, Line, Points, ...\n\n\t\ttextures.resetTextureUnits();\n\n\t\tconst fog = scene.fog;\n\t\tconst environment = material.isMeshStandardMaterial ? scene.environment : null;\n\t\tconst encoding = ( _currentRenderTarget === null ) ? _this.outputEncoding : _currentRenderTarget.texture.encoding;\n\t\tconst envMap = ( material.isMeshStandardMaterial ? cubeuvmaps : cubemaps ).get( material.envMap || environment );\n\t\tconst vertexAlphas = material.vertexColors === true && !! geometry.attributes.color && geometry.attributes.color.itemSize === 4;\n\t\tconst vertexTangents = !! material.normalMap && !! geometry.attributes.tangent;\n\t\tconst morphTargets = !! geometry.morphAttributes.position;\n\t\tconst morphNormals = !! geometry.morphAttributes.normal;\n\t\tconst morphTargetsCount = !! geometry.morphAttributes.position ? geometry.morphAttributes.position.length : 0;\n\n\t\tconst materialProperties = properties.get( material );\n\t\tconst lights = currentRenderState.state.lights;\n\n\t\tif ( _clippingEnabled === true ) {\n\n\t\t\tif ( _localClippingEnabled === true || camera !== _currentCamera ) {\n\n\t\t\t\tconst useCache =\n\t\t\t\t\tcamera === _currentCamera &&\n\t\t\t\t\tmaterial.id === _currentMaterialId;\n\n\t\t\t\t// we might want to call this function with some ClippingGroup\n\t\t\t\t// object instead of the material, once it becomes feasible\n\t\t\t\t// (#8465, #8379)\n\t\t\t\tclipping.setState( material, camera, useCache );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tlet needsProgramChange = false;\n\n\t\tif ( material.version === materialProperties.__version ) {\n\n\t\t\tif ( materialProperties.needsLights && ( materialProperties.lightsStateVersion !== lights.state.version ) ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.outputEncoding !== encoding ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( object.isInstancedMesh && materialProperties.instancing === false ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( ! object.isInstancedMesh && materialProperties.instancing === true ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( object.isSkinnedMesh && materialProperties.skinning === false ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( ! object.isSkinnedMesh && materialProperties.skinning === true ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.envMap !== envMap ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( material.fog && materialProperties.fog !== fog ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.numClippingPlanes !== undefined &&\n\t\t\t\t( materialProperties.numClippingPlanes !== clipping.numPlanes ||\n\t\t\t\tmaterialProperties.numIntersection !== clipping.numIntersection ) ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.vertexAlphas !== vertexAlphas ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.vertexTangents !== vertexTangents ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.morphTargets !== morphTargets ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( materialProperties.morphNormals !== morphNormals ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t} else if ( capabilities.isWebGL2 === true && materialProperties.morphTargetsCount !== morphTargetsCount ) {\n\n\t\t\t\tneedsProgramChange = true;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tneedsProgramChange = true;\n\t\t\tmaterialProperties.__version = material.version;\n\n\t\t}\n\n\t\t//\n\n\t\tlet program = materialProperties.currentProgram;\n\n\t\tif ( needsProgramChange === true ) {\n\n\t\t\tprogram = getProgram( material, scene, object );\n\n\t\t}\n\n\t\tlet refreshProgram = false;\n\t\tlet refreshMaterial = false;\n\t\tlet refreshLights = false;\n\n\t\tconst p_uniforms = program.getUniforms(),\n\t\t\tm_uniforms = materialProperties.uniforms;\n\n\t\tif ( state.useProgram( program.program ) ) {\n\n\t\t\trefreshProgram = true;\n\t\t\trefreshMaterial = true;\n\t\t\trefreshLights = true;\n\n\t\t}\n\n\t\tif ( material.id !== _currentMaterialId ) {\n\n\t\t\t_currentMaterialId = material.id;\n\n\t\t\trefreshMaterial = true;\n\n\t\t}\n\n\t\tif ( refreshProgram || _currentCamera !== camera ) {\n\n\t\t\tp_uniforms.setValue( _gl, 'projectionMatrix', camera.projectionMatrix );\n\n\t\t\tif ( capabilities.logarithmicDepthBuffer ) {\n\n\t\t\t\tp_uniforms.setValue( _gl, 'logDepthBufFC',\n\t\t\t\t\t2.0 / ( Math.log( camera.far + 1.0 ) / Math.LN2 ) );\n\n\t\t\t}\n\n\t\t\tif ( _currentCamera !== camera ) {\n\n\t\t\t\t_currentCamera = camera;\n\n\t\t\t\t// lighting uniforms depend on the camera so enforce an update\n\t\t\t\t// now, in case this material supports lights - or later, when\n\t\t\t\t// the next material that does gets activated:\n\n\t\t\t\trefreshMaterial = true;\t\t// set to true on material change\n\t\t\t\trefreshLights = true;\t\t// remains set until update done\n\n\t\t\t}\n\n\t\t\t// load material specific uniforms\n\t\t\t// (shader material also gets them for the sake of genericity)\n\n\t\t\tif ( material.isShaderMaterial ||\n\t\t\t\tmaterial.isMeshPhongMaterial ||\n\t\t\t\tmaterial.isMeshToonMaterial ||\n\t\t\t\tmaterial.isMeshStandardMaterial ||\n\t\t\t\tmaterial.envMap ) {\n\n\t\t\t\tconst uCamPos = p_uniforms.map.cameraPosition;\n\n\t\t\t\tif ( uCamPos !== undefined ) {\n\n\t\t\t\t\tuCamPos.setValue( _gl,\n\t\t\t\t\t\t_vector3.setFromMatrixPosition( camera.matrixWorld ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( material.isMeshPhongMaterial ||\n\t\t\t\tmaterial.isMeshToonMaterial ||\n\t\t\t\tmaterial.isMeshLambertMaterial ||\n\t\t\t\tmaterial.isMeshBasicMaterial ||\n\t\t\t\tmaterial.isMeshStandardMaterial ||\n\t\t\t\tmaterial.isShaderMaterial ) {\n\n\t\t\t\tp_uniforms.setValue( _gl, 'isOrthographic', camera.isOrthographicCamera === true );\n\n\t\t\t}\n\n\t\t\tif ( material.isMeshPhongMaterial ||\n\t\t\t\tmaterial.isMeshToonMaterial ||\n\t\t\t\tmaterial.isMeshLambertMaterial ||\n\t\t\t\tmaterial.isMeshBasicMaterial ||\n\t\t\t\tmaterial.isMeshStandardMaterial ||\n\t\t\t\tmaterial.isShaderMaterial ||\n\t\t\t\tmaterial.isShadowMaterial ||\n\t\t\t\tobject.isSkinnedMesh ) {\n\n\t\t\t\tp_uniforms.setValue( _gl, 'viewMatrix', camera.matrixWorldInverse );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// skinning and morph target uniforms must be set even if material didn't change\n\t\t// auto-setting of texture unit for bone and morph texture must go before other textures\n\t\t// otherwise textures used for skinning and morphing can take over texture units reserved for other material textures\n\n\t\tif ( object.isSkinnedMesh ) {\n\n\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrix' );\n\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrixInverse' );\n\n\t\t\tconst skeleton = object.skeleton;\n\n\t\t\tif ( skeleton ) {\n\n\t\t\t\tif ( capabilities.floatVertexTextures ) {\n\n\t\t\t\t\tif ( skeleton.boneTexture === null ) skeleton.computeBoneTexture();\n\n\t\t\t\t\tp_uniforms.setValue( _gl, 'boneTexture', skeleton.boneTexture, textures );\n\t\t\t\t\tp_uniforms.setValue( _gl, 'boneTextureSize', skeleton.boneTextureSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tp_uniforms.setOptional( _gl, skeleton, 'boneMatrices' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( !! geometry && ( geometry.morphAttributes.position !== undefined || geometry.morphAttributes.normal !== undefined ) ) {\n\n\t\t\tmorphtargets.update( object, geometry, material, program );\n\n\t\t}\n\n\n\t\tif ( refreshMaterial || materialProperties.receiveShadow !== object.receiveShadow ) {\n\n\t\t\tmaterialProperties.receiveShadow = object.receiveShadow;\n\t\t\tp_uniforms.setValue( _gl, 'receiveShadow', object.receiveShadow );\n\n\t\t}\n\n\t\tif ( refreshMaterial ) {\n\n\t\t\tp_uniforms.setValue( _gl, 'toneMappingExposure', _this.toneMappingExposure );\n\n\t\t\tif ( materialProperties.needsLights ) {\n\n\t\t\t\t// the current material requires lighting info\n\n\t\t\t\t// note: all lighting uniforms are always set correctly\n\t\t\t\t// they simply reference the renderer's state for their\n\t\t\t\t// values\n\t\t\t\t//\n\t\t\t\t// use the current material's .needsUpdate flags to set\n\t\t\t\t// the GL state when required\n\n\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, refreshLights );\n\n\t\t\t}\n\n\t\t\t// refresh uniforms common to several materials\n\n\t\t\tif ( fog && material.fog ) {\n\n\t\t\t\tmaterials.refreshFogUniforms( m_uniforms, fog );\n\n\t\t\t}\n\n\t\t\tmaterials.refreshMaterialUniforms( m_uniforms, material, _pixelRatio, _height, _transmissionRenderTarget );\n\n\t\t\tWebGLUniforms.upload( _gl, materialProperties.uniformsList, m_uniforms, textures );\n\n\t\t}\n\n\t\tif ( material.isShaderMaterial && material.uniformsNeedUpdate === true ) {\n\n\t\t\tWebGLUniforms.upload( _gl, materialProperties.uniformsList, m_uniforms, textures );\n\t\t\tmaterial.uniformsNeedUpdate = false;\n\n\t\t}\n\n\t\tif ( material.isSpriteMaterial ) {\n\n\t\t\tp_uniforms.setValue( _gl, 'center', object.center );\n\n\t\t}\n\n\t\t// common matrices\n\n\t\tp_uniforms.setValue( _gl, 'modelViewMatrix', object.modelViewMatrix );\n\t\tp_uniforms.setValue( _gl, 'normalMatrix', object.normalMatrix );\n\t\tp_uniforms.setValue( _gl, 'modelMatrix', object.matrixWorld );\n\n\t\treturn program;\n\n\t}\n\n\t// If uniforms are marked as clean, they don't need to be loaded to the GPU.\n\n\tfunction markUniformsLightsNeedsUpdate( uniforms, value ) {\n\n\t\tuniforms.ambientLightColor.needsUpdate = value;\n\t\tuniforms.lightProbe.needsUpdate = value;\n\n\t\tuniforms.directionalLights.needsUpdate = value;\n\t\tuniforms.directionalLightShadows.needsUpdate = value;\n\t\tuniforms.pointLights.needsUpdate = value;\n\t\tuniforms.pointLightShadows.needsUpdate = value;\n\t\tuniforms.spotLights.needsUpdate = value;\n\t\tuniforms.spotLightShadows.needsUpdate = value;\n\t\tuniforms.rectAreaLights.needsUpdate = value;\n\t\tuniforms.hemisphereLights.needsUpdate = value;\n\n\t}\n\n\tfunction materialNeedsLights( material ) {\n\n\t\treturn material.isMeshLambertMaterial || material.isMeshToonMaterial || material.isMeshPhongMaterial ||\n\t\t\tmaterial.isMeshStandardMaterial || material.isShadowMaterial ||\n\t\t\t( material.isShaderMaterial && material.lights === true );\n\n\t}\n\n\tthis.getActiveCubeFace = function () {\n\n\t\treturn _currentActiveCubeFace;\n\n\t};\n\n\tthis.getActiveMipmapLevel = function () {\n\n\t\treturn _currentActiveMipmapLevel;\n\n\t};\n\n\tthis.getRenderTarget = function () {\n\n\t\treturn _currentRenderTarget;\n\n\t};\n\n\tthis.setRenderTarget = function ( renderTarget, activeCubeFace = 0, activeMipmapLevel = 0 ) {\n\n\t\t_currentRenderTarget = renderTarget;\n\t\t_currentActiveCubeFace = activeCubeFace;\n\t\t_currentActiveMipmapLevel = activeMipmapLevel;\n\n\t\tif ( renderTarget && properties.get( renderTarget ).__webglFramebuffer === undefined ) {\n\n\t\t\ttextures.setupRenderTarget( renderTarget );\n\n\t\t}\n\n\t\tlet framebuffer = null;\n\t\tlet isCube = false;\n\t\tlet isRenderTarget3D = false;\n\n\t\tif ( renderTarget ) {\n\n\t\t\tconst texture = renderTarget.texture;\n\n\t\t\tif ( texture.isDataTexture3D || texture.isDataTexture2DArray ) {\n\n\t\t\t\tisRenderTarget3D = true;\n\n\t\t\t}\n\n\t\t\tconst __webglFramebuffer = properties.get( renderTarget ).__webglFramebuffer;\n\n\t\t\tif ( renderTarget.isWebGLCubeRenderTarget ) {\n\n\t\t\t\tframebuffer = __webglFramebuffer[ activeCubeFace ];\n\t\t\t\tisCube = true;\n\n\t\t\t} else if ( renderTarget.isWebGLMultisampleRenderTarget ) {\n\n\t\t\t\tframebuffer = properties.get( renderTarget ).__webglMultisampledFramebuffer;\n\n\t\t\t} else {\n\n\t\t\t\tframebuffer = __webglFramebuffer;\n\n\t\t\t}\n\n\t\t\t_currentViewport.copy( renderTarget.viewport );\n\t\t\t_currentScissor.copy( renderTarget.scissor );\n\t\t\t_currentScissorTest = renderTarget.scissorTest;\n\n\t\t} else {\n\n\t\t\t_currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio ).floor();\n\t\t\t_currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio ).floor();\n\t\t\t_currentScissorTest = _scissorTest;\n\n\t\t}\n\n\t\tconst framebufferBound = state.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\n\n\t\tif ( framebufferBound && capabilities.drawBuffers ) {\n\n\t\t\tlet needsUpdate = false;\n\n\t\t\tif ( renderTarget ) {\n\n\t\t\t\tif ( renderTarget.isWebGLMultipleRenderTargets ) {\n\n\t\t\t\t\tconst textures = renderTarget.texture;\n\n\t\t\t\t\tif ( _currentDrawBuffers.length !== textures.length || _currentDrawBuffers[ 0 ] !== _gl.COLOR_ATTACHMENT0 ) {\n\n\t\t\t\t\t\tfor ( let i = 0, il = textures.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\t_currentDrawBuffers[ i ] = _gl.COLOR_ATTACHMENT0 + i;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_currentDrawBuffers.length = textures.length;\n\n\t\t\t\t\t\tneedsUpdate = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( _currentDrawBuffers.length !== 1 || _currentDrawBuffers[ 0 ] !== _gl.COLOR_ATTACHMENT0 ) {\n\n\t\t\t\t\t\t_currentDrawBuffers[ 0 ] = _gl.COLOR_ATTACHMENT0;\n\t\t\t\t\t\t_currentDrawBuffers.length = 1;\n\n\t\t\t\t\t\tneedsUpdate = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( _currentDrawBuffers.length !== 1 || _currentDrawBuffers[ 0 ] !== _gl.BACK ) {\n\n\t\t\t\t\t_currentDrawBuffers[ 0 ] = _gl.BACK;\n\t\t\t\t\t_currentDrawBuffers.length = 1;\n\n\t\t\t\t\tneedsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( needsUpdate ) {\n\n\t\t\t\tif ( capabilities.isWebGL2 ) {\n\n\t\t\t\t\t_gl.drawBuffers( _currentDrawBuffers );\n\n\t\t\t\t} else {\n\n\t\t\t\t\textensions.get( 'WEBGL_draw_buffers' ).drawBuffersWEBGL( _currentDrawBuffers );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.viewport( _currentViewport );\n\t\tstate.scissor( _currentScissor );\n\t\tstate.setScissorTest( _currentScissorTest );\n\n\t\tif ( isCube ) {\n\n\t\t\tconst textureProperties = properties.get( renderTarget.texture );\n\t\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + activeCubeFace, textureProperties.__webglTexture, activeMipmapLevel );\n\n\t\t} else if ( isRenderTarget3D ) {\n\n\t\t\tconst textureProperties = properties.get( renderTarget.texture );\n\t\t\tconst layer = activeCubeFace || 0;\n\t\t\t_gl.framebufferTextureLayer( _gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, textureProperties.__webglTexture, activeMipmapLevel || 0, layer );\n\n\t\t}\n\n\t\t_currentMaterialId = - 1; // reset current material to ensure correct uniform bindings\n\n\t};\n\n\tthis.readRenderTargetPixels = function ( renderTarget, x, y, width, height, buffer, activeCubeFaceIndex ) {\n\n\t\tif ( ! ( renderTarget && renderTarget.isWebGLRenderTarget ) ) {\n\n\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tlet framebuffer = properties.get( renderTarget ).__webglFramebuffer;\n\n\t\tif ( renderTarget.isWebGLCubeRenderTarget && activeCubeFaceIndex !== undefined ) {\n\n\t\t\tframebuffer = framebuffer[ activeCubeFaceIndex ];\n\n\t\t}\n\n\t\tif ( framebuffer ) {\n\n\t\t\tstate.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\n\n\t\t\ttry {\n\n\t\t\t\tconst texture = renderTarget.texture;\n\t\t\t\tconst textureFormat = texture.format;\n\t\t\t\tconst textureType = texture.type;\n\n\t\t\t\tif ( textureFormat !== RGBAFormat && utils.convert( textureFormat ) !== _gl.getParameter( _gl.IMPLEMENTATION_COLOR_READ_FORMAT ) ) {\n\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.' );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tconst halfFloatSupportedByExt = ( textureType === HalfFloatType ) && ( extensions.has( 'EXT_color_buffer_half_float' ) || ( capabilities.isWebGL2 && extensions.has( 'EXT_color_buffer_float' ) ) );\n\n\t\t\t\tif ( textureType !== UnsignedByteType && utils.convert( textureType ) !== _gl.getParameter( _gl.IMPLEMENTATION_COLOR_READ_TYPE ) && // Edge and Chrome Mac < 52 (#9513)\n\t\t\t\t\t! ( textureType === FloatType && ( capabilities.isWebGL2 || extensions.has( 'OES_texture_float' ) || extensions.has( 'WEBGL_color_buffer_float' ) ) ) && // Chrome Mac >= 52 and Firefox\n\t\t\t\t\t! halfFloatSupportedByExt ) {\n\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.' );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( _gl.checkFramebufferStatus( _gl.FRAMEBUFFER ) === _gl.FRAMEBUFFER_COMPLETE ) {\n\n\t\t\t\t\t// the following if statement ensures valid read requests (no out-of-bounds pixels, see #8604)\n\n\t\t\t\t\tif ( ( x >= 0 && x <= ( renderTarget.width - width ) ) && ( y >= 0 && y <= ( renderTarget.height - height ) ) ) {\n\n\t\t\t\t\t\t_gl.readPixels( x, y, width, height, utils.convert( textureFormat ), utils.convert( textureType ), buffer );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.' );\n\n\t\t\t\t}\n\n\t\t\t} finally {\n\n\t\t\t\t// restore framebuffer of current render target if necessary\n\n\t\t\t\tconst framebuffer = ( _currentRenderTarget !== null ) ? properties.get( _currentRenderTarget ).__webglFramebuffer : null;\n\t\t\t\tstate.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tthis.copyFramebufferToTexture = function ( position, texture, level = 0 ) {\n\n\t\tconst levelScale = Math.pow( 2, - level );\n\t\tconst width = Math.floor( texture.image.width * levelScale );\n\t\tconst height = Math.floor( texture.image.height * levelScale );\n\n\t\tlet glFormat = utils.convert( texture.format );\n\n\t\tif ( capabilities.isWebGL2 ) {\n\n\t\t\t// Workaround for https://bugs.chromium.org/p/chromium/issues/detail?id=1120100\n\t\t\t// Not needed in Chrome 93+\n\n\t\t\tif ( glFormat === _gl.RGB ) glFormat = _gl.RGB8;\n\t\t\tif ( glFormat === _gl.RGBA ) glFormat = _gl.RGBA8;\n\n\t\t}\n\n\t\ttextures.setTexture2D( texture, 0 );\n\n\t\t_gl.copyTexImage2D( _gl.TEXTURE_2D, level, glFormat, position.x, position.y, width, height, 0 );\n\n\t\tstate.unbindTexture();\n\n\t};\n\n\tthis.copyTextureToTexture = function ( position, srcTexture, dstTexture, level = 0 ) {\n\n\t\tconst width = srcTexture.image.width;\n\t\tconst height = srcTexture.image.height;\n\t\tconst glFormat = utils.convert( dstTexture.format );\n\t\tconst glType = utils.convert( dstTexture.type );\n\n\t\ttextures.setTexture2D( dstTexture, 0 );\n\n\t\t// As another texture upload may have changed pixelStorei\n\t\t// parameters, make sure they are correct for the dstTexture\n\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, dstTexture.flipY );\n\t\t_gl.pixelStorei( _gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, dstTexture.premultiplyAlpha );\n\t\t_gl.pixelStorei( _gl.UNPACK_ALIGNMENT, dstTexture.unpackAlignment );\n\n\t\tif ( srcTexture.isDataTexture ) {\n\n\t\t\t_gl.texSubImage2D( _gl.TEXTURE_2D, level, position.x, position.y, width, height, glFormat, glType, srcTexture.image.data );\n\n\t\t} else {\n\n\t\t\tif ( srcTexture.isCompressedTexture ) {\n\n\t\t\t\t_gl.compressedTexSubImage2D( _gl.TEXTURE_2D, level, position.x, position.y, srcTexture.mipmaps[ 0 ].width, srcTexture.mipmaps[ 0 ].height, glFormat, srcTexture.mipmaps[ 0 ].data );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.texSubImage2D( _gl.TEXTURE_2D, level, position.x, position.y, glFormat, glType, srcTexture.image );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Generate mipmaps only when copying level 0\n\t\tif ( level === 0 && dstTexture.generateMipmaps ) _gl.generateMipmap( _gl.TEXTURE_2D );\n\n\t\tstate.unbindTexture();\n\n\t};\n\n\tthis.copyTextureToTexture3D = function ( sourceBox, position, srcTexture, dstTexture, level = 0 ) {\n\n\t\tif ( _this.isWebGL1Renderer ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst width = sourceBox.max.x - sourceBox.min.x + 1;\n\t\tconst height = sourceBox.max.y - sourceBox.min.y + 1;\n\t\tconst depth = sourceBox.max.z - sourceBox.min.z + 1;\n\t\tconst glFormat = utils.convert( dstTexture.format );\n\t\tconst glType = utils.convert( dstTexture.type );\n\t\tlet glTarget;\n\n\t\tif ( dstTexture.isDataTexture3D ) {\n\n\t\t\ttextures.setTexture3D( dstTexture, 0 );\n\t\t\tglTarget = _gl.TEXTURE_3D;\n\n\t\t} else if ( dstTexture.isDataTexture2DArray ) {\n\n\t\t\ttextures.setTexture2DArray( dstTexture, 0 );\n\t\t\tglTarget = _gl.TEXTURE_2D_ARRAY;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, dstTexture.flipY );\n\t\t_gl.pixelStorei( _gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, dstTexture.premultiplyAlpha );\n\t\t_gl.pixelStorei( _gl.UNPACK_ALIGNMENT, dstTexture.unpackAlignment );\n\n\t\tconst unpackRowLen = _gl.getParameter( _gl.UNPACK_ROW_LENGTH );\n\t\tconst unpackImageHeight = _gl.getParameter( _gl.UNPACK_IMAGE_HEIGHT );\n\t\tconst unpackSkipPixels = _gl.getParameter( _gl.UNPACK_SKIP_PIXELS );\n\t\tconst unpackSkipRows = _gl.getParameter( _gl.UNPACK_SKIP_ROWS );\n\t\tconst unpackSkipImages = _gl.getParameter( _gl.UNPACK_SKIP_IMAGES );\n\n\t\tconst image = srcTexture.isCompressedTexture ? srcTexture.mipmaps[ 0 ] : srcTexture.image;\n\n\t\t_gl.pixelStorei( _gl.UNPACK_ROW_LENGTH, image.width );\n\t\t_gl.pixelStorei( _gl.UNPACK_IMAGE_HEIGHT, image.height );\n\t\t_gl.pixelStorei( _gl.UNPACK_SKIP_PIXELS, sourceBox.min.x );\n\t\t_gl.pixelStorei( _gl.UNPACK_SKIP_ROWS, sourceBox.min.y );\n\t\t_gl.pixelStorei( _gl.UNPACK_SKIP_IMAGES, sourceBox.min.z );\n\n\t\tif ( srcTexture.isDataTexture || srcTexture.isDataTexture3D ) {\n\n\t\t\t_gl.texSubImage3D( glTarget, level, position.x, position.y, position.z, width, height, depth, glFormat, glType, image.data );\n\n\t\t} else {\n\n\t\t\tif ( srcTexture.isCompressedTexture ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture.' );\n\t\t\t\t_gl.compressedTexSubImage3D( glTarget, level, position.x, position.y, position.z, width, height, depth, glFormat, image.data );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.texSubImage3D( glTarget, level, position.x, position.y, position.z, width, height, depth, glFormat, glType, image );\n\n\t\t\t}\n\n\t\t}\n\n\t\t_gl.pixelStorei( _gl.UNPACK_ROW_LENGTH, unpackRowLen );\n\t\t_gl.pixelStorei( _gl.UNPACK_IMAGE_HEIGHT, unpackImageHeight );\n\t\t_gl.pixelStorei( _gl.UNPACK_SKIP_PIXELS, unpackSkipPixels );\n\t\t_gl.pixelStorei( _gl.UNPACK_SKIP_ROWS, unpackSkipRows );\n\t\t_gl.pixelStorei( _gl.UNPACK_SKIP_IMAGES, unpackSkipImages );\n\n\t\t// Generate mipmaps only when copying level 0\n\t\tif ( level === 0 && dstTexture.generateMipmaps ) _gl.generateMipmap( glTarget );\n\n\t\tstate.unbindTexture();\n\n\t};\n\n\tthis.initTexture = function ( texture ) {\n\n\t\ttextures.setTexture2D( texture, 0 );\n\n\t\tstate.unbindTexture();\n\n\t};\n\n\tthis.resetState = function () {\n\n\t\t_currentActiveCubeFace = 0;\n\t\t_currentActiveMipmapLevel = 0;\n\t\t_currentRenderTarget = null;\n\n\t\tstate.reset();\n\t\tbindingStates.reset();\n\n\t};\n\n\tif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\n\n\t\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'observe', { detail: this } ) ); // eslint-disable-line no-undef\n\n\t}\n\n}\n\nWebGLRenderer.prototype.isWebGLRenderer = true;\n\nexport { WebGLRenderer };\n","import { Object3D } from '../core/Object3D.js';\n\nclass Scene extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'Scene';\n\n\t\tthis.background = null;\n\t\tthis.environment = null;\n\t\tthis.fog = null;\n\n\t\tthis.overrideMaterial = null;\n\n\t\tthis.autoUpdate = true; // checked by the renderer\n\n\t\tif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\n\n\t\t\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'observe', { detail: this } ) ); // eslint-disable-line no-undef\n\n\t\t}\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tif ( source.background !== null ) this.background = source.background.clone();\n\t\tif ( source.environment !== null ) this.environment = source.environment.clone();\n\t\tif ( source.fog !== null ) this.fog = source.fog.clone();\n\n\t\tif ( source.overrideMaterial !== null ) this.overrideMaterial = source.overrideMaterial.clone();\n\n\t\tthis.autoUpdate = source.autoUpdate;\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tif ( this.fog !== null ) data.object.fog = this.fog.toJSON();\n\n\t\treturn data;\n\n\t}\n\n}\n\nScene.prototype.isScene = true;\n\nexport { Scene };\n","import { Object3D } from '../core/Object3D.js';\nimport { Color } from '../math/Color.js';\n\nclass Light extends Object3D {\n\n\tconstructor( color, intensity = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Light';\n\n\t\tthis.color = new Color( color );\n\t\tthis.intensity = intensity;\n\n\t}\n\n\tdispose() {\n\n\t\t// Empty here in base class; some subclasses override.\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\t\tthis.intensity = source.intensity;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.color = this.color.getHex();\n\t\tdata.object.intensity = this.intensity;\n\n\t\tif ( this.groundColor !== undefined ) data.object.groundColor = this.groundColor.getHex();\n\n\t\tif ( this.distance !== undefined ) data.object.distance = this.distance;\n\t\tif ( this.angle !== undefined ) data.object.angle = this.angle;\n\t\tif ( this.decay !== undefined ) data.object.decay = this.decay;\n\t\tif ( this.penumbra !== undefined ) data.object.penumbra = this.penumbra;\n\n\t\tif ( this.shadow !== undefined ) data.object.shadow = this.shadow.toJSON();\n\n\t\treturn data;\n\n\t}\n\n}\n\nLight.prototype.isLight = true;\n\nexport { Light };\n","import { Light } from './Light.js';\n\nclass AmbientLight extends Light {\n\n\tconstructor( color, intensity ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.type = 'AmbientLight';\n\n\t}\n\n}\n\nAmbientLight.prototype.isAmbientLight = true;\n\nexport { AmbientLight };\n","import * as THREE from 'three';\n\nconst resizeRendererToDisplaySize = (\n  renderer: THREE.WebGLRenderer,\n): boolean => {\n  const canvas = renderer.domElement;\n  const pixelRatio = window.devicePixelRatio;\n  const width = (canvas.clientWidth * pixelRatio) | 0;\n  const height = (canvas.clientHeight * pixelRatio) | 0;\n  if (canvas.width !== width || canvas.height !== height) {\n    renderer.setSize(width, height, false);\n    return true;\n  }\n  return false;\n};\n\nlet currentTime = Date.now();\n\ntype AnimatedObj = { update: (deltat: number) => void };\n\nexport const animate = (\n  environment: Environment,\n  objects: AnimatedObj[],\n): void => {\n  const { renderer, scene, camera } = environment;\n\n  // Check if renderer needs to be resized\n  if (resizeRendererToDisplaySize(renderer)) {\n    const canvas = renderer.domElement;\n    camera.aspect = canvas.clientWidth / canvas.clientHeight;\n    camera.updateProjectionMatrix();\n  }\n\n  // Calculate delta time\n  const now = Date.now();\n  const deltat = now - currentTime;\n  currentTime = now;\n\n  // Update the objects provided\n  objects.forEach((object) => object.update(deltat));\n\n  // Render the scene\n  renderer.render(scene, camera);\n\n  // Call animate again on the next frame\n  requestAnimationFrame(() => animate(environment, objects));\n};\n\ninterface Environment {\n  renderer: THREE.WebGLRenderer;\n  scene: THREE.Scene;\n  camera: THREE.PerspectiveCamera;\n}\n\nexport const createScene = (canvas: HTMLCanvasElement): Environment => {\n  // Create the Three.js renderer and attach it to our canvas\n  const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });\n\n  // Create a new Three.js scene\n  const scene = new THREE.Scene();\n  scene.background = new THREE.Color(30 / 256, 26 / 256, 22 / 256);\n\n  const ambientLight = new THREE.AmbientLight(0xdddddd, 0.6);\n  scene.add(ambientLight);\n\n  // Add a camera so we can view the scene\n  const camera = new THREE.PerspectiveCamera(\n    45,\n    canvas.width / canvas.height,\n    1,\n    4000,\n  );\n  camera.position.setY(2);\n  camera.position.setZ(10);\n\n  return { renderer, scene, camera };\n};\n","import { TangentSpaceNormalMap } from '../constants.js';\nimport { Material } from './Material.js';\nimport { Vector2 } from '../math/Vector2.js';\n\n/**\n * parameters = {\n *  opacity: <float>,\n *\n *  bumpMap: new THREE.Texture( <Image> ),\n *  bumpScale: <float>,\n *\n *  normalMap: new THREE.Texture( <Image> ),\n *  normalMapType: THREE.TangentSpaceNormalMap,\n *  normalScale: <Vector2>,\n *\n *  displacementMap: new THREE.Texture( <Image> ),\n *  displacementScale: <float>,\n *  displacementBias: <float>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>\n *\n *  flatShading: <bool>\n * }\n */\n\nclass MeshNormalMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshNormalMaterial';\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.fog = false;\n\n\t\tthis.flatShading = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshNormalMaterial.prototype.isMeshNormalMaterial = true;\n\nexport { MeshNormalMaterial };\n","import { Matrix4 } from '../math/Matrix4.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Vector4 } from '../math/Vector4.js';\nimport { Frustum } from '../math/Frustum.js';\n\nconst _projScreenMatrix = /*@__PURE__*/ new Matrix4();\nconst _lightPositionWorld = /*@__PURE__*/ new Vector3();\nconst _lookTarget = /*@__PURE__*/ new Vector3();\n\nclass LightShadow {\n\n\tconstructor( camera ) {\n\n\t\tthis.camera = camera;\n\n\t\tthis.bias = 0;\n\t\tthis.normalBias = 0;\n\t\tthis.radius = 1;\n\t\tthis.blurSamples = 8;\n\n\t\tthis.mapSize = new Vector2( 512, 512 );\n\n\t\tthis.map = null;\n\t\tthis.mapPass = null;\n\t\tthis.matrix = new Matrix4();\n\n\t\tthis.autoUpdate = true;\n\t\tthis.needsUpdate = false;\n\n\t\tthis._frustum = new Frustum();\n\t\tthis._frameExtents = new Vector2( 1, 1 );\n\n\t\tthis._viewportCount = 1;\n\n\t\tthis._viewports = [\n\n\t\t\tnew Vector4( 0, 0, 1, 1 )\n\n\t\t];\n\n\t}\n\n\tgetViewportCount() {\n\n\t\treturn this._viewportCount;\n\n\t}\n\n\tgetFrustum() {\n\n\t\treturn this._frustum;\n\n\t}\n\n\tupdateMatrices( light ) {\n\n\t\tconst shadowCamera = this.camera;\n\t\tconst shadowMatrix = this.matrix;\n\n\t\t_lightPositionWorld.setFromMatrixPosition( light.matrixWorld );\n\t\tshadowCamera.position.copy( _lightPositionWorld );\n\n\t\t_lookTarget.setFromMatrixPosition( light.target.matrixWorld );\n\t\tshadowCamera.lookAt( _lookTarget );\n\t\tshadowCamera.updateMatrixWorld();\n\n\t\t_projScreenMatrix.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\n\t\tthis._frustum.setFromProjectionMatrix( _projScreenMatrix );\n\n\t\tshadowMatrix.set(\n\t\t\t0.5, 0.0, 0.0, 0.5,\n\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t0.0, 0.0, 0.0, 1.0\n\t\t);\n\n\t\tshadowMatrix.multiply( shadowCamera.projectionMatrix );\n\t\tshadowMatrix.multiply( shadowCamera.matrixWorldInverse );\n\n\t}\n\n\tgetViewport( viewportIndex ) {\n\n\t\treturn this._viewports[ viewportIndex ];\n\n\t}\n\n\tgetFrameExtents() {\n\n\t\treturn this._frameExtents;\n\n\t}\n\n\tdispose() {\n\n\t\tif ( this.map ) {\n\n\t\t\tthis.map.dispose();\n\n\t\t}\n\n\t\tif ( this.mapPass ) {\n\n\t\t\tthis.mapPass.dispose();\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.camera = source.camera.clone();\n\n\t\tthis.bias = source.bias;\n\t\tthis.radius = source.radius;\n\n\t\tthis.mapSize.copy( source.mapSize );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst object = {};\n\n\t\tif ( this.bias !== 0 ) object.bias = this.bias;\n\t\tif ( this.normalBias !== 0 ) object.normalBias = this.normalBias;\n\t\tif ( this.radius !== 1 ) object.radius = this.radius;\n\t\tif ( this.mapSize.x !== 512 || this.mapSize.y !== 512 ) object.mapSize = this.mapSize.toArray();\n\n\t\tobject.camera = this.camera.toJSON( false ).object;\n\t\tdelete object.camera.matrix;\n\n\t\treturn object;\n\n\t}\n\n}\n\nexport { LightShadow };\n","import { LightShadow } from './LightShadow.js';\nimport * as MathUtils from '../math/MathUtils.js';\nimport { PerspectiveCamera } from '../cameras/PerspectiveCamera.js';\n\nclass SpotLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new PerspectiveCamera( 50, 1, 0.5, 500 ) );\n\n\t\tthis.focus = 1;\n\n\t}\n\n\tupdateMatrices( light ) {\n\n\t\tconst camera = this.camera;\n\n\t\tconst fov = MathUtils.RAD2DEG * 2 * light.angle * this.focus;\n\t\tconst aspect = this.mapSize.width / this.mapSize.height;\n\t\tconst far = light.distance || camera.far;\n\n\t\tif ( fov !== camera.fov || aspect !== camera.aspect || far !== camera.far ) {\n\n\t\t\tcamera.fov = fov;\n\t\t\tcamera.aspect = aspect;\n\t\t\tcamera.far = far;\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t\tsuper.updateMatrices( light );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.focus = source.focus;\n\n\t\treturn this;\n\n\t}\n\n}\n\nSpotLightShadow.prototype.isSpotLightShadow = true;\n\nexport { SpotLightShadow };\n","import { Light } from './Light.js';\nimport { SpotLightShadow } from './SpotLightShadow.js';\nimport { Object3D } from '../core/Object3D.js';\n\nclass SpotLight extends Light {\n\n\tconstructor( color, intensity, distance = 0, angle = Math.PI / 3, penumbra = 0, decay = 1 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.type = 'SpotLight';\n\n\t\tthis.position.copy( Object3D.DefaultUp );\n\t\tthis.updateMatrix();\n\n\t\tthis.target = new Object3D();\n\n\t\tthis.distance = distance;\n\t\tthis.angle = angle;\n\t\tthis.penumbra = penumbra;\n\t\tthis.decay = decay; // for physically correct lights, should be 2.\n\n\t\tthis.shadow = new SpotLightShadow();\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in candela)\n\t\t// by convention for a spotlight, luminous power (lm) = π * luminous intensity (cd)\n\t\treturn this.intensity * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in candela) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / Math.PI;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.distance = source.distance;\n\t\tthis.angle = source.angle;\n\t\tthis.penumbra = source.penumbra;\n\t\tthis.decay = source.decay;\n\n\t\tthis.target = source.target.clone();\n\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nSpotLight.prototype.isSpotLight = true;\n\nexport { SpotLight };\n","import * as THREE from 'three';\nimport AlbumCoverManager from './albumcovers';\nimport { SpotifyTrack } from './spotify';\nimport TextGenerator from './text';\nimport WallpaperManager from './wallpaper';\n\nconst HALL_WIDTH = 7.2;\nconst HALL_LENGTH = 20;\nconst HALL_HEIGHT = 5;\nconst CENTER_APOTHEM = HALL_WIDTH / (2 * Math.sqrt(3));\nconst HALL_WALL_LENGTH = HALL_LENGTH - CENTER_APOTHEM;\nconst ALBUM_COVER_SIZE = 2.2;\nconst LOGIN_BUTTON_WIDTH = 3;\nconst LOGIN_BUTTON_TEXT_SIZE = 0.2;\n\nexport default class Hall {\n  root: THREE.Group;\n\n  floor: THREE.Mesh;\n  centerFloor: THREE.Mesh;\n  ceiling: THREE.Mesh;\n\n  leftWall: THREE.Mesh;\n  normalFromLeftWall: THREE.Vector3;\n  rightWall: THREE.Mesh;\n  normalFromRightWall: THREE.Vector3;\n  trackGroups: THREE.Group[];\n\n  endGroup: THREE.Group;\n  endWall: THREE.Mesh;\n  endWallSpotlight: THREE.SpotLight;\n  normalFromEndWall: THREE.Vector3;\n  endTitles: THREE.Group;\n\n  title: string;\n  coversManager: AlbumCoverManager;\n  textGenerator: TextGenerator;\n  wallpaperMgr: WallpaperManager;\n\n  constructor(\n    rotation: number,\n    title: string,\n    parent: THREE.Object3D,\n    coversManager: AlbumCoverManager,\n    textGenerator: TextGenerator,\n    wallpaperMgr: WallpaperManager,\n  ) {\n    this.root = new THREE.Group();\n    this.root.rotateY(rotation);\n    parent.add(this.root);\n\n    const tempMaterial = new THREE.MeshNormalMaterial();\n\n    const floorGeometry = new THREE.PlaneGeometry(HALL_WIDTH, HALL_WALL_LENGTH);\n    this.floor = new THREE.Mesh(floorGeometry, tempMaterial);\n    this.floor.position.setZ((HALL_LENGTH + CENTER_APOTHEM) / 2);\n    this.floor.rotateX(-Math.PI / 2);\n    this.root.add(this.floor);\n\n    if (rotation === 0) {\n      const centerFloorGeometry = new THREE.PlaneGeometry(\n        HALL_WIDTH,\n        (Math.sqrt(3) * HALL_WIDTH) / 2 + 0.02,\n      );\n      this.centerFloor = new THREE.Mesh(centerFloorGeometry, tempMaterial);\n      this.centerFloor.rotateX(-Math.PI / 2);\n      this.centerFloor.rotateZ(Math.PI / 3);\n      this.centerFloor.translateY(-1.05);\n      this.root.add(this.centerFloor);\n    } else {\n      this.centerFloor = null;\n    }\n\n    const sideWallGeometry = new THREE.PlaneGeometry(\n      HALL_WALL_LENGTH,\n      HALL_HEIGHT,\n    );\n\n    this.leftWall = new THREE.Mesh(sideWallGeometry, tempMaterial);\n    this.leftWall.position.setX(HALL_WIDTH / 2);\n    this.leftWall.position.setY(HALL_HEIGHT / 2);\n    this.leftWall.position.setZ((HALL_LENGTH + CENTER_APOTHEM) / 2);\n    this.leftWall.rotateY(-Math.PI / 2);\n    this.root.add(this.leftWall);\n\n    this.normalFromLeftWall = new THREE.Vector3();\n    this.leftWall.getWorldDirection(this.normalFromLeftWall);\n\n    this.rightWall = new THREE.Mesh(sideWallGeometry, tempMaterial);\n    this.rightWall.position.setX(-HALL_WIDTH / 2);\n    this.rightWall.position.setY(HALL_HEIGHT / 2);\n    this.rightWall.position.setZ((HALL_LENGTH + CENTER_APOTHEM) / 2);\n    this.rightWall.rotateY(Math.PI / 2);\n    this.root.add(this.rightWall);\n\n    this.normalFromRightWall = new THREE.Vector3();\n    this.rightWall.getWorldDirection(this.normalFromRightWall);\n\n    this.trackGroups = Array.from(Array(10).keys()).map((idx) => {\n      const trackGroup = new THREE.Group();\n      if (idx % 2 === 0) {\n        trackGroup.position.setX(HALL_WIDTH / 2 - 0.01);\n        trackGroup.rotateY(-Math.PI / 2);\n      } else {\n        trackGroup.position.setX(-HALL_WIDTH / 2 + 0.01);\n        trackGroup.rotateY(Math.PI / 2);\n      }\n      trackGroup.position.setY(HALL_HEIGHT / 2);\n      trackGroup.position.setZ(\n        HALL_WALL_LENGTH * (0.97 - Math.floor(idx / 2) / 5.5),\n      );\n\n      this.root.add(trackGroup);\n      return trackGroup;\n    });\n\n    this.endGroup = new THREE.Group();\n    this.endGroup.position.setY(HALL_HEIGHT / 2);\n    this.endGroup.position.setZ(HALL_LENGTH);\n    this.endGroup.rotateY(Math.PI);\n    this.root.add(this.endGroup);\n\n    this.endTitles = new THREE.Group();\n    this.endTitles.translateZ(0.01);\n    this.endGroup.add(this.endTitles);\n\n    const endWallGeometry = new THREE.PlaneGeometry(HALL_WIDTH, HALL_HEIGHT);\n    this.endWall = new THREE.Mesh(endWallGeometry, tempMaterial);\n    this.endGroup.add(this.endWall);\n\n    this.normalFromEndWall = new THREE.Vector3();\n    this.endWall.getWorldDirection(this.normalFromEndWall);\n\n    this.endWallSpotlight = new THREE.SpotLight(0xffffff, 3);\n    this.endWallSpotlight.angle = 0.8;\n    this.endWallSpotlight.penumbra = 0.2;\n    this.endWallSpotlight.decay = 2;\n    this.endWallSpotlight.distance = 20;\n\n    const endWallPosition = new THREE.Vector3();\n    this.endWall.getWorldPosition(endWallPosition);\n    this.endWallSpotlight.position.copy(endWallPosition);\n    this.endWallSpotlight.translateY(2);\n    this.endWallSpotlight.translateOnAxis(this.normalFromEndWall, 0.5);\n    this.endWallSpotlight.target.position.copy(endWallPosition);\n    this.endWallSpotlight.target.position.copy(endWallPosition);\n\n    parent.add(this.endWallSpotlight.target);\n    parent.add(this.endWallSpotlight);\n\n    this.title = title;\n    this.coversManager = coversManager;\n    this.textGenerator = textGenerator;\n    this.wallpaperMgr = wallpaperMgr;\n  }\n\n  getWalls(): THREE.Mesh[] {\n    return [this.rightWall, this.endWall, this.leftWall];\n  }\n\n  async loadFloor() {\n    this.floor.material = await this.wallpaperMgr.getHallFloorMaterial();\n    if (this.centerFloor) {\n      this.centerFloor.material =\n        await this.wallpaperMgr.getCenterFloorMaterial();\n    }\n  }\n\n  async setWallpaper(wallpaperIdx: 0 | 1 | 2) {\n    const { sides, end } = await this.wallpaperMgr.getWallpaper(\n      wallpaperIdx,\n      HALL_WIDTH,\n      HALL_HEIGHT,\n      HALL_WALL_LENGTH,\n    );\n\n    this.leftWall.material = sides;\n    this.rightWall.material = sides;\n    this.endWall.material = end;\n  }\n\n  async drawEndWall() {\n    const endWallTop10Text = this.textGenerator.newRegular('Top 10', {\n      size: 0.4,\n      horizAnchor: 'center',\n      maxWidth: HALL_WIDTH,\n    });\n    endWallTop10Text.translateY(0.4);\n    this.endTitles.add(endWallTop10Text);\n\n    const endWallTitleText = this.textGenerator.newBold(this.title, {\n      size: 0.4,\n      materialType: 'normal',\n      horizAnchor: 'center',\n      maxWidth: HALL_WIDTH,\n    });\n    endWallTitleText.translateY(-0.2);\n    this.endTitles.add(endWallTitleText);\n  }\n\n  setLoginButton(): THREE.Object3D {\n    this.endGroup.position.z = CENTER_APOTHEM;\n\n    this.endWallSpotlight.translateOnAxis(\n      this.normalFromEndWall,\n      HALL_LENGTH - CENTER_APOTHEM,\n    );\n    this.endWallSpotlight.target.translateOnAxis(\n      this.normalFromEndWall,\n      HALL_LENGTH - CENTER_APOTHEM,\n    );\n\n    const loginButton = new THREE.Group();\n    loginButton.translateY(-1);\n    loginButton.translateZ(0.01);\n\n    const loginButtonBodyGeom = new THREE.BoxGeometry(\n      LOGIN_BUTTON_WIDTH,\n      0.9,\n      0.01,\n    );\n    const loginButtonBody = new THREE.Mesh(\n      loginButtonBodyGeom,\n      new THREE.MeshNormalMaterial(),\n    );\n    loginButton.add(loginButtonBody);\n\n    const loginButtonText = this.textGenerator.newRegular('Login to Spotify', {\n      size: LOGIN_BUTTON_TEXT_SIZE,\n      horizAnchor: 'center',\n      maxWidth: LOGIN_BUTTON_WIDTH,\n    });\n    loginButtonText.translateZ(0.01);\n    loginButtonText.translateY(-LOGIN_BUTTON_TEXT_SIZE / 2);\n    loginButton.add(loginButtonText);\n    this.endGroup.add(loginButton);\n\n    return loginButton;\n  }\n\n  async setTracks(\n    tracks: SpotifyTrack[],\n    parent: THREE.Object3D,\n  ): Promise<THREE.Object3D[]> {\n    const textureUrls = tracks.map((track) => track.album.images[0].url);\n    const albumCoverMaterials = await this.coversManager.fetchAlbums(\n      textureUrls,\n    );\n\n    const albumCoverGeometry = new THREE.PlaneGeometry(\n      ALBUM_COVER_SIZE,\n      ALBUM_COVER_SIZE,\n    );\n\n    const position = new THREE.Vector3();\n\n    tracks.forEach((track, idx) => {\n      const albumCoverMaterial = albumCoverMaterials[idx];\n      const albumCover = new THREE.Mesh(albumCoverGeometry, albumCoverMaterial);\n      this.trackGroups[idx].add(albumCover);\n\n      const albumSpotlight = new THREE.SpotLight(0xffffff, 3, 20, 0.4, 0.2, 2);\n      this.trackGroups[idx].getWorldPosition(position);\n      albumSpotlight.position.copy(position);\n      albumSpotlight.translateY(2);\n      const normal =\n        idx % 2 === 0 ? this.normalFromLeftWall : this.normalFromRightWall;\n      albumSpotlight.translateOnAxis(normal, 0.5);\n      albumSpotlight.target.position.copy(position);\n      parent.add(albumSpotlight.target);\n      parent.add(albumSpotlight);\n\n      const idxText = this.textGenerator.newBold(`${idx + 1}`, {\n        size: 0.5,\n        materialType: 'normal',\n        maxWidth: ALBUM_COVER_SIZE,\n      });\n      idxText.translateY(0.2 - ALBUM_COVER_SIZE / 2);\n      idxText.translateX(0.2 - ALBUM_COVER_SIZE / 2);\n      this.trackGroups[idx].add(idxText);\n\n      const songNameText = this.textGenerator.newBold(track.name, {\n        horizAnchor: 'center',\n        maxWidth: ALBUM_COVER_SIZE,\n      });\n      songNameText.translateY(-0.2 - ALBUM_COVER_SIZE / 2);\n      const songTextBBox = new THREE.Box3().setFromObject(songNameText);\n      this.trackGroups[idx].add(songNameText);\n\n      const artistNameText = this.textGenerator.newRegular(\n        track.artists[0].name,\n        { horizAnchor: 'center', maxWidth: ALBUM_COVER_SIZE },\n      );\n      artistNameText.translateY(songTextBBox.min.y - 0.15);\n      this.trackGroups[idx].add(artistNameText);\n    });\n\n    return this.trackGroups;\n  }\n}\n","import { BufferGeometry } from '../core/BufferGeometry.js';\nimport { Float32BufferAttribute } from '../core/BufferAttribute.js';\nimport { Vector3 } from '../math/Vector3.js';\n\nclass SphereGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, widthSegments = 32, heightSegments = 16, phiStart = 0, phiLength = Math.PI * 2, thetaStart = 0, thetaLength = Math.PI ) {\n\n\t\tsuper();\n\t\tthis.type = 'SphereGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\tphiStart: phiStart,\n\t\t\tphiLength: phiLength,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\twidthSegments = Math.max( 3, Math.floor( widthSegments ) );\n\t\theightSegments = Math.max( 2, Math.floor( heightSegments ) );\n\n\t\tconst thetaEnd = Math.min( thetaStart + thetaLength, Math.PI );\n\n\t\tlet index = 0;\n\t\tconst grid = [];\n\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let iy = 0; iy <= heightSegments; iy ++ ) {\n\n\t\t\tconst verticesRow = [];\n\n\t\t\tconst v = iy / heightSegments;\n\n\t\t\t// special case for the poles\n\n\t\t\tlet uOffset = 0;\n\n\t\t\tif ( iy == 0 && thetaStart == 0 ) {\n\n\t\t\t\tuOffset = 0.5 / widthSegments;\n\n\t\t\t} else if ( iy == heightSegments && thetaEnd == Math.PI ) {\n\n\t\t\t\tuOffset = - 0.5 / widthSegments;\n\n\t\t\t}\n\n\t\t\tfor ( let ix = 0; ix <= widthSegments; ix ++ ) {\n\n\t\t\t\tconst u = ix / widthSegments;\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = - radius * Math.cos( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\n\t\t\t\tvertex.y = radius * Math.cos( thetaStart + v * thetaLength );\n\t\t\t\tvertex.z = radius * Math.sin( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormal.copy( vertex ).normalize();\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( u + uOffset, 1 - v );\n\n\t\t\t\tverticesRow.push( index ++ );\n\n\t\t\t}\n\n\t\t\tgrid.push( verticesRow );\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let iy = 0; iy < heightSegments; iy ++ ) {\n\n\t\t\tfor ( let ix = 0; ix < widthSegments; ix ++ ) {\n\n\t\t\t\tconst a = grid[ iy ][ ix + 1 ];\n\t\t\t\tconst b = grid[ iy ][ ix ];\n\t\t\t\tconst c = grid[ iy + 1 ][ ix ];\n\t\t\t\tconst d = grid[ iy + 1 ][ ix + 1 ];\n\n\t\t\t\tif ( iy !== 0 || thetaStart > 0 ) indices.push( a, b, d );\n\t\t\t\tif ( iy !== heightSegments - 1 || thetaEnd < Math.PI ) indices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new SphereGeometry( data.radius, data.widthSegments, data.heightSegments, data.phiStart, data.phiLength, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nexport { SphereGeometry, SphereGeometry as SphereBufferGeometry };\n","import { Ray } from '../math/Ray.js';\nimport { Layers } from './Layers.js';\n\nclass Raycaster {\n\n\tconstructor( origin, direction, near = 0, far = Infinity ) {\n\n\t\tthis.ray = new Ray( origin, direction );\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\t\tthis.camera = null;\n\t\tthis.layers = new Layers();\n\n\t\tthis.params = {\n\t\t\tMesh: {},\n\t\t\tLine: { threshold: 1 },\n\t\t\tLOD: {},\n\t\t\tPoints: { threshold: 1 },\n\t\t\tSprite: {}\n\t\t};\n\n\t}\n\n\tset( origin, direction ) {\n\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\n\n\t\tthis.ray.set( origin, direction );\n\n\t}\n\n\tsetFromCamera( coords, camera ) {\n\n\t\tif ( camera && camera.isPerspectiveCamera ) {\n\n\t\t\tthis.ray.origin.setFromMatrixPosition( camera.matrixWorld );\n\t\t\tthis.ray.direction.set( coords.x, coords.y, 0.5 ).unproject( camera ).sub( this.ray.origin ).normalize();\n\t\t\tthis.camera = camera;\n\n\t\t} else if ( camera && camera.isOrthographicCamera ) {\n\n\t\t\tthis.ray.origin.set( coords.x, coords.y, ( camera.near + camera.far ) / ( camera.near - camera.far ) ).unproject( camera ); // set origin in plane of camera\n\t\t\tthis.ray.direction.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld );\n\t\t\tthis.camera = camera;\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Raycaster: Unsupported camera type: ' + camera.type );\n\n\t\t}\n\n\t}\n\n\tintersectObject( object, recursive = true, intersects = [] ) {\n\n\t\tintersectObject( object, this, intersects, recursive );\n\n\t\tintersects.sort( ascSort );\n\n\t\treturn intersects;\n\n\t}\n\n\tintersectObjects( objects, recursive = true, intersects = [] ) {\n\n\t\tfor ( let i = 0, l = objects.length; i < l; i ++ ) {\n\n\t\t\tintersectObject( objects[ i ], this, intersects, recursive );\n\n\t\t}\n\n\t\tintersects.sort( ascSort );\n\n\t\treturn intersects;\n\n\t}\n\n}\n\nfunction ascSort( a, b ) {\n\n\treturn a.distance - b.distance;\n\n}\n\nfunction intersectObject( object, raycaster, intersects, recursive ) {\n\n\tif ( object.layers.test( raycaster.layers ) ) {\n\n\t\tobject.raycast( raycaster, intersects );\n\n\t}\n\n\tif ( recursive === true ) {\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tintersectObject( children[ i ], raycaster, intersects, true );\n\n\t\t}\n\n\t}\n\n}\n\nexport { Raycaster };\n","import {\n\tEuler,\n\tEventDispatcher,\n\tVector3\n} from 'three';\n\nconst _euler = new Euler( 0, 0, 0, 'YXZ' );\nconst _vector = new Vector3();\n\nconst _changeEvent = { type: 'change' };\nconst _lockEvent = { type: 'lock' };\nconst _unlockEvent = { type: 'unlock' };\n\nconst _PI_2 = Math.PI / 2;\n\nclass PointerLockControls extends EventDispatcher {\n\n\tconstructor( camera, domElement ) {\n\n\t\tsuper();\n\n\t\tif ( domElement === undefined ) {\n\n\t\t\tconsole.warn( 'THREE.PointerLockControls: The second parameter \"domElement\" is now mandatory.' );\n\t\t\tdomElement = document.body;\n\n\t\t}\n\n\t\tthis.domElement = domElement;\n\t\tthis.isLocked = false;\n\n\t\t// Set to constrain the pitch of the camera\n\t\t// Range is 0 to Math.PI radians\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\n\t\tconst scope = this;\n\n\t\tfunction onMouseMove( event ) {\n\n\t\t\tif ( scope.isLocked === false ) return;\n\n\t\t\tconst movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;\n\t\t\tconst movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\n\n\t\t\t_euler.setFromQuaternion( camera.quaternion );\n\n\t\t\t_euler.y -= movementX * 0.002;\n\t\t\t_euler.x -= movementY * 0.002;\n\n\t\t\t_euler.x = Math.max( _PI_2 - scope.maxPolarAngle, Math.min( _PI_2 - scope.minPolarAngle, _euler.x ) );\n\n\t\t\tcamera.quaternion.setFromEuler( _euler );\n\n\t\t\tscope.dispatchEvent( _changeEvent );\n\n\t\t}\n\n\t\tfunction onPointerlockChange() {\n\n\t\t\tif ( scope.domElement.ownerDocument.pointerLockElement === scope.domElement ) {\n\n\t\t\t\tscope.dispatchEvent( _lockEvent );\n\n\t\t\t\tscope.isLocked = true;\n\n\t\t\t} else {\n\n\t\t\t\tscope.dispatchEvent( _unlockEvent );\n\n\t\t\t\tscope.isLocked = false;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction onPointerlockError() {\n\n\t\t\tconsole.error( 'THREE.PointerLockControls: Unable to use Pointer Lock API' );\n\n\t\t}\n\n\t\tthis.connect = function () {\n\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'mousemove', onMouseMove );\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointerlockchange', onPointerlockChange );\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointerlockerror', onPointerlockError );\n\n\t\t};\n\n\t\tthis.disconnect = function () {\n\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'mousemove', onMouseMove );\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerlockchange', onPointerlockChange );\n\t\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerlockerror', onPointerlockError );\n\n\t\t};\n\n\t\tthis.dispose = function () {\n\n\t\t\tthis.disconnect();\n\n\t\t};\n\n\t\tthis.getObject = function () { // retaining this method for backward compatibility\n\n\t\t\treturn camera;\n\n\t\t};\n\n\t\tthis.getDirection = function () {\n\n\t\t\tconst direction = new Vector3( 0, 0, - 1 );\n\n\t\t\treturn function ( v ) {\n\n\t\t\t\treturn v.copy( direction ).applyQuaternion( camera.quaternion );\n\n\t\t\t};\n\n\t\t}();\n\n\t\tthis.moveForward = function ( distance ) {\n\n\t\t\t// move forward parallel to the xz-plane\n\t\t\t// assumes camera.up is y-up\n\n\t\t\t_vector.setFromMatrixColumn( camera.matrix, 0 );\n\n\t\t\t_vector.crossVectors( camera.up, _vector );\n\n\t\t\tcamera.position.addScaledVector( _vector, distance );\n\n\t\t};\n\n\t\tthis.moveRight = function ( distance ) {\n\n\t\t\t_vector.setFromMatrixColumn( camera.matrix, 0 );\n\n\t\t\tcamera.position.addScaledVector( _vector, distance );\n\n\t\t};\n\n\t\tthis.lock = function () {\n\n\t\t\tthis.domElement.requestPointerLock();\n\n\t\t};\n\n\t\tthis.unlock = function () {\n\n\t\t\tscope.domElement.ownerDocument.exitPointerLock();\n\n\t\t};\n\n\t\tthis.connect();\n\n\t}\n\n}\n\nexport { PointerLockControls };\n","import * as THREE from 'three';\nimport { PointerLockControls } from '@three/controls/PointerLockControls';\nimport MousePointerControls from './pointer';\n\ninterface MovementState {\n  up: boolean;\n  down: boolean;\n  left: boolean;\n  right: boolean;\n}\n\nexport default class MovementControls {\n  pointerLockControls: PointerLockControls;\n  pointer: THREE.Mesh;\n  movement: MovementState;\n  direction: THREE.Vector3;\n  collisionRaycaster: THREE.Raycaster;\n  walls: THREE.Mesh[];\n  rotationAxis: THREE.Vector3;\n\n  constructor(\n    camera: THREE.Camera,\n    scene: THREE.Scene,\n    pointerControls: MousePointerControls,\n  ) {\n    this.pointerLockControls = new PointerLockControls(camera, document.body);\n\n    // Create a pointer so that the user knows where is the center of the screen\n    const pointerGeometry = new THREE.SphereGeometry(0.01, 16, 8);\n    const pointerMaterial = new THREE.MeshBasicMaterial({ color: 'white' });\n    this.pointer = new THREE.Mesh(pointerGeometry, pointerMaterial);\n    scene.add(this.pointer);\n\n    const instructionsDiv = document.getElementById('instructions');\n\n    document.addEventListener('pointerdown', (e) => {\n      if (instructionsDiv.style.display === 'none') {\n        pointerControls.onClick(e);\n      } else {\n        this.pointerLockControls.lock();\n      }\n    });\n\n    this.pointerLockControls.addEventListener(\n      'lock',\n      () => (instructionsDiv.style.display = 'none'),\n    );\n    this.pointerLockControls.addEventListener(\n      'unlock',\n      () => (instructionsDiv.style.display = 'flex'),\n    );\n\n    this.movement = { up: false, down: false, left: false, right: false };\n    document.addEventListener(\n      'keydown',\n      (e) => {\n        switch (e.key) {\n          case 'ArrowUp':\n          case 'w':\n            this.movement.up = true;\n            break;\n          case 'ArrowLeft':\n          case 'a':\n            this.movement.left = true;\n            break;\n          case 'ArrowDown':\n          case 's':\n            this.movement.down = true;\n            break;\n          case 'ArrowRight':\n          case 'd':\n            this.movement.right = true;\n            break;\n          case 'Escape':\n            this.pointerLockControls.unlock();\n            break;\n        }\n      },\n      false,\n    );\n    document.addEventListener(\n      'keyup',\n      (e) => {\n        switch (e.key) {\n          case 'ArrowUp':\n          case 'w':\n            this.movement.up = false;\n            break;\n          case 'ArrowLeft':\n          case 'a':\n            this.movement.left = false;\n            break;\n          case 'ArrowDown':\n          case 's':\n            this.movement.down = false;\n            break;\n          case 'ArrowRight':\n          case 'd':\n            this.movement.right = false;\n            break;\n          case 'Escape':\n            this.pointerLockControls.unlock();\n            break;\n        }\n      },\n      false,\n    );\n\n    this.direction = new THREE.Vector3();\n\n    this.collisionRaycaster = new THREE.Raycaster();\n    this.walls = [];\n    this.rotationAxis = new THREE.Vector3(0, 1, 0);\n  }\n\n  addWalls(walls: THREE.Mesh[]) {\n    this.walls.push(...walls);\n  }\n\n  update(deltat: number) {\n    const camera =\n      this.pointerLockControls.getObject() as THREE.PerspectiveCamera;\n\n    this.direction.z = Number(this.movement.up) - Number(this.movement.down);\n    this.direction.x = Number(this.movement.right) - Number(this.movement.left);\n    this.direction.normalize();\n\n    this.collisionRaycaster.ray.origin.copy(camera.position);\n    camera.getWorldDirection(this.collisionRaycaster.ray.direction);\n    this.collisionRaycaster.ray.direction.setY(0);\n\n    const frontWall = this.collisionRaycaster.intersectObjects(this.walls)[0];\n    if (frontWall && frontWall.distance < 2 && this.direction.z > 0) {\n      this.direction.setZ(0);\n    }\n\n    this.collisionRaycaster.ray.direction.applyAxisAngle(\n      this.rotationAxis,\n      Math.PI / 2,\n    );\n    const leftWall = this.collisionRaycaster.intersectObjects(this.walls)[0];\n    if (leftWall && leftWall.distance < 2 && this.direction.x < 0) {\n      this.direction.setX(0);\n    }\n\n    this.collisionRaycaster.ray.direction.applyAxisAngle(\n      this.rotationAxis,\n      Math.PI / 2,\n    );\n    const backWall = this.collisionRaycaster.intersectObjects(this.walls)[0];\n    if (backWall && backWall.distance < 2 && this.direction.z < 0) {\n      this.direction.setZ(0);\n    }\n\n    this.collisionRaycaster.ray.direction.applyAxisAngle(\n      this.rotationAxis,\n      Math.PI / 2,\n    );\n    const rightWall = this.collisionRaycaster.intersectObjects(this.walls)[0];\n    if (rightWall && rightWall.distance < 2 && this.direction.x > 0) {\n      this.direction.setX(0);\n    }\n\n    const rightMov = (this.direction.x * deltat) / 100;\n    const forwardMov = (this.direction.z * deltat) / 100;\n    this.pointerLockControls.moveRight(rightMov);\n    this.pointerLockControls.moveForward(forwardMov);\n\n    this.pointer.position.copy(camera.position);\n    this.pointer.rotation.copy(camera.rotation);\n    this.pointer.translateZ(-1.5);\n    this.pointer.updateMatrix();\n  }\n}\n","import * as THREE from 'three';\n\ntype ObjectsMapType = { [key: string]: THREE.Object3D };\ntype HandlersMapType = { [key: string]: () => void };\n\nexport default class MousePointerControls {\n  camera: THREE.Camera;\n  raycaster: THREE.Raycaster;\n  mouse: THREE.Vector2;\n  objectsMap: ObjectsMapType;\n  handlersMap: HandlersMapType;\n\n  constructor(camera: THREE.Camera) {\n    this.camera = camera;\n    this.raycaster = new THREE.Raycaster();\n    this.mouse = new THREE.Vector2(0, 0);\n    this.objectsMap = {};\n    this.handlersMap = {};\n  }\n\n  addObjectAndHandler(object: THREE.Object3D, handler: () => void) {\n    const { uuid } = object;\n    this.objectsMap[uuid] = object;\n    this.handlersMap[uuid] = handler;\n  }\n\n  onClick(event: PointerEvent) {\n    event.preventDefault();\n\n    this.raycaster.setFromCamera(this.mouse, this.camera);\n\n    const firstIntersection = this.raycaster.intersectObjects(\n      Object.values(this.objectsMap),\n      true,\n    )[0];\n\n    if (firstIntersection) {\n      // Search for parent originally added\n      let objIntersected = firstIntersection.object;\n      while (!this.objectsMap[objIntersected.uuid]) {\n        objIntersected = objIntersected.parent;\n      }\n\n      // Execute its handler\n      const { uuid } = objIntersected;\n      this.handlersMap[uuid]();\n    }\n  }\n}\n","import { BufferGeometry } from '../core/BufferGeometry.js';\nimport { Float32BufferAttribute } from '../core/BufferAttribute.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Vector3 } from '../math/Vector3.js';\n\nclass RingGeometry extends BufferGeometry {\n\n\tconstructor( innerRadius = 0.5, outerRadius = 1, thetaSegments = 8, phiSegments = 1, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'RingGeometry';\n\n\t\tthis.parameters = {\n\t\t\tinnerRadius: innerRadius,\n\t\t\touterRadius: outerRadius,\n\t\t\tthetaSegments: thetaSegments,\n\t\t\tphiSegments: phiSegments,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tthetaSegments = Math.max( 3, thetaSegments );\n\t\tphiSegments = Math.max( 1, phiSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// some helper variables\n\n\t\tlet radius = innerRadius;\n\t\tconst radiusStep = ( ( outerRadius - innerRadius ) / phiSegments );\n\t\tconst vertex = new Vector3();\n\t\tconst uv = new Vector2();\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let j = 0; j <= phiSegments; j ++ ) {\n\n\t\t\tfor ( let i = 0; i <= thetaSegments; i ++ ) {\n\n\t\t\t\t// values are generate from the inside of the ring to the outside\n\n\t\t\t\tconst segment = thetaStart + i / thetaSegments * thetaLength;\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = radius * Math.cos( segment );\n\t\t\t\tvertex.y = radius * Math.sin( segment );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormals.push( 0, 0, 1 );\n\n\t\t\t\t// uv\n\n\t\t\t\tuv.x = ( vertex.x / outerRadius + 1 ) / 2;\n\t\t\t\tuv.y = ( vertex.y / outerRadius + 1 ) / 2;\n\n\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t}\n\n\t\t\t// increase the radius for next row of vertices\n\n\t\t\tradius += radiusStep;\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let j = 0; j < phiSegments; j ++ ) {\n\n\t\t\tconst thetaSegmentLevel = j * ( thetaSegments + 1 );\n\n\t\t\tfor ( let i = 0; i < thetaSegments; i ++ ) {\n\n\t\t\t\tconst segment = i + thetaSegmentLevel;\n\n\t\t\t\tconst a = segment;\n\t\t\t\tconst b = segment + thetaSegments + 1;\n\t\t\t\tconst c = segment + thetaSegments + 2;\n\t\t\t\tconst d = segment + 1;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new RingGeometry( data.innerRadius, data.outerRadius, data.thetaSegments, data.phiSegments, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\n\nexport { RingGeometry, RingGeometry as RingBufferGeometry };\n","class LoaderUtils {\n\n\tstatic decodeText( array ) {\n\n\t\tif ( typeof TextDecoder !== 'undefined' ) {\n\n\t\t\treturn new TextDecoder().decode( array );\n\n\t\t}\n\n\t\t// Avoid the String.fromCharCode.apply(null, array) shortcut, which\n\t\t// throws a \"maximum call stack size exceeded\" error for large arrays.\n\n\t\tlet s = '';\n\n\t\tfor ( let i = 0, il = array.length; i < il; i ++ ) {\n\n\t\t\t// Implicitly assumes little-endian.\n\t\t\ts += String.fromCharCode( array[ i ] );\n\n\t\t}\n\n\t\ttry {\n\n\t\t\t// merges multi-byte utf-8 characters.\n\n\t\t\treturn decodeURIComponent( escape( s ) );\n\n\t\t} catch ( e ) { // see #16358\n\n\t\t\treturn s;\n\n\t\t}\n\n\t}\n\n\tstatic extractUrlBase( url ) {\n\n\t\tconst index = url.lastIndexOf( '/' );\n\n\t\tif ( index === - 1 ) return './';\n\n\t\treturn url.substr( 0, index + 1 );\n\n\t}\n\n\tstatic resolveURL( url, path ) {\n\n\t\t// Invalid URL\n\t\tif ( typeof url !== 'string' || url === '' ) return '';\n\n\t\t// Host Relative URL\n\t\tif ( /^https?:\\/\\//i.test( path ) && /^\\//.test( url ) ) {\n\n\t\t\tpath = path.replace( /(^https?:\\/\\/[^\\/]+).*/i, '$1' );\n\n\t\t}\n\n\t\t// Absolute URL http://,https://,//\n\t\tif ( /^(https?:)?\\/\\//i.test( url ) ) return url;\n\n\t\t// Data URI\n\t\tif ( /^data:.*,.*$/i.test( url ) ) return url;\n\n\t\t// Blob URL\n\t\tif ( /^blob:.*$/i.test( url ) ) return url;\n\n\t\t// Relative URL\n\t\treturn path + url;\n\n\t}\n\n}\n\nexport { LoaderUtils };\n","import { Cache } from './Cache.js';\nimport { Loader } from './Loader.js';\n\nconst loading = {};\n\nclass FileLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( url === undefined ) url = '';\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tthis.manager.itemStart( url );\n\n\t\t\tsetTimeout( () => {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tthis.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\t// Check if request is duplicate\n\n\t\tif ( loading[ url ] !== undefined ) {\n\n\t\t\tloading[ url ].push( {\n\n\t\t\t\tonLoad: onLoad,\n\t\t\t\tonProgress: onProgress,\n\t\t\t\tonError: onError\n\n\t\t\t} );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Initialise array for duplicate requests\n\t\tloading[ url ] = [];\n\n\t\tloading[ url ].push( {\n\t\t\tonLoad: onLoad,\n\t\t\tonProgress: onProgress,\n\t\t\tonError: onError,\n\t\t} );\n\n\t\t// create request\n\t\tconst req = new Request( url, {\n\t\t\theaders: new Headers( this.requestHeader ),\n\t\t\tcredentials: this.withCredentials ? 'include' : 'same-origin',\n\t\t\t// An abort controller could be added within a future PR\n\t\t} );\n\n\t\t// start the fetch\n\t\tfetch( req )\n\t\t\t.then( response => {\n\n\t\t\t\tif ( response.status === 200 || response.status === 0 ) {\n\n\t\t\t\t\t// Some browsers return HTTP Status 0 when using non-http protocol\n\t\t\t\t\t// e.g. 'file://' or 'data://'. Handle as success.\n\n\t\t\t\t\tif ( response.status === 0 ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.FileLoader: HTTP Status 0 received.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst callbacks = loading[ url ];\n\t\t\t\t\tconst reader = response.body.getReader();\n\t\t\t\t\tconst contentLength = response.headers.get( 'Content-Length' );\n\t\t\t\t\tconst total = contentLength ? parseInt( contentLength ) : 0;\n\t\t\t\t\tconst lengthComputable = total !== 0;\n\t\t\t\t\tlet loaded = 0;\n\n\t\t\t\t\t// periodically read data into the new stream tracking while download progress\n\t\t\t\t\treturn new ReadableStream( {\n\t\t\t\t\t\tstart( controller ) {\n\n\t\t\t\t\t\t\treadData();\n\n\t\t\t\t\t\t\tfunction readData() {\n\n\t\t\t\t\t\t\t\treader.read().then( ( { done, value } ) => {\n\n\t\t\t\t\t\t\t\t\tif ( done ) {\n\n\t\t\t\t\t\t\t\t\t\tcontroller.close();\n\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\tloaded += value.byteLength;\n\n\t\t\t\t\t\t\t\t\t\tconst event = new ProgressEvent( 'progress', { lengthComputable, loaded, total } );\n\t\t\t\t\t\t\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\t\t\t\t\t\t\tif ( callback.onProgress ) callback.onProgress( event );\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tcontroller.enqueue( value );\n\t\t\t\t\t\t\t\t\t\treadData();\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow Error( `fetch for \"${response.url}\" responded with ${response.status}: ${response.statusText}` );\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.then( stream => {\n\n\t\t\t\tconst response = new Response( stream );\n\n\t\t\t\tswitch ( this.responseType ) {\n\n\t\t\t\t\tcase 'arraybuffer':\n\n\t\t\t\t\t\treturn response.arrayBuffer();\n\n\t\t\t\t\tcase 'blob':\n\n\t\t\t\t\t\treturn response.blob();\n\n\t\t\t\t\tcase 'document':\n\n\t\t\t\t\t\treturn response.text()\n\t\t\t\t\t\t\t.then( text => {\n\n\t\t\t\t\t\t\t\tconst parser = new DOMParser();\n\t\t\t\t\t\t\t\treturn parser.parseFromString( text, this.mimeType );\n\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\tcase 'json':\n\n\t\t\t\t\t\treturn response.json();\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\treturn response.text();\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.then( data => {\n\n\t\t\t\t// Add to cache only on HTTP success, so that we do not cache\n\t\t\t\t// error response bodies as proper responses to requests.\n\t\t\t\tCache.add( url, data );\n\n\t\t\t\tconst callbacks = loading[ url ];\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onLoad ) callback.onLoad( data );\n\n\t\t\t\t}\n\n\t\t\t\tthis.manager.itemEnd( url );\n\n\t\t\t} )\n\t\t\t.catch( err => {\n\n\t\t\t\t// Abort errors and other errors are handled the same\n\n\t\t\t\tconst callbacks = loading[ url ];\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onError ) callback.onError( err );\n\n\t\t\t\t}\n\n\t\t\t\tthis.manager.itemError( url );\n\t\t\t\tthis.manager.itemEnd( url );\n\n\t\t\t} );\n\n\t\tthis.manager.itemStart( url );\n\n\t}\n\n\tsetResponseType( value ) {\n\n\t\tthis.responseType = value;\n\t\treturn this;\n\n\t}\n\n\tsetMimeType( value ) {\n\n\t\tthis.mimeType = value;\n\t\treturn this;\n\n\t}\n\n}\n\n\nexport { FileLoader };\n","import { LightShadow } from './LightShadow.js';\nimport { OrthographicCamera } from '../cameras/OrthographicCamera.js';\n\nclass DirectionalLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new OrthographicCamera( - 5, 5, 5, - 5, 0.5, 500 ) );\n\n\t}\n\n}\n\nDirectionalLightShadow.prototype.isDirectionalLightShadow = true;\n\nexport { DirectionalLightShadow };\n","import { Light } from './Light.js';\nimport { DirectionalLightShadow } from './DirectionalLightShadow.js';\nimport { Object3D } from '../core/Object3D.js';\n\nclass DirectionalLight extends Light {\n\n\tconstructor( color, intensity ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.type = 'DirectionalLight';\n\n\t\tthis.position.copy( Object3D.DefaultUp );\n\t\tthis.updateMatrix();\n\n\t\tthis.target = new Object3D();\n\n\t\tthis.shadow = new DirectionalLightShadow();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.target = source.target.clone();\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nDirectionalLight.prototype.isDirectionalLight = true;\n\nexport { DirectionalLight };\n","import { LightShadow } from './LightShadow.js';\nimport { PerspectiveCamera } from '../cameras/PerspectiveCamera.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Vector4 } from '../math/Vector4.js';\n\nconst _projScreenMatrix = /*@__PURE__*/ new Matrix4();\nconst _lightPositionWorld = /*@__PURE__*/ new Vector3();\nconst _lookTarget = /*@__PURE__*/ new Vector3();\n\nclass PointLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new PerspectiveCamera( 90, 1, 0.5, 500 ) );\n\n\t\tthis._frameExtents = new Vector2( 4, 2 );\n\n\t\tthis._viewportCount = 6;\n\n\t\tthis._viewports = [\n\t\t\t// These viewports map a cube-map onto a 2D texture with the\n\t\t\t// following orientation:\n\t\t\t//\n\t\t\t//  xzXZ\n\t\t\t//   y Y\n\t\t\t//\n\t\t\t// X - Positive x direction\n\t\t\t// x - Negative x direction\n\t\t\t// Y - Positive y direction\n\t\t\t// y - Negative y direction\n\t\t\t// Z - Positive z direction\n\t\t\t// z - Negative z direction\n\n\t\t\t// positive X\n\t\t\tnew Vector4( 2, 1, 1, 1 ),\n\t\t\t// negative X\n\t\t\tnew Vector4( 0, 1, 1, 1 ),\n\t\t\t// positive Z\n\t\t\tnew Vector4( 3, 1, 1, 1 ),\n\t\t\t// negative Z\n\t\t\tnew Vector4( 1, 1, 1, 1 ),\n\t\t\t// positive Y\n\t\t\tnew Vector4( 3, 0, 1, 1 ),\n\t\t\t// negative Y\n\t\t\tnew Vector4( 1, 0, 1, 1 )\n\t\t];\n\n\t\tthis._cubeDirections = [\n\t\t\tnew Vector3( 1, 0, 0 ), new Vector3( - 1, 0, 0 ), new Vector3( 0, 0, 1 ),\n\t\t\tnew Vector3( 0, 0, - 1 ), new Vector3( 0, 1, 0 ), new Vector3( 0, - 1, 0 )\n\t\t];\n\n\t\tthis._cubeUps = [\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ),\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 0, 1 ),\tnew Vector3( 0, 0, - 1 )\n\t\t];\n\n\t}\n\n\tupdateMatrices( light, viewportIndex = 0 ) {\n\n\t\tconst camera = this.camera;\n\t\tconst shadowMatrix = this.matrix;\n\n\t\tconst far = light.distance || camera.far;\n\n\t\tif ( far !== camera.far ) {\n\n\t\t\tcamera.far = far;\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t\t_lightPositionWorld.setFromMatrixPosition( light.matrixWorld );\n\t\tcamera.position.copy( _lightPositionWorld );\n\n\t\t_lookTarget.copy( camera.position );\n\t\t_lookTarget.add( this._cubeDirections[ viewportIndex ] );\n\t\tcamera.up.copy( this._cubeUps[ viewportIndex ] );\n\t\tcamera.lookAt( _lookTarget );\n\t\tcamera.updateMatrixWorld();\n\n\t\tshadowMatrix.makeTranslation( - _lightPositionWorld.x, - _lightPositionWorld.y, - _lightPositionWorld.z );\n\n\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\n\t\tthis._frustum.setFromProjectionMatrix( _projScreenMatrix );\n\n\t}\n\n}\n\nPointLightShadow.prototype.isPointLightShadow = true;\n\nexport { PointLightShadow };\n","import { Light } from './Light.js';\nimport { PointLightShadow } from './PointLightShadow.js';\n\nclass PointLight extends Light {\n\n\tconstructor( color, intensity, distance = 0, decay = 1 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.type = 'PointLight';\n\n\t\tthis.distance = distance;\n\t\tthis.decay = decay; // for physically correct lights, should be 2.\n\n\t\tthis.shadow = new PointLightShadow();\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in candela)\n\t\t// for an isotropic light source, luminous power (lm) = 4 π luminous intensity (cd)\n\t\treturn this.intensity * 4 * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in candela) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / ( 4 * Math.PI );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.distance = source.distance;\n\t\tthis.decay = source.decay;\n\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nPointLight.prototype.isPointLight = true;\n\nexport { PointLight };\n","import { TangentSpaceNormalMap } from '../constants.js';\nimport { Material } from './Material.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Color } from '../math/Color.js';\n\n/**\n * parameters = {\n *  color: <hex>,\n *  roughness: <float>,\n *  metalness: <float>,\n *  opacity: <float>,\n *\n *  map: new THREE.Texture( <Image> ),\n *\n *  lightMap: new THREE.Texture( <Image> ),\n *  lightMapIntensity: <float>\n *\n *  aoMap: new THREE.Texture( <Image> ),\n *  aoMapIntensity: <float>\n *\n *  emissive: <hex>,\n *  emissiveIntensity: <float>\n *  emissiveMap: new THREE.Texture( <Image> ),\n *\n *  bumpMap: new THREE.Texture( <Image> ),\n *  bumpScale: <float>,\n *\n *  normalMap: new THREE.Texture( <Image> ),\n *  normalMapType: THREE.TangentSpaceNormalMap,\n *  normalScale: <Vector2>,\n *\n *  displacementMap: new THREE.Texture( <Image> ),\n *  displacementScale: <float>,\n *  displacementBias: <float>,\n *\n *  roughnessMap: new THREE.Texture( <Image> ),\n *\n *  metalnessMap: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\n *  envMapIntensity: <float>\n *\n *  refractionRatio: <float>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n *\n *  flatShading: <bool>\n * }\n */\n\nclass MeshStandardMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.defines = { 'STANDARD': '' };\n\n\t\tthis.type = 'MeshStandardMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\t\tthis.roughness = 1.0;\n\t\tthis.metalness = 0.0;\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.roughnessMap = null;\n\n\t\tthis.metalnessMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.envMapIntensity = 1.0;\n\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.flatShading = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = { 'STANDARD': '' };\n\n\t\tthis.color.copy( source.color );\n\t\tthis.roughness = source.roughness;\n\t\tthis.metalness = source.metalness;\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.roughnessMap = source.roughnessMap;\n\n\t\tthis.metalnessMap = source.metalnessMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.envMapIntensity = source.envMapIntensity;\n\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshStandardMaterial.prototype.isMeshStandardMaterial = true;\n\nexport { MeshStandardMaterial };\n","import { Vector2 } from '../math/Vector2.js';\nimport { MeshStandardMaterial } from './MeshStandardMaterial.js';\nimport { Color } from '../math/Color.js';\nimport * as MathUtils from '../math/MathUtils.js';\n\n/**\n * parameters = {\n *  clearcoat: <float>,\n *  clearcoatMap: new THREE.Texture( <Image> ),\n *  clearcoatRoughness: <float>,\n *  clearcoatRoughnessMap: new THREE.Texture( <Image> ),\n *  clearcoatNormalScale: <Vector2>,\n *  clearcoatNormalMap: new THREE.Texture( <Image> ),\n *\n *  ior: <float>,\n *  reflectivity: <float>,\n *\n *  sheen: <float>,\n *  sheenColor: <Color>,\n *  sheenColorMap: new THREE.Texture( <Image> ),\n *  sheenRoughness: <float>,\n *  sheenRoughnessMap: new THREE.Texture( <Image> ),\n *\n *  transmission: <float>,\n *  transmissionMap: new THREE.Texture( <Image> ),\n *\n *  thickness: <float>,\n *  thicknessMap: new THREE.Texture( <Image> ),\n *  attenuationDistance: <float>,\n *  attenuationColor: <Color>,\n *\n *  specularIntensity: <float>,\n *  specularIntensityMap: new THREE.Texture( <Image> ),\n *  specularColor: <Color>,\n *  specularColorMap: new THREE.Texture( <Image> )\n * }\n */\n\nclass MeshPhysicalMaterial extends MeshStandardMaterial {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.defines = {\n\n\t\t\t'STANDARD': '',\n\t\t\t'PHYSICAL': ''\n\n\t\t};\n\n\t\tthis.type = 'MeshPhysicalMaterial';\n\n\t\tthis.clearcoatMap = null;\n\t\tthis.clearcoatRoughness = 0.0;\n\t\tthis.clearcoatRoughnessMap = null;\n\t\tthis.clearcoatNormalScale = new Vector2( 1, 1 );\n\t\tthis.clearcoatNormalMap = null;\n\n\t\tthis.ior = 1.5;\n\n\t\tObject.defineProperty( this, 'reflectivity', {\n\t\t\tget: function () {\n\n\t\t\t\treturn ( MathUtils.clamp( 2.5 * ( this.ior - 1 ) / ( this.ior + 1 ), 0, 1 ) );\n\n\t\t\t},\n\t\t\tset: function ( reflectivity ) {\n\n\t\t\t\tthis.ior = ( 1 + 0.4 * reflectivity ) / ( 1 - 0.4 * reflectivity );\n\n\t\t\t}\n\t\t} );\n\n\t\tthis.sheenColor = new Color( 0x000000 );\n\t\tthis.sheenColorMap = null;\n\t\tthis.sheenRoughness = 1.0;\n\t\tthis.sheenRoughnessMap = null;\n\n\t\tthis.transmissionMap = null;\n\n\t\tthis.thickness = 0.01;\n\t\tthis.thicknessMap = null;\n\t\tthis.attenuationDistance = 0.0;\n\t\tthis.attenuationColor = new Color( 1, 1, 1 );\n\n\t\tthis.specularIntensity = 1.0;\n\t\tthis.specularIntensityMap = null;\n\t\tthis.specularColor = new Color( 1, 1, 1 );\n\t\tthis.specularColorMap = null;\n\n\t\tthis._sheen = 0.0;\n\t\tthis._clearcoat = 0;\n\t\tthis._transmission = 0;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tget sheen() {\n\n\t\treturn this._sheen;\n\n\t}\n\n\tset sheen( value ) {\n\n\t\tif ( this._sheen > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._sheen = value;\n\n\t}\n\n\tget clearcoat() {\n\n\t\treturn this._clearcoat;\n\n\t}\n\n\tset clearcoat( value ) {\n\n\t\tif ( this._clearcoat > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._clearcoat = value;\n\n\t}\n\n\tget transmission() {\n\n\t\treturn this._transmission;\n\n\t}\n\n\tset transmission( value ) {\n\n\t\tif ( this._transmission > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._transmission = value;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = {\n\n\t\t\t'STANDARD': '',\n\t\t\t'PHYSICAL': ''\n\n\t\t};\n\n\t\tthis.clearcoat = source.clearcoat;\n\t\tthis.clearcoatMap = source.clearcoatMap;\n\t\tthis.clearcoatRoughness = source.clearcoatRoughness;\n\t\tthis.clearcoatRoughnessMap = source.clearcoatRoughnessMap;\n\t\tthis.clearcoatNormalMap = source.clearcoatNormalMap;\n\t\tthis.clearcoatNormalScale.copy( source.clearcoatNormalScale );\n\n\t\tthis.ior = source.ior;\n\n\t\tthis.sheen = source.sheen;\n\t\tthis.sheenColor.copy( source.sheenColor );\n\t\tthis.sheenColorMap = source.sheenColorMap;\n\t\tthis.sheenRoughness = source.sheenRoughness;\n\t\tthis.sheenRoughnessMap = source.sheenRoughnessMap;\n\n\t\tthis.transmission = source.transmission;\n\t\tthis.transmissionMap = source.transmissionMap;\n\n\t\tthis.thickness = source.thickness;\n\t\tthis.thicknessMap = source.thicknessMap;\n\t\tthis.attenuationDistance = source.attenuationDistance;\n\t\tthis.attenuationColor.copy( source.attenuationColor );\n\n\t\tthis.specularIntensity = source.specularIntensity;\n\t\tthis.specularIntensityMap = source.specularIntensityMap;\n\t\tthis.specularColor.copy( source.specularColor );\n\t\tthis.specularColorMap = source.specularColorMap;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshPhysicalMaterial.prototype.isMeshPhysicalMaterial = true;\n\nexport { MeshPhysicalMaterial };\n","/**\n * Abstract base class of interpolants over parametric samples.\n *\n * The parameter domain is one dimensional, typically the time or a path\n * along a curve defined by the data.\n *\n * The sample values can have any dimensionality and derived classes may\n * apply special interpretations to the data.\n *\n * This class provides the interval seek in a Template Method, deferring\n * the actual interpolation to derived classes.\n *\n * Time complexity is O(1) for linear access crossing at most two points\n * and O(log N) for random access, where N is the number of positions.\n *\n * References:\n *\n * \t\thttp://www.oodesign.com/template-method-pattern.html\n *\n */\n\nclass Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tthis.parameterPositions = parameterPositions;\n\t\tthis._cachedIndex = 0;\n\n\t\tthis.resultBuffer = resultBuffer !== undefined ?\n\t\t\tresultBuffer : new sampleValues.constructor( sampleSize );\n\t\tthis.sampleValues = sampleValues;\n\t\tthis.valueSize = sampleSize;\n\n\t\tthis.settings = null;\n\t\tthis.DefaultSettings_ = {};\n\n\t}\n\n\tevaluate( t ) {\n\n\t\tconst pp = this.parameterPositions;\n\t\tlet i1 = this._cachedIndex,\n\t\t\tt1 = pp[ i1 ],\n\t\t\tt0 = pp[ i1 - 1 ];\n\n\t\tvalidate_interval: {\n\n\t\t\tseek: {\n\n\t\t\t\tlet right;\n\n\t\t\t\tlinear_scan: {\n\n\t\t\t\t\t//- See http://jsperf.com/comparison-to-undefined/3\n\t\t\t\t\t//- slower code:\n\t\t\t\t\t//-\n\t\t\t\t\t//- \t\t\t\tif ( t >= t1 || t1 === undefined ) {\n\t\t\t\t\tforward_scan: if ( ! ( t < t1 ) ) {\n\n\t\t\t\t\t\tfor ( let giveUpAt = i1 + 2; ; ) {\n\n\t\t\t\t\t\t\tif ( t1 === undefined ) {\n\n\t\t\t\t\t\t\t\tif ( t < t0 ) break forward_scan;\n\n\t\t\t\t\t\t\t\t// after end\n\n\t\t\t\t\t\t\t\ti1 = pp.length;\n\t\t\t\t\t\t\t\tthis._cachedIndex = i1;\n\t\t\t\t\t\t\t\treturn this.afterEnd_( i1 - 1, t, t0 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\n\n\t\t\t\t\t\t\tt0 = t1;\n\t\t\t\t\t\t\tt1 = pp[ ++ i1 ];\n\n\t\t\t\t\t\t\tif ( t < t1 ) {\n\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\n\t\t\t\t\t\t\t\tbreak seek;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// prepare binary search on the right side of the index\n\t\t\t\t\t\tright = pp.length;\n\t\t\t\t\t\tbreak linear_scan;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t//- slower code:\n\t\t\t\t\t//-\t\t\t\t\tif ( t < t0 || t0 === undefined ) {\n\t\t\t\t\tif ( ! ( t >= t0 ) ) {\n\n\t\t\t\t\t\t// looping?\n\n\t\t\t\t\t\tconst t1global = pp[ 1 ];\n\n\t\t\t\t\t\tif ( t < t1global ) {\n\n\t\t\t\t\t\t\ti1 = 2; // + 1, using the scan for the details\n\t\t\t\t\t\t\tt0 = t1global;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// linear reverse scan\n\n\t\t\t\t\t\tfor ( let giveUpAt = i1 - 2; ; ) {\n\n\t\t\t\t\t\t\tif ( t0 === undefined ) {\n\n\t\t\t\t\t\t\t\t// before start\n\n\t\t\t\t\t\t\t\tthis._cachedIndex = 0;\n\t\t\t\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\n\n\t\t\t\t\t\t\tt1 = t0;\n\t\t\t\t\t\t\tt0 = pp[ -- i1 - 1 ];\n\n\t\t\t\t\t\t\tif ( t >= t0 ) {\n\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\n\t\t\t\t\t\t\t\tbreak seek;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// prepare binary search on the left side of the index\n\t\t\t\t\t\tright = i1;\n\t\t\t\t\t\ti1 = 0;\n\t\t\t\t\t\tbreak linear_scan;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// the interval is valid\n\n\t\t\t\t\tbreak validate_interval;\n\n\t\t\t\t} // linear scan\n\n\t\t\t\t// binary search\n\n\t\t\t\twhile ( i1 < right ) {\n\n\t\t\t\t\tconst mid = ( i1 + right ) >>> 1;\n\n\t\t\t\t\tif ( t < pp[ mid ] ) {\n\n\t\t\t\t\t\tright = mid;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ti1 = mid + 1;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tt1 = pp[ i1 ];\n\t\t\t\tt0 = pp[ i1 - 1 ];\n\n\t\t\t\t// check boundary cases, again\n\n\t\t\t\tif ( t0 === undefined ) {\n\n\t\t\t\t\tthis._cachedIndex = 0;\n\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\n\n\t\t\t\t}\n\n\t\t\t\tif ( t1 === undefined ) {\n\n\t\t\t\t\ti1 = pp.length;\n\t\t\t\t\tthis._cachedIndex = i1;\n\t\t\t\t\treturn this.afterEnd_( i1 - 1, t0, t );\n\n\t\t\t\t}\n\n\t\t\t} // seek\n\n\t\t\tthis._cachedIndex = i1;\n\n\t\t\tthis.intervalChanged_( i1, t0, t1 );\n\n\t\t} // validate_interval\n\n\t\treturn this.interpolate_( i1, t0, t, t1 );\n\n\t}\n\n\tgetSettings_() {\n\n\t\treturn this.settings || this.DefaultSettings_;\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// copies a sample value to the result buffer\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\t\t\toffset = index * stride;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\t// Template methods for derived classes:\n\n\tinterpolate_( /* i1, t0, t, t1 */ ) {\n\n\t\tthrow new Error( 'call to abstract method' );\n\t\t// implementations shall return this.resultBuffer\n\n\t}\n\n\tintervalChanged_( /* i1, t0, t1 */ ) {\n\n\t\t// empty\n\n\t}\n\n}\n\n// ALIAS DEFINITIONS\n\nInterpolant.prototype.beforeStart_ = Interpolant.prototype.copySampleValue_;\nInterpolant.prototype.afterEnd_ = Interpolant.prototype.copySampleValue_;\n\nexport { Interpolant };\n","import { Cache } from './Cache.js';\nimport { Loader } from './Loader.js';\n\nclass ImageBitmapLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tif ( typeof createImageBitmap === 'undefined' ) {\n\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: createImageBitmap() not supported.' );\n\n\t\t}\n\n\t\tif ( typeof fetch === 'undefined' ) {\n\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: fetch() not supported.' );\n\n\t\t}\n\n\t\tthis.options = { premultiplyAlpha: 'none' };\n\n\t}\n\n\tsetOptions( options ) {\n\n\t\tthis.options = options;\n\n\t\treturn this;\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( url === undefined ) url = '';\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst scope = this;\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tconst fetchOptions = {};\n\t\tfetchOptions.credentials = ( this.crossOrigin === 'anonymous' ) ? 'same-origin' : 'include';\n\t\tfetchOptions.headers = this.requestHeader;\n\n\t\tfetch( url, fetchOptions ).then( function ( res ) {\n\n\t\t\treturn res.blob();\n\n\t\t} ).then( function ( blob ) {\n\n\t\t\treturn createImageBitmap( blob, Object.assign( scope.options, { colorSpaceConversion: 'none' } ) );\n\n\t\t} ).then( function ( imageBitmap ) {\n\n\t\t\tCache.add( url, imageBitmap );\n\n\t\t\tif ( onLoad ) onLoad( imageBitmap );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t} ).catch( function ( e ) {\n\n\t\t\tif ( onError ) onError( e );\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t} );\n\n\t\tscope.manager.itemStart( url );\n\n\t}\n\n}\n\nImageBitmapLoader.prototype.isImageBitmapLoader = true;\n\nexport { ImageBitmapLoader };\n","import * as MathUtils from '../math/MathUtils.js';\nimport { StaticDrawUsage } from '../constants.js';\n\nclass InterleavedBuffer {\n\n\tconstructor( array, stride ) {\n\n\t\tthis.array = array;\n\t\tthis.stride = stride;\n\t\tthis.count = array !== undefined ? array.length / stride : 0;\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.updateRange = { offset: 0, count: - 1 };\n\n\t\tthis.version = 0;\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t}\n\n\tonUploadCallback() {}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.array = new source.array.constructor( source.array );\n\t\tthis.count = source.count;\n\t\tthis.stride = source.stride;\n\t\tthis.usage = source.usage;\n\n\t\treturn this;\n\n\t}\n\n\tcopyAt( index1, attribute, index2 ) {\n\n\t\tindex1 *= this.stride;\n\t\tindex2 *= attribute.stride;\n\n\t\tfor ( let i = 0, l = this.stride; i < l; i ++ ) {\n\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tset( value, offset = 0 ) {\n\n\t\tthis.array.set( value, offset );\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tif ( data.arrayBuffers === undefined ) {\n\n\t\t\tdata.arrayBuffers = {};\n\n\t\t}\n\n\t\tif ( this.array.buffer._uuid === undefined ) {\n\n\t\t\tthis.array.buffer._uuid = MathUtils.generateUUID();\n\n\t\t}\n\n\t\tif ( data.arrayBuffers[ this.array.buffer._uuid ] === undefined ) {\n\n\t\t\tdata.arrayBuffers[ this.array.buffer._uuid ] = this.array.slice( 0 ).buffer;\n\n\t\t}\n\n\t\tconst array = new this.array.constructor( data.arrayBuffers[ this.array.buffer._uuid ] );\n\n\t\tconst ib = new this.constructor( array, this.stride );\n\t\tib.setUsage( this.usage );\n\n\t\treturn ib;\n\n\t}\n\n\tonUpload( callback ) {\n\n\t\tthis.onUploadCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tif ( data.arrayBuffers === undefined ) {\n\n\t\t\tdata.arrayBuffers = {};\n\n\t\t}\n\n\t\t// generate UUID for array buffer if necessary\n\n\t\tif ( this.array.buffer._uuid === undefined ) {\n\n\t\t\tthis.array.buffer._uuid = MathUtils.generateUUID();\n\n\t\t}\n\n\t\tif ( data.arrayBuffers[ this.array.buffer._uuid ] === undefined ) {\n\n\t\t\tdata.arrayBuffers[ this.array.buffer._uuid ] = Array.prototype.slice.call( new Uint32Array( this.array.buffer ) );\n\n\t\t}\n\n\t\t//\n\n\t\treturn {\n\t\t\tuuid: this.uuid,\n\t\t\tbuffer: this.array.buffer._uuid,\n\t\t\ttype: this.array.constructor.name,\n\t\t\tstride: this.stride\n\t\t};\n\n\t}\n\n}\n\nInterleavedBuffer.prototype.isInterleavedBuffer = true;\n\nexport { InterleavedBuffer };\n","import { Vector3 } from '../math/Vector3.js';\nimport { BufferAttribute } from './BufferAttribute.js';\n\nconst _vector = /*@__PURE__*/ new Vector3();\n\nclass InterleavedBufferAttribute {\n\n\tconstructor( interleavedBuffer, itemSize, offset, normalized = false ) {\n\n\t\tthis.name = '';\n\n\t\tthis.data = interleavedBuffer;\n\t\tthis.itemSize = itemSize;\n\t\tthis.offset = offset;\n\n\t\tthis.normalized = normalized === true;\n\n\t}\n\n\tget count() {\n\n\t\treturn this.data.count;\n\n\t}\n\n\tget array() {\n\n\t\treturn this.data.array;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tthis.data.needsUpdate = value;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tfor ( let i = 0, l = this.data.count; i < l; i ++ ) {\n\n\t\t\t_vector.x = this.getX( i );\n\t\t\t_vector.y = this.getY( i );\n\t\t\t_vector.z = this.getZ( i );\n\n\t\t\t_vector.applyMatrix4( m );\n\n\t\t\tthis.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector.x = this.getX( i );\n\t\t\t_vector.y = this.getY( i );\n\t\t\t_vector.z = this.getZ( i );\n\n\t\t\t_vector.applyNormalMatrix( m );\n\n\t\t\tthis.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector.x = this.getX( i );\n\t\t\t_vector.y = this.getY( i );\n\t\t\t_vector.z = this.getZ( i );\n\n\t\t\t_vector.transformDirection( m );\n\n\t\t\tthis.setXYZ( i, _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetX( index, x ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset ] = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( index, y ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( index, z ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetW( index, w ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tgetX( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset ];\n\n\t}\n\n\tgetY( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 1 ];\n\n\t}\n\n\tgetZ( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 2 ];\n\n\t}\n\n\tgetW( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 3 ];\n\n\t}\n\n\tsetXY( index, x, y ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZ( index, x, y, z ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZW( index, x, y, z, w ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\t\tthis.data.array[ index + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconsole.log( 'THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.' );\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0; i < this.count; i ++ ) {\n\n\t\t\t\tconst index = i * this.data.stride + this.offset;\n\n\t\t\t\tfor ( let j = 0; j < this.itemSize; j ++ ) {\n\n\t\t\t\t\tarray.push( this.data.array[ index + j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new BufferAttribute( new this.array.constructor( array ), this.itemSize, this.normalized );\n\n\t\t} else {\n\n\t\t\tif ( data.interleavedBuffers === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers = {};\n\n\t\t\t}\n\n\t\t\tif ( data.interleavedBuffers[ this.data.uuid ] === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers[ this.data.uuid ] = this.data.clone( data );\n\n\t\t\t}\n\n\t\t\treturn new InterleavedBufferAttribute( data.interleavedBuffers[ this.data.uuid ], this.itemSize, this.offset, this.normalized );\n\n\t\t}\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconsole.log( 'THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.' );\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0; i < this.count; i ++ ) {\n\n\t\t\t\tconst index = i * this.data.stride + this.offset;\n\n\t\t\t\tfor ( let j = 0; j < this.itemSize; j ++ ) {\n\n\t\t\t\t\tarray.push( this.data.array[ index + j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// deinterleave data and save it as an ordinary buffer attribute for now\n\n\t\t\treturn {\n\t\t\t\titemSize: this.itemSize,\n\t\t\t\ttype: this.array.constructor.name,\n\t\t\t\tarray: array,\n\t\t\t\tnormalized: this.normalized\n\t\t\t};\n\n\t\t} else {\n\n\t\t\t// save as true interlaved attribtue\n\n\t\t\tif ( data.interleavedBuffers === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers = {};\n\n\t\t\t}\n\n\t\t\tif ( data.interleavedBuffers[ this.data.uuid ] === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers[ this.data.uuid ] = this.data.toJSON( data );\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tisInterleavedBufferAttribute: true,\n\t\t\t\titemSize: this.itemSize,\n\t\t\t\tdata: this.data.uuid,\n\t\t\t\toffset: this.offset,\n\t\t\t\tnormalized: this.normalized\n\t\t\t};\n\n\t\t}\n\n\t}\n\n}\n\nInterleavedBufferAttribute.prototype.isInterleavedBufferAttribute = true;\n\n\nexport { InterleavedBufferAttribute };\n","import { Material } from './Material.js';\nimport { Color } from '../math/Color.js';\n\n/**\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *  map: new THREE.Texture( <Image> ),\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  size: <float>,\n *  sizeAttenuation: <bool>\n *\n * }\n */\n\nclass PointsMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'PointsMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.size = 1;\n\t\tthis.sizeAttenuation = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.size = source.size;\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\n\n\t\treturn this;\n\n\t}\n\n}\n\nPointsMaterial.prototype.isPointsMaterial = true;\n\nexport { PointsMaterial };\n","import { Material } from './Material.js';\nimport { Color } from '../math/Color.js';\n\n/**\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *\n *  linewidth: <float>,\n *  linecap: \"round\",\n *  linejoin: \"round\"\n * }\n */\n\nclass LineBasicMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'LineBasicMaterial';\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.linewidth = 1;\n\t\tthis.linecap = 'round';\n\t\tthis.linejoin = 'round';\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.linewidth = source.linewidth;\n\t\tthis.linecap = source.linecap;\n\t\tthis.linejoin = source.linejoin;\n\n\t\treturn this;\n\n\t}\n\n}\n\nLineBasicMaterial.prototype.isLineBasicMaterial = true;\n\nexport { LineBasicMaterial };\n","// Characters [].:/ are reserved for track binding syntax.\nconst _RESERVED_CHARS_RE = '\\\\[\\\\]\\\\.:\\\\/';\nconst _reservedRe = new RegExp( '[' + _RESERVED_CHARS_RE + ']', 'g' );\n\n// Attempts to allow node names from any language. ES5's `\\w` regexp matches\n// only latin characters, and the unicode \\p{L} is not yet supported. So\n// instead, we exclude reserved characters and match everything else.\nconst _wordChar = '[^' + _RESERVED_CHARS_RE + ']';\nconst _wordCharOrDot = '[^' + _RESERVED_CHARS_RE.replace( '\\\\.', '' ) + ']';\n\n// Parent directories, delimited by '/' or ':'. Currently unused, but must\n// be matched to parse the rest of the track name.\nconst _directoryRe = /((?:WC+[\\/:])*)/.source.replace( 'WC', _wordChar );\n\n// Target node. May contain word characters (a-zA-Z0-9_) and '.' or '-'.\nconst _nodeRe = /(WCOD+)?/.source.replace( 'WCOD', _wordCharOrDot );\n\n// Object on target node, and accessor. May not contain reserved\n// characters. Accessor may contain any character except closing bracket.\nconst _objectRe = /(?:\\.(WC+)(?:\\[(.+)\\])?)?/.source.replace( 'WC', _wordChar );\n\n// Property and accessor. May not contain reserved characters. Accessor may\n// contain any non-bracket characters.\nconst _propertyRe = /\\.(WC+)(?:\\[(.+)\\])?/.source.replace( 'WC', _wordChar );\n\nconst _trackRe = new RegExp( ''\n\t+ '^'\n\t+ _directoryRe\n\t+ _nodeRe\n\t+ _objectRe\n\t+ _propertyRe\n\t+ '$'\n);\n\nconst _supportedObjectNames = [ 'material', 'materials', 'bones' ];\n\nclass Composite {\n\n\tconstructor( targetGroup, path, optionalParsedPath ) {\n\n\t\tconst parsedPath = optionalParsedPath || PropertyBinding.parseTrackName( path );\n\n\t\tthis._targetGroup = targetGroup;\n\t\tthis._bindings = targetGroup.subscribe_( path, parsedPath );\n\n\t}\n\n\tgetValue( array, offset ) {\n\n\t\tthis.bind(); // bind all binding\n\n\t\tconst firstValidIndex = this._targetGroup.nCachedObjects_,\n\t\t\tbinding = this._bindings[ firstValidIndex ];\n\n\t\t// and only call .getValue on the first\n\t\tif ( binding !== undefined ) binding.getValue( array, offset );\n\n\t}\n\n\tsetValue( array, offset ) {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].setValue( array, offset );\n\n\t\t}\n\n\t}\n\n\tbind() {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].bind();\n\n\t\t}\n\n\t}\n\n\tunbind() {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].unbind();\n\n\t\t}\n\n\t}\n\n}\n\n// Note: This class uses a State pattern on a per-method basis:\n// 'bind' sets 'this.getValue' / 'setValue' and shadows the\n// prototype version of these methods with one that represents\n// the bound state. When the property is not found, the methods\n// become no-ops.\nclass PropertyBinding {\n\n\tconstructor( rootNode, path, parsedPath ) {\n\n\t\tthis.path = path;\n\t\tthis.parsedPath = parsedPath || PropertyBinding.parseTrackName( path );\n\n\t\tthis.node = PropertyBinding.findNode( rootNode, this.parsedPath.nodeName ) || rootNode;\n\n\t\tthis.rootNode = rootNode;\n\n\t\t// initial state of these methods that calls 'bind'\n\t\tthis.getValue = this._getValue_unbound;\n\t\tthis.setValue = this._setValue_unbound;\n\n\t}\n\n\n\tstatic create( root, path, parsedPath ) {\n\n\t\tif ( ! ( root && root.isAnimationObjectGroup ) ) {\n\n\t\t\treturn new PropertyBinding( root, path, parsedPath );\n\n\t\t} else {\n\n\t\t\treturn new PropertyBinding.Composite( root, path, parsedPath );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Replaces spaces with underscores and removes unsupported characters from\n\t * node names, to ensure compatibility with parseTrackName().\n\t *\n\t * @param {string} name Node name to be sanitized.\n\t * @return {string}\n\t */\n\tstatic sanitizeNodeName( name ) {\n\n\t\treturn name.replace( /\\s/g, '_' ).replace( _reservedRe, '' );\n\n\t}\n\n\tstatic parseTrackName( trackName ) {\n\n\t\tconst matches = _trackRe.exec( trackName );\n\n\t\tif ( ! matches ) {\n\n\t\t\tthrow new Error( 'PropertyBinding: Cannot parse trackName: ' + trackName );\n\n\t\t}\n\n\t\tconst results = {\n\t\t\t// directoryName: matches[ 1 ], // (tschw) currently unused\n\t\t\tnodeName: matches[ 2 ],\n\t\t\tobjectName: matches[ 3 ],\n\t\t\tobjectIndex: matches[ 4 ],\n\t\t\tpropertyName: matches[ 5 ], // required\n\t\t\tpropertyIndex: matches[ 6 ]\n\t\t};\n\n\t\tconst lastDot = results.nodeName && results.nodeName.lastIndexOf( '.' );\n\n\t\tif ( lastDot !== undefined && lastDot !== - 1 ) {\n\n\t\t\tconst objectName = results.nodeName.substring( lastDot + 1 );\n\n\t\t\t// Object names must be checked against an allowlist. Otherwise, there\n\t\t\t// is no way to parse 'foo.bar.baz': 'baz' must be a property, but\n\t\t\t// 'bar' could be the objectName, or part of a nodeName (which can\n\t\t\t// include '.' characters).\n\t\t\tif ( _supportedObjectNames.indexOf( objectName ) !== - 1 ) {\n\n\t\t\t\tresults.nodeName = results.nodeName.substring( 0, lastDot );\n\t\t\t\tresults.objectName = objectName;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( results.propertyName === null || results.propertyName.length === 0 ) {\n\n\t\t\tthrow new Error( 'PropertyBinding: can not parse propertyName from trackName: ' + trackName );\n\n\t\t}\n\n\t\treturn results;\n\n\t}\n\n\tstatic findNode( root, nodeName ) {\n\n\t\tif ( ! nodeName || nodeName === '' || nodeName === '.' || nodeName === - 1 || nodeName === root.name || nodeName === root.uuid ) {\n\n\t\t\treturn root;\n\n\t\t}\n\n\t\t// search into skeleton bones.\n\t\tif ( root.skeleton ) {\n\n\t\t\tconst bone = root.skeleton.getBoneByName( nodeName );\n\n\t\t\tif ( bone !== undefined ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// search into node subtree.\n\t\tif ( root.children ) {\n\n\t\t\tconst searchNodeSubtree = function ( children ) {\n\n\t\t\t\tfor ( let i = 0; i < children.length; i ++ ) {\n\n\t\t\t\t\tconst childNode = children[ i ];\n\n\t\t\t\t\tif ( childNode.name === nodeName || childNode.uuid === nodeName ) {\n\n\t\t\t\t\t\treturn childNode;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst result = searchNodeSubtree( childNode.children );\n\n\t\t\t\t\tif ( result ) return result;\n\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\n\t\t\t};\n\n\t\t\tconst subTreeNode = searchNodeSubtree( root.children );\n\n\t\t\tif ( subTreeNode ) {\n\n\t\t\t\treturn subTreeNode;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t// these are used to \"bind\" a nonexistent property\n\t_getValue_unavailable() {}\n\t_setValue_unavailable() {}\n\n\t// Getters\n\n\t_getValue_direct( buffer, offset ) {\n\n\t\tbuffer[ offset ] = this.targetObject[ this.propertyName ];\n\n\t}\n\n\t_getValue_array( buffer, offset ) {\n\n\t\tconst source = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = source.length; i !== n; ++ i ) {\n\n\t\t\tbuffer[ offset ++ ] = source[ i ];\n\n\t\t}\n\n\t}\n\n\t_getValue_arrayElement( buffer, offset ) {\n\n\t\tbuffer[ offset ] = this.resolvedProperty[ this.propertyIndex ];\n\n\t}\n\n\t_getValue_toArray( buffer, offset ) {\n\n\t\tthis.resolvedProperty.toArray( buffer, offset );\n\n\t}\n\n\t// Direct\n\n\t_setValue_direct( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\n\t}\n\n\t_setValue_direct_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_direct_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// EntireArray\n\n\t_setValue_array( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t}\n\n\t_setValue_array_setNeedsUpdate( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_array_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// ArrayElement\n\n\t_setValue_arrayElement( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\n\t}\n\n\t_setValue_arrayElement_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_arrayElement_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// HasToFromArray\n\n\t_setValue_fromArray( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\n\t}\n\n\t_setValue_fromArray_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_fromArray_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t_getValue_unbound( targetArray, offset ) {\n\n\t\tthis.bind();\n\t\tthis.getValue( targetArray, offset );\n\n\t}\n\n\t_setValue_unbound( sourceArray, offset ) {\n\n\t\tthis.bind();\n\t\tthis.setValue( sourceArray, offset );\n\n\t}\n\n\t// create getter / setter pair for a property in the scene graph\n\tbind() {\n\n\t\tlet targetObject = this.node;\n\t\tconst parsedPath = this.parsedPath;\n\n\t\tconst objectName = parsedPath.objectName;\n\t\tconst propertyName = parsedPath.propertyName;\n\t\tlet propertyIndex = parsedPath.propertyIndex;\n\n\t\tif ( ! targetObject ) {\n\n\t\t\ttargetObject = PropertyBinding.findNode( this.rootNode, parsedPath.nodeName ) || this.rootNode;\n\n\t\t\tthis.node = targetObject;\n\n\t\t}\n\n\t\t// set fail state so we can just 'return' on error\n\t\tthis.getValue = this._getValue_unavailable;\n\t\tthis.setValue = this._setValue_unavailable;\n\n\t\t// ensure there is a value node\n\t\tif ( ! targetObject ) {\n\n\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to update node for track: ' + this.path + ' but it wasn\\'t found.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( objectName ) {\n\n\t\t\tlet objectIndex = parsedPath.objectIndex;\n\n\t\t\t// special cases were we need to reach deeper into the hierarchy to get the face materials....\n\t\t\tswitch ( objectName ) {\n\n\t\t\t\tcase 'materials':\n\n\t\t\t\t\tif ( ! targetObject.material ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material as node does not have a material.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! targetObject.material.materials ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject.material.materials;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bones':\n\n\t\t\t\t\tif ( ! targetObject.skeleton ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// potential future optimization: skip this if propertyIndex is already an integer\n\t\t\t\t\t// and convert the integer string to a true integer.\n\n\t\t\t\t\ttargetObject = targetObject.skeleton.bones;\n\n\t\t\t\t\t// support resolving morphTarget names into indices.\n\t\t\t\t\tfor ( let i = 0; i < targetObject.length; i ++ ) {\n\n\t\t\t\t\t\tif ( targetObject[ i ].name === objectIndex ) {\n\n\t\t\t\t\t\t\tobjectIndex = i;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tif ( targetObject[ objectName ] === undefined ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to objectName of node undefined.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject[ objectName ];\n\n\t\t\t}\n\n\n\t\t\tif ( objectIndex !== undefined ) {\n\n\t\t\t\tif ( targetObject[ objectIndex ] === undefined ) {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.', this, targetObject );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\ttargetObject = targetObject[ objectIndex ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// resolve property\n\t\tconst nodeProperty = targetObject[ propertyName ];\n\n\t\tif ( nodeProperty === undefined ) {\n\n\t\t\tconst nodeName = parsedPath.nodeName;\n\n\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to update property for track: ' + nodeName +\n\t\t\t\t'.' + propertyName + ' but it wasn\\'t found.', targetObject );\n\t\t\treturn;\n\n\t\t}\n\n\t\t// determine versioning scheme\n\t\tlet versioning = this.Versioning.None;\n\n\t\tthis.targetObject = targetObject;\n\n\t\tif ( targetObject.needsUpdate !== undefined ) { // material\n\n\t\t\tversioning = this.Versioning.NeedsUpdate;\n\n\t\t} else if ( targetObject.matrixWorldNeedsUpdate !== undefined ) { // node transform\n\n\t\t\tversioning = this.Versioning.MatrixWorldNeedsUpdate;\n\n\t\t}\n\n\t\t// determine how the property gets bound\n\t\tlet bindingType = this.BindingType.Direct;\n\n\t\tif ( propertyIndex !== undefined ) {\n\n\t\t\t// access a sub element of the property array (only primitives are supported right now)\n\n\t\t\tif ( propertyName === 'morphTargetInfluences' ) {\n\n\t\t\t\t// potential optimization, skip this if propertyIndex is already an integer, and convert the integer string to a true integer.\n\n\t\t\t\t// support resolving morphTarget names into indices.\n\t\t\t\tif ( ! targetObject.geometry ) {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.', this );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( targetObject.geometry.isBufferGeometry ) {\n\n\t\t\t\t\tif ( ! targetObject.geometry.morphAttributes ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( targetObject.morphTargetDictionary[ propertyIndex ] !== undefined ) {\n\n\t\t\t\t\t\tpropertyIndex = targetObject.morphTargetDictionary[ propertyIndex ];\n\n\t\t\t\t\t}\n\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.', this );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tbindingType = this.BindingType.ArrayElement;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\t\t\tthis.propertyIndex = propertyIndex;\n\n\t\t} else if ( nodeProperty.fromArray !== undefined && nodeProperty.toArray !== undefined ) {\n\n\t\t\t// must use copy for Object3D.Euler/Quaternion\n\n\t\t\tbindingType = this.BindingType.HasFromToArray;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\n\t\t} else if ( Array.isArray( nodeProperty ) ) {\n\n\t\t\tbindingType = this.BindingType.EntireArray;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\n\t\t} else {\n\n\t\t\tthis.propertyName = propertyName;\n\n\t\t}\n\n\t\t// select getter / setter\n\t\tthis.getValue = this.GetterByBindingType[ bindingType ];\n\t\tthis.setValue = this.SetterByBindingTypeAndVersioning[ bindingType ][ versioning ];\n\n\t}\n\n\tunbind() {\n\n\t\tthis.node = null;\n\n\t\t// back to the prototype version of getValue / setValue\n\t\t// note: avoiding to mutate the shape of 'this' via 'delete'\n\t\tthis.getValue = this._getValue_unbound;\n\t\tthis.setValue = this._setValue_unbound;\n\n\t}\n\n}\n\nPropertyBinding.Composite = Composite;\n\nPropertyBinding.prototype.BindingType = {\n\tDirect: 0,\n\tEntireArray: 1,\n\tArrayElement: 2,\n\tHasFromToArray: 3\n};\n\nPropertyBinding.prototype.Versioning = {\n\tNone: 0,\n\tNeedsUpdate: 1,\n\tMatrixWorldNeedsUpdate: 2\n};\n\nPropertyBinding.prototype.GetterByBindingType = [\n\n\tPropertyBinding.prototype._getValue_direct,\n\tPropertyBinding.prototype._getValue_array,\n\tPropertyBinding.prototype._getValue_arrayElement,\n\tPropertyBinding.prototype._getValue_toArray,\n\n];\n\nPropertyBinding.prototype.SetterByBindingTypeAndVersioning = [\n\n\t[\n\t\t// Direct\n\t\tPropertyBinding.prototype._setValue_direct,\n\t\tPropertyBinding.prototype._setValue_direct_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// EntireArray\n\n\t\tPropertyBinding.prototype._setValue_array,\n\t\tPropertyBinding.prototype._setValue_array_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// ArrayElement\n\t\tPropertyBinding.prototype._setValue_arrayElement,\n\t\tPropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// HasToFromArray\n\t\tPropertyBinding.prototype._setValue_fromArray,\n\t\tPropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate,\n\n\t]\n\n];\n\n\nexport { PropertyBinding };\n","import { Mesh } from './Mesh.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Vector4 } from '../math/Vector4.js';\n\nconst _basePosition = /*@__PURE__*/ new Vector3();\n\nconst _skinIndex = /*@__PURE__*/ new Vector4();\nconst _skinWeight = /*@__PURE__*/ new Vector4();\n\nconst _vector = /*@__PURE__*/ new Vector3();\nconst _matrix = /*@__PURE__*/ new Matrix4();\n\nclass SkinnedMesh extends Mesh {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'SkinnedMesh';\n\n\t\tthis.bindMode = 'attached';\n\t\tthis.bindMatrix = new Matrix4();\n\t\tthis.bindMatrixInverse = new Matrix4();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.bindMode = source.bindMode;\n\t\tthis.bindMatrix.copy( source.bindMatrix );\n\t\tthis.bindMatrixInverse.copy( source.bindMatrixInverse );\n\n\t\tthis.skeleton = source.skeleton;\n\n\t\treturn this;\n\n\t}\n\n\tbind( skeleton, bindMatrix ) {\n\n\t\tthis.skeleton = skeleton;\n\n\t\tif ( bindMatrix === undefined ) {\n\n\t\t\tthis.updateMatrixWorld( true );\n\n\t\t\tthis.skeleton.calculateInverses();\n\n\t\t\tbindMatrix = this.matrixWorld;\n\n\t\t}\n\n\t\tthis.bindMatrix.copy( bindMatrix );\n\t\tthis.bindMatrixInverse.copy( bindMatrix ).invert();\n\n\t}\n\n\tpose() {\n\n\t\tthis.skeleton.pose();\n\n\t}\n\n\tnormalizeSkinWeights() {\n\n\t\tconst vector = new Vector4();\n\n\t\tconst skinWeight = this.geometry.attributes.skinWeight;\n\n\t\tfor ( let i = 0, l = skinWeight.count; i < l; i ++ ) {\n\n\t\t\tvector.x = skinWeight.getX( i );\n\t\t\tvector.y = skinWeight.getY( i );\n\t\t\tvector.z = skinWeight.getZ( i );\n\t\t\tvector.w = skinWeight.getW( i );\n\n\t\t\tconst scale = 1.0 / vector.manhattanLength();\n\n\t\t\tif ( scale !== Infinity ) {\n\n\t\t\t\tvector.multiplyScalar( scale );\n\n\t\t\t} else {\n\n\t\t\t\tvector.set( 1, 0, 0, 0 ); // do something reasonable\n\n\t\t\t}\n\n\t\t\tskinWeight.setXYZW( i, vector.x, vector.y, vector.z, vector.w );\n\n\t\t}\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tif ( this.bindMode === 'attached' ) {\n\n\t\t\tthis.bindMatrixInverse.copy( this.matrixWorld ).invert();\n\n\t\t} else if ( this.bindMode === 'detached' ) {\n\n\t\t\tthis.bindMatrixInverse.copy( this.bindMatrix ).invert();\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.SkinnedMesh: Unrecognized bindMode: ' + this.bindMode );\n\n\t\t}\n\n\t}\n\n\tboneTransform( index, target ) {\n\n\t\tconst skeleton = this.skeleton;\n\t\tconst geometry = this.geometry;\n\n\t\t_skinIndex.fromBufferAttribute( geometry.attributes.skinIndex, index );\n\t\t_skinWeight.fromBufferAttribute( geometry.attributes.skinWeight, index );\n\n\t\t_basePosition.copy( target ).applyMatrix4( this.bindMatrix );\n\n\t\ttarget.set( 0, 0, 0 );\n\n\t\tfor ( let i = 0; i < 4; i ++ ) {\n\n\t\t\tconst weight = _skinWeight.getComponent( i );\n\n\t\t\tif ( weight !== 0 ) {\n\n\t\t\t\tconst boneIndex = _skinIndex.getComponent( i );\n\n\t\t\t\t_matrix.multiplyMatrices( skeleton.bones[ boneIndex ].matrixWorld, skeleton.boneInverses[ boneIndex ] );\n\n\t\t\t\ttarget.addScaledVector( _vector.copy( _basePosition ).applyMatrix4( _matrix ), weight );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn target.applyMatrix4( this.bindMatrixInverse );\n\n\t}\n\n}\n\nSkinnedMesh.prototype.isSkinnedMesh = true;\n\nexport { SkinnedMesh };\n","import { Sphere } from '../math/Sphere.js';\nimport { Ray } from '../math/Ray.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Object3D } from '../core/Object3D.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { LineBasicMaterial } from '../materials/LineBasicMaterial.js';\nimport { BufferGeometry } from '../core/BufferGeometry.js';\nimport { Float32BufferAttribute } from '../core/BufferAttribute.js';\n\nconst _start = /*@__PURE__*/ new Vector3();\nconst _end = /*@__PURE__*/ new Vector3();\nconst _inverseMatrix = /*@__PURE__*/ new Matrix4();\nconst _ray = /*@__PURE__*/ new Ray();\nconst _sphere = /*@__PURE__*/ new Sphere();\n\nclass Line extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new LineBasicMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Line';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.material = source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\tcomputeLineDistances() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\t// we assume non-indexed geometry\n\n\t\t\tif ( geometry.index === null ) {\n\n\t\t\t\tconst positionAttribute = geometry.attributes.position;\n\t\t\t\tconst lineDistances = [ 0 ];\n\n\t\t\t\tfor ( let i = 1, l = positionAttribute.count; i < l; i ++ ) {\n\n\t\t\t\t\t_start.fromBufferAttribute( positionAttribute, i - 1 );\n\t\t\t\t\t_end.fromBufferAttribute( positionAttribute, i );\n\n\t\t\t\t\tlineDistances[ i ] = lineDistances[ i - 1 ];\n\t\t\t\t\tlineDistances[ i ] += _start.distanceTo( _end );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\n\n\t\t\t}\n\n\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\tconsole.error( 'THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst threshold = raycaster.params.Line.threshold;\n\t\tconst drawRange = geometry.drawRange;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere.copy( geometry.boundingSphere );\n\t\t_sphere.applyMatrix4( matrixWorld );\n\t\t_sphere.radius += threshold;\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix.copy( matrixWorld ).invert();\n\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\n\n\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\tconst localThresholdSq = localThreshold * localThreshold;\n\n\t\tconst vStart = new Vector3();\n\t\tconst vEnd = new Vector3();\n\t\tconst interSegment = new Vector3();\n\t\tconst interRay = new Vector3();\n\t\tconst step = this.isLineSegments ? 2 : 1;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst index = geometry.index;\n\t\t\tconst attributes = geometry.attributes;\n\t\t\tconst positionAttribute = attributes.position;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, l = end - 1; i < l; i += step ) {\n\n\t\t\t\t\tconst a = index.getX( i );\n\t\t\t\t\tconst b = index.getX( i + 1 );\n\n\t\t\t\t\tvStart.fromBufferAttribute( positionAttribute, a );\n\t\t\t\t\tvEnd.fromBufferAttribute( positionAttribute, b );\n\n\t\t\t\t\tconst distSq = _ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\n\n\t\t\t\t\tif ( distSq > localThresholdSq ) continue;\n\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\t\tconst distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\tface: null,\n\t\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\t\tobject: this\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, l = end - 1; i < l; i += step ) {\n\n\t\t\t\t\tvStart.fromBufferAttribute( positionAttribute, i );\n\t\t\t\t\tvEnd.fromBufferAttribute( positionAttribute, i + 1 );\n\n\t\t\t\t\tconst distSq = _ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\n\n\t\t\t\t\tif ( distSq > localThresholdSq ) continue;\n\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\t\tconst distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\tface: null,\n\t\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\t\tobject: this\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\tconsole.error( 'THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst morphAttributes = geometry.morphAttributes;\n\t\t\tconst keys = Object.keys( morphAttributes );\n\n\t\t\tif ( keys.length > 0 ) {\n\n\t\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst morphTargets = geometry.morphTargets;\n\n\t\t\tif ( morphTargets !== undefined && morphTargets.length > 0 ) {\n\n\t\t\t\tconsole.error( 'THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nLine.prototype.isLine = true;\n\n\nexport { Line };\n","import { Line } from './Line.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Float32BufferAttribute } from '../core/BufferAttribute.js';\n\nconst _start = /*@__PURE__*/ new Vector3();\nconst _end = /*@__PURE__*/ new Vector3();\n\nclass LineSegments extends Line {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'LineSegments';\n\n\t}\n\n\tcomputeLineDistances() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\t// we assume non-indexed geometry\n\n\t\t\tif ( geometry.index === null ) {\n\n\t\t\t\tconst positionAttribute = geometry.attributes.position;\n\t\t\t\tconst lineDistances = [];\n\n\t\t\t\tfor ( let i = 0, l = positionAttribute.count; i < l; i += 2 ) {\n\n\t\t\t\t\t_start.fromBufferAttribute( positionAttribute, i );\n\t\t\t\t\t_end.fromBufferAttribute( positionAttribute, i + 1 );\n\n\t\t\t\t\tlineDistances[ i ] = ( i === 0 ) ? 0 : lineDistances[ i - 1 ];\n\t\t\t\t\tlineDistances[ i + 1 ] = lineDistances[ i ] + _start.distanceTo( _end );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\n\n\t\t\t}\n\n\t\t} else if ( geometry.isGeometry ) {\n\n\t\t\tconsole.error( 'THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nLineSegments.prototype.isLineSegments = true;\n\nexport { LineSegments };\n","import { Line } from './Line.js';\n\nclass LineLoop extends Line {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'LineLoop';\n\n\t}\n\n}\n\nLineLoop.prototype.isLineLoop = true;\n\nexport { LineLoop };\n","import { Sphere } from '../math/Sphere.js';\nimport { Ray } from '../math/Ray.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { Object3D } from '../core/Object3D.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { PointsMaterial } from '../materials/PointsMaterial.js';\nimport { BufferGeometry } from '../core/BufferGeometry.js';\n\nconst _inverseMatrix = /*@__PURE__*/ new Matrix4();\nconst _ray = /*@__PURE__*/ new Ray();\nconst _sphere = /*@__PURE__*/ new Sphere();\nconst _position = /*@__PURE__*/ new Vector3();\n\nclass Points extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new PointsMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Points';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.material = source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst threshold = raycaster.params.Points.threshold;\n\t\tconst drawRange = geometry.drawRange;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere.copy( geometry.boundingSphere );\n\t\t_sphere.applyMatrix4( matrixWorld );\n\t\t_sphere.radius += threshold;\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix.copy( matrixWorld ).invert();\n\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\n\n\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\tconst localThresholdSq = localThreshold * localThreshold;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst index = geometry.index;\n\t\t\tconst attributes = geometry.attributes;\n\t\t\tconst positionAttribute = attributes.position;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, il = end; i < il; i ++ ) {\n\n\t\t\t\t\tconst a = index.getX( i );\n\n\t\t\t\t\t_position.fromBufferAttribute( positionAttribute, a );\n\n\t\t\t\t\ttestPoint( _position, a, localThresholdSq, matrixWorld, raycaster, intersects, this );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, l = end; i < l; i ++ ) {\n\n\t\t\t\t\t_position.fromBufferAttribute( positionAttribute, i );\n\n\t\t\t\t\ttestPoint( _position, i, localThresholdSq, matrixWorld, raycaster, intersects, this );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tconst morphAttributes = geometry.morphAttributes;\n\t\t\tconst keys = Object.keys( morphAttributes );\n\n\t\t\tif ( keys.length > 0 ) {\n\n\t\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst morphTargets = geometry.morphTargets;\n\n\t\t\tif ( morphTargets !== undefined && morphTargets.length > 0 ) {\n\n\t\t\t\tconsole.error( 'THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nPoints.prototype.isPoints = true;\n\nfunction testPoint( point, index, localThresholdSq, matrixWorld, raycaster, intersects, object ) {\n\n\tconst rayPointDistanceSq = _ray.distanceSqToPoint( point );\n\n\tif ( rayPointDistanceSq < localThresholdSq ) {\n\n\t\tconst intersectPoint = new Vector3();\n\n\t\t_ray.closestPointToPoint( point, intersectPoint );\n\t\tintersectPoint.applyMatrix4( matrixWorld );\n\n\t\tconst distance = raycaster.ray.origin.distanceTo( intersectPoint );\n\n\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\n\n\t\tintersects.push( {\n\n\t\t\tdistance: distance,\n\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\n\t\t\tpoint: intersectPoint,\n\t\t\tindex: index,\n\t\t\tface: null,\n\t\t\tobject: object\n\n\t\t} );\n\n\t}\n\n}\n\nexport { Points };\n","import { ZeroCurvatureEnding } from '../../constants.js';\nimport { Interpolant } from '../Interpolant.js';\nimport { WrapAroundEnding, ZeroSlopeEnding } from '../../constants.js';\n\n/**\n * Fast and simple cubic spline interpolant.\n *\n * It was derived from a Hermitian construction setting the first derivative\n * at each sample position to the linear slope between neighboring positions\n * over their parameter interval.\n */\n\nclass CubicInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t\tthis._weightPrev = - 0;\n\t\tthis._offsetPrev = - 0;\n\t\tthis._weightNext = - 0;\n\t\tthis._offsetNext = - 0;\n\n\t\tthis.DefaultSettings_ = {\n\n\t\t\tendingStart: ZeroCurvatureEnding,\n\t\t\tendingEnd: ZeroCurvatureEnding\n\n\t\t};\n\n\t}\n\n\tintervalChanged_( i1, t0, t1 ) {\n\n\t\tconst pp = this.parameterPositions;\n\t\tlet iPrev = i1 - 2,\n\t\t\tiNext = i1 + 1,\n\n\t\t\ttPrev = pp[ iPrev ],\n\t\t\ttNext = pp[ iNext ];\n\n\t\tif ( tPrev === undefined ) {\n\n\t\t\tswitch ( this.getSettings_().endingStart ) {\n\n\t\t\t\tcase ZeroSlopeEnding:\n\n\t\t\t\t\t// f'(t0) = 0\n\t\t\t\t\tiPrev = i1;\n\t\t\t\t\ttPrev = 2 * t0 - t1;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase WrapAroundEnding:\n\n\t\t\t\t\t// use the other end of the curve\n\t\t\t\t\tiPrev = pp.length - 2;\n\t\t\t\t\ttPrev = t0 + pp[ iPrev ] - pp[ iPrev + 1 ];\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault: // ZeroCurvatureEnding\n\n\t\t\t\t\t// f''(t0) = 0 a.k.a. Natural Spline\n\t\t\t\t\tiPrev = i1;\n\t\t\t\t\ttPrev = t1;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( tNext === undefined ) {\n\n\t\t\tswitch ( this.getSettings_().endingEnd ) {\n\n\t\t\t\tcase ZeroSlopeEnding:\n\n\t\t\t\t\t// f'(tN) = 0\n\t\t\t\t\tiNext = i1;\n\t\t\t\t\ttNext = 2 * t1 - t0;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase WrapAroundEnding:\n\n\t\t\t\t\t// use the other end of the curve\n\t\t\t\t\tiNext = 1;\n\t\t\t\t\ttNext = t1 + pp[ 1 ] - pp[ 0 ];\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault: // ZeroCurvatureEnding\n\n\t\t\t\t\t// f''(tN) = 0, a.k.a. Natural Spline\n\t\t\t\t\tiNext = i1 - 1;\n\t\t\t\t\ttNext = t0;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst halfDt = ( t1 - t0 ) * 0.5,\n\t\t\tstride = this.valueSize;\n\n\t\tthis._weightPrev = halfDt / ( t0 - tPrev );\n\t\tthis._weightNext = halfDt / ( tNext - t1 );\n\t\tthis._offsetPrev = iPrev * stride;\n\t\tthis._offsetNext = iNext * stride;\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\to1 = i1 * stride,\t\to0 = o1 - stride,\n\t\t\toP = this._offsetPrev, \toN = this._offsetNext,\n\t\t\twP = this._weightPrev,\twN = this._weightNext,\n\n\t\t\tp = ( t - t0 ) / ( t1 - t0 ),\n\t\t\tpp = p * p,\n\t\t\tppp = pp * p;\n\n\t\t// evaluate polynomials\n\n\t\tconst sP = - wP * ppp + 2 * wP * pp - wP * p;\n\t\tconst s0 = ( 1 + wP ) * ppp + ( - 1.5 - 2 * wP ) * pp + ( - 0.5 + wP ) * p + 1;\n\t\tconst s1 = ( - 1 - wN ) * ppp + ( 1.5 + wN ) * pp + 0.5 * p;\n\t\tconst sN = wN * ppp - wN * pp;\n\n\t\t// combine data linearly\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] =\n\t\t\t\t\tsP * values[ oP + i ] +\n\t\t\t\t\ts0 * values[ o0 + i ] +\n\t\t\t\t\ts1 * values[ o1 + i ] +\n\t\t\t\t\tsN * values[ oN + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nexport { CubicInterpolant };\n","import { Interpolant } from '../Interpolant.js';\n\nclass LinearInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\toffset1 = i1 * stride,\n\t\t\toffset0 = offset1 - stride,\n\n\t\t\tweight1 = ( t - t0 ) / ( t1 - t0 ),\n\t\t\tweight0 = 1 - weight1;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] =\n\t\t\t\t\tvalues[ offset0 + i ] * weight0 +\n\t\t\t\t\tvalues[ offset1 + i ] * weight1;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\n\nexport { LinearInterpolant };\n","import { Interpolant } from '../Interpolant.js';\n\n/**\n *\n * Interpolant that evaluates to the sample value at the position preceeding\n * the parameter.\n */\n\nclass DiscreteInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1 /*, t0, t, t1 */ ) {\n\n\t\treturn this.copySampleValue_( i1 - 1 );\n\n\t}\n\n}\n\n\nexport { DiscreteInterpolant };\n","import { Quaternion } from '../math/Quaternion.js';\nimport { AdditiveAnimationBlendMode } from '../constants.js';\n\nconst AnimationUtils = {\n\n\t// same as Array.prototype.slice, but also works on typed arrays\n\tarraySlice: function ( array, from, to ) {\n\n\t\tif ( AnimationUtils.isTypedArray( array ) ) {\n\n\t\t\t// in ios9 array.subarray(from, undefined) will return empty array\n\t\t\t// but array.subarray(from) or array.subarray(from, len) is correct\n\t\t\treturn new array.constructor( array.subarray( from, to !== undefined ? to : array.length ) );\n\n\t\t}\n\n\t\treturn array.slice( from, to );\n\n\t},\n\n\t// converts an array to a specific type\n\tconvertArray: function ( array, type, forceClone ) {\n\n\t\tif ( ! array || // let 'undefined' and 'null' pass\n\t\t\t! forceClone && array.constructor === type ) return array;\n\n\t\tif ( typeof type.BYTES_PER_ELEMENT === 'number' ) {\n\n\t\t\treturn new type( array ); // create typed array\n\n\t\t}\n\n\t\treturn Array.prototype.slice.call( array ); // create Array\n\n\t},\n\n\tisTypedArray: function ( object ) {\n\n\t\treturn ArrayBuffer.isView( object ) &&\n\t\t\t! ( object instanceof DataView );\n\n\t},\n\n\t// returns an array by which times and values can be sorted\n\tgetKeyframeOrder: function ( times ) {\n\n\t\tfunction compareTime( i, j ) {\n\n\t\t\treturn times[ i ] - times[ j ];\n\n\t\t}\n\n\t\tconst n = times.length;\n\t\tconst result = new Array( n );\n\t\tfor ( let i = 0; i !== n; ++ i ) result[ i ] = i;\n\n\t\tresult.sort( compareTime );\n\n\t\treturn result;\n\n\t},\n\n\t// uses the array previously returned by 'getKeyframeOrder' to sort data\n\tsortedArray: function ( values, stride, order ) {\n\n\t\tconst nValues = values.length;\n\t\tconst result = new values.constructor( nValues );\n\n\t\tfor ( let i = 0, dstOffset = 0; dstOffset !== nValues; ++ i ) {\n\n\t\t\tconst srcOffset = order[ i ] * stride;\n\n\t\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\t\tresult[ dstOffset ++ ] = values[ srcOffset + j ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn result;\n\n\t},\n\n\t// function for parsing AOS keyframe formats\n\tflattenJSON: function ( jsonKeys, times, values, valuePropertyName ) {\n\n\t\tlet i = 1, key = jsonKeys[ 0 ];\n\n\t\twhile ( key !== undefined && key[ valuePropertyName ] === undefined ) {\n\n\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t}\n\n\t\tif ( key === undefined ) return; // no data\n\n\t\tlet value = key[ valuePropertyName ];\n\t\tif ( value === undefined ) return; // no data\n\n\t\tif ( Array.isArray( value ) ) {\n\n\t\t\tdo {\n\n\t\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\ttimes.push( key.time );\n\t\t\t\t\tvalues.push.apply( values, value ); // push all elements\n\n\t\t\t\t}\n\n\t\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t\t} while ( key !== undefined );\n\n\t\t} else if ( value.toArray !== undefined ) {\n\n\t\t\t// ...assume THREE.Math-ish\n\n\t\t\tdo {\n\n\t\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\ttimes.push( key.time );\n\t\t\t\t\tvalue.toArray( values, values.length );\n\n\t\t\t\t}\n\n\t\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t\t} while ( key !== undefined );\n\n\t\t} else {\n\n\t\t\t// otherwise push as-is\n\n\t\t\tdo {\n\n\t\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\ttimes.push( key.time );\n\t\t\t\t\tvalues.push( value );\n\n\t\t\t\t}\n\n\t\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t\t} while ( key !== undefined );\n\n\t\t}\n\n\t},\n\n\tsubclip: function ( sourceClip, name, startFrame, endFrame, fps = 30 ) {\n\n\t\tconst clip = sourceClip.clone();\n\n\t\tclip.name = name;\n\n\t\tconst tracks = [];\n\n\t\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\t\tconst track = clip.tracks[ i ];\n\t\t\tconst valueSize = track.getValueSize();\n\n\t\t\tconst times = [];\n\t\t\tconst values = [];\n\n\t\t\tfor ( let j = 0; j < track.times.length; ++ j ) {\n\n\t\t\t\tconst frame = track.times[ j ] * fps;\n\n\t\t\t\tif ( frame < startFrame || frame >= endFrame ) continue;\n\n\t\t\t\ttimes.push( track.times[ j ] );\n\n\t\t\t\tfor ( let k = 0; k < valueSize; ++ k ) {\n\n\t\t\t\t\tvalues.push( track.values[ j * valueSize + k ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( times.length === 0 ) continue;\n\n\t\t\ttrack.times = AnimationUtils.convertArray( times, track.times.constructor );\n\t\t\ttrack.values = AnimationUtils.convertArray( values, track.values.constructor );\n\n\t\t\ttracks.push( track );\n\n\t\t}\n\n\t\tclip.tracks = tracks;\n\n\t\t// find minimum .times value across all tracks in the trimmed clip\n\n\t\tlet minStartTime = Infinity;\n\n\t\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\t\tif ( minStartTime > clip.tracks[ i ].times[ 0 ] ) {\n\n\t\t\t\tminStartTime = clip.tracks[ i ].times[ 0 ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// shift all tracks such that clip begins at t=0\n\n\t\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\t\tclip.tracks[ i ].shift( - 1 * minStartTime );\n\n\t\t}\n\n\t\tclip.resetDuration();\n\n\t\treturn clip;\n\n\t},\n\n\tmakeClipAdditive: function ( targetClip, referenceFrame = 0, referenceClip = targetClip, fps = 30 ) {\n\n\t\tif ( fps <= 0 ) fps = 30;\n\n\t\tconst numTracks = referenceClip.tracks.length;\n\t\tconst referenceTime = referenceFrame / fps;\n\n\t\t// Make each track's values relative to the values at the reference frame\n\t\tfor ( let i = 0; i < numTracks; ++ i ) {\n\n\t\t\tconst referenceTrack = referenceClip.tracks[ i ];\n\t\t\tconst referenceTrackType = referenceTrack.ValueTypeName;\n\n\t\t\t// Skip this track if it's non-numeric\n\t\t\tif ( referenceTrackType === 'bool' || referenceTrackType === 'string' ) continue;\n\n\t\t\t// Find the track in the target clip whose name and type matches the reference track\n\t\t\tconst targetTrack = targetClip.tracks.find( function ( track ) {\n\n\t\t\t\treturn track.name === referenceTrack.name\n\t\t\t\t\t&& track.ValueTypeName === referenceTrackType;\n\n\t\t\t} );\n\n\t\t\tif ( targetTrack === undefined ) continue;\n\n\t\t\tlet referenceOffset = 0;\n\t\t\tconst referenceValueSize = referenceTrack.getValueSize();\n\n\t\t\tif ( referenceTrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline ) {\n\n\t\t\t\treferenceOffset = referenceValueSize / 3;\n\n\t\t\t}\n\n\t\t\tlet targetOffset = 0;\n\t\t\tconst targetValueSize = targetTrack.getValueSize();\n\n\t\t\tif ( targetTrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline ) {\n\n\t\t\t\ttargetOffset = targetValueSize / 3;\n\n\t\t\t}\n\n\t\t\tconst lastIndex = referenceTrack.times.length - 1;\n\t\t\tlet referenceValue;\n\n\t\t\t// Find the value to subtract out of the track\n\t\t\tif ( referenceTime <= referenceTrack.times[ 0 ] ) {\n\n\t\t\t\t// Reference frame is earlier than the first keyframe, so just use the first keyframe\n\t\t\t\tconst startIndex = referenceOffset;\n\t\t\t\tconst endIndex = referenceValueSize - referenceOffset;\n\t\t\t\treferenceValue = AnimationUtils.arraySlice( referenceTrack.values, startIndex, endIndex );\n\n\t\t\t} else if ( referenceTime >= referenceTrack.times[ lastIndex ] ) {\n\n\t\t\t\t// Reference frame is after the last keyframe, so just use the last keyframe\n\t\t\t\tconst startIndex = lastIndex * referenceValueSize + referenceOffset;\n\t\t\t\tconst endIndex = startIndex + referenceValueSize - referenceOffset;\n\t\t\t\treferenceValue = AnimationUtils.arraySlice( referenceTrack.values, startIndex, endIndex );\n\n\t\t\t} else {\n\n\t\t\t\t// Interpolate to the reference value\n\t\t\t\tconst interpolant = referenceTrack.createInterpolant();\n\t\t\t\tconst startIndex = referenceOffset;\n\t\t\t\tconst endIndex = referenceValueSize - referenceOffset;\n\t\t\t\tinterpolant.evaluate( referenceTime );\n\t\t\t\treferenceValue = AnimationUtils.arraySlice( interpolant.resultBuffer, startIndex, endIndex );\n\n\t\t\t}\n\n\t\t\t// Conjugate the quaternion\n\t\t\tif ( referenceTrackType === 'quaternion' ) {\n\n\t\t\t\tconst referenceQuat = new Quaternion().fromArray( referenceValue ).normalize().conjugate();\n\t\t\t\treferenceQuat.toArray( referenceValue );\n\n\t\t\t}\n\n\t\t\t// Subtract the reference value from all of the track values\n\n\t\t\tconst numTimes = targetTrack.times.length;\n\t\t\tfor ( let j = 0; j < numTimes; ++ j ) {\n\n\t\t\t\tconst valueStart = j * targetValueSize + targetOffset;\n\n\t\t\t\tif ( referenceTrackType === 'quaternion' ) {\n\n\t\t\t\t\t// Multiply the conjugate for quaternion track types\n\t\t\t\t\tQuaternion.multiplyQuaternionsFlat(\n\t\t\t\t\t\ttargetTrack.values,\n\t\t\t\t\t\tvalueStart,\n\t\t\t\t\t\treferenceValue,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\ttargetTrack.values,\n\t\t\t\t\t\tvalueStart\n\t\t\t\t\t);\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst valueEnd = targetValueSize - targetOffset * 2;\n\n\t\t\t\t\t// Subtract each value for all other numeric track types\n\t\t\t\t\tfor ( let k = 0; k < valueEnd; ++ k ) {\n\n\t\t\t\t\t\ttargetTrack.values[ valueStart + k ] -= referenceValue[ k ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\ttargetClip.blendMode = AdditiveAnimationBlendMode;\n\n\t\treturn targetClip;\n\n\t}\n\n};\n\nexport { AnimationUtils };\n","import {\n\tInterpolateLinear,\n\tInterpolateSmooth,\n\tInterpolateDiscrete\n} from '../constants.js';\nimport { CubicInterpolant } from '../math/interpolants/CubicInterpolant.js';\nimport { LinearInterpolant } from '../math/interpolants/LinearInterpolant.js';\nimport { DiscreteInterpolant } from '../math/interpolants/DiscreteInterpolant.js';\nimport { AnimationUtils } from './AnimationUtils.js';\n\nclass KeyframeTrack {\n\n\tconstructor( name, times, values, interpolation ) {\n\n\t\tif ( name === undefined ) throw new Error( 'THREE.KeyframeTrack: track name is undefined' );\n\t\tif ( times === undefined || times.length === 0 ) throw new Error( 'THREE.KeyframeTrack: no keyframes in track named ' + name );\n\n\t\tthis.name = name;\n\n\t\tthis.times = AnimationUtils.convertArray( times, this.TimeBufferType );\n\t\tthis.values = AnimationUtils.convertArray( values, this.ValueBufferType );\n\n\t\tthis.setInterpolation( interpolation || this.DefaultInterpolation );\n\n\t}\n\n\t// Serialization (in static context, because of constructor invocation\n\t// and automatic invocation of .toJSON):\n\n\tstatic toJSON( track ) {\n\n\t\tconst trackType = track.constructor;\n\n\t\tlet json;\n\n\t\t// derived classes can define a static toJSON method\n\t\tif ( trackType.toJSON !== this.toJSON ) {\n\n\t\t\tjson = trackType.toJSON( track );\n\n\t\t} else {\n\n\t\t\t// by default, we assume the data can be serialized as-is\n\t\t\tjson = {\n\n\t\t\t\t'name': track.name,\n\t\t\t\t'times': AnimationUtils.convertArray( track.times, Array ),\n\t\t\t\t'values': AnimationUtils.convertArray( track.values, Array )\n\n\t\t\t};\n\n\t\t\tconst interpolation = track.getInterpolation();\n\n\t\t\tif ( interpolation !== track.DefaultInterpolation ) {\n\n\t\t\t\tjson.interpolation = interpolation;\n\n\t\t\t}\n\n\t\t}\n\n\t\tjson.type = track.ValueTypeName; // mandatory\n\n\t\treturn json;\n\n\t}\n\n\tInterpolantFactoryMethodDiscrete( result ) {\n\n\t\treturn new DiscreteInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tInterpolantFactoryMethodLinear( result ) {\n\n\t\treturn new LinearInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tInterpolantFactoryMethodSmooth( result ) {\n\n\t\treturn new CubicInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tsetInterpolation( interpolation ) {\n\n\t\tlet factoryMethod;\n\n\t\tswitch ( interpolation ) {\n\n\t\t\tcase InterpolateDiscrete:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodDiscrete;\n\n\t\t\t\tbreak;\n\n\t\t\tcase InterpolateLinear:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodLinear;\n\n\t\t\t\tbreak;\n\n\t\t\tcase InterpolateSmooth:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodSmooth;\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( factoryMethod === undefined ) {\n\n\t\t\tconst message = 'unsupported interpolation for ' +\n\t\t\t\tthis.ValueTypeName + ' keyframe track named ' + this.name;\n\n\t\t\tif ( this.createInterpolant === undefined ) {\n\n\t\t\t\t// fall back to default, unless the default itself is messed up\n\t\t\t\tif ( interpolation !== this.DefaultInterpolation ) {\n\n\t\t\t\t\tthis.setInterpolation( this.DefaultInterpolation );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( message ); // fatal, in this case\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconsole.warn( 'THREE.KeyframeTrack:', message );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tthis.createInterpolant = factoryMethod;\n\n\t\treturn this;\n\n\t}\n\n\tgetInterpolation() {\n\n\t\tswitch ( this.createInterpolant ) {\n\n\t\t\tcase this.InterpolantFactoryMethodDiscrete:\n\n\t\t\t\treturn InterpolateDiscrete;\n\n\t\t\tcase this.InterpolantFactoryMethodLinear:\n\n\t\t\t\treturn InterpolateLinear;\n\n\t\t\tcase this.InterpolantFactoryMethodSmooth:\n\n\t\t\t\treturn InterpolateSmooth;\n\n\t\t}\n\n\t}\n\n\tgetValueSize() {\n\n\t\treturn this.values.length / this.times.length;\n\n\t}\n\n\t// move all keyframes either forwards or backwards in time\n\tshift( timeOffset ) {\n\n\t\tif ( timeOffset !== 0.0 ) {\n\n\t\t\tconst times = this.times;\n\n\t\t\tfor ( let i = 0, n = times.length; i !== n; ++ i ) {\n\n\t\t\t\ttimes[ i ] += timeOffset;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// scale all keyframe times by a factor (useful for frame <-> seconds conversions)\n\tscale( timeScale ) {\n\n\t\tif ( timeScale !== 1.0 ) {\n\n\t\t\tconst times = this.times;\n\n\t\t\tfor ( let i = 0, n = times.length; i !== n; ++ i ) {\n\n\t\t\t\ttimes[ i ] *= timeScale;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// removes keyframes before and after animation without changing any values within the range [startTime, endTime].\n\t// IMPORTANT: We do not shift around keys to the start of the track time, because for interpolated keys this will change their values\n\ttrim( startTime, endTime ) {\n\n\t\tconst times = this.times,\n\t\t\tnKeys = times.length;\n\n\t\tlet from = 0,\n\t\t\tto = nKeys - 1;\n\n\t\twhile ( from !== nKeys && times[ from ] < startTime ) {\n\n\t\t\t++ from;\n\n\t\t}\n\n\t\twhile ( to !== - 1 && times[ to ] > endTime ) {\n\n\t\t\t-- to;\n\n\t\t}\n\n\t\t++ to; // inclusive -> exclusive bound\n\n\t\tif ( from !== 0 || to !== nKeys ) {\n\n\t\t\t// empty tracks are forbidden, so keep at least one keyframe\n\t\t\tif ( from >= to ) {\n\n\t\t\t\tto = Math.max( to, 1 );\n\t\t\t\tfrom = to - 1;\n\n\t\t\t}\n\n\t\t\tconst stride = this.getValueSize();\n\t\t\tthis.times = AnimationUtils.arraySlice( times, from, to );\n\t\t\tthis.values = AnimationUtils.arraySlice( this.values, from * stride, to * stride );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// ensure we do not get a GarbageInGarbageOut situation, make sure tracks are at least minimally viable\n\tvalidate() {\n\n\t\tlet valid = true;\n\n\t\tconst valueSize = this.getValueSize();\n\t\tif ( valueSize - Math.floor( valueSize ) !== 0 ) {\n\n\t\t\tconsole.error( 'THREE.KeyframeTrack: Invalid value size in track.', this );\n\t\t\tvalid = false;\n\n\t\t}\n\n\t\tconst times = this.times,\n\t\t\tvalues = this.values,\n\n\t\t\tnKeys = times.length;\n\n\t\tif ( nKeys === 0 ) {\n\n\t\t\tconsole.error( 'THREE.KeyframeTrack: Track is empty.', this );\n\t\t\tvalid = false;\n\n\t\t}\n\n\t\tlet prevTime = null;\n\n\t\tfor ( let i = 0; i !== nKeys; i ++ ) {\n\n\t\t\tconst currTime = times[ i ];\n\n\t\t\tif ( typeof currTime === 'number' && isNaN( currTime ) ) {\n\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Time is not a valid number.', this, i, currTime );\n\t\t\t\tvalid = false;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( prevTime !== null && prevTime > currTime ) {\n\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Out of order keys.', this, i, currTime, prevTime );\n\t\t\t\tvalid = false;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tprevTime = currTime;\n\n\t\t}\n\n\t\tif ( values !== undefined ) {\n\n\t\t\tif ( AnimationUtils.isTypedArray( values ) ) {\n\n\t\t\t\tfor ( let i = 0, n = values.length; i !== n; ++ i ) {\n\n\t\t\t\t\tconst value = values[ i ];\n\n\t\t\t\t\tif ( isNaN( value ) ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Value is not a valid number.', this, i, value );\n\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn valid;\n\n\t}\n\n\t// removes equivalent sequential keys as common in morph target sequences\n\t// (0,0,0,0,1,1,1,0,0,0,0,0,0,0) --> (0,0,1,1,0,0)\n\toptimize() {\n\n\t\t// times or values may be shared with other tracks, so overwriting is unsafe\n\t\tconst times = AnimationUtils.arraySlice( this.times ),\n\t\t\tvalues = AnimationUtils.arraySlice( this.values ),\n\t\t\tstride = this.getValueSize(),\n\n\t\t\tsmoothInterpolation = this.getInterpolation() === InterpolateSmooth,\n\n\t\t\tlastIndex = times.length - 1;\n\n\t\tlet writeIndex = 1;\n\n\t\tfor ( let i = 1; i < lastIndex; ++ i ) {\n\n\t\t\tlet keep = false;\n\n\t\t\tconst time = times[ i ];\n\t\t\tconst timeNext = times[ i + 1 ];\n\n\t\t\t// remove adjacent keyframes scheduled at the same time\n\n\t\t\tif ( time !== timeNext && ( i !== 1 || time !== times[ 0 ] ) ) {\n\n\t\t\t\tif ( ! smoothInterpolation ) {\n\n\t\t\t\t\t// remove unnecessary keyframes same as their neighbors\n\n\t\t\t\t\tconst offset = i * stride,\n\t\t\t\t\t\toffsetP = offset - stride,\n\t\t\t\t\t\toffsetN = offset + stride;\n\n\t\t\t\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\t\t\t\tconst value = values[ offset + j ];\n\n\t\t\t\t\t\tif ( value !== values[ offsetP + j ] ||\n\t\t\t\t\t\t\tvalue !== values[ offsetN + j ] ) {\n\n\t\t\t\t\t\t\tkeep = true;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tkeep = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// in-place compaction\n\n\t\t\tif ( keep ) {\n\n\t\t\t\tif ( i !== writeIndex ) {\n\n\t\t\t\t\ttimes[ writeIndex ] = times[ i ];\n\n\t\t\t\t\tconst readOffset = i * stride,\n\t\t\t\t\t\twriteOffset = writeIndex * stride;\n\n\t\t\t\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t++ writeIndex;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// flush last keyframe (compaction looks ahead)\n\n\t\tif ( lastIndex > 0 ) {\n\n\t\t\ttimes[ writeIndex ] = times[ lastIndex ];\n\n\t\t\tfor ( let readOffset = lastIndex * stride, writeOffset = writeIndex * stride, j = 0; j !== stride; ++ j ) {\n\n\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\n\n\t\t\t}\n\n\t\t\t++ writeIndex;\n\n\t\t}\n\n\t\tif ( writeIndex !== times.length ) {\n\n\t\t\tthis.times = AnimationUtils.arraySlice( times, 0, writeIndex );\n\t\t\tthis.values = AnimationUtils.arraySlice( values, 0, writeIndex * stride );\n\n\t\t} else {\n\n\t\t\tthis.times = times;\n\t\t\tthis.values = values;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\tconst times = AnimationUtils.arraySlice( this.times, 0 );\n\t\tconst values = AnimationUtils.arraySlice( this.values, 0 );\n\n\t\tconst TypedKeyframeTrack = this.constructor;\n\t\tconst track = new TypedKeyframeTrack( this.name, times, values );\n\n\t\t// Interpolant argument to constructor is not saved, so copy the factory method directly.\n\t\ttrack.createInterpolant = this.createInterpolant;\n\n\t\treturn track;\n\n\t}\n\n}\n\nKeyframeTrack.prototype.TimeBufferType = Float32Array;\nKeyframeTrack.prototype.ValueBufferType = Float32Array;\nKeyframeTrack.prototype.DefaultInterpolation = InterpolateLinear;\n\nexport { KeyframeTrack };\n","import { KeyframeTrack } from '../KeyframeTrack.js';\n\n/**\n * A Track of numeric keyframe values.\n */\nclass NumberKeyframeTrack extends KeyframeTrack {}\n\nNumberKeyframeTrack.prototype.ValueTypeName = 'number';\n// ValueBufferType is inherited\n// DefaultInterpolation is inherited\n\nexport { NumberKeyframeTrack };\n","import { Interpolant } from '../Interpolant.js';\nimport { Quaternion } from '../Quaternion.js';\n\n/**\n * Spherical linear unit quaternion interpolant.\n */\n\nclass QuaternionLinearInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\talpha = ( t - t0 ) / ( t1 - t0 );\n\n\t\tlet offset = i1 * stride;\n\n\t\tfor ( let end = offset + stride; offset !== end; offset += 4 ) {\n\n\t\t\tQuaternion.slerpFlat( result, 0, values, offset - stride, values, offset, alpha );\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\n\nexport { QuaternionLinearInterpolant };\n","import { InterpolateLinear } from '../../constants.js';\nimport { KeyframeTrack } from '../KeyframeTrack.js';\nimport { QuaternionLinearInterpolant } from '../../math/interpolants/QuaternionLinearInterpolant.js';\n\n/**\n * A Track of quaternion keyframe values.\n */\nclass QuaternionKeyframeTrack extends KeyframeTrack {\n\n\tInterpolantFactoryMethodLinear( result ) {\n\n\t\treturn new QuaternionLinearInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n}\n\nQuaternionKeyframeTrack.prototype.ValueTypeName = 'quaternion';\n// ValueBufferType is inherited\nQuaternionKeyframeTrack.prototype.DefaultInterpolation = InterpolateLinear;\nQuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\nexport { QuaternionKeyframeTrack };\n","import { KeyframeTrack } from '../KeyframeTrack.js';\n\n/**\n * A Track of vectored keyframe values.\n */\nclass VectorKeyframeTrack extends KeyframeTrack {}\n\nVectorKeyframeTrack.prototype.ValueTypeName = 'vector';\n// ValueBufferType is inherited\n// DefaultInterpolation is inherited\n\nexport { VectorKeyframeTrack };\n","import { InterpolateDiscrete } from '../../constants.js';\nimport { KeyframeTrack } from '../KeyframeTrack.js';\n\n/**\n * A Track of Boolean keyframe values.\n */\nclass BooleanKeyframeTrack extends KeyframeTrack {}\n\nBooleanKeyframeTrack.prototype.ValueTypeName = 'bool';\nBooleanKeyframeTrack.prototype.ValueBufferType = Array;\nBooleanKeyframeTrack.prototype.DefaultInterpolation = InterpolateDiscrete;\nBooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear = undefined;\nBooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\n// Note: Actually this track could have a optimized / compressed\n// representation of a single value and a custom interpolant that\n// computes \"firstValue ^ isOdd( index )\".\n\nexport { BooleanKeyframeTrack };\n","import { KeyframeTrack } from '../KeyframeTrack.js';\n\n/**\n * A Track of keyframe values that represent color.\n */\nclass ColorKeyframeTrack extends KeyframeTrack {}\n\nColorKeyframeTrack.prototype.ValueTypeName = 'color';\n// ValueBufferType is inherited\n// DefaultInterpolation is inherited\n\n// Note: Very basic implementation and nothing special yet.\n// However, this is the place for color space parameterization.\n\nexport { ColorKeyframeTrack };\n","import { InterpolateDiscrete } from '../../constants.js';\nimport { KeyframeTrack } from '../KeyframeTrack.js';\n\n/**\n * A Track that interpolates Strings\n */\nclass StringKeyframeTrack extends KeyframeTrack {}\n\nStringKeyframeTrack.prototype.ValueTypeName = 'string';\nStringKeyframeTrack.prototype.ValueBufferType = Array;\nStringKeyframeTrack.prototype.DefaultInterpolation = InterpolateDiscrete;\nStringKeyframeTrack.prototype.InterpolantFactoryMethodLinear = undefined;\nStringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\nexport { StringKeyframeTrack };\n","import { AnimationUtils } from './AnimationUtils.js';\nimport { KeyframeTrack } from './KeyframeTrack.js';\nimport { BooleanKeyframeTrack } from './tracks/BooleanKeyframeTrack.js';\nimport { ColorKeyframeTrack } from './tracks/ColorKeyframeTrack.js';\nimport { NumberKeyframeTrack } from './tracks/NumberKeyframeTrack.js';\nimport { QuaternionKeyframeTrack } from './tracks/QuaternionKeyframeTrack.js';\nimport { StringKeyframeTrack } from './tracks/StringKeyframeTrack.js';\nimport { VectorKeyframeTrack } from './tracks/VectorKeyframeTrack.js';\nimport * as MathUtils from '../math/MathUtils.js';\nimport { NormalAnimationBlendMode } from '../constants.js';\n\nclass AnimationClip {\n\n\tconstructor( name, duration = - 1, tracks, blendMode = NormalAnimationBlendMode ) {\n\n\t\tthis.name = name;\n\t\tthis.tracks = tracks;\n\t\tthis.duration = duration;\n\t\tthis.blendMode = blendMode;\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\t// this means it should figure out its duration by scanning the tracks\n\t\tif ( this.duration < 0 ) {\n\n\t\t\tthis.resetDuration();\n\n\t\t}\n\n\t}\n\n\n\tstatic parse( json ) {\n\n\t\tconst tracks = [],\n\t\t\tjsonTracks = json.tracks,\n\t\t\tframeTime = 1.0 / ( json.fps || 1.0 );\n\n\t\tfor ( let i = 0, n = jsonTracks.length; i !== n; ++ i ) {\n\n\t\t\ttracks.push( parseKeyframeTrack( jsonTracks[ i ] ).scale( frameTime ) );\n\n\t\t}\n\n\t\tconst clip = new this( json.name, json.duration, tracks, json.blendMode );\n\t\tclip.uuid = json.uuid;\n\n\t\treturn clip;\n\n\t}\n\n\tstatic toJSON( clip ) {\n\n\t\tconst tracks = [],\n\t\t\tclipTracks = clip.tracks;\n\n\t\tconst json = {\n\n\t\t\t'name': clip.name,\n\t\t\t'duration': clip.duration,\n\t\t\t'tracks': tracks,\n\t\t\t'uuid': clip.uuid,\n\t\t\t'blendMode': clip.blendMode\n\n\t\t};\n\n\t\tfor ( let i = 0, n = clipTracks.length; i !== n; ++ i ) {\n\n\t\t\ttracks.push( KeyframeTrack.toJSON( clipTracks[ i ] ) );\n\n\t\t}\n\n\t\treturn json;\n\n\t}\n\n\tstatic CreateFromMorphTargetSequence( name, morphTargetSequence, fps, noLoop ) {\n\n\t\tconst numMorphTargets = morphTargetSequence.length;\n\t\tconst tracks = [];\n\n\t\tfor ( let i = 0; i < numMorphTargets; i ++ ) {\n\n\t\t\tlet times = [];\n\t\t\tlet values = [];\n\n\t\t\ttimes.push(\n\t\t\t\t( i + numMorphTargets - 1 ) % numMorphTargets,\n\t\t\t\ti,\n\t\t\t\t( i + 1 ) % numMorphTargets );\n\n\t\t\tvalues.push( 0, 1, 0 );\n\n\t\t\tconst order = AnimationUtils.getKeyframeOrder( times );\n\t\t\ttimes = AnimationUtils.sortedArray( times, 1, order );\n\t\t\tvalues = AnimationUtils.sortedArray( values, 1, order );\n\n\t\t\t// if there is a key at the first frame, duplicate it as the\n\t\t\t// last frame as well for perfect loop.\n\t\t\tif ( ! noLoop && times[ 0 ] === 0 ) {\n\n\t\t\t\ttimes.push( numMorphTargets );\n\t\t\t\tvalues.push( values[ 0 ] );\n\n\t\t\t}\n\n\t\t\ttracks.push(\n\t\t\t\tnew NumberKeyframeTrack(\n\t\t\t\t\t'.morphTargetInfluences[' + morphTargetSequence[ i ].name + ']',\n\t\t\t\t\ttimes, values\n\t\t\t\t).scale( 1.0 / fps ) );\n\n\t\t}\n\n\t\treturn new this( name, - 1, tracks );\n\n\t}\n\n\tstatic findByName( objectOrClipArray, name ) {\n\n\t\tlet clipArray = objectOrClipArray;\n\n\t\tif ( ! Array.isArray( objectOrClipArray ) ) {\n\n\t\t\tconst o = objectOrClipArray;\n\t\t\tclipArray = o.geometry && o.geometry.animations || o.animations;\n\n\t\t}\n\n\t\tfor ( let i = 0; i < clipArray.length; i ++ ) {\n\n\t\t\tif ( clipArray[ i ].name === name ) {\n\n\t\t\t\treturn clipArray[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tstatic CreateClipsFromMorphTargetSequences( morphTargets, fps, noLoop ) {\n\n\t\tconst animationToMorphTargets = {};\n\n\t\t// tested with https://regex101.com/ on trick sequences\n\t\t// such flamingo_flyA_003, flamingo_run1_003, crdeath0059\n\t\tconst pattern = /^([\\w-]*?)([\\d]+)$/;\n\n\t\t// sort morph target names into animation groups based\n\t\t// patterns like Walk_001, Walk_002, Run_001, Run_002\n\t\tfor ( let i = 0, il = morphTargets.length; i < il; i ++ ) {\n\n\t\t\tconst morphTarget = morphTargets[ i ];\n\t\t\tconst parts = morphTarget.name.match( pattern );\n\n\t\t\tif ( parts && parts.length > 1 ) {\n\n\t\t\t\tconst name = parts[ 1 ];\n\n\t\t\t\tlet animationMorphTargets = animationToMorphTargets[ name ];\n\n\t\t\t\tif ( ! animationMorphTargets ) {\n\n\t\t\t\t\tanimationToMorphTargets[ name ] = animationMorphTargets = [];\n\n\t\t\t\t}\n\n\t\t\t\tanimationMorphTargets.push( morphTarget );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst clips = [];\n\n\t\tfor ( const name in animationToMorphTargets ) {\n\n\t\t\tclips.push( this.CreateFromMorphTargetSequence( name, animationToMorphTargets[ name ], fps, noLoop ) );\n\n\t\t}\n\n\t\treturn clips;\n\n\t}\n\n\t// parse the animation.hierarchy format\n\tstatic parseAnimation( animation, bones ) {\n\n\t\tif ( ! animation ) {\n\n\t\t\tconsole.error( 'THREE.AnimationClip: No animation in JSONLoader data.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst addNonemptyTrack = function ( trackType, trackName, animationKeys, propertyName, destTracks ) {\n\n\t\t\t// only return track if there are actually keys.\n\t\t\tif ( animationKeys.length !== 0 ) {\n\n\t\t\t\tconst times = [];\n\t\t\t\tconst values = [];\n\n\t\t\t\tAnimationUtils.flattenJSON( animationKeys, times, values, propertyName );\n\n\t\t\t\t// empty keys are filtered out, so check again\n\t\t\t\tif ( times.length !== 0 ) {\n\n\t\t\t\t\tdestTracks.push( new trackType( trackName, times, values ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tconst tracks = [];\n\n\t\tconst clipName = animation.name || 'default';\n\t\tconst fps = animation.fps || 30;\n\t\tconst blendMode = animation.blendMode;\n\n\t\t// automatic length determination in AnimationClip.\n\t\tlet duration = animation.length || - 1;\n\n\t\tconst hierarchyTracks = animation.hierarchy || [];\n\n\t\tfor ( let h = 0; h < hierarchyTracks.length; h ++ ) {\n\n\t\t\tconst animationKeys = hierarchyTracks[ h ].keys;\n\n\t\t\t// skip empty tracks\n\t\t\tif ( ! animationKeys || animationKeys.length === 0 ) continue;\n\n\t\t\t// process morph targets\n\t\t\tif ( animationKeys[ 0 ].morphTargets ) {\n\n\t\t\t\t// figure out all morph targets used in this track\n\t\t\t\tconst morphTargetNames = {};\n\n\t\t\t\tlet k;\n\n\t\t\t\tfor ( k = 0; k < animationKeys.length; k ++ ) {\n\n\t\t\t\t\tif ( animationKeys[ k ].morphTargets ) {\n\n\t\t\t\t\t\tfor ( let m = 0; m < animationKeys[ k ].morphTargets.length; m ++ ) {\n\n\t\t\t\t\t\t\tmorphTargetNames[ animationKeys[ k ].morphTargets[ m ] ] = - 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// create a track for each morph target with all zero\n\t\t\t\t// morphTargetInfluences except for the keys in which\n\t\t\t\t// the morphTarget is named.\n\t\t\t\tfor ( const morphTargetName in morphTargetNames ) {\n\n\t\t\t\t\tconst times = [];\n\t\t\t\t\tconst values = [];\n\n\t\t\t\t\tfor ( let m = 0; m !== animationKeys[ k ].morphTargets.length; ++ m ) {\n\n\t\t\t\t\t\tconst animationKey = animationKeys[ k ];\n\n\t\t\t\t\t\ttimes.push( animationKey.time );\n\t\t\t\t\t\tvalues.push( ( animationKey.morphTarget === morphTargetName ) ? 1 : 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttracks.push( new NumberKeyframeTrack( '.morphTargetInfluence[' + morphTargetName + ']', times, values ) );\n\n\t\t\t\t}\n\n\t\t\t\tduration = morphTargetNames.length * ( fps || 1.0 );\n\n\t\t\t} else {\n\n\t\t\t\t// ...assume skeletal animation\n\n\t\t\t\tconst boneName = '.bones[' + bones[ h ].name + ']';\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tVectorKeyframeTrack, boneName + '.position',\n\t\t\t\t\tanimationKeys, 'pos', tracks );\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tQuaternionKeyframeTrack, boneName + '.quaternion',\n\t\t\t\t\tanimationKeys, 'rot', tracks );\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tVectorKeyframeTrack, boneName + '.scale',\n\t\t\t\t\tanimationKeys, 'scl', tracks );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( tracks.length === 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst clip = new this( clipName, duration, tracks, blendMode );\n\n\t\treturn clip;\n\n\t}\n\n\tresetDuration() {\n\n\t\tconst tracks = this.tracks;\n\t\tlet duration = 0;\n\n\t\tfor ( let i = 0, n = tracks.length; i !== n; ++ i ) {\n\n\t\t\tconst track = this.tracks[ i ];\n\n\t\t\tduration = Math.max( duration, track.times[ track.times.length - 1 ] );\n\n\t\t}\n\n\t\tthis.duration = duration;\n\n\t\treturn this;\n\n\t}\n\n\ttrim() {\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tthis.tracks[ i ].trim( 0, this.duration );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tvalidate() {\n\n\t\tlet valid = true;\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tvalid = valid && this.tracks[ i ].validate();\n\n\t\t}\n\n\t\treturn valid;\n\n\t}\n\n\toptimize() {\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tthis.tracks[ i ].optimize();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\tconst tracks = [];\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\ttracks.push( this.tracks[ i ].clone() );\n\n\t\t}\n\n\t\treturn new this.constructor( this.name, this.duration, tracks, this.blendMode );\n\n\t}\n\n\ttoJSON() {\n\n\t\treturn this.constructor.toJSON( this );\n\n\t}\n\n}\n\nfunction getTrackTypeForValueTypeName( typeName ) {\n\n\tswitch ( typeName.toLowerCase() ) {\n\n\t\tcase 'scalar':\n\t\tcase 'double':\n\t\tcase 'float':\n\t\tcase 'number':\n\t\tcase 'integer':\n\n\t\t\treturn NumberKeyframeTrack;\n\n\t\tcase 'vector':\n\t\tcase 'vector2':\n\t\tcase 'vector3':\n\t\tcase 'vector4':\n\n\t\t\treturn VectorKeyframeTrack;\n\n\t\tcase 'color':\n\n\t\t\treturn ColorKeyframeTrack;\n\n\t\tcase 'quaternion':\n\n\t\t\treturn QuaternionKeyframeTrack;\n\n\t\tcase 'bool':\n\t\tcase 'boolean':\n\n\t\t\treturn BooleanKeyframeTrack;\n\n\t\tcase 'string':\n\n\t\t\treturn StringKeyframeTrack;\n\n\t}\n\n\tthrow new Error( 'THREE.KeyframeTrack: Unsupported typeName: ' + typeName );\n\n}\n\nfunction parseKeyframeTrack( json ) {\n\n\tif ( json.type === undefined ) {\n\n\t\tthrow new Error( 'THREE.KeyframeTrack: track type undefined, can not parse' );\n\n\t}\n\n\tconst trackType = getTrackTypeForValueTypeName( json.type );\n\n\tif ( json.times === undefined ) {\n\n\t\tconst times = [], values = [];\n\n\t\tAnimationUtils.flattenJSON( json.keys, times, values, 'value' );\n\n\t\tjson.times = times;\n\t\tjson.values = values;\n\n\t}\n\n\t// derived classes can define a static parse method\n\tif ( trackType.parse !== undefined ) {\n\n\t\treturn trackType.parse( json );\n\n\t} else {\n\n\t\t// by default, we assume a constructor compatible with the base\n\t\treturn new trackType( json.name, json.times, json.values, json.interpolation );\n\n\t}\n\n}\n\nexport { AnimationClip };\n","import { Object3D } from '../core/Object3D.js';\n\nclass Bone extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'Bone';\n\n\t}\n\n}\n\nBone.prototype.isBone = true;\n\nexport { Bone };\n","import { Texture } from './Texture.js';\nimport { NearestFilter } from '../constants.js';\n\nclass DataTexture extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, format, type, mapping, wrapS, wrapT, magFilter = NearestFilter, minFilter = NearestFilter, anisotropy, encoding ) {\n\n\t\tsuper( null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\n\n\t\tthis.image = { data: data, width: width, height: height };\n\n\t\tthis.magFilter = magFilter;\n\t\tthis.minFilter = minFilter;\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t\tthis.needsUpdate = true;\n\n\t}\n\n}\n\nDataTexture.prototype.isDataTexture = true;\n\nexport { DataTexture };\n","import {\n\tRGBAFormat,\n\tFloatType\n} from '../constants.js';\nimport { Bone } from './Bone.js';\nimport { Matrix4 } from '../math/Matrix4.js';\nimport { DataTexture } from '../textures/DataTexture.js';\nimport * as MathUtils from '../math/MathUtils.js';\n\nconst _offsetMatrix = /*@__PURE__*/ new Matrix4();\nconst _identityMatrix = /*@__PURE__*/ new Matrix4();\n\nclass Skeleton {\n\n\tconstructor( bones = [], boneInverses = [] ) {\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.bones = bones.slice( 0 );\n\t\tthis.boneInverses = boneInverses;\n\t\tthis.boneMatrices = null;\n\n\t\tthis.boneTexture = null;\n\t\tthis.boneTextureSize = 0;\n\n\t\tthis.frame = - 1;\n\n\t\tthis.init();\n\n\t}\n\n\tinit() {\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\n\t\tthis.boneMatrices = new Float32Array( bones.length * 16 );\n\n\t\t// calculate inverse bone matrices if necessary\n\n\t\tif ( boneInverses.length === 0 ) {\n\n\t\t\tthis.calculateInverses();\n\n\t\t} else {\n\n\t\t\t// handle special case\n\n\t\t\tif ( bones.length !== boneInverses.length ) {\n\n\t\t\t\tconsole.warn( 'THREE.Skeleton: Number of inverse bone matrices does not match amount of bones.' );\n\n\t\t\t\tthis.boneInverses = [];\n\n\t\t\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\t\t\tthis.boneInverses.push( new Matrix4() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcalculateInverses() {\n\n\t\tthis.boneInverses.length = 0;\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst inverse = new Matrix4();\n\n\t\t\tif ( this.bones[ i ] ) {\n\n\t\t\t\tinverse.copy( this.bones[ i ].matrixWorld ).invert();\n\n\t\t\t}\n\n\t\t\tthis.boneInverses.push( inverse );\n\n\t\t}\n\n\t}\n\n\tpose() {\n\n\t\t// recover the bind-time world matrices\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone ) {\n\n\t\t\t\tbone.matrixWorld.copy( this.boneInverses[ i ] ).invert();\n\n\t\t\t}\n\n\t\t}\n\n\t\t// compute the local matrices, positions, rotations and scales\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone ) {\n\n\t\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t\tbone.matrix.copy( bone.parent.matrixWorld ).invert();\n\t\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbone.matrix.copy( bone.matrixWorld );\n\n\t\t\t\t}\n\n\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tupdate() {\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\t\tconst boneMatrices = this.boneMatrices;\n\t\tconst boneTexture = this.boneTexture;\n\n\t\t// flatten bone matrices to array\n\n\t\tfor ( let i = 0, il = bones.length; i < il; i ++ ) {\n\n\t\t\t// compute the offset between the current and the original transform\n\n\t\t\tconst matrix = bones[ i ] ? bones[ i ].matrixWorld : _identityMatrix;\n\n\t\t\t_offsetMatrix.multiplyMatrices( matrix, boneInverses[ i ] );\n\t\t\t_offsetMatrix.toArray( boneMatrices, i * 16 );\n\n\t\t}\n\n\t\tif ( boneTexture !== null ) {\n\n\t\t\tboneTexture.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new Skeleton( this.bones, this.boneInverses );\n\n\t}\n\n\tcomputeBoneTexture() {\n\n\t\t// layout (1 matrix = 4 pixels)\n\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\n\t\t//  with  8x8  pixel texture max   16 bones * 4 pixels =  (8 * 8)\n\t\t//       16x16 pixel texture max   64 bones * 4 pixels = (16 * 16)\n\t\t//       32x32 pixel texture max  256 bones * 4 pixels = (32 * 32)\n\t\t//       64x64 pixel texture max 1024 bones * 4 pixels = (64 * 64)\n\n\t\tlet size = Math.sqrt( this.bones.length * 4 ); // 4 pixels needed for 1 matrix\n\t\tsize = MathUtils.ceilPowerOfTwo( size );\n\t\tsize = Math.max( size, 4 );\n\n\t\tconst boneMatrices = new Float32Array( size * size * 4 ); // 4 floats per RGBA pixel\n\t\tboneMatrices.set( this.boneMatrices ); // copy current values\n\n\t\tconst boneTexture = new DataTexture( boneMatrices, size, size, RGBAFormat, FloatType );\n\n\t\tthis.boneMatrices = boneMatrices;\n\t\tthis.boneTexture = boneTexture;\n\t\tthis.boneTextureSize = size;\n\n\t\treturn this;\n\n\t}\n\n\tgetBoneByName( name ) {\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone.name === name ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn undefined;\n\n\t}\n\n\tdispose( ) {\n\n\t\tif ( this.boneTexture !== null ) {\n\n\t\t\tthis.boneTexture.dispose();\n\n\t\t\tthis.boneTexture = null;\n\n\t\t}\n\n\t}\n\n\tfromJSON( json, bones ) {\n\n\t\tthis.uuid = json.uuid;\n\n\t\tfor ( let i = 0, l = json.bones.length; i < l; i ++ ) {\n\n\t\t\tconst uuid = json.bones[ i ];\n\t\t\tlet bone = bones[ uuid ];\n\n\t\t\tif ( bone === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Skeleton: No bone found with UUID:', uuid );\n\t\t\t\tbone = new Bone();\n\n\t\t\t}\n\n\t\t\tthis.bones.push( bone );\n\t\t\tthis.boneInverses.push( new Matrix4().fromArray( json.boneInverses[ i ] ) );\n\n\t\t}\n\n\t\tthis.init();\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Skeleton',\n\t\t\t\tgenerator: 'Skeleton.toJSON'\n\t\t\t},\n\t\t\tbones: [],\n\t\t\tboneInverses: []\n\t\t};\n\n\t\tdata.uuid = this.uuid;\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\n\t\tfor ( let i = 0, l = bones.length; i < l; i ++ ) {\n\n\t\t\tconst bone = bones[ i ];\n\t\t\tdata.bones.push( bone.uuid );\n\n\t\t\tconst boneInverse = boneInverses[ i ];\n\t\t\tdata.boneInverses.push( boneInverse.toArray() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n}\n\nexport { Skeleton };\n","import {\n\tAnimationClip,\n\tBone,\n\tBox3,\n\tBufferAttribute,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tDirectionalLight,\n\tDoubleSide,\n\tFileLoader,\n\tFrontSide,\n\tGroup,\n\tImageBitmapLoader,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tInterpolant,\n\tInterpolateDiscrete,\n\tInterpolateLinear,\n\tLine,\n\tLineBasicMaterial,\n\tLineLoop,\n\tLineSegments,\n\tLinearFilter,\n\tLinearMipmapLinearFilter,\n\tLinearMipmapNearestFilter,\n\tLoader,\n\tLoaderUtils,\n\tMaterial,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tMeshPhysicalMaterial,\n\tMeshStandardMaterial,\n\tMirroredRepeatWrapping,\n\tNearestFilter,\n\tNearestMipmapLinearFilter,\n\tNearestMipmapNearestFilter,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPoints,\n\tPointsMaterial,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRGBFormat,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSphere,\n\tSpotLight,\n\tTangentSpaceNormalMap,\n\tTexture,\n\tTextureLoader,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tVector2,\n\tVector3,\n\tVectorKeyframeTrack,\n\tsRGBEncoding\n} from 'three';\n\nclass GLTFLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.dracoLoader = null;\n\t\tthis.ktx2Loader = null;\n\t\tthis.meshoptDecoder = null;\n\n\t\tthis.pluginCallbacks = [];\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsClearcoatExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureBasisUExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureWebPExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSheenExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsTransmissionExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsVolumeExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsIorExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSpecularExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFLightsExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshoptCompression( parser );\n\n\t\t} );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tlet resourcePath;\n\n\t\tif ( this.resourcePath !== '' ) {\n\n\t\t\tresourcePath = this.resourcePath;\n\n\t\t} else if ( this.path !== '' ) {\n\n\t\t\tresourcePath = this.path;\n\n\t\t} else {\n\n\t\t\tresourcePath = LoaderUtils.extractUrlBase( url );\n\n\t\t}\n\n\t\t// Tells the LoadingManager to track an extra item, which resolves after\n\t\t// the model is fully loaded. This means the count of items loaded will\n\t\t// be incorrect, but ensures manager.onLoad() does not fire early.\n\t\tthis.manager.itemStart( url );\n\n\t\tconst _onError = function ( e ) {\n\n\t\t\tif ( onError ) {\n\n\t\t\t\tonError( e );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( e );\n\n\t\t\t}\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t};\n\n\t\tconst loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tloader.load( url, function ( data ) {\n\n\t\t\ttry {\n\n\t\t\t\tscope.parse( data, resourcePath, function ( gltf ) {\n\n\t\t\t\t\tonLoad( gltf );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, _onError );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\t_onError( e );\n\n\t\t\t}\n\n\t\t}, onProgress, _onError );\n\n\t}\n\n\tsetDRACOLoader( dracoLoader ) {\n\n\t\tthis.dracoLoader = dracoLoader;\n\t\treturn this;\n\n\t}\n\n\tsetDDSLoader() {\n\n\t\tthrow new Error(\n\n\t\t\t'THREE.GLTFLoader: \"MSFT_texture_dds\" no longer supported. Please update to \"KHR_texture_basisu\".'\n\n\t\t);\n\n\t}\n\n\tsetKTX2Loader( ktx2Loader ) {\n\n\t\tthis.ktx2Loader = ktx2Loader;\n\t\treturn this;\n\n\t}\n\n\tsetMeshoptDecoder( meshoptDecoder ) {\n\n\t\tthis.meshoptDecoder = meshoptDecoder;\n\t\treturn this;\n\n\t}\n\n\tregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) === - 1 ) {\n\n\t\t\tthis.pluginCallbacks.push( callback );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) !== - 1 ) {\n\n\t\t\tthis.pluginCallbacks.splice( this.pluginCallbacks.indexOf( callback ), 1 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tparse( data, path, onLoad, onError ) {\n\n\t\tlet content;\n\t\tconst extensions = {};\n\t\tconst plugins = {};\n\n\t\tif ( typeof data === 'string' ) {\n\n\t\t\tcontent = data;\n\n\t\t} else {\n\n\t\t\tconst magic = LoaderUtils.decodeText( new Uint8Array( data, 0, 4 ) );\n\n\t\t\tif ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\textensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\n\n\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\tif ( onError ) onError( error );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tcontent = extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content;\n\n\t\t\t} else {\n\n\t\t\t\tcontent = LoaderUtils.decodeText( new Uint8Array( data ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst json = JSON.parse( content );\n\n\t\tif ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\n\n\t\t\tif ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.' ) );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst parser = new GLTFParser( json, {\n\n\t\t\tpath: path || this.resourcePath || '',\n\t\t\tcrossOrigin: this.crossOrigin,\n\t\t\trequestHeader: this.requestHeader,\n\t\t\tmanager: this.manager,\n\t\t\tktx2Loader: this.ktx2Loader,\n\t\t\tmeshoptDecoder: this.meshoptDecoder\n\n\t\t} );\n\n\t\tparser.fileLoader.setRequestHeader( this.requestHeader );\n\n\t\tfor ( let i = 0; i < this.pluginCallbacks.length; i ++ ) {\n\n\t\t\tconst plugin = this.pluginCallbacks[ i ]( parser );\n\t\t\tplugins[ plugin.name ] = plugin;\n\n\t\t\t// Workaround to avoid determining as unknown extension\n\t\t\t// in addUnknownExtensionsToUserData().\n\t\t\t// Remove this workaround if we move all the existing\n\t\t\t// extension handlers to plugin system\n\t\t\textensions[ plugin.name ] = true;\n\n\t\t}\n\n\t\tif ( json.extensionsUsed ) {\n\n\t\t\tfor ( let i = 0; i < json.extensionsUsed.length; ++ i ) {\n\n\t\t\t\tconst extensionName = json.extensionsUsed[ i ];\n\t\t\t\tconst extensionsRequired = json.extensionsRequired || [];\n\n\t\t\t\tswitch ( extensionName ) {\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_UNLIT:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsUnlitExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsPbrSpecularGlossinessExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFTextureTransformExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MESH_QUANTIZATION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMeshQuantizationExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( extensionsRequired.indexOf( extensionName ) >= 0 && plugins[ extensionName ] === undefined ) {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tparser.setExtensions( extensions );\n\t\tparser.setPlugins( plugins );\n\t\tparser.parse( onLoad, onError );\n\n\t}\n\n}\n\n/* GLTFREGISTRY */\n\nfunction GLTFRegistry() {\n\n\tlet objects = {};\n\n\treturn\t{\n\n\t\tget: function ( key ) {\n\n\t\t\treturn objects[ key ];\n\n\t\t},\n\n\t\tadd: function ( key, object ) {\n\n\t\t\tobjects[ key ] = object;\n\n\t\t},\n\n\t\tremove: function ( key ) {\n\n\t\t\tdelete objects[ key ];\n\n\t\t},\n\n\t\tremoveAll: function () {\n\n\t\t\tobjects = {};\n\n\t\t}\n\n\t};\n\n}\n\n/*********************************/\n/********** EXTENSIONS ***********/\n/*********************************/\n\nconst EXTENSIONS = {\n\tKHR_BINARY_GLTF: 'KHR_binary_glTF',\n\tKHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n\tKHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n\tKHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n\tKHR_MATERIALS_IOR: 'KHR_materials_ior',\n\tKHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\n\tKHR_MATERIALS_SHEEN: 'KHR_materials_sheen',\n\tKHR_MATERIALS_SPECULAR: 'KHR_materials_specular',\n\tKHR_MATERIALS_TRANSMISSION: 'KHR_materials_transmission',\n\tKHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n\tKHR_MATERIALS_VOLUME: 'KHR_materials_volume',\n\tKHR_TEXTURE_BASISU: 'KHR_texture_basisu',\n\tKHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n\tKHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n\tEXT_TEXTURE_WEBP: 'EXT_texture_webp',\n\tEXT_MESHOPT_COMPRESSION: 'EXT_meshopt_compression'\n};\n\n/**\n * Punctual Lights Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n */\nclass GLTFLightsExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n\t\t// Object3D instance caches\n\t\tthis.cache = { refs: {}, uses: {} };\n\n\t}\n\n\t_markDefs() {\n\n\t\tconst parser = this.parser;\n\t\tconst nodeDefs = this.parser.json.nodes || [];\n\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.extensions\n\t\t\t\t\t&& nodeDef.extensions[ this.name ]\n\t\t\t\t\t&& nodeDef.extensions[ this.name ].light !== undefined ) {\n\n\t\t\t\tparser._addNodeRef( this.cache, nodeDef.extensions[ this.name ].light );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_loadLight( lightIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst cacheKey = 'light:' + lightIndex;\n\t\tlet dependency = parser.cache.get( cacheKey );\n\n\t\tif ( dependency ) return dependency;\n\n\t\tconst json = parser.json;\n\t\tconst extensions = ( json.extensions && json.extensions[ this.name ] ) || {};\n\t\tconst lightDefs = extensions.lights || [];\n\t\tconst lightDef = lightDefs[ lightIndex ];\n\t\tlet lightNode;\n\n\t\tconst color = new Color( 0xffffff );\n\n\t\tif ( lightDef.color !== undefined ) color.fromArray( lightDef.color );\n\n\t\tconst range = lightDef.range !== undefined ? lightDef.range : 0;\n\n\t\tswitch ( lightDef.type ) {\n\n\t\t\tcase 'directional':\n\t\t\t\tlightNode = new DirectionalLight( color );\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tcase 'point':\n\t\t\t\tlightNode = new PointLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\tbreak;\n\n\t\t\tcase 'spot':\n\t\t\t\tlightNode = new SpotLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\t// Handle spotlight properties.\n\t\t\t\tlightDef.spot = lightDef.spot || {};\n\t\t\t\tlightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n\t\t\t\tlightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n\t\t\t\tlightNode.angle = lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unexpected light type: ' + lightDef.type );\n\n\t\t}\n\n\t\t// Some lights (e.g. spot) default to a position other than the origin. Reset the position\n\t\t// here, because node-level parsing will only override position if explicitly specified.\n\t\tlightNode.position.set( 0, 0, 0 );\n\n\t\tlightNode.decay = 2;\n\n\t\tif ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\n\n\t\tlightNode.name = parser.createUniqueName( lightDef.name || ( 'light_' + lightIndex ) );\n\n\t\tdependency = Promise.resolve( lightNode );\n\n\t\tparser.cache.add( cacheKey, dependency );\n\n\t\treturn dependency;\n\n\t}\n\n\tcreateNodeAttachment( nodeIndex ) {\n\n\t\tconst self = this;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\t\tconst lightDef = ( nodeDef.extensions && nodeDef.extensions[ this.name ] ) || {};\n\t\tconst lightIndex = lightDef.light;\n\n\t\tif ( lightIndex === undefined ) return null;\n\n\t\treturn this._loadLight( lightIndex ).then( function ( light ) {\n\n\t\t\treturn parser._getNodeRef( self.cache, lightIndex, light );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Unlit Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n */\nclass GLTFMaterialsUnlitExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n\n\t}\n\n\tgetMaterialType() {\n\n\t\treturn MeshBasicMaterial;\n\n\t}\n\n\textendParams( materialParams, materialDef, parser ) {\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness;\n\n\t\tif ( metallicRoughness ) {\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Clearcoat Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n */\nclass GLTFMaterialsClearcoatExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.clearcoatFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoat = extension.clearcoatFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatMap', extension.clearcoatTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatRoughnessMap', extension.clearcoatRoughnessTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatNormalTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatNormalMap', extension.clearcoatNormalTexture ) );\n\n\t\t\tif ( extension.clearcoatNormalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = extension.clearcoatNormalTexture.scale;\n\n\t\t\t\tmaterialParams.clearcoatNormalScale = new Vector2( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Sheen Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_sheen\n */\nclass GLTFMaterialsSheenExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SHEEN;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.sheenColor = new Color( 0, 0, 0 );\n\t\tmaterialParams.sheenRoughness = 0;\n\t\tmaterialParams.sheen = 1;\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.sheenColorFactor !== undefined ) {\n\n\t\t\tmaterialParams.sheenColor.fromArray( extension.sheenColorFactor );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.sheenRoughness = extension.sheenRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.sheenColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenColorMap', extension.sheenColorTexture ) );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenRoughnessMap', extension.sheenRoughnessTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Transmission Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_transmission\n * Draft: https://github.com/KhronosGroup/glTF/pull/1698\n */\nclass GLTFMaterialsTransmissionExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_TRANSMISSION;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.transmissionFactor !== undefined ) {\n\n\t\t\tmaterialParams.transmission = extension.transmissionFactor;\n\n\t\t}\n\n\t\tif ( extension.transmissionTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'transmissionMap', extension.transmissionTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials Volume Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_volume\n */\nclass GLTFMaterialsVolumeExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_VOLUME;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.thickness = extension.thicknessFactor !== undefined ? extension.thicknessFactor : 0;\n\n\t\tif ( extension.thicknessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'thicknessMap', extension.thicknessTexture ) );\n\n\t\t}\n\n\t\tmaterialParams.attenuationDistance = extension.attenuationDistance || 0;\n\n\t\tconst colorArray = extension.attenuationColor || [ 1, 1, 1 ];\n\t\tmaterialParams.attenuationColor = new Color( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ] );\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials ior Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_ior\n */\nclass GLTFMaterialsIorExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_IOR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.ior = extension.ior !== undefined ? extension.ior : 1.5;\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Materials specular Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_specular\n */\nclass GLTFMaterialsSpecularExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SPECULAR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.specularIntensity = extension.specularFactor !== undefined ? extension.specularFactor : 1.0;\n\n\t\tif ( extension.specularTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularIntensityMap', extension.specularTexture ) );\n\n\t\t}\n\n\t\tconst colorArray = extension.specularColorFactor || [ 1, 1, 1 ];\n\t\tmaterialParams.specularColor = new Color( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ] );\n\n\t\tif ( extension.specularColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularColorMap', extension.specularColorTexture ).then( function ( texture ) {\n\n\t\t\t\ttexture.encoding = sRGBEncoding;\n\n\t\t\t} ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * BasisU Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_basisu\n */\nclass GLTFTextureBasisUExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_BASISU;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ this.name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ this.name ];\n\t\tconst source = json.images[ extension.source ];\n\t\tconst loader = parser.options.ktx2Loader;\n\n\t\tif ( ! loader ) {\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures' );\n\n\t\t\t} else {\n\n\t\t\t\t// Assumes that the extension is optional and that a fallback texture is present\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.loadTextureImage( textureIndex, source, loader );\n\n\t}\n\n}\n\n/**\n * WebP Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_webp\n */\nclass GLTFTextureWebPExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_WEBP;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: WebP required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image. Support for lossy images doesn't guarantee support for all\n\t\t\t\t// WebP images, unfortunately.\n\t\t\t\timage.src = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';\n\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * meshopt BufferView Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_meshopt_compression\n */\nclass GLTFMeshoptCompression {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESHOPT_COMPRESSION;\n\t\tthis.parser = parser;\n\n\t}\n\n\tloadBufferView( index ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst bufferView = json.bufferViews[ index ];\n\n\t\tif ( bufferView.extensions && bufferView.extensions[ this.name ] ) {\n\n\t\t\tconst extensionDef = bufferView.extensions[ this.name ];\n\n\t\t\tconst buffer = this.parser.getDependency( 'buffer', extensionDef.buffer );\n\t\t\tconst decoder = this.parser.options.meshoptDecoder;\n\n\t\t\tif ( ! decoder || ! decoder.supported ) {\n\n\t\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Assumes that the extension is optional and that fallback buffer data is present\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn Promise.all( [ buffer, decoder.ready ] ).then( function ( res ) {\n\n\t\t\t\tconst byteOffset = extensionDef.byteOffset || 0;\n\t\t\t\tconst byteLength = extensionDef.byteLength || 0;\n\n\t\t\t\tconst count = extensionDef.count;\n\t\t\t\tconst stride = extensionDef.byteStride;\n\n\t\t\t\tconst result = new ArrayBuffer( count * stride );\n\t\t\t\tconst source = new Uint8Array( res[ 0 ], byteOffset, byteLength );\n\n\t\t\t\tdecoder.decodeGltfBuffer( new Uint8Array( result ), count, stride, source, extensionDef.mode, extensionDef.filter );\n\t\t\t\treturn result;\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t}\n\n}\n\n/* BINARY EXTENSION */\nconst BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\nconst BINARY_EXTENSION_HEADER_LENGTH = 12;\nconst BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\n\nclass GLTFBinaryExtension {\n\n\tconstructor( data ) {\n\n\t\tthis.name = EXTENSIONS.KHR_BINARY_GLTF;\n\t\tthis.content = null;\n\t\tthis.body = null;\n\n\t\tconst headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\n\n\t\tthis.header = {\n\t\t\tmagic: LoaderUtils.decodeText( new Uint8Array( data.slice( 0, 4 ) ) ),\n\t\t\tversion: headerView.getUint32( 4, true ),\n\t\t\tlength: headerView.getUint32( 8, true )\n\t\t};\n\n\t\tif ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\n\n\t\t} else if ( this.header.version < 2.0 ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Legacy binary file detected.' );\n\n\t\t}\n\n\t\tconst chunkContentsLength = this.header.length - BINARY_EXTENSION_HEADER_LENGTH;\n\t\tconst chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tlet chunkIndex = 0;\n\n\t\twhile ( chunkIndex < chunkContentsLength ) {\n\n\t\t\tconst chunkLength = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tconst chunkType = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tif ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\n\n\t\t\t\tconst contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\n\t\t\t\tthis.content = LoaderUtils.decodeText( contentArray );\n\n\t\t\t} else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\n\n\t\t\t\tconst byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n\t\t\t\tthis.body = data.slice( byteOffset, byteOffset + chunkLength );\n\n\t\t\t}\n\n\t\t\t// Clients must ignore chunks with unknown types.\n\n\t\t\tchunkIndex += chunkLength;\n\n\t\t}\n\n\t\tif ( this.content === null ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: JSON content not found.' );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * DRACO Mesh Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n */\nclass GLTFDracoMeshCompressionExtension {\n\n\tconstructor( json, dracoLoader ) {\n\n\t\tif ( ! dracoLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n\t\tthis.json = json;\n\t\tthis.dracoLoader = dracoLoader;\n\t\tthis.dracoLoader.preload();\n\n\t}\n\n\tdecodePrimitive( primitive, parser ) {\n\n\t\tconst json = this.json;\n\t\tconst dracoLoader = this.dracoLoader;\n\t\tconst bufferViewIndex = primitive.extensions[ this.name ].bufferView;\n\t\tconst gltfAttributeMap = primitive.extensions[ this.name ].attributes;\n\t\tconst threeAttributeMap = {};\n\t\tconst attributeNormalizedMap = {};\n\t\tconst attributeTypeMap = {};\n\n\t\tfor ( const attributeName in gltfAttributeMap ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tthreeAttributeMap[ threeAttributeName ] = gltfAttributeMap[ attributeName ];\n\n\t\t}\n\n\t\tfor ( const attributeName in primitive.attributes ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tif ( gltfAttributeMap[ attributeName ] !== undefined ) {\n\n\t\t\t\tconst accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\n\t\t\t\tconst componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t\tattributeTypeMap[ threeAttributeName ] = componentType;\n\t\t\t\tattributeNormalizedMap[ threeAttributeName ] = accessorDef.normalized === true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\n\n\t\t\treturn new Promise( function ( resolve ) {\n\n\t\t\t\tdracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\n\n\t\t\t\t\tfor ( const attributeName in geometry.attributes ) {\n\n\t\t\t\t\t\tconst attribute = geometry.attributes[ attributeName ];\n\t\t\t\t\t\tconst normalized = attributeNormalizedMap[ attributeName ];\n\n\t\t\t\t\t\tif ( normalized !== undefined ) attribute.normalized = normalized;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve( geometry );\n\n\t\t\t\t}, threeAttributeMap, attributeTypeMap );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Texture Transform Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n */\nclass GLTFTextureTransformExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n\n\t}\n\n\textendTexture( texture, transform ) {\n\n\t\tif ( transform.texCoord !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.' );\n\n\t\t}\n\n\t\tif ( transform.offset === undefined && transform.rotation === undefined && transform.scale === undefined ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21819.\n\t\t\treturn texture;\n\n\t\t}\n\n\t\ttexture = texture.clone();\n\n\t\tif ( transform.offset !== undefined ) {\n\n\t\t\ttexture.offset.fromArray( transform.offset );\n\n\t\t}\n\n\t\tif ( transform.rotation !== undefined ) {\n\n\t\t\ttexture.rotation = transform.rotation;\n\n\t\t}\n\n\t\tif ( transform.scale !== undefined ) {\n\n\t\t\ttexture.repeat.fromArray( transform.scale );\n\n\t\t}\n\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t}\n\n}\n\n/**\n * Specular-Glossiness Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness\n */\n\n/**\n * A sub class of StandardMaterial with some of the functionality\n * changed via the `onBeforeCompile` callback\n * @pailhead\n */\nclass GLTFMeshStandardSGMaterial extends MeshStandardMaterial {\n\n\tconstructor( params ) {\n\n\t\tsuper();\n\n\t\tthis.isGLTFSpecularGlossinessMaterial = true;\n\n\t\t//various chunks that need replacing\n\t\tconst specularMapParsFragmentChunk = [\n\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t'\tuniform sampler2D specularMap;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst glossinessMapParsFragmentChunk = [\n\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t'\tuniform sampler2D glossinessMap;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst specularMapFragmentChunk = [\n\t\t\t'vec3 specularFactor = specular;',\n\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t'\tvec4 texelSpecular = texture2D( specularMap, vUv );',\n\t\t\t'\ttexelSpecular = sRGBToLinear( texelSpecular );',\n\t\t\t'\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t'\tspecularFactor *= texelSpecular.rgb;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst glossinessMapFragmentChunk = [\n\t\t\t'float glossinessFactor = glossiness;',\n\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t'\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\n\t\t\t'\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t'\tglossinessFactor *= texelGlossiness.a;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst lightPhysicalFragmentChunk = [\n\t\t\t'PhysicalMaterial material;',\n\t\t\t'material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );',\n\t\t\t'vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );',\n\t\t\t'float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );',\n\t\t\t'material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.',\n\t\t\t'material.roughness += geometryRoughness;',\n\t\t\t'material.roughness = min( material.roughness, 1.0 );',\n\t\t\t'material.specularColor = specularFactor;',\n\t\t].join( '\\n' );\n\n\t\tconst uniforms = {\n\t\t\tspecular: { value: new Color().setHex( 0xffffff ) },\n\t\t\tglossiness: { value: 1 },\n\t\t\tspecularMap: { value: null },\n\t\t\tglossinessMap: { value: null }\n\t\t};\n\n\t\tthis._extraUniforms = uniforms;\n\n\t\tthis.onBeforeCompile = function ( shader ) {\n\n\t\t\tfor ( const uniformName in uniforms ) {\n\n\t\t\t\tshader.uniforms[ uniformName ] = uniforms[ uniformName ];\n\n\t\t\t}\n\n\t\t\tshader.fragmentShader = shader.fragmentShader\n\t\t\t\t.replace( 'uniform float roughness;', 'uniform vec3 specular;' )\n\t\t\t\t.replace( 'uniform float metalness;', 'uniform float glossiness;' )\n\t\t\t\t.replace( '#include <roughnessmap_pars_fragment>', specularMapParsFragmentChunk )\n\t\t\t\t.replace( '#include <metalnessmap_pars_fragment>', glossinessMapParsFragmentChunk )\n\t\t\t\t.replace( '#include <roughnessmap_fragment>', specularMapFragmentChunk )\n\t\t\t\t.replace( '#include <metalnessmap_fragment>', glossinessMapFragmentChunk )\n\t\t\t\t.replace( '#include <lights_physical_fragment>', lightPhysicalFragmentChunk );\n\n\t\t};\n\n\t\tObject.defineProperties( this, {\n\n\t\t\tspecular: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.specular.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.specular.value = v;\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tspecularMap: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.specularMap.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.specularMap.value = v;\n\n\t\t\t\t\tif ( v ) {\n\n\t\t\t\t\t\tthis.defines.USE_SPECULARMAP = ''; // USE_UV is set by the renderer for specular maps\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tdelete this.defines.USE_SPECULARMAP;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tglossiness: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.glossiness.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.glossiness.value = v;\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tglossinessMap: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.glossinessMap.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.glossinessMap.value = v;\n\n\t\t\t\t\tif ( v ) {\n\n\t\t\t\t\t\tthis.defines.USE_GLOSSINESSMAP = '';\n\t\t\t\t\t\tthis.defines.USE_UV = '';\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tdelete this.defines.USE_GLOSSINESSMAP;\n\t\t\t\t\t\tdelete this.defines.USE_UV;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t} );\n\n\t\tdelete this.metalness;\n\t\tdelete this.roughness;\n\t\tdelete this.metalnessMap;\n\t\tdelete this.roughnessMap;\n\n\t\tthis.setValues( params );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.specularMap = source.specularMap;\n\t\tthis.specular.copy( source.specular );\n\t\tthis.glossinessMap = source.glossinessMap;\n\t\tthis.glossiness = source.glossiness;\n\t\tdelete this.metalness;\n\t\tdelete this.roughness;\n\t\tdelete this.metalnessMap;\n\t\tdelete this.roughnessMap;\n\t\treturn this;\n\n\t}\n\n}\n\n\nclass GLTFMaterialsPbrSpecularGlossinessExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS;\n\n\t\tthis.specularGlossinessParams = [\n\t\t\t'color',\n\t\t\t'map',\n\t\t\t'lightMap',\n\t\t\t'lightMapIntensity',\n\t\t\t'aoMap',\n\t\t\t'aoMapIntensity',\n\t\t\t'emissive',\n\t\t\t'emissiveIntensity',\n\t\t\t'emissiveMap',\n\t\t\t'bumpMap',\n\t\t\t'bumpScale',\n\t\t\t'normalMap',\n\t\t\t'normalMapType',\n\t\t\t'displacementMap',\n\t\t\t'displacementScale',\n\t\t\t'displacementBias',\n\t\t\t'specularMap',\n\t\t\t'specular',\n\t\t\t'glossinessMap',\n\t\t\t'glossiness',\n\t\t\t'alphaMap',\n\t\t\t'envMap',\n\t\t\t'envMapIntensity',\n\t\t\t'refractionRatio',\n\t\t];\n\n\t}\n\n\tgetMaterialType() {\n\n\t\treturn GLTFMeshStandardSGMaterial;\n\n\t}\n\n\textendParams( materialParams, materialDef, parser ) {\n\n\t\tconst pbrSpecularGlossiness = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tconst pending = [];\n\n\t\tif ( Array.isArray( pbrSpecularGlossiness.diffuseFactor ) ) {\n\n\t\t\tconst array = pbrSpecularGlossiness.diffuseFactor;\n\n\t\t\tmaterialParams.color.fromArray( array );\n\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t}\n\n\t\tif ( pbrSpecularGlossiness.diffuseTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'map', pbrSpecularGlossiness.diffuseTexture ) );\n\n\t\t}\n\n\t\tmaterialParams.emissive = new Color( 0.0, 0.0, 0.0 );\n\t\tmaterialParams.glossiness = pbrSpecularGlossiness.glossinessFactor !== undefined ? pbrSpecularGlossiness.glossinessFactor : 1.0;\n\t\tmaterialParams.specular = new Color( 1.0, 1.0, 1.0 );\n\n\t\tif ( Array.isArray( pbrSpecularGlossiness.specularFactor ) ) {\n\n\t\t\tmaterialParams.specular.fromArray( pbrSpecularGlossiness.specularFactor );\n\n\t\t}\n\n\t\tif ( pbrSpecularGlossiness.specularGlossinessTexture !== undefined ) {\n\n\t\t\tconst specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture;\n\t\t\tpending.push( parser.assignTexture( materialParams, 'glossinessMap', specGlossMapDef ) );\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularMap', specGlossMapDef ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n\tcreateMaterial( materialParams ) {\n\n\t\tconst material = new GLTFMeshStandardSGMaterial( materialParams );\n\t\tmaterial.fog = true;\n\n\t\tmaterial.color = materialParams.color;\n\n\t\tmaterial.map = materialParams.map === undefined ? null : materialParams.map;\n\n\t\tmaterial.lightMap = null;\n\t\tmaterial.lightMapIntensity = 1.0;\n\n\t\tmaterial.aoMap = materialParams.aoMap === undefined ? null : materialParams.aoMap;\n\t\tmaterial.aoMapIntensity = 1.0;\n\n\t\tmaterial.emissive = materialParams.emissive;\n\t\tmaterial.emissiveIntensity = 1.0;\n\t\tmaterial.emissiveMap = materialParams.emissiveMap === undefined ? null : materialParams.emissiveMap;\n\n\t\tmaterial.bumpMap = materialParams.bumpMap === undefined ? null : materialParams.bumpMap;\n\t\tmaterial.bumpScale = 1;\n\n\t\tmaterial.normalMap = materialParams.normalMap === undefined ? null : materialParams.normalMap;\n\t\tmaterial.normalMapType = TangentSpaceNormalMap;\n\n\t\tif ( materialParams.normalScale ) material.normalScale = materialParams.normalScale;\n\n\t\tmaterial.displacementMap = null;\n\t\tmaterial.displacementScale = 1;\n\t\tmaterial.displacementBias = 0;\n\n\t\tmaterial.specularMap = materialParams.specularMap === undefined ? null : materialParams.specularMap;\n\t\tmaterial.specular = materialParams.specular;\n\n\t\tmaterial.glossinessMap = materialParams.glossinessMap === undefined ? null : materialParams.glossinessMap;\n\t\tmaterial.glossiness = materialParams.glossiness;\n\n\t\tmaterial.alphaMap = null;\n\n\t\tmaterial.envMap = materialParams.envMap === undefined ? null : materialParams.envMap;\n\t\tmaterial.envMapIntensity = 1.0;\n\n\t\tmaterial.refractionRatio = 0.98;\n\n\t\treturn material;\n\n\t}\n\n}\n\n/**\n * Mesh Quantization Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n */\nclass GLTFMeshQuantizationExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\n\n\t}\n\n}\n\n/*********************************/\n/********** INTERPOLATION ********/\n/*********************************/\n\n// Spline Interpolation\n// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\nclass GLTFCubicSplineInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// Copies a sample value to the result buffer. See description of glTF\n\t\t// CUBICSPLINE values layout in interpolate_() function below.\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tvalueSize = this.valueSize,\n\t\t\toffset = index * valueSize * 3 + valueSize;\n\n\t\tfor ( let i = 0; i !== valueSize; i ++ ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nGLTFCubicSplineInterpolant.prototype.beforeStart_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\nGLTFCubicSplineInterpolant.prototype.afterEnd_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\nGLTFCubicSplineInterpolant.prototype.interpolate_ = function ( i1, t0, t, t1 ) {\n\n\tconst result = this.resultBuffer;\n\tconst values = this.sampleValues;\n\tconst stride = this.valueSize;\n\n\tconst stride2 = stride * 2;\n\tconst stride3 = stride * 3;\n\n\tconst td = t1 - t0;\n\n\tconst p = ( t - t0 ) / td;\n\tconst pp = p * p;\n\tconst ppp = pp * p;\n\n\tconst offset1 = i1 * stride3;\n\tconst offset0 = offset1 - stride3;\n\n\tconst s2 = - 2 * ppp + 3 * pp;\n\tconst s3 = ppp - pp;\n\tconst s0 = 1 - s2;\n\tconst s1 = s3 - pp + p;\n\n\t// Layout of keyframe output values for CUBICSPLINE animations:\n\t//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n\tfor ( let i = 0; i !== stride; i ++ ) {\n\n\t\tconst p0 = values[ offset0 + i + stride ]; // splineVertex_k\n\t\tconst m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\n\t\tconst p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\n\t\tconst m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n\t\tresult[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n\n\t}\n\n\treturn result;\n\n};\n\nconst _q = new Quaternion();\n\nclass GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant {\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = super.interpolate_( i1, t0, t, t1 );\n\n\t\t_q.fromArray( result ).normalize().toArray( result );\n\n\t\treturn result;\n\n\t}\n\n}\n\n\n/*********************************/\n/********** INTERNALS ************/\n/*********************************/\n\n/* CONSTANTS */\n\nconst WEBGL_CONSTANTS = {\n\tFLOAT: 5126,\n\t//FLOAT_MAT2: 35674,\n\tFLOAT_MAT3: 35675,\n\tFLOAT_MAT4: 35676,\n\tFLOAT_VEC2: 35664,\n\tFLOAT_VEC3: 35665,\n\tFLOAT_VEC4: 35666,\n\tLINEAR: 9729,\n\tREPEAT: 10497,\n\tSAMPLER_2D: 35678,\n\tPOINTS: 0,\n\tLINES: 1,\n\tLINE_LOOP: 2,\n\tLINE_STRIP: 3,\n\tTRIANGLES: 4,\n\tTRIANGLE_STRIP: 5,\n\tTRIANGLE_FAN: 6,\n\tUNSIGNED_BYTE: 5121,\n\tUNSIGNED_SHORT: 5123\n};\n\nconst WEBGL_COMPONENT_TYPES = {\n\t5120: Int8Array,\n\t5121: Uint8Array,\n\t5122: Int16Array,\n\t5123: Uint16Array,\n\t5125: Uint32Array,\n\t5126: Float32Array\n};\n\nconst WEBGL_FILTERS = {\n\t9728: NearestFilter,\n\t9729: LinearFilter,\n\t9984: NearestMipmapNearestFilter,\n\t9985: LinearMipmapNearestFilter,\n\t9986: NearestMipmapLinearFilter,\n\t9987: LinearMipmapLinearFilter\n};\n\nconst WEBGL_WRAPPINGS = {\n\t33071: ClampToEdgeWrapping,\n\t33648: MirroredRepeatWrapping,\n\t10497: RepeatWrapping\n};\n\nconst WEBGL_TYPE_SIZES = {\n\t'SCALAR': 1,\n\t'VEC2': 2,\n\t'VEC3': 3,\n\t'VEC4': 4,\n\t'MAT2': 4,\n\t'MAT3': 9,\n\t'MAT4': 16\n};\n\nconst ATTRIBUTES = {\n\tPOSITION: 'position',\n\tNORMAL: 'normal',\n\tTANGENT: 'tangent',\n\tTEXCOORD_0: 'uv',\n\tTEXCOORD_1: 'uv2',\n\tCOLOR_0: 'color',\n\tWEIGHTS_0: 'skinWeight',\n\tJOINTS_0: 'skinIndex',\n};\n\nconst PATH_PROPERTIES = {\n\tscale: 'scale',\n\ttranslation: 'position',\n\trotation: 'quaternion',\n\tweights: 'morphTargetInfluences'\n};\n\nconst INTERPOLATION = {\n\tCUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n\t\t                        // keyframe track will be initialized with a default interpolation type, then modified.\n\tLINEAR: InterpolateLinear,\n\tSTEP: InterpolateDiscrete\n};\n\nconst ALPHA_MODES = {\n\tOPAQUE: 'OPAQUE',\n\tMASK: 'MASK',\n\tBLEND: 'BLEND'\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n */\nfunction createDefaultMaterial( cache ) {\n\n\tif ( cache[ 'DefaultMaterial' ] === undefined ) {\n\n\t\tcache[ 'DefaultMaterial' ] = new MeshStandardMaterial( {\n\t\t\tcolor: 0xFFFFFF,\n\t\t\temissive: 0x000000,\n\t\t\tmetalness: 1,\n\t\t\troughness: 1,\n\t\t\ttransparent: false,\n\t\t\tdepthTest: true,\n\t\t\tside: FrontSide\n\t\t} );\n\n\t}\n\n\treturn cache[ 'DefaultMaterial' ];\n\n}\n\nfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\n\n\t// Add unknown glTF extensions to an object's userData.\n\n\tfor ( const name in objectDef.extensions ) {\n\n\t\tif ( knownExtensions[ name ] === undefined ) {\n\n\t\t\tobject.userData.gltfExtensions = object.userData.gltfExtensions || {};\n\t\t\tobject.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {Object3D|Material|BufferGeometry} object\n * @param {GLTF.definition} gltfDef\n */\nfunction assignExtrasToUserData( object, gltfDef ) {\n\n\tif ( gltfDef.extras !== undefined ) {\n\n\t\tif ( typeof gltfDef.extras === 'object' ) {\n\n\t\t\tObject.assign( object.userData, gltfDef.extras );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n *\n * @param {BufferGeometry} geometry\n * @param {Array<GLTF.Target>} targets\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addMorphTargets( geometry, targets, parser ) {\n\n\tlet hasMorphPosition = false;\n\tlet hasMorphNormal = false;\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( target.POSITION !== undefined ) hasMorphPosition = true;\n\t\tif ( target.NORMAL !== undefined ) hasMorphNormal = true;\n\n\t\tif ( hasMorphPosition && hasMorphNormal ) break;\n\n\t}\n\n\tif ( ! hasMorphPosition && ! hasMorphNormal ) return Promise.resolve( geometry );\n\n\tconst pendingPositionAccessors = [];\n\tconst pendingNormalAccessors = [];\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( hasMorphPosition ) {\n\n\t\t\tconst pendingAccessor = target.POSITION !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.POSITION )\n\t\t\t\t: geometry.attributes.position;\n\n\t\t\tpendingPositionAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphNormal ) {\n\n\t\t\tconst pendingAccessor = target.NORMAL !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.NORMAL )\n\t\t\t\t: geometry.attributes.normal;\n\n\t\t\tpendingNormalAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t}\n\n\treturn Promise.all( [\n\t\tPromise.all( pendingPositionAccessors ),\n\t\tPromise.all( pendingNormalAccessors )\n\t] ).then( function ( accessors ) {\n\n\t\tconst morphPositions = accessors[ 0 ];\n\t\tconst morphNormals = accessors[ 1 ];\n\n\t\tif ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\n\t\tif ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\n\t\tgeometry.morphTargetsRelative = true;\n\n\t\treturn geometry;\n\n\t} );\n\n}\n\n/**\n * @param {Mesh} mesh\n * @param {GLTF.Mesh} meshDef\n */\nfunction updateMorphTargets( mesh, meshDef ) {\n\n\tmesh.updateMorphTargets();\n\n\tif ( meshDef.weights !== undefined ) {\n\n\t\tfor ( let i = 0, il = meshDef.weights.length; i < il; i ++ ) {\n\n\t\t\tmesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\n\n\t\t}\n\n\t}\n\n\t// .extras has user-defined data, so check that .extras.targetNames is an array.\n\tif ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\n\n\t\tconst targetNames = meshDef.extras.targetNames;\n\n\t\tif ( mesh.morphTargetInfluences.length === targetNames.length ) {\n\n\t\t\tmesh.morphTargetDictionary = {};\n\n\t\t\tfor ( let i = 0, il = targetNames.length; i < il; i ++ ) {\n\n\t\t\t\tmesh.morphTargetDictionary[ targetNames[ i ] ] = i;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\n\n\t\t}\n\n\t}\n\n}\n\nfunction createPrimitiveKey( primitiveDef ) {\n\n\tconst dracoExtension = primitiveDef.extensions && primitiveDef.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ];\n\tlet geometryKey;\n\n\tif ( dracoExtension ) {\n\n\t\tgeometryKey = 'draco:' + dracoExtension.bufferView\n\t\t\t\t+ ':' + dracoExtension.indices\n\t\t\t\t+ ':' + createAttributesKey( dracoExtension.attributes );\n\n\t} else {\n\n\t\tgeometryKey = primitiveDef.indices + ':' + createAttributesKey( primitiveDef.attributes ) + ':' + primitiveDef.mode;\n\n\t}\n\n\treturn geometryKey;\n\n}\n\nfunction createAttributesKey( attributes ) {\n\n\tlet attributesKey = '';\n\n\tconst keys = Object.keys( attributes ).sort();\n\n\tfor ( let i = 0, il = keys.length; i < il; i ++ ) {\n\n\t\tattributesKey += keys[ i ] + ':' + attributes[ keys[ i ] ] + ';';\n\n\t}\n\n\treturn attributesKey;\n\n}\n\nfunction getNormalizedComponentScale( constructor ) {\n\n\t// Reference:\n\t// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization#encoding-quantized-data\n\n\tswitch ( constructor ) {\n\n\t\tcase Int8Array:\n\t\t\treturn 1 / 127;\n\n\t\tcase Uint8Array:\n\t\t\treturn 1 / 255;\n\n\t\tcase Int16Array:\n\t\t\treturn 1 / 32767;\n\n\t\tcase Uint16Array:\n\t\t\treturn 1 / 65535;\n\n\t\tdefault:\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported normalized accessor component type.' );\n\n\t}\n\n}\n\n/* GLTF PARSER */\n\nclass GLTFParser {\n\n\tconstructor( json = {}, options = {} ) {\n\n\t\tthis.json = json;\n\t\tthis.extensions = {};\n\t\tthis.plugins = {};\n\t\tthis.options = options;\n\n\t\t// loader object cache\n\t\tthis.cache = new GLTFRegistry();\n\n\t\t// associations between Three.js objects and glTF elements\n\t\tthis.associations = new Map();\n\n\t\t// BufferGeometry caching\n\t\tthis.primitiveCache = {};\n\n\t\t// Object3D instance caches\n\t\tthis.meshCache = { refs: {}, uses: {} };\n\t\tthis.cameraCache = { refs: {}, uses: {} };\n\t\tthis.lightCache = { refs: {}, uses: {} };\n\n\t\tthis.textureCache = {};\n\n\t\t// Track node names, to ensure no duplicates\n\t\tthis.nodeNamesUsed = {};\n\n\t\t// Use an ImageBitmapLoader if imageBitmaps are supported. Moves much of the\n\t\t// expensive work of uploading a texture to the GPU off the main thread.\n\t\tif ( typeof createImageBitmap !== 'undefined' && /Firefox/.test( navigator.userAgent ) === false ) {\n\n\t\t\tthis.textureLoader = new ImageBitmapLoader( this.options.manager );\n\n\t\t} else {\n\n\t\t\tthis.textureLoader = new TextureLoader( this.options.manager );\n\n\t\t}\n\n\t\tthis.textureLoader.setCrossOrigin( this.options.crossOrigin );\n\t\tthis.textureLoader.setRequestHeader( this.options.requestHeader );\n\n\t\tthis.fileLoader = new FileLoader( this.options.manager );\n\t\tthis.fileLoader.setResponseType( 'arraybuffer' );\n\n\t\tif ( this.options.crossOrigin === 'use-credentials' ) {\n\n\t\t\tthis.fileLoader.setWithCredentials( true );\n\n\t\t}\n\n\t}\n\n\tsetExtensions( extensions ) {\n\n\t\tthis.extensions = extensions;\n\n\t}\n\n\tsetPlugins( plugins ) {\n\n\t\tthis.plugins = plugins;\n\n\t}\n\n\tparse( onLoad, onError ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\t// Clear the loader cache\n\t\tthis.cache.removeAll();\n\n\t\t// Mark the special nodes/meshes in json for efficient parse\n\t\tthis._invokeAll( function ( ext ) {\n\n\t\t\treturn ext._markDefs && ext._markDefs();\n\n\t\t} );\n\n\t\tPromise.all( this._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.beforeRoot && ext.beforeRoot();\n\n\t\t} ) ).then( function () {\n\n\t\t\treturn Promise.all( [\n\n\t\t\t\tparser.getDependencies( 'scene' ),\n\t\t\t\tparser.getDependencies( 'animation' ),\n\t\t\t\tparser.getDependencies( 'camera' ),\n\n\t\t\t] );\n\n\t\t} ).then( function ( dependencies ) {\n\n\t\t\tconst result = {\n\t\t\t\tscene: dependencies[ 0 ][ json.scene || 0 ],\n\t\t\t\tscenes: dependencies[ 0 ],\n\t\t\t\tanimations: dependencies[ 1 ],\n\t\t\t\tcameras: dependencies[ 2 ],\n\t\t\t\tasset: json.asset,\n\t\t\t\tparser: parser,\n\t\t\t\tuserData: {}\n\t\t\t};\n\n\t\t\taddUnknownExtensionsToUserData( extensions, result, json );\n\n\t\t\tassignExtrasToUserData( result, json );\n\n\t\t\tPromise.all( parser._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.afterRoot && ext.afterRoot( result );\n\n\t\t\t} ) ).then( function () {\n\n\t\t\t\tonLoad( result );\n\n\t\t\t} );\n\n\t\t} ).catch( onError );\n\n\t}\n\n\t/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */\n\t_markDefs() {\n\n\t\tconst nodeDefs = this.json.nodes || [];\n\t\tconst skinDefs = this.json.skins || [];\n\t\tconst meshDefs = this.json.meshes || [];\n\n\t\t// Nothing in the node definition indicates whether it is a Bone or an\n\t\t// Object3D. Use the skins' joint references to mark bones.\n\t\tfor ( let skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\n\n\t\t\tconst joints = skinDefs[ skinIndex ].joints;\n\n\t\t\tfor ( let i = 0, il = joints.length; i < il; i ++ ) {\n\n\t\t\t\tnodeDefs[ joints[ i ] ].isBone = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Iterate over all nodes, marking references to shared resources,\n\t\t// as well as skeleton joints.\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.meshCache, nodeDef.mesh );\n\n\t\t\t\t// Nothing in the mesh definition indicates whether it is\n\t\t\t\t// a SkinnedMesh or Mesh. Use the node's mesh reference\n\t\t\t\t// to mark SkinnedMesh if node has skin.\n\t\t\t\tif ( nodeDef.skin !== undefined ) {\n\n\t\t\t\t\tmeshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.cameraCache, nodeDef.camera );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Counts references to shared node / Object3D resources. These resources\n\t * can be reused, or \"instantiated\", at multiple nodes in the scene\n\t * hierarchy. Mesh, Camera, and Light instances are instantiated and must\n\t * be marked. Non-scenegraph resources (like Materials, Geometries, and\n\t * Textures) can be reused directly and are not marked here.\n\t *\n\t * Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t */\n\t_addNodeRef( cache, index ) {\n\n\t\tif ( index === undefined ) return;\n\n\t\tif ( cache.refs[ index ] === undefined ) {\n\n\t\t\tcache.refs[ index ] = cache.uses[ index ] = 0;\n\n\t\t}\n\n\t\tcache.refs[ index ] ++;\n\n\t}\n\n\t/** Returns a reference to a shared resource, cloning it if necessary. */\n\t_getNodeRef( cache, index, object ) {\n\n\t\tif ( cache.refs[ index ] <= 1 ) return object;\n\n\t\tconst ref = object.clone();\n\n\t\t// Propagates mappings to the cloned object, prevents mappings on the\n\t\t// original object from being lost.\n\t\tconst updateMappings = ( original, clone ) => {\n\n\t\t\tconst mappings = this.associations.get( original );\n\t\t\tif ( mappings != null ) {\n\n\t\t\t\tthis.associations.set( clone, mappings );\n\n\t\t\t}\n\n\t\t\tfor ( const [ i, child ] of original.children.entries() ) {\n\n\t\t\t\tupdateMappings( child, clone.children[ i ] );\n\n\t\t\t}\n\n\t\t};\n\n\t\tupdateMappings( object, ref );\n\n\t\tref.name += '_instance_' + ( cache.uses[ index ] ++ );\n\n\t\treturn ref;\n\n\t}\n\n\t_invokeOne( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.push( this );\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) return result;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t_invokeAll( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.unshift( this );\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) pending.push( result );\n\n\t\t}\n\n\t\treturn pending;\n\n\t}\n\n\t/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n\t */\n\tgetDependency( type, index ) {\n\n\t\tconst cacheKey = type + ':' + index;\n\t\tlet dependency = this.cache.get( cacheKey );\n\n\t\tif ( ! dependency ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'scene':\n\t\t\t\t\tdependency = this.loadScene( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'node':\n\t\t\t\t\tdependency = this.loadNode( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mesh':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMesh && ext.loadMesh( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'accessor':\n\t\t\t\t\tdependency = this.loadAccessor( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bufferView':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadBufferView && ext.loadBufferView( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdependency = this.loadBuffer( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'material':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMaterial && ext.loadMaterial( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'texture':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadTexture && ext.loadTexture( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'skin':\n\t\t\t\t\tdependency = this.loadSkin( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'animation':\n\t\t\t\t\tdependency = this.loadAnimation( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'camera':\n\t\t\t\t\tdependency = this.loadCamera( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error( 'Unknown type: ' + type );\n\n\t\t\t}\n\n\t\t\tthis.cache.add( cacheKey, dependency );\n\n\t\t}\n\n\t\treturn dependency;\n\n\t}\n\n\t/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */\n\tgetDependencies( type ) {\n\n\t\tlet dependencies = this.cache.get( type );\n\n\t\tif ( ! dependencies ) {\n\n\t\t\tconst parser = this;\n\t\t\tconst defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\n\n\t\t\tdependencies = Promise.all( defs.map( function ( def, index ) {\n\n\t\t\t\treturn parser.getDependency( type, index );\n\n\t\t\t} ) );\n\n\t\t\tthis.cache.add( type, dependencies );\n\n\t\t}\n\n\t\treturn dependencies;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBuffer( bufferIndex ) {\n\n\t\tconst bufferDef = this.json.buffers[ bufferIndex ];\n\t\tconst loader = this.fileLoader;\n\n\t\tif ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\n\n\t\t}\n\n\t\t// If present, GLB container is required to be the first buffer.\n\t\tif ( bufferDef.uri === undefined && bufferIndex === 0 ) {\n\n\t\t\treturn Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\n\n\t\t}\n\n\t\tconst options = this.options;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tloader.load( LoaderUtils.resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\n\n\t\t\t\treject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBufferView( bufferViewIndex ) {\n\n\t\tconst bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\n\n\t\treturn this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\n\n\t\t\tconst byteLength = bufferViewDef.byteLength || 0;\n\t\t\tconst byteOffset = bufferViewDef.byteOffset || 0;\n\t\t\treturn buffer.slice( byteOffset, byteOffset + byteLength );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n\t */\n\tloadAccessor( accessorIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst accessorDef = this.json.accessors[ accessorIndex ];\n\n\t\tif ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\n\n\t\t\t// Ignore empty accessors, which may be used to declare runtime\n\t\t\t// information about attributes coming from another source (e.g. Draco\n\t\t\t// compression extension).\n\t\t\treturn Promise.resolve( null );\n\n\t\t}\n\n\t\tconst pendingBufferViews = [];\n\n\t\tif ( accessorDef.bufferView !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\n\n\t\t} else {\n\n\t\t\tpendingBufferViews.push( null );\n\n\t\t}\n\n\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\n\n\t\t}\n\n\t\treturn Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\n\n\t\t\tconst bufferView = bufferViews[ 0 ];\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n\t\t\tconst elementBytes = TypedArray.BYTES_PER_ELEMENT;\n\t\t\tconst itemBytes = elementBytes * itemSize;\n\t\t\tconst byteOffset = accessorDef.byteOffset || 0;\n\t\t\tconst byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\n\t\t\tconst normalized = accessorDef.normalized === true;\n\t\t\tlet array, bufferAttribute;\n\n\t\t\t// The buffer is not interleaved if the stride is the item size in bytes.\n\t\t\tif ( byteStride && byteStride !== itemBytes ) {\n\n\t\t\t\t// Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n\t\t\t\t// This makes sure that IBA.count reflects accessor.count properly\n\t\t\t\tconst ibSlice = Math.floor( byteOffset / byteStride );\n\t\t\t\tconst ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType + ':' + ibSlice + ':' + accessorDef.count;\n\t\t\t\tlet ib = parser.cache.get( ibCacheKey );\n\n\t\t\t\tif ( ! ib ) {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, ibSlice * byteStride, accessorDef.count * byteStride / elementBytes );\n\n\t\t\t\t\t// Integer parameters to IB/IBA are in array elements, not bytes.\n\t\t\t\t\tib = new InterleavedBuffer( array, byteStride / elementBytes );\n\n\t\t\t\t\tparser.cache.add( ibCacheKey, ib );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( ib, itemSize, ( byteOffset % byteStride ) / elementBytes, normalized );\n\n\t\t\t} else {\n\n\t\t\t\tif ( bufferView === null ) {\n\n\t\t\t\t\tarray = new TypedArray( accessorDef.count * itemSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t\t\t}\n\n\t\t\t// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n\t\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\t\tconst itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n\t\t\t\tconst TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\n\n\t\t\t\tconst byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n\t\t\t\tconst byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n\t\t\t\tconst sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\n\t\t\t\tconst sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\n\n\t\t\t\tif ( bufferView !== null ) {\n\n\t\t\t\t\t// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n\t\t\t\t\tbufferAttribute = new BufferAttribute( bufferAttribute.array.slice(), bufferAttribute.itemSize, bufferAttribute.normalized );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0, il = sparseIndices.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst index = sparseIndices[ i ];\n\n\t\t\t\t\tbufferAttribute.setX( index, sparseValues[ i * itemSize ] );\n\t\t\t\t\tif ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\n\t\t\t\t\tif ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\n\t\t\t\t\tif ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\n\t\t\t\t\tif ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn bufferAttribute;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture>}\n\t */\n\tloadTexture( textureIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst source = json.images[ textureDef.source ];\n\n\t\tlet loader = this.textureLoader;\n\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.loadTextureImage( textureIndex, source, loader );\n\n\t}\n\n\tloadTextureImage( textureIndex, source, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tconst cacheKey = ( source.uri || source.bufferView ) + ':' + textureDef.sampler;\n\n\t\tif ( this.textureCache[ cacheKey ] ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21559.\n\t\t\treturn this.textureCache[ cacheKey ];\n\n\t\t}\n\n\t\tconst URL = self.URL || self.webkitURL;\n\n\t\tlet sourceURI = source.uri || '';\n\t\tlet isObjectURL = false;\n\n\t\tif ( source.bufferView !== undefined ) {\n\n\t\t\t// Load binary image data from bufferView, if provided.\n\n\t\t\tsourceURI = parser.getDependency( 'bufferView', source.bufferView ).then( function ( bufferView ) {\n\n\t\t\t\tisObjectURL = true;\n\t\t\t\tconst blob = new Blob( [ bufferView ], { type: source.mimeType } );\n\t\t\t\tsourceURI = URL.createObjectURL( blob );\n\t\t\t\treturn sourceURI;\n\n\t\t\t} );\n\n\t\t} else if ( source.uri === undefined ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Image ' + textureIndex + ' is missing URI and bufferView' );\n\n\t\t}\n\n\t\tconst promise = Promise.resolve( sourceURI ).then( function ( sourceURI ) {\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tlet onLoad = resolve;\n\n\t\t\t\tif ( loader.isImageBitmapLoader === true ) {\n\n\t\t\t\t\tonLoad = function ( imageBitmap ) {\n\n\t\t\t\t\t\tconst texture = new Texture( imageBitmap );\n\t\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\t\tresolve( texture );\n\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t\tloader.load( LoaderUtils.resolveURL( sourceURI, options.path ), onLoad, undefined, reject );\n\n\t\t\t} );\n\n\t\t} ).then( function ( texture ) {\n\n\t\t\t// Clean up resources and configure Texture.\n\n\t\t\tif ( isObjectURL === true ) {\n\n\t\t\t\tURL.revokeObjectURL( sourceURI );\n\n\t\t\t}\n\n\t\t\ttexture.flipY = false;\n\n\t\t\tif ( textureDef.name ) texture.name = textureDef.name;\n\n\t\t\tconst samplers = json.samplers || {};\n\t\t\tconst sampler = samplers[ textureDef.sampler ] || {};\n\n\t\t\ttexture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || LinearFilter;\n\t\t\ttexture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || LinearMipmapLinearFilter;\n\t\t\ttexture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || RepeatWrapping;\n\t\t\ttexture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || RepeatWrapping;\n\n\t\t\tparser.associations.set( texture, { textures: textureIndex } );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function () {\n\n\t\t\tconsole.error( 'THREE.GLTFLoader: Couldn\\'t load texture', sourceURI );\n\t\t\treturn null;\n\n\t\t} );\n\n\t\tthis.textureCache[ cacheKey ] = promise;\n\n\t\treturn promise;\n\n\t}\n\n\t/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @return {Promise<Texture>}\n\t */\n\tassignTexture( materialParams, mapName, mapDef ) {\n\n\t\tconst parser = this;\n\n\t\treturn this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\n\n\t\t\t// Materials sample aoMap from UV set 1 and other maps from UV set 0 - this can't be configured\n\t\t\t// However, we will copy UV set 0 to UV set 1 on demand for aoMap\n\t\t\tif ( mapDef.texCoord !== undefined && mapDef.texCoord != 0 && ! ( mapName === 'aoMap' && mapDef.texCoord == 1 ) ) {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Custom UV set ' + mapDef.texCoord + ' for texture ' + mapName + ' not yet supported.' );\n\n\t\t\t}\n\n\t\t\tif ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\n\n\t\t\t\tconst transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\n\n\t\t\t\tif ( transform ) {\n\n\t\t\t\t\tconst gltfReference = parser.associations.get( texture );\n\t\t\t\t\ttexture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\n\t\t\t\t\tparser.associations.set( texture, gltfReference );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tmaterialParams[ mapName ] = texture;\n\n\t\t\treturn texture;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Assigns final material to a Mesh, Line, or Points instance. The instance\n\t * already has a material (generated from the glTF material options alone)\n\t * but reuse of the same glTF material may require multiple threejs materials\n\t * to accommodate different primitive types, defines, etc. New materials will\n\t * be created if necessary, and reused from a cache.\n\t * @param  {Object3D} mesh Mesh, Line, or Points instance.\n\t */\n\tassignFinalMaterial( mesh ) {\n\n\t\tconst geometry = mesh.geometry;\n\t\tlet material = mesh.material;\n\n\t\tconst useDerivativeTangents = geometry.attributes.tangent === undefined;\n\t\tconst useVertexColors = geometry.attributes.color !== undefined;\n\t\tconst useFlatShading = geometry.attributes.normal === undefined;\n\n\t\tif ( mesh.isPoints ) {\n\n\t\t\tconst cacheKey = 'PointsMaterial:' + material.uuid;\n\n\t\t\tlet pointsMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! pointsMaterial ) {\n\n\t\t\t\tpointsMaterial = new PointsMaterial();\n\t\t\t\tMaterial.prototype.copy.call( pointsMaterial, material );\n\t\t\t\tpointsMaterial.color.copy( material.color );\n\t\t\t\tpointsMaterial.map = material.map;\n\t\t\t\tpointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\n\n\t\t\t\tthis.cache.add( cacheKey, pointsMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = pointsMaterial;\n\n\t\t} else if ( mesh.isLine ) {\n\n\t\t\tconst cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n\t\t\tlet lineMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! lineMaterial ) {\n\n\t\t\t\tlineMaterial = new LineBasicMaterial();\n\t\t\t\tMaterial.prototype.copy.call( lineMaterial, material );\n\t\t\t\tlineMaterial.color.copy( material.color );\n\n\t\t\t\tthis.cache.add( cacheKey, lineMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = lineMaterial;\n\n\t\t}\n\n\t\t// Clone the material if it will be modified\n\t\tif ( useDerivativeTangents || useVertexColors || useFlatShading ) {\n\n\t\t\tlet cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n\t\t\tif ( material.isGLTFSpecularGlossinessMaterial ) cacheKey += 'specular-glossiness:';\n\t\t\tif ( useDerivativeTangents ) cacheKey += 'derivative-tangents:';\n\t\t\tif ( useVertexColors ) cacheKey += 'vertex-colors:';\n\t\t\tif ( useFlatShading ) cacheKey += 'flat-shading:';\n\n\t\t\tlet cachedMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! cachedMaterial ) {\n\n\t\t\t\tcachedMaterial = material.clone();\n\n\t\t\t\tif ( useVertexColors ) cachedMaterial.vertexColors = true;\n\t\t\t\tif ( useFlatShading ) cachedMaterial.flatShading = true;\n\n\t\t\t\tif ( useDerivativeTangents ) {\n\n\t\t\t\t\t// https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n\t\t\t\t\tif ( cachedMaterial.normalScale ) cachedMaterial.normalScale.y *= - 1;\n\t\t\t\t\tif ( cachedMaterial.clearcoatNormalScale ) cachedMaterial.clearcoatNormalScale.y *= - 1;\n\n\t\t\t\t}\n\n\t\t\t\tthis.cache.add( cacheKey, cachedMaterial );\n\n\t\t\t\tthis.associations.set( cachedMaterial, this.associations.get( material ) );\n\n\t\t\t}\n\n\t\t\tmaterial = cachedMaterial;\n\n\t\t}\n\n\t\t// workarounds for mesh and geometry\n\n\t\tif ( material.aoMap && geometry.attributes.uv2 === undefined && geometry.attributes.uv !== undefined ) {\n\n\t\t\tgeometry.setAttribute( 'uv2', geometry.attributes.uv );\n\n\t\t}\n\n\t\tmesh.material = material;\n\n\t}\n\n\tgetMaterialType( /* materialIndex */ ) {\n\n\t\treturn MeshStandardMaterial;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<Material>}\n\t */\n\tloadMaterial( materialIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst materialDef = json.materials[ materialIndex ];\n\n\t\tlet materialType;\n\t\tconst materialParams = {};\n\t\tconst materialExtensions = materialDef.extensions || {};\n\n\t\tconst pending = [];\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ] ) {\n\n\t\t\tconst sgExtension = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ];\n\t\t\tmaterialType = sgExtension.getMaterialType();\n\t\t\tpending.push( sgExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else if ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\n\n\t\t\tconst kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\n\t\t\tmaterialType = kmuExtension.getMaterialType();\n\t\t\tpending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else {\n\n\t\t\t// Specification:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n\t\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n\t\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n\t\t\tmaterialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n\t\t\tif ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialType = this._invokeOne( function ( ext ) {\n\n\t\t\t\treturn ext.getMaterialType && ext.getMaterialType( materialIndex );\n\n\t\t\t} );\n\n\t\t\tpending.push( Promise.all( this._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.extendMaterialParams && ext.extendMaterialParams( materialIndex, materialParams );\n\n\t\t\t} ) ) );\n\n\t\t}\n\n\t\tif ( materialDef.doubleSided === true ) {\n\n\t\t\tmaterialParams.side = DoubleSide;\n\n\t\t}\n\n\t\tconst alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n\t\tif ( alphaMode === ALPHA_MODES.BLEND ) {\n\n\t\t\tmaterialParams.transparent = true;\n\n\t\t\t// See: https://github.com/mrdoob/three.js/issues/17706\n\t\t\tmaterialParams.depthWrite = false;\n\n\t\t} else {\n\n\t\t\tmaterialParams.format = RGBFormat;\n\t\t\tmaterialParams.transparent = false;\n\n\t\t\tif ( alphaMode === ALPHA_MODES.MASK ) {\n\n\t\t\t\tmaterialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\n\n\t\t\tmaterialParams.normalScale = new Vector2( 1, 1 );\n\n\t\t\tif ( materialDef.normalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = materialDef.normalTexture.scale;\n\n\t\t\t\tmaterialParams.normalScale.set( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\n\n\t\t\tif ( materialDef.occlusionTexture.strength !== undefined ) {\n\n\t\t\t\tmaterialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tmaterialParams.emissive = new Color().fromArray( materialDef.emissiveFactor );\n\n\t\t}\n\n\t\tif ( materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\tlet material;\n\n\t\t\tif ( materialType === GLTFMeshStandardSGMaterial ) {\n\n\t\t\t\tmaterial = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].createMaterial( materialParams );\n\n\t\t\t} else {\n\n\t\t\t\tmaterial = new materialType( materialParams );\n\n\t\t\t}\n\n\t\t\tif ( materialDef.name ) material.name = materialDef.name;\n\n\t\t\t// baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\n\t\t\tif ( material.map ) material.map.encoding = sRGBEncoding;\n\t\t\tif ( material.emissiveMap ) material.emissiveMap.encoding = sRGBEncoding;\n\n\t\t\tassignExtrasToUserData( material, materialDef );\n\n\t\t\tparser.associations.set( material, { materials: materialIndex } );\n\n\t\t\tif ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\n\n\t\t\treturn material;\n\n\t\t} );\n\n\t}\n\n\t/** When Object3D instances are targeted by animation, they need unique names. */\n\tcreateUniqueName( originalName ) {\n\n\t\tconst sanitizedName = PropertyBinding.sanitizeNodeName( originalName || '' );\n\n\t\tlet name = sanitizedName;\n\n\t\tfor ( let i = 1; this.nodeNamesUsed[ name ]; ++ i ) {\n\n\t\t\tname = sanitizedName + '_' + i;\n\n\t\t}\n\n\t\tthis.nodeNamesUsed[ name ] = true;\n\n\t\treturn name;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<BufferGeometry>>}\n\t */\n\tloadGeometries( primitives ) {\n\n\t\tconst parser = this;\n\t\tconst extensions = this.extensions;\n\t\tconst cache = this.primitiveCache;\n\n\t\tfunction createDracoPrimitive( primitive ) {\n\n\t\t\treturn extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\n\t\t\t\t.decodePrimitive( primitive, parser )\n\t\t\t\t.then( function ( geometry ) {\n\n\t\t\t\t\treturn addPrimitiveAttributes( geometry, primitive, parser );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst primitive = primitives[ i ];\n\t\t\tconst cacheKey = createPrimitiveKey( primitive );\n\n\t\t\t// See if we've already created this geometry\n\t\t\tconst cached = cache[ cacheKey ];\n\n\t\t\tif ( cached ) {\n\n\t\t\t\t// Use the cached geometry if it exists\n\t\t\t\tpending.push( cached.promise );\n\n\t\t\t} else {\n\n\t\t\t\tlet geometryPromise;\n\n\t\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\n\n\t\t\t\t\t// Use DRACO geometry if available\n\t\t\t\t\tgeometryPromise = createDracoPrimitive( primitive );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Otherwise create a new geometry\n\t\t\t\t\tgeometryPromise = addPrimitiveAttributes( new BufferGeometry(), primitive, parser );\n\n\t\t\t\t}\n\n\t\t\t\t// Cache this geometry\n\t\t\t\tcache[ cacheKey ] = { primitive: primitive, promise: geometryPromise };\n\n\t\t\t\tpending.push( geometryPromise );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<Group|Mesh|SkinnedMesh>}\n\t */\n\tloadMesh( meshIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\tconst meshDef = json.meshes[ meshIndex ];\n\t\tconst primitives = meshDef.primitives;\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst material = primitives[ i ].material === undefined\n\t\t\t\t? createDefaultMaterial( this.cache )\n\t\t\t\t: this.getDependency( 'material', primitives[ i ].material );\n\n\t\t\tpending.push( material );\n\n\t\t}\n\n\t\tpending.push( parser.loadGeometries( primitives ) );\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst materials = results.slice( 0, results.length - 1 );\n\t\t\tconst geometries = results[ results.length - 1 ];\n\n\t\t\tconst meshes = [];\n\n\t\t\tfor ( let i = 0, il = geometries.length; i < il; i ++ ) {\n\n\t\t\t\tconst geometry = geometries[ i ];\n\t\t\t\tconst primitive = primitives[ i ];\n\n\t\t\t\t// 1. create Mesh\n\n\t\t\t\tlet mesh;\n\n\t\t\t\tconst material = materials[ i ];\n\n\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n\t\t\t\t\t\tprimitive.mode === undefined ) {\n\n\t\t\t\t\t// .isSkinnedMesh isn't in glTF spec. See ._markDefs()\n\t\t\t\t\tmesh = meshDef.isSkinnedMesh === true\n\t\t\t\t\t\t? new SkinnedMesh( geometry, material )\n\t\t\t\t\t\t: new Mesh( geometry, material );\n\n\t\t\t\t\tif ( mesh.isSkinnedMesh === true && ! mesh.geometry.attributes.skinWeight.normalized ) {\n\n\t\t\t\t\t\t// we normalize floating point skin weight array to fix malformed assets (see #15319)\n\t\t\t\t\t\t// it's important to skip this for non-float32 data since normalizeSkinWeights assumes non-normalized inputs\n\t\t\t\t\t\tmesh.normalizeSkinWeights();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleStripDrawMode );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleFanDrawMode );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\n\n\t\t\t\t\tmesh = new LineSegments( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\n\n\t\t\t\t\tmesh = new Line( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\n\n\t\t\t\t\tmesh = new LineLoop( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\n\n\t\t\t\t\tmesh = new Points( geometry, material );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\n\n\t\t\t\t}\n\n\t\t\t\tif ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\n\n\t\t\t\t\tupdateMorphTargets( mesh, meshDef );\n\n\t\t\t\t}\n\n\t\t\t\tmesh.name = parser.createUniqueName( meshDef.name || ( 'mesh_' + meshIndex ) );\n\n\t\t\t\tassignExtrasToUserData( mesh, meshDef );\n\n\t\t\t\tif ( primitive.extensions ) addUnknownExtensionsToUserData( extensions, mesh, primitive );\n\n\t\t\t\tparser.assignFinalMaterial( mesh );\n\n\t\t\t\tmeshes.push( mesh );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tparser.associations.set( meshes[ i ], {\n\t\t\t\t\tmeshes: meshIndex,\n\t\t\t\t\tprimitives: i\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tif ( meshes.length === 1 ) {\n\n\t\t\t\treturn meshes[ 0 ];\n\n\t\t\t}\n\n\t\t\tconst group = new Group();\n\n\t\t\tparser.associations.set( group, { meshes: meshIndex } );\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tgroup.add( meshes[ i ] );\n\n\t\t\t}\n\n\t\t\treturn group;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */\n\tloadCamera( cameraIndex ) {\n\n\t\tlet camera;\n\t\tconst cameraDef = this.json.cameras[ cameraIndex ];\n\t\tconst params = cameraDef[ cameraDef.type ];\n\n\t\tif ( ! params ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( cameraDef.type === 'perspective' ) {\n\n\t\t\tcamera = new PerspectiveCamera( MathUtils.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\n\n\t\t} else if ( cameraDef.type === 'orthographic' ) {\n\n\t\t\tcamera = new OrthographicCamera( - params.xmag, params.xmag, params.ymag, - params.ymag, params.znear, params.zfar );\n\n\t\t}\n\n\t\tif ( cameraDef.name ) camera.name = this.createUniqueName( cameraDef.name );\n\n\t\tassignExtrasToUserData( camera, cameraDef );\n\n\t\treturn Promise.resolve( camera );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Object>}\n\t */\n\tloadSkin( skinIndex ) {\n\n\t\tconst skinDef = this.json.skins[ skinIndex ];\n\n\t\tconst skinEntry = { joints: skinDef.joints };\n\n\t\tif ( skinDef.inverseBindMatrices === undefined ) {\n\n\t\t\treturn Promise.resolve( skinEntry );\n\n\t\t}\n\n\t\treturn this.getDependency( 'accessor', skinDef.inverseBindMatrices ).then( function ( accessor ) {\n\n\t\t\tskinEntry.inverseBindMatrices = accessor;\n\n\t\t\treturn skinEntry;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<AnimationClip>}\n\t */\n\tloadAnimation( animationIndex ) {\n\n\t\tconst json = this.json;\n\n\t\tconst animationDef = json.animations[ animationIndex ];\n\n\t\tconst pendingNodes = [];\n\t\tconst pendingInputAccessors = [];\n\t\tconst pendingOutputAccessors = [];\n\t\tconst pendingSamplers = [];\n\t\tconst pendingTargets = [];\n\n\t\tfor ( let i = 0, il = animationDef.channels.length; i < il; i ++ ) {\n\n\t\t\tconst channel = animationDef.channels[ i ];\n\t\t\tconst sampler = animationDef.samplers[ channel.sampler ];\n\t\t\tconst target = channel.target;\n\t\t\tconst name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\n\t\t\tconst input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\n\t\t\tconst output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\n\n\t\t\tpendingNodes.push( this.getDependency( 'node', name ) );\n\t\t\tpendingInputAccessors.push( this.getDependency( 'accessor', input ) );\n\t\t\tpendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\n\t\t\tpendingSamplers.push( sampler );\n\t\t\tpendingTargets.push( target );\n\n\t\t}\n\n\t\treturn Promise.all( [\n\n\t\t\tPromise.all( pendingNodes ),\n\t\t\tPromise.all( pendingInputAccessors ),\n\t\t\tPromise.all( pendingOutputAccessors ),\n\t\t\tPromise.all( pendingSamplers ),\n\t\t\tPromise.all( pendingTargets )\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tconst nodes = dependencies[ 0 ];\n\t\t\tconst inputAccessors = dependencies[ 1 ];\n\t\t\tconst outputAccessors = dependencies[ 2 ];\n\t\t\tconst samplers = dependencies[ 3 ];\n\t\t\tconst targets = dependencies[ 4 ];\n\n\t\t\tconst tracks = [];\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst node = nodes[ i ];\n\t\t\t\tconst inputAccessor = inputAccessors[ i ];\n\t\t\t\tconst outputAccessor = outputAccessors[ i ];\n\t\t\t\tconst sampler = samplers[ i ];\n\t\t\t\tconst target = targets[ i ];\n\n\t\t\t\tif ( node === undefined ) continue;\n\n\t\t\t\tnode.updateMatrix();\n\t\t\t\tnode.matrixAutoUpdate = true;\n\n\t\t\t\tlet TypedKeyframeTrack;\n\n\t\t\t\tswitch ( PATH_PROPERTIES[ target.path ] ) {\n\n\t\t\t\t\tcase PATH_PROPERTIES.weights:\n\n\t\t\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.rotation:\n\n\t\t\t\t\t\tTypedKeyframeTrack = QuaternionKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.position:\n\t\t\t\t\tcase PATH_PROPERTIES.scale:\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tconst targetName = node.name ? node.name : node.uuid;\n\n\t\t\t\tconst interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : InterpolateLinear;\n\n\t\t\t\tconst targetNames = [];\n\n\t\t\t\tif ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\n\n\t\t\t\t\t// Node may be a Group (glTF mesh with several primitives) or a Mesh.\n\t\t\t\t\tnode.traverse( function ( object ) {\n\n\t\t\t\t\t\tif ( object.isMesh === true && object.morphTargetInfluences ) {\n\n\t\t\t\t\t\t\ttargetNames.push( object.name ? object.name : object.uuid );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttargetNames.push( targetName );\n\n\t\t\t\t}\n\n\t\t\t\tlet outputArray = outputAccessor.array;\n\n\t\t\t\tif ( outputAccessor.normalized ) {\n\n\t\t\t\t\tconst scale = getNormalizedComponentScale( outputArray.constructor );\n\t\t\t\t\tconst scaled = new Float32Array( outputArray.length );\n\n\t\t\t\t\tfor ( let j = 0, jl = outputArray.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tscaled[ j ] = outputArray[ j ] * scale;\n\n\t\t\t\t\t}\n\n\t\t\t\t\toutputArray = scaled;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let j = 0, jl = targetNames.length; j < jl; j ++ ) {\n\n\t\t\t\t\tconst track = new TypedKeyframeTrack(\n\t\t\t\t\t\ttargetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\n\t\t\t\t\t\tinputAccessor.array,\n\t\t\t\t\t\toutputArray,\n\t\t\t\t\t\tinterpolation\n\t\t\t\t\t);\n\n\t\t\t\t\t// Override interpolation with custom factory method.\n\t\t\t\t\tif ( sampler.interpolation === 'CUBICSPLINE' ) {\n\n\t\t\t\t\t\ttrack.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\n\n\t\t\t\t\t\t\t// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n\t\t\t\t\t\t\t// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n\t\t\t\t\t\t\t// must be divided by three to get the interpolant's sampleSize argument.\n\n\t\t\t\t\t\t\tconst interpolantType = ( this instanceof QuaternionKeyframeTrack ) ? GLTFCubicSplineQuaternionInterpolant : GLTFCubicSplineInterpolant;\n\n\t\t\t\t\t\t\treturn new interpolantType( this.times, this.values, this.getValueSize() / 3, result );\n\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n\t\t\t\t\t\ttrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttracks.push( track );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst name = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\n\n\t\t\treturn new AnimationClip( name, undefined, tracks );\n\n\t\t} );\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( nodeDef.mesh === undefined ) return null;\n\n\t\treturn parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\n\n\t\t\tconst node = parser._getNodeRef( parser.meshCache, nodeDef.mesh, mesh );\n\n\t\t\t// if weights are provided on the node, override weights on the mesh.\n\t\t\tif ( nodeDef.weights !== undefined ) {\n\n\t\t\t\tnode.traverse( function ( o ) {\n\n\t\t\t\t\tif ( ! o.isMesh ) return;\n\n\t\t\t\t\tfor ( let i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\t\t\to.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<Object3D>}\n\t */\n\tloadNode( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst parser = this;\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\t// reserve node's name before its dependencies, so the root has the intended name.\n\t\tconst nodeName = nodeDef.name ? parser.createUniqueName( nodeDef.name ) : '';\n\n\t\treturn ( function () {\n\n\t\t\tconst pending = [];\n\n\t\t\tconst meshPromise = parser._invokeOne( function ( ext ) {\n\n\t\t\t\treturn ext.createNodeMesh && ext.createNodeMesh( nodeIndex );\n\n\t\t\t} );\n\n\t\t\tif ( meshPromise ) {\n\n\t\t\t\tpending.push( meshPromise );\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\t\tpending.push( parser.getDependency( 'camera', nodeDef.camera ).then( function ( camera ) {\n\n\t\t\t\t\treturn parser._getNodeRef( parser.cameraCache, nodeDef.camera, camera );\n\n\t\t\t\t} ) );\n\n\t\t\t}\n\n\t\t\tparser._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.createNodeAttachment && ext.createNodeAttachment( nodeIndex );\n\n\t\t\t} ).forEach( function ( promise ) {\n\n\t\t\t\tpending.push( promise );\n\n\t\t\t} );\n\n\t\t\treturn Promise.all( pending );\n\n\t\t}() ).then( function ( objects ) {\n\n\t\t\tlet node;\n\n\t\t\t// .isBone isn't in glTF spec. See ._markDefs\n\t\t\tif ( nodeDef.isBone === true ) {\n\n\t\t\t\tnode = new Bone();\n\n\t\t\t} else if ( objects.length > 1 ) {\n\n\t\t\t\tnode = new Group();\n\n\t\t\t} else if ( objects.length === 1 ) {\n\n\t\t\t\tnode = objects[ 0 ];\n\n\t\t\t} else {\n\n\t\t\t\tnode = new Object3D();\n\n\t\t\t}\n\n\t\t\tif ( node !== objects[ 0 ] ) {\n\n\t\t\t\tfor ( let i = 0, il = objects.length; i < il; i ++ ) {\n\n\t\t\t\t\tnode.add( objects[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.name ) {\n\n\t\t\t\tnode.userData.name = nodeDef.name;\n\t\t\t\tnode.name = nodeName;\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( node, nodeDef );\n\n\t\t\tif ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\n\n\t\t\tif ( nodeDef.matrix !== undefined ) {\n\n\t\t\t\tconst matrix = new Matrix4();\n\t\t\t\tmatrix.fromArray( nodeDef.matrix );\n\t\t\t\tnode.applyMatrix4( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tif ( nodeDef.translation !== undefined ) {\n\n\t\t\t\t\tnode.position.fromArray( nodeDef.translation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.rotation !== undefined ) {\n\n\t\t\t\t\tnode.quaternion.fromArray( nodeDef.rotation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.scale !== undefined ) {\n\n\t\t\t\t\tnode.scale.fromArray( nodeDef.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( ! parser.associations.has( node ) ) {\n\n\t\t\t\tparser.associations.set( node, {} );\n\n\t\t\t}\n\n\t\t\tparser.associations.get( node ).nodes = nodeIndex;\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<Group>}\n\t */\n\tloadScene( sceneIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst sceneDef = this.json.scenes[ sceneIndex ];\n\t\tconst parser = this;\n\n\t\t// Loader returns Group, not Scene.\n\t\t// See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n\t\tconst scene = new Group();\n\t\tif ( sceneDef.name ) scene.name = parser.createUniqueName( sceneDef.name );\n\n\t\tassignExtrasToUserData( scene, sceneDef );\n\n\t\tif ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\n\n\t\tconst nodeIds = sceneDef.nodes || [];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = nodeIds.length; i < il; i ++ ) {\n\n\t\t\tpending.push( buildNodeHierarchy( nodeIds[ i ], scene, json, parser ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\t// Removes dangling associations, associations that reference a node that\n\t\t\t// didn't make it into the scene.\n\t\t\tconst reduceAssociations = ( node ) => {\n\n\t\t\t\tconst reducedAssociations = new Map();\n\n\t\t\t\tfor ( const [ key, value ] of parser.associations ) {\n\n\t\t\t\t\tif ( key instanceof Material || key instanceof Texture ) {\n\n\t\t\t\t\t\treducedAssociations.set( key, value );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tnode.traverse( ( node ) => {\n\n\t\t\t\t\tconst mappings = parser.associations.get( node );\n\n\t\t\t\t\tif ( mappings != null ) {\n\n\t\t\t\t\t\treducedAssociations.set( node, mappings );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\treturn reducedAssociations;\n\n\t\t\t};\n\n\t\t\tparser.associations = reduceAssociations( scene );\n\n\t\t\treturn scene;\n\n\t\t} );\n\n\t}\n\n}\n\nfunction buildNodeHierarchy( nodeId, parentObject, json, parser ) {\n\n\tconst nodeDef = json.nodes[ nodeId ];\n\n\treturn parser.getDependency( 'node', nodeId ).then( function ( node ) {\n\n\t\tif ( nodeDef.skin === undefined ) return node;\n\n\t\t// build skeleton here as well\n\n\t\tlet skinEntry;\n\n\t\treturn parser.getDependency( 'skin', nodeDef.skin ).then( function ( skin ) {\n\n\t\t\tskinEntry = skin;\n\n\t\t\tconst pendingJoints = [];\n\n\t\t\tfor ( let i = 0, il = skinEntry.joints.length; i < il; i ++ ) {\n\n\t\t\t\tpendingJoints.push( parser.getDependency( 'node', skinEntry.joints[ i ] ) );\n\n\t\t\t}\n\n\t\t\treturn Promise.all( pendingJoints );\n\n\t\t} ).then( function ( jointNodes ) {\n\n\t\t\tnode.traverse( function ( mesh ) {\n\n\t\t\t\tif ( ! mesh.isMesh ) return;\n\n\t\t\t\tconst bones = [];\n\t\t\t\tconst boneInverses = [];\n\n\t\t\t\tfor ( let j = 0, jl = jointNodes.length; j < jl; j ++ ) {\n\n\t\t\t\t\tconst jointNode = jointNodes[ j ];\n\n\t\t\t\t\tif ( jointNode ) {\n\n\t\t\t\t\t\tbones.push( jointNode );\n\n\t\t\t\t\t\tconst mat = new Matrix4();\n\n\t\t\t\t\t\tif ( skinEntry.inverseBindMatrices !== undefined ) {\n\n\t\t\t\t\t\t\tmat.fromArray( skinEntry.inverseBindMatrices.array, j * 16 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tboneInverses.push( mat );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinEntry.joints[ j ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tmesh.bind( new Skeleton( bones, boneInverses ), mesh.matrixWorld );\n\n\t\t\t} );\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t} ).then( function ( node ) {\n\n\t\t// build node hierachy\n\n\t\tparentObject.add( node );\n\n\t\tconst pending = [];\n\n\t\tif ( nodeDef.children ) {\n\n\t\t\tconst children = nodeDef.children;\n\n\t\t\tfor ( let i = 0, il = children.length; i < il; i ++ ) {\n\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tpending.push( buildNodeHierarchy( child, node, json, parser ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t} );\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n */\nfunction computeBounds( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst box = new Box3();\n\n\tif ( attributes.POSITION !== undefined ) {\n\n\t\tconst accessor = parser.json.accessors[ attributes.POSITION ];\n\n\t\tconst min = accessor.min;\n\t\tconst max = accessor.max;\n\n\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\tbox.set(\n\t\t\t\tnew Vector3( min[ 0 ], min[ 1 ], min[ 2 ] ),\n\t\t\t\tnew Vector3( max[ 0 ], max[ 1 ], max[ 2 ] )\n\t\t\t);\n\n\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\tbox.min.multiplyScalar( boxScale );\n\t\t\t\tbox.max.multiplyScalar( boxScale );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\treturn;\n\n\t\t}\n\n\t} else {\n\n\t\treturn;\n\n\t}\n\n\tconst targets = primitiveDef.targets;\n\n\tif ( targets !== undefined ) {\n\n\t\tconst maxDisplacement = new Vector3();\n\t\tconst vector = new Vector3();\n\n\t\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tconst target = targets[ i ];\n\n\t\t\tif ( target.POSITION !== undefined ) {\n\n\t\t\t\tconst accessor = parser.json.accessors[ target.POSITION ];\n\t\t\t\tconst min = accessor.min;\n\t\t\t\tconst max = accessor.max;\n\n\t\t\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\t\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\t\t\t// we need to get max of absolute components because target weight is [-1,1]\n\t\t\t\t\tvector.setX( Math.max( Math.abs( min[ 0 ] ), Math.abs( max[ 0 ] ) ) );\n\t\t\t\t\tvector.setY( Math.max( Math.abs( min[ 1 ] ), Math.abs( max[ 1 ] ) ) );\n\t\t\t\t\tvector.setZ( Math.max( Math.abs( min[ 2 ] ), Math.abs( max[ 2 ] ) ) );\n\n\n\t\t\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\t\t\tvector.multiplyScalar( boxScale );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n\t\t\t\t\t// to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n\t\t\t\t\t// are used to implement key-frame animations and as such only two are active at a time - this results in very large\n\t\t\t\t\t// boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n\t\t\t\t\tmaxDisplacement.max( vector );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n\t\tbox.expandByVector( maxDisplacement );\n\n\t}\n\n\tgeometry.boundingBox = box;\n\n\tconst sphere = new Sphere();\n\n\tbox.getCenter( sphere.center );\n\tsphere.radius = box.min.distanceTo( box.max ) / 2;\n\n\tgeometry.boundingSphere = sphere;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst pending = [];\n\n\tfunction assignAttributeAccessor( accessorIndex, attributeName ) {\n\n\t\treturn parser.getDependency( 'accessor', accessorIndex )\n\t\t\t.then( function ( accessor ) {\n\n\t\t\t\tgeometry.setAttribute( attributeName, accessor );\n\n\t\t\t} );\n\n\t}\n\n\tfor ( const gltfAttributeName in attributes ) {\n\n\t\tconst threeAttributeName = ATTRIBUTES[ gltfAttributeName ] || gltfAttributeName.toLowerCase();\n\n\t\t// Skip attributes already provided by e.g. Draco extension.\n\t\tif ( threeAttributeName in geometry.attributes ) continue;\n\n\t\tpending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\n\n\t}\n\n\tif ( primitiveDef.indices !== undefined && ! geometry.index ) {\n\n\t\tconst accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\n\n\t\t\tgeometry.setIndex( accessor );\n\n\t\t} );\n\n\t\tpending.push( accessor );\n\n\t}\n\n\tassignExtrasToUserData( geometry, primitiveDef );\n\n\tcomputeBounds( geometry, primitiveDef, parser );\n\n\treturn Promise.all( pending ).then( function () {\n\n\t\treturn primitiveDef.targets !== undefined\n\t\t\t? addMorphTargets( geometry, primitiveDef.targets, parser )\n\t\t\t: geometry;\n\n\t} );\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {Number} drawMode\n * @return {BufferGeometry}\n */\nfunction toTrianglesDrawMode( geometry, drawMode ) {\n\n\tlet index = geometry.getIndex();\n\n\t// generate index if not present\n\n\tif ( index === null ) {\n\n\t\tconst indices = [];\n\n\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tfor ( let i = 0; i < position.count; i ++ ) {\n\n\t\t\t\tindices.push( i );\n\n\t\t\t}\n\n\t\t\tgeometry.setIndex( indices );\n\t\t\tindex = geometry.getIndex();\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.' );\n\t\t\treturn geometry;\n\n\t\t}\n\n\t}\n\n\t//\n\n\tconst numberOfTriangles = index.count - 2;\n\tconst newIndices = [];\n\n\tif ( drawMode === TriangleFanDrawMode ) {\n\n\t\t// gl.TRIANGLE_FAN\n\n\t\tfor ( let i = 1; i <= numberOfTriangles; i ++ ) {\n\n\t\t\tnewIndices.push( index.getX( 0 ) );\n\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\n\t\t}\n\n\t} else {\n\n\t\t// gl.TRIANGLE_STRIP\n\n\t\tfor ( let i = 0; i < numberOfTriangles; i ++ ) {\n\n\t\t\tif ( i % 2 === 0 ) {\n\n\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\n\n\t\t\t} else {\n\n\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\tnewIndices.push( index.getX( i ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tif ( ( newIndices.length / 3 ) !== numberOfTriangles ) {\n\n\t\tconsole.error( 'THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.' );\n\n\t}\n\n\t// build final geometry\n\n\tconst newGeometry = geometry.clone();\n\tnewGeometry.setIndex( newIndices );\n\n\treturn newGeometry;\n\n}\n\nexport { GLTFLoader };\n","import { Material } from './Material.js';\nimport { MultiplyOperation } from '../constants.js';\nimport { Color } from '../math/Color.js';\n\n/**\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *\n *  map: new THREE.Texture( <Image> ),\n *\n *  lightMap: new THREE.Texture( <Image> ),\n *  lightMapIntensity: <float>\n *\n *  aoMap: new THREE.Texture( <Image> ),\n *  aoMapIntensity: <float>\n *\n *  emissive: <hex>,\n *  emissiveIntensity: <float>\n *  emissiveMap: new THREE.Texture( <Image> ),\n *\n *  specularMap: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\n *  combine: THREE.Multiply,\n *  reflectivity: <float>,\n *  refractionRatio: <float>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n *\n * }\n */\n\nclass MeshLambertMaterial extends Material {\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'MeshLambertMaterial';\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\treturn this;\n\n\t}\n\n}\n\nMeshLambertMaterial.prototype.isMeshLambertMaterial = true;\n\nexport { MeshLambertMaterial };\n","/*!\nfflate - fast JavaScript compression/decompression\n<https://101arrowz.github.io/fflate>\nLicensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE\nversion 0.6.9\n*/\n\n// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar durl = function (c) { return URL.createObjectURL(new Blob([c], { type: 'text/javascript' })); };\nvar cwk = function (u) { return new Worker(u); };\ntry {\n    URL.revokeObjectURL(durl(''));\n}\ncatch (e) {\n    // We're in Deno or a very old browser\n    durl = function (c) { return 'data:application/javascript;charset=UTF-8,' + encodeURI(c); };\n    // If Deno, this is necessary; if not, this changes nothing\n    cwk = function (u) { return new Worker(u, { type: 'module' }); };\n}\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = cwk(ch2[id] || (ch2[id] = durl(c)));\n    w.onerror = function (e) { return cb(e.error, null); };\n    w.onmessage = function (e) { return cb(null, e.data); };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, u32 = Uint32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\n// see fleb note\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new u32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return [b, r];\n};\nvar _a = freb(fleb, 2), fl = _a[0], revfl = _a[1];\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b[0], revfd = _b[1];\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >>> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >>> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >>> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >>> 8) | ((x & 0x00FF) << 8)) >>> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i)\n        ++l[cd[i] - 1];\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 0; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >>> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >>> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p / 8) | 0) + (p & 7 && 1); };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    var n = new (v instanceof u16 ? u16 : v instanceof u32 ? u32 : u8)(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, buf, st) {\n    // source length\n    var sl = dat.length;\n    if (!sl || (st && !st.l && sl < 5))\n        return buf || new u8(0);\n    // have to estimate size\n    var noBuf = !buf || st;\n    // no state\n    var noSt = !st || st.i;\n    if (!st)\n        st = {};\n    // Assumes roughly 33% compression ratio average\n    if (!buf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            st.f = final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                // ensure size\n                if (noBuf)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >>> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                throw 'invalid block type';\n            if (pos > tbts) {\n                if (noSt)\n                    throw 'unexpected EOF';\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17;\n        if (noBuf)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    throw 'unexpected EOF';\n                break;\n            }\n            if (!c)\n                throw 'invalid length/literal';\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n                if (!d)\n                    throw 'invalid distance';\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & ((1 << b) - 1), pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                if (noBuf)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                for (; bt < end; bt += 4) {\n                    buf[bt] = buf[bt - dt];\n                    buf[bt + 1] = buf[bt + 1 - dt];\n                    buf[bt + 2] = buf[bt + 2 - dt];\n                    buf[bt + 3] = buf[bt + 3 - dt];\n                }\n                bt = end;\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n    d[o + 2] |= v >>> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return [et, 0];\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return [v, 1];\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return [new u8(tr), mbt];\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return [cl.subarray(0, cli), s];\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >>> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a[0], mlb = _a[1];\n    var _b = hTree(df, 15), ddt = _b[0], mdb = _b[1];\n    var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n    var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        lcfreq[lclt[i] & 31]++;\n    for (var i = 0; i < lcdt.length; ++i)\n        lcfreq[lcdt[i] & 31]++;\n    var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n    if (flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >>> 5) & 127), p += clct[i] >>> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        if (syms[i] > 255) {\n            var len = (syms[i] >>> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (syms[i] >>> 23) & 31), p += fleb[len];\n            var dst = syms[i] & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (syms[i] >>> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n    var s = dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var pos = 0;\n    if (!lvl || s < 8) {\n        for (var i = 0; i <= s; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e < s) {\n                // write full block\n                pos = wfblk(w, pos, dat.subarray(i, e));\n            }\n            else {\n                // write final block\n                w[i] = lst;\n                pos = wfblk(w, pos, dat.subarray(i, s));\n            }\n        }\n    }\n    else {\n        var opt = deo[lvl - 1];\n        var n = opt >>> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = new u16(32768), head = new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new u32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index  l/lind  waitdx  bitpos\n        var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n        for (; i < s; ++i) {\n            // hash value\n            // deopt when i > s - 3 - at end, deopt acceptable\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && rem > 423) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = (imod - pimod) & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = (i - dif + j + 32768) & 32767;\n                                    var pti = prev[ti];\n                                    var cd = (ti - pti + 32768) & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += (imod - pimod + 32768) & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one Uint32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        // this is the easiest way to avoid needing to maintain state\n        if (!lst && pos & 7)\n            pos = wfblk(w, pos + 1, et);\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new u32(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && 0xEDB88320) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Alder32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a >>> 8) << 16 | (b & 255) << 8 | (b >>> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, !st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/ /g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return [fnStr, td];\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k] instanceof u8 || v[k] instanceof u16 || v[k] instanceof u32)\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    var _a;\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            _a = wcln(fns[i], fnStr, td_1), fnStr = _a[0], td_1 = _a[1];\n        ch[id] = wcln(fns[m], fnStr, td_1);\n    }\n    var td = mrg({}, ch[id][1]);\n    return wk(ch[id][0] + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, u32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, hMap, max, bits, bits16, shft, slc, inflt, inflateSync, pbf, gu8]; };\nvar bDflt = function () { return [u8, u16, u32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zlv]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get u8\nvar gu8 = function (o) { return o && o.size && new u8(o.size); };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (t)\n            throw 'stream finished';\n        if (!strm.ondata)\n            throw 'no stream handler';\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        throw 'invalid gzip data';\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += d[10] | (d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return ((d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16) | (d[l - 1] << 24)) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + ((o.filename && (o.filename.length + 1)) || 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (fl ? (32 - 2 * fl) : 1);\n};\n// zlib valid\nvar zlv = function (d) {\n    if ((d[0] & 15) != 8 || (d[0] >>> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        throw 'invalid zlib data';\n    if (d[1] & 32)\n        throw 'invalid zlib data: preset dictionaries not supported';\n};\nfunction AsyncCmpStrm(opts, cb) {\n    if (!cb && typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n// zlib footer: -4 to -0 is Adler32\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (!cb && typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, !f), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        this.d = final;\n        this.p(chunk, final || false);\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an inflation stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Inflate(cb) {\n        this.s = {};\n        this.p = new u8(0);\n        this.ondata = cb;\n    }\n    Inflate.prototype.e = function (c) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        var l = this.p.length;\n        var n = new u8(l + c.length);\n        n.set(this.p), n.set(c, l), this.p = n;\n    };\n    Inflate.prototype.c = function (final) {\n        this.d = this.s.i = final || false;\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.o, this.s);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous inflation stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncInflate(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, 0, function () {\n            var strm = new Inflate();\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gu8(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, out) {\n    return inflt(data, out);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        this.c.p(c);\n        this.l += c.length;\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, !f);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a GUNZIP stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Gunzip(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            var s = this.p.length > 3 ? gzs(this.p) : 4;\n            if (s >= this.p.length && !final)\n                return;\n            this.p = this.p.subarray(s), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 8)\n                throw 'invalid gzip stream';\n            this.p = this.p.subarray(0, -8);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous GUNZIP stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncGunzip(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, 0, function () {\n            var strm = new Gunzip();\n            onmessage = astrm(strm);\n        }, 9);\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param out Where to write the data. GZIP already encodes the output size, so providing this doesn't save memory.\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, out) {\n    return inflt(data.subarray(gzs(data), -8), out || new u8(gzl(data)));\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        this.c.p(c);\n        var raw = dopt(c, this.o, this.v && 2, f && 4, !f);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates a Zlib decompression stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Unzlib(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 2 && !final)\n                return;\n            this.p = this.p.subarray(2), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                throw 'invalid zlib stream';\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous Zlib decompression stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncUnzlib(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, 0, function () {\n            var strm = new Unzlib();\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gu8(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, out) {\n    return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    /**\n     * Creates a decompression stream\n     * @param cb The callback to call whenever data is decompressed\n     */\n    function Decompress(cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no stream handler';\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_1 = this;\n                var cb = function () { _this_1.ondata.apply(_this_1, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(cb)\n                        : new this.Z(cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    /**\n   * Creates an asynchronous decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n    function AsyncDecompress(cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, out) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, out)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, out)\n            : unzlibSync(data, out);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k;\n        if (val instanceof u8)\n            t[n] = [val, o];\n        else if (Array.isArray(val))\n            t[n] = [val[0], mrg(o, val[1])];\n        else\n            fltn(val, n + '/', t, o);\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return [r, slc(d, i - 1)];\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback';\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    throw 'invalid utf-8 data';\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            throw 'stream finished';\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), ch = _a[0], np = _a[1];\n        if (final) {\n            if (np.length)\n                throw 'invalid utf-8 data';\n            this.p = null;\n        }\n        else\n            this.p = np;\n        this.ondata(ch, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback';\n        if (this.d)\n            throw 'stream finished';\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td)\n        return td.decode(dat);\n    else {\n        var _a = dutf8(dat), out = _a[0], ext = _a[1];\n        if (ext.length)\n            throw 'invalid utf-8 data';\n        return out;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                throw 'extra field too long';\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c == null && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        throw 'date not in range 1980-2099';\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >>> 1)), b += 4;\n    if (c != null) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback - add to ZIP archive before pushing';\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this_1.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this_1 = this;\n        if (this.d & 2)\n            throw 'stream finished';\n        var f = strToU8(file.filename), fl = f.length;\n        var com = file.comment, o = com && strToU8(com);\n        var u = fl != file.filename.length || (o && (com.length != o.length));\n        var hl = fl + exfl(file.extra) + 30;\n        if (fl > 65535)\n            throw 'filename too long';\n        var header = new u8(hl);\n        wzh(header, 0, file, f, u);\n        var chks = [header];\n        var pAll = function () {\n            for (var _i = 0, chks_1 = chks; _i < chks_1.length; _i++) {\n                var chk = chks_1[_i];\n                _this_1.ondata(null, chk, false);\n            }\n            chks = [];\n        };\n        var tr = this.d;\n        this.d = 0;\n        var ind = this.u.length;\n        var uf = mrg(file, {\n            f: f,\n            u: u,\n            o: o,\n            t: function () {\n                if (file.terminate)\n                    file.terminate();\n            },\n            r: function () {\n                pAll();\n                if (tr) {\n                    var nxt = _this_1.u[ind + 1];\n                    if (nxt)\n                        nxt.r();\n                    else\n                        _this_1.d = 1;\n                }\n                tr = 1;\n            }\n        });\n        var cl = 0;\n        file.ondata = function (err, dat, final) {\n            if (err) {\n                _this_1.ondata(err, dat, final);\n                _this_1.terminate();\n            }\n            else {\n                cl += dat.length;\n                chks.push(dat);\n                if (final) {\n                    var dd = new u8(16);\n                    wbytes(dd, 0, 0x8074B50);\n                    wbytes(dd, 4, file.crc);\n                    wbytes(dd, 8, cl);\n                    wbytes(dd, 12, file.size);\n                    chks.push(dd);\n                    uf.c = cl, uf.b = hl + cl + 16, uf.crc = file.crc, uf.size = file.size;\n                    if (tr)\n                        uf.r();\n                    tr = 1;\n                }\n                else if (tr)\n                    pAll();\n            }\n        };\n        this.u.push(uf);\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this_1 = this;\n        if (this.d & 2) {\n            if (this.d & 1)\n                throw 'stream finishing';\n            throw 'stream finished';\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this_1.d & 1))\n                        return;\n                    _this_1.u.splice(-1, 1);\n                    _this_1.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, f.c, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cb(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cb(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl('filename too long', null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            throw 'filename too long';\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this_1 = this;\n        this.i = new Inflate(function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, data, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this_1 = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this_1.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this_1.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this_1 = this;\n        if (!this.onfile)\n            throw 'no callback';\n        if (!this.p)\n            throw 'stream finished';\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_2 = [];\n                        this_1.k.unshift(chks_2);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    throw 'no callback';\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this_1.o[cmp_1];\n                                    if (!ctr)\n                                        throw 'unknown compression type ' + cmp_1;\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_3 = chks_2; _i < chks_3.length; _i++) {\n                                        var dat = chks_3[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this_1.k[0] == chks_2 && _this_1.c)\n                                        _this_1.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                throw 'invalid zip file';\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\n/**\n * Asynchronously decompresses a ZIP archive\n * @param data The raw compressed ZIP file\n * @param cb The callback to call with the decompressed files\n * @returns A function that can be used to immediately terminate the unzipping\n */\nexport function unzip(data, cb) {\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cb('invalid zip file', null);\n            return;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (!lft)\n        cb(null, {});\n    var c = lft;\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50) {\n            cb('invalid zip file', null);\n            return;\n        }\n        c = lft = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    var _loop_3 = function (i) {\n        var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                files[fn] = d;\n                if (!--lft)\n                    cb(null, files);\n            }\n        };\n        if (!c_1)\n            cbl(null, slc(data, b, b + sc));\n        else if (c_1 == 8) {\n            var infl = data.subarray(b, b + sc);\n            if (sc < 320000) {\n                try {\n                    cbl(null, inflateSync(infl, new u8(su)));\n                }\n                catch (e) {\n                    cbl(e, null);\n                }\n            }\n            else\n                term.push(inflate(infl, { size: su }, cbl));\n        }\n        else\n            cbl('unknown compression type ' + c_1, null);\n    };\n    for (var i = 0; i < c; ++i) {\n        _loop_3(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @returns The decompressed files\n */\nexport function unzipSync(data) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            throw 'invalid zip file';\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50)\n            throw 'invalid zip file';\n        c = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!c_2)\n            files[fn] = slc(data, b, b + sc);\n        else if (c_2 == 8)\n            files[fn] = inflateSync(data.subarray(b, b + sc), new u8(su));\n        else\n            throw 'unknown compression type ' + c_2;\n    }\n    return files;\n}\n","import * as MathUtils from '../../math/MathUtils.js';\nimport { Vector2 } from '../../math/Vector2.js';\nimport { Vector3 } from '../../math/Vector3.js';\nimport { Matrix4 } from '../../math/Matrix4.js';\n\n/**\n * Extensible curve object.\n *\n * Some common of curve methods:\n * .getPoint( t, optionalTarget ), .getTangent( t, optionalTarget )\n * .getPointAt( u, optionalTarget ), .getTangentAt( u, optionalTarget )\n * .getPoints(), .getSpacedPoints()\n * .getLength()\n * .updateArcLengths()\n *\n * This following curves inherit from THREE.Curve:\n *\n * -- 2D curves --\n * THREE.ArcCurve\n * THREE.CubicBezierCurve\n * THREE.EllipseCurve\n * THREE.LineCurve\n * THREE.QuadraticBezierCurve\n * THREE.SplineCurve\n *\n * -- 3D curves --\n * THREE.CatmullRomCurve3\n * THREE.CubicBezierCurve3\n * THREE.LineCurve3\n * THREE.QuadraticBezierCurve3\n *\n * A series of curves can be represented as a THREE.CurvePath.\n *\n **/\n\nclass Curve {\n\n\tconstructor() {\n\n\t\tthis.type = 'Curve';\n\n\t\tthis.arcLengthDivisions = 200;\n\n\t}\n\n\t// Virtual base class method to overwrite and implement in subclasses\n\t//\t- t [0 .. 1]\n\n\tgetPoint( /* t, optionalTarget */ ) {\n\n\t\tconsole.warn( 'THREE.Curve: .getPoint() not implemented.' );\n\t\treturn null;\n\n\t}\n\n\t// Get point at relative position in curve according to arc length\n\t// - u [0 .. 1]\n\n\tgetPointAt( u, optionalTarget ) {\n\n\t\tconst t = this.getUtoTmapping( u );\n\t\treturn this.getPoint( t, optionalTarget );\n\n\t}\n\n\t// Get sequence of points using getPoint( t )\n\n\tgetPoints( divisions = 5 ) {\n\n\t\tconst points = [];\n\n\t\tfor ( let d = 0; d <= divisions; d ++ ) {\n\n\t\t\tpoints.push( this.getPoint( d / divisions ) );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\t// Get sequence of points using getPointAt( u )\n\n\tgetSpacedPoints( divisions = 5 ) {\n\n\t\tconst points = [];\n\n\t\tfor ( let d = 0; d <= divisions; d ++ ) {\n\n\t\t\tpoints.push( this.getPointAt( d / divisions ) );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\t// Get total curve arc length\n\n\tgetLength() {\n\n\t\tconst lengths = this.getLengths();\n\t\treturn lengths[ lengths.length - 1 ];\n\n\t}\n\n\t// Get list of cumulative segment lengths\n\n\tgetLengths( divisions = this.arcLengthDivisions ) {\n\n\t\tif ( this.cacheArcLengths &&\n\t\t\t( this.cacheArcLengths.length === divisions + 1 ) &&\n\t\t\t! this.needsUpdate ) {\n\n\t\t\treturn this.cacheArcLengths;\n\n\t\t}\n\n\t\tthis.needsUpdate = false;\n\n\t\tconst cache = [];\n\t\tlet current, last = this.getPoint( 0 );\n\t\tlet sum = 0;\n\n\t\tcache.push( 0 );\n\n\t\tfor ( let p = 1; p <= divisions; p ++ ) {\n\n\t\t\tcurrent = this.getPoint( p / divisions );\n\t\t\tsum += current.distanceTo( last );\n\t\t\tcache.push( sum );\n\t\t\tlast = current;\n\n\t\t}\n\n\t\tthis.cacheArcLengths = cache;\n\n\t\treturn cache; // { sums: cache, sum: sum }; Sum is in the last element.\n\n\t}\n\n\tupdateArcLengths() {\n\n\t\tthis.needsUpdate = true;\n\t\tthis.getLengths();\n\n\t}\n\n\t// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equidistant\n\n\tgetUtoTmapping( u, distance ) {\n\n\t\tconst arcLengths = this.getLengths();\n\n\t\tlet i = 0;\n\t\tconst il = arcLengths.length;\n\n\t\tlet targetArcLength; // The targeted u distance value to get\n\n\t\tif ( distance ) {\n\n\t\t\ttargetArcLength = distance;\n\n\t\t} else {\n\n\t\t\ttargetArcLength = u * arcLengths[ il - 1 ];\n\n\t\t}\n\n\t\t// binary search for the index with largest value smaller than target u distance\n\n\t\tlet low = 0, high = il - 1, comparison;\n\n\t\twhile ( low <= high ) {\n\n\t\t\ti = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\n\n\t\t\tcomparison = arcLengths[ i ] - targetArcLength;\n\n\t\t\tif ( comparison < 0 ) {\n\n\t\t\t\tlow = i + 1;\n\n\t\t\t} else if ( comparison > 0 ) {\n\n\t\t\t\thigh = i - 1;\n\n\t\t\t} else {\n\n\t\t\t\thigh = i;\n\t\t\t\tbreak;\n\n\t\t\t\t// DONE\n\n\t\t\t}\n\n\t\t}\n\n\t\ti = high;\n\n\t\tif ( arcLengths[ i ] === targetArcLength ) {\n\n\t\t\treturn i / ( il - 1 );\n\n\t\t}\n\n\t\t// we could get finer grain at lengths, or use simple interpolation between two points\n\n\t\tconst lengthBefore = arcLengths[ i ];\n\t\tconst lengthAfter = arcLengths[ i + 1 ];\n\n\t\tconst segmentLength = lengthAfter - lengthBefore;\n\n\t\t// determine where we are between the 'before' and 'after' points\n\n\t\tconst segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\n\n\t\t// add that fractional amount to t\n\n\t\tconst t = ( i + segmentFraction ) / ( il - 1 );\n\n\t\treturn t;\n\n\t}\n\n\t// Returns a unit vector tangent at t\n\t// In case any sub curve does not implement its tangent derivation,\n\t// 2 points a small delta apart will be used to find its gradient\n\t// which seems to give a reasonable approximation\n\n\tgetTangent( t, optionalTarget ) {\n\n\t\tconst delta = 0.0001;\n\t\tlet t1 = t - delta;\n\t\tlet t2 = t + delta;\n\n\t\t// Capping in case of danger\n\n\t\tif ( t1 < 0 ) t1 = 0;\n\t\tif ( t2 > 1 ) t2 = 1;\n\n\t\tconst pt1 = this.getPoint( t1 );\n\t\tconst pt2 = this.getPoint( t2 );\n\n\t\tconst tangent = optionalTarget || ( ( pt1.isVector2 ) ? new Vector2() : new Vector3() );\n\n\t\ttangent.copy( pt2 ).sub( pt1 ).normalize();\n\n\t\treturn tangent;\n\n\t}\n\n\tgetTangentAt( u, optionalTarget ) {\n\n\t\tconst t = this.getUtoTmapping( u );\n\t\treturn this.getTangent( t, optionalTarget );\n\n\t}\n\n\tcomputeFrenetFrames( segments, closed ) {\n\n\t\t// see http://www.cs.indiana.edu/pub/techreports/TR425.pdf\n\n\t\tconst normal = new Vector3();\n\n\t\tconst tangents = [];\n\t\tconst normals = [];\n\t\tconst binormals = [];\n\n\t\tconst vec = new Vector3();\n\t\tconst mat = new Matrix4();\n\n\t\t// compute the tangent vectors for each segment on the curve\n\n\t\tfor ( let i = 0; i <= segments; i ++ ) {\n\n\t\t\tconst u = i / segments;\n\n\t\t\ttangents[ i ] = this.getTangentAt( u, new Vector3() );\n\n\t\t}\n\n\t\t// select an initial normal vector perpendicular to the first tangent vector,\n\t\t// and in the direction of the minimum tangent xyz component\n\n\t\tnormals[ 0 ] = new Vector3();\n\t\tbinormals[ 0 ] = new Vector3();\n\t\tlet min = Number.MAX_VALUE;\n\t\tconst tx = Math.abs( tangents[ 0 ].x );\n\t\tconst ty = Math.abs( tangents[ 0 ].y );\n\t\tconst tz = Math.abs( tangents[ 0 ].z );\n\n\t\tif ( tx <= min ) {\n\n\t\t\tmin = tx;\n\t\t\tnormal.set( 1, 0, 0 );\n\n\t\t}\n\n\t\tif ( ty <= min ) {\n\n\t\t\tmin = ty;\n\t\t\tnormal.set( 0, 1, 0 );\n\n\t\t}\n\n\t\tif ( tz <= min ) {\n\n\t\t\tnormal.set( 0, 0, 1 );\n\n\t\t}\n\n\t\tvec.crossVectors( tangents[ 0 ], normal ).normalize();\n\n\t\tnormals[ 0 ].crossVectors( tangents[ 0 ], vec );\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] );\n\n\n\t\t// compute the slowly-varying normal and binormal vectors for each segment on the curve\n\n\t\tfor ( let i = 1; i <= segments; i ++ ) {\n\n\t\t\tnormals[ i ] = normals[ i - 1 ].clone();\n\n\t\t\tbinormals[ i ] = binormals[ i - 1 ].clone();\n\n\t\t\tvec.crossVectors( tangents[ i - 1 ], tangents[ i ] );\n\n\t\t\tif ( vec.length() > Number.EPSILON ) {\n\n\t\t\t\tvec.normalize();\n\n\t\t\t\tconst theta = Math.acos( MathUtils.clamp( tangents[ i - 1 ].dot( tangents[ i ] ), - 1, 1 ) ); // clamp for floating pt errors\n\n\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( vec, theta ) );\n\n\t\t\t}\n\n\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\n\n\t\t}\n\n\t\t// if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\n\n\t\tif ( closed === true ) {\n\n\t\t\tlet theta = Math.acos( MathUtils.clamp( normals[ 0 ].dot( normals[ segments ] ), - 1, 1 ) );\n\t\t\ttheta /= segments;\n\n\t\t\tif ( tangents[ 0 ].dot( vec.crossVectors( normals[ 0 ], normals[ segments ] ) ) > 0 ) {\n\n\t\t\t\ttheta = - theta;\n\n\t\t\t}\n\n\t\t\tfor ( let i = 1; i <= segments; i ++ ) {\n\n\t\t\t\t// twist a little...\n\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( tangents[ i ], theta * i ) );\n\t\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\ttangents: tangents,\n\t\t\tnormals: normals,\n\t\t\tbinormals: binormals\n\t\t};\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.arcLengthDivisions = source.arcLengthDivisions;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.5,\n\t\t\t\ttype: 'Curve',\n\t\t\t\tgenerator: 'Curve.toJSON'\n\t\t\t}\n\t\t};\n\n\t\tdata.arcLengthDivisions = this.arcLengthDivisions;\n\t\tdata.type = this.type;\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tthis.arcLengthDivisions = json.arcLengthDivisions;\n\n\t\treturn this;\n\n\t}\n\n}\n\n\nexport { Curve };\n","import {\n\tVector3,\n\tVector4\n} from 'three';\n\n/**\n * NURBS utils\n *\n * See NURBSCurve and NURBSSurface.\n **/\n\n\n/**************************************************************\n *\tNURBS Utils\n **************************************************************/\n\n/*\nFinds knot vector span.\n\np : degree\nu : parametric value\nU : knot vector\n\nreturns the span\n*/\nfunction findSpan( p, u, U ) {\n\n\tconst n = U.length - p - 1;\n\n\tif ( u >= U[ n ] ) {\n\n\t\treturn n - 1;\n\n\t}\n\n\tif ( u <= U[ p ] ) {\n\n\t\treturn p;\n\n\t}\n\n\tlet low = p;\n\tlet high = n;\n\tlet mid = Math.floor( ( low + high ) / 2 );\n\n\twhile ( u < U[ mid ] || u >= U[ mid + 1 ] ) {\n\n\t\tif ( u < U[ mid ] ) {\n\n\t\t\thigh = mid;\n\n\t\t} else {\n\n\t\t\tlow = mid;\n\n\t\t}\n\n\t\tmid = Math.floor( ( low + high ) / 2 );\n\n\t}\n\n\treturn mid;\n\n}\n\n\n/*\nCalculate basis functions. See The NURBS Book, page 70, algorithm A2.2\n\nspan : span in which u lies\nu    : parametric point\np    : degree\nU    : knot vector\n\nreturns array[p+1] with basis functions values.\n*/\nfunction calcBasisFunctions( span, u, p, U ) {\n\n\tconst N = [];\n\tconst left = [];\n\tconst right = [];\n\tN[ 0 ] = 1.0;\n\n\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\tleft[ j ] = u - U[ span + 1 - j ];\n\t\tright[ j ] = U[ span + j ] - u;\n\n\t\tlet saved = 0.0;\n\n\t\tfor ( let r = 0; r < j; ++ r ) {\n\n\t\t\tconst rv = right[ r + 1 ];\n\t\t\tconst lv = left[ j - r ];\n\t\t\tconst temp = N[ r ] / ( rv + lv );\n\t\t\tN[ r ] = saved + rv * temp;\n\t\t\tsaved = lv * temp;\n\n\t\t}\n\n\t\tN[ j ] = saved;\n\n\t}\n\n\treturn N;\n\n}\n\n\n/*\nCalculate B-Spline curve points. See The NURBS Book, page 82, algorithm A3.1.\n\np : degree of B-Spline\nU : knot vector\nP : control points (x, y, z, w)\nu : parametric point\n\nreturns point for given u\n*/\nfunction calcBSplinePoint( p, U, P, u ) {\n\n\tconst span = findSpan( p, u, U );\n\tconst N = calcBasisFunctions( span, u, p, U );\n\tconst C = new Vector4( 0, 0, 0, 0 );\n\n\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\tconst point = P[ span - p + j ];\n\t\tconst Nj = N[ j ];\n\t\tconst wNj = point.w * Nj;\n\t\tC.x += point.x * wNj;\n\t\tC.y += point.y * wNj;\n\t\tC.z += point.z * wNj;\n\t\tC.w += point.w * Nj;\n\n\t}\n\n\treturn C;\n\n}\n\n\n/*\nCalculate basis functions derivatives. See The NURBS Book, page 72, algorithm A2.3.\n\nspan : span in which u lies\nu    : parametric point\np    : degree\nn    : number of derivatives to calculate\nU    : knot vector\n\nreturns array[n+1][p+1] with basis functions derivatives\n*/\nfunction calcBasisFunctionDerivatives( span, u, p, n, U ) {\n\n\tconst zeroArr = [];\n\tfor ( let i = 0; i <= p; ++ i )\n\t\tzeroArr[ i ] = 0.0;\n\n\tconst ders = [];\n\n\tfor ( let i = 0; i <= n; ++ i )\n\t\tders[ i ] = zeroArr.slice( 0 );\n\n\tconst ndu = [];\n\n\tfor ( let i = 0; i <= p; ++ i )\n\t\tndu[ i ] = zeroArr.slice( 0 );\n\n\tndu[ 0 ][ 0 ] = 1.0;\n\n\tconst left = zeroArr.slice( 0 );\n\tconst right = zeroArr.slice( 0 );\n\n\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\tleft[ j ] = u - U[ span + 1 - j ];\n\t\tright[ j ] = U[ span + j ] - u;\n\n\t\tlet saved = 0.0;\n\n\t\tfor ( let r = 0; r < j; ++ r ) {\n\n\t\t\tconst rv = right[ r + 1 ];\n\t\t\tconst lv = left[ j - r ];\n\t\t\tndu[ j ][ r ] = rv + lv;\n\n\t\t\tconst temp = ndu[ r ][ j - 1 ] / ndu[ j ][ r ];\n\t\t\tndu[ r ][ j ] = saved + rv * temp;\n\t\t\tsaved = lv * temp;\n\n\t\t}\n\n\t\tndu[ j ][ j ] = saved;\n\n\t}\n\n\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\tders[ 0 ][ j ] = ndu[ j ][ p ];\n\n\t}\n\n\tfor ( let r = 0; r <= p; ++ r ) {\n\n\t\tlet s1 = 0;\n\t\tlet s2 = 1;\n\n\t\tconst a = [];\n\t\tfor ( let i = 0; i <= p; ++ i ) {\n\n\t\t\ta[ i ] = zeroArr.slice( 0 );\n\n\t\t}\n\n\t\ta[ 0 ][ 0 ] = 1.0;\n\n\t\tfor ( let k = 1; k <= n; ++ k ) {\n\n\t\t\tlet d = 0.0;\n\t\t\tconst rk = r - k;\n\t\t\tconst pk = p - k;\n\n\t\t\tif ( r >= k ) {\n\n\t\t\t\ta[ s2 ][ 0 ] = a[ s1 ][ 0 ] / ndu[ pk + 1 ][ rk ];\n\t\t\t\td = a[ s2 ][ 0 ] * ndu[ rk ][ pk ];\n\n\t\t\t}\n\n\t\t\tconst j1 = ( rk >= - 1 ) ? 1 : - rk;\n\t\t\tconst j2 = ( r - 1 <= pk ) ? k - 1 : p - r;\n\n\t\t\tfor ( let j = j1; j <= j2; ++ j ) {\n\n\t\t\t\ta[ s2 ][ j ] = ( a[ s1 ][ j ] - a[ s1 ][ j - 1 ] ) / ndu[ pk + 1 ][ rk + j ];\n\t\t\t\td += a[ s2 ][ j ] * ndu[ rk + j ][ pk ];\n\n\t\t\t}\n\n\t\t\tif ( r <= pk ) {\n\n\t\t\t\ta[ s2 ][ k ] = - a[ s1 ][ k - 1 ] / ndu[ pk + 1 ][ r ];\n\t\t\t\td += a[ s2 ][ k ] * ndu[ r ][ pk ];\n\n\t\t\t}\n\n\t\t\tders[ k ][ r ] = d;\n\n\t\t\tconst j = s1;\n\t\t\ts1 = s2;\n\t\t\ts2 = j;\n\n\t\t}\n\n\t}\n\n\tlet r = p;\n\n\tfor ( let k = 1; k <= n; ++ k ) {\n\n\t\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\t\tders[ k ][ j ] *= r;\n\n\t\t}\n\n\t\tr *= p - k;\n\n\t}\n\n\treturn ders;\n\n}\n\n\n/*\n\tCalculate derivatives of a B-Spline. See The NURBS Book, page 93, algorithm A3.2.\n\n\tp  : degree\n\tU  : knot vector\n\tP  : control points\n\tu  : Parametric points\n\tnd : number of derivatives\n\n\treturns array[d+1] with derivatives\n\t*/\nfunction calcBSplineDerivatives( p, U, P, u, nd ) {\n\n\tconst du = nd < p ? nd : p;\n\tconst CK = [];\n\tconst span = findSpan( p, u, U );\n\tconst nders = calcBasisFunctionDerivatives( span, u, p, du, U );\n\tconst Pw = [];\n\n\tfor ( let i = 0; i < P.length; ++ i ) {\n\n\t\tconst point = P[ i ].clone();\n\t\tconst w = point.w;\n\n\t\tpoint.x *= w;\n\t\tpoint.y *= w;\n\t\tpoint.z *= w;\n\n\t\tPw[ i ] = point;\n\n\t}\n\n\tfor ( let k = 0; k <= du; ++ k ) {\n\n\t\tconst point = Pw[ span - p ].clone().multiplyScalar( nders[ k ][ 0 ] );\n\n\t\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\t\tpoint.add( Pw[ span - p + j ].clone().multiplyScalar( nders[ k ][ j ] ) );\n\n\t\t}\n\n\t\tCK[ k ] = point;\n\n\t}\n\n\tfor ( let k = du + 1; k <= nd + 1; ++ k ) {\n\n\t\tCK[ k ] = new Vector4( 0, 0, 0 );\n\n\t}\n\n\treturn CK;\n\n}\n\n\n/*\nCalculate \"K over I\"\n\nreturns k!/(i!(k-i)!)\n*/\nfunction calcKoverI( k, i ) {\n\n\tlet nom = 1;\n\n\tfor ( let j = 2; j <= k; ++ j ) {\n\n\t\tnom *= j;\n\n\t}\n\n\tlet denom = 1;\n\n\tfor ( let j = 2; j <= i; ++ j ) {\n\n\t\tdenom *= j;\n\n\t}\n\n\tfor ( let j = 2; j <= k - i; ++ j ) {\n\n\t\tdenom *= j;\n\n\t}\n\n\treturn nom / denom;\n\n}\n\n\n/*\nCalculate derivatives (0-nd) of rational curve. See The NURBS Book, page 127, algorithm A4.2.\n\nPders : result of function calcBSplineDerivatives\n\nreturns array with derivatives for rational curve.\n*/\nfunction calcRationalCurveDerivatives( Pders ) {\n\n\tconst nd = Pders.length;\n\tconst Aders = [];\n\tconst wders = [];\n\n\tfor ( let i = 0; i < nd; ++ i ) {\n\n\t\tconst point = Pders[ i ];\n\t\tAders[ i ] = new Vector3( point.x, point.y, point.z );\n\t\twders[ i ] = point.w;\n\n\t}\n\n\tconst CK = [];\n\n\tfor ( let k = 0; k < nd; ++ k ) {\n\n\t\tconst v = Aders[ k ].clone();\n\n\t\tfor ( let i = 1; i <= k; ++ i ) {\n\n\t\t\tv.sub( CK[ k - i ].clone().multiplyScalar( calcKoverI( k, i ) * wders[ i ] ) );\n\n\t\t}\n\n\t\tCK[ k ] = v.divideScalar( wders[ 0 ] );\n\n\t}\n\n\treturn CK;\n\n}\n\n\n/*\nCalculate NURBS curve derivatives. See The NURBS Book, page 127, algorithm A4.2.\n\np  : degree\nU  : knot vector\nP  : control points in homogeneous space\nu  : parametric points\nnd : number of derivatives\n\nreturns array with derivatives.\n*/\nfunction calcNURBSDerivatives( p, U, P, u, nd ) {\n\n\tconst Pders = calcBSplineDerivatives( p, U, P, u, nd );\n\treturn calcRationalCurveDerivatives( Pders );\n\n}\n\n\n/*\nCalculate rational B-Spline surface point. See The NURBS Book, page 134, algorithm A4.3.\n\np1, p2 : degrees of B-Spline surface\nU1, U2 : knot vectors\nP      : control points (x, y, z, w)\nu, v   : parametric values\n\nreturns point for given (u, v)\n*/\nfunction calcSurfacePoint( p, q, U, V, P, u, v, target ) {\n\n\tconst uspan = findSpan( p, u, U );\n\tconst vspan = findSpan( q, v, V );\n\tconst Nu = calcBasisFunctions( uspan, u, p, U );\n\tconst Nv = calcBasisFunctions( vspan, v, q, V );\n\tconst temp = [];\n\n\tfor ( let l = 0; l <= q; ++ l ) {\n\n\t\ttemp[ l ] = new Vector4( 0, 0, 0, 0 );\n\t\tfor ( let k = 0; k <= p; ++ k ) {\n\n\t\t\tconst point = P[ uspan - p + k ][ vspan - q + l ].clone();\n\t\t\tconst w = point.w;\n\t\t\tpoint.x *= w;\n\t\t\tpoint.y *= w;\n\t\t\tpoint.z *= w;\n\t\t\ttemp[ l ].add( point.multiplyScalar( Nu[ k ] ) );\n\n\t\t}\n\n\t}\n\n\tconst Sw = new Vector4( 0, 0, 0, 0 );\n\tfor ( let l = 0; l <= q; ++ l ) {\n\n\t\tSw.add( temp[ l ].multiplyScalar( Nv[ l ] ) );\n\n\t}\n\n\tSw.divideScalar( Sw.w );\n\ttarget.set( Sw.x, Sw.y, Sw.z );\n\n}\n\n\n\nexport {\n\tfindSpan,\n\tcalcBasisFunctions,\n\tcalcBSplinePoint,\n\tcalcBasisFunctionDerivatives,\n\tcalcBSplineDerivatives,\n\tcalcKoverI,\n\tcalcRationalCurveDerivatives,\n\tcalcNURBSDerivatives,\n\tcalcSurfacePoint,\n};\n","import {\n\tCurve,\n\tVector3,\n\tVector4\n} from 'three';\nimport * as NURBSUtils from '../curves/NURBSUtils.js';\n\n/**\n * NURBS curve object\n *\n * Derives from Curve, overriding getPoint and getTangent.\n *\n * Implementation is based on (x, y [, z=0 [, w=1]]) control points with w=weight.\n *\n **/\n\nclass NURBSCurve extends Curve {\n\n\tconstructor(\n\t\tdegree,\n\t\tknots /* array of reals */,\n\t\tcontrolPoints /* array of Vector(2|3|4) */,\n\t\tstartKnot /* index in knots */,\n\t\tendKnot /* index in knots */\n\t) {\n\n\t\tsuper();\n\n\t\tthis.degree = degree;\n\t\tthis.knots = knots;\n\t\tthis.controlPoints = [];\n\t\t// Used by periodic NURBS to remove hidden spans\n\t\tthis.startKnot = startKnot || 0;\n\t\tthis.endKnot = endKnot || ( this.knots.length - 1 );\n\n\t\tfor ( let i = 0; i < controlPoints.length; ++ i ) {\n\n\t\t\t// ensure Vector4 for control points\n\t\t\tconst point = controlPoints[ i ];\n\t\t\tthis.controlPoints[ i ] = new Vector4( point.x, point.y, point.z, point.w );\n\n\t\t}\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst u = this.knots[ this.startKnot ] + t * ( this.knots[ this.endKnot ] - this.knots[ this.startKnot ] ); // linear mapping t->u\n\n\t\t// following results in (wx, wy, wz, w) homogeneous point\n\t\tconst hpoint = NURBSUtils.calcBSplinePoint( this.degree, this.knots, this.controlPoints, u );\n\n\t\tif ( hpoint.w !== 1.0 ) {\n\n\t\t\t// project to 3D space: (wx, wy, wz, w) -> (x, y, z, 1)\n\t\t\thpoint.divideScalar( hpoint.w );\n\n\t\t}\n\n\t\treturn point.set( hpoint.x, hpoint.y, hpoint.z );\n\n\t}\n\n\tgetTangent( t, optionalTarget = new Vector3() ) {\n\n\t\tconst tangent = optionalTarget;\n\n\t\tconst u = this.knots[ 0 ] + t * ( this.knots[ this.knots.length - 1 ] - this.knots[ 0 ] );\n\t\tconst ders = NURBSUtils.calcNURBSDerivatives( this.degree, this.knots, this.controlPoints, u, 1 );\n\t\ttangent.copy( ders[ 1 ] ).normalize();\n\n\t\treturn tangent;\n\n\t}\n\n}\n\nexport { NURBSCurve };\n","import {\n\tAmbientLight,\n\tAnimationClip,\n\tBone,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tDirectionalLight,\n\tEquirectangularReflectionMapping,\n\tEuler,\n\tFileLoader,\n\tFloat32BufferAttribute,\n\tGroup,\n\tLine,\n\tLineBasicMaterial,\n\tLoader,\n\tLoaderUtils,\n\tMathUtils,\n\tMatrix3,\n\tMatrix4,\n\tMesh,\n\tMeshLambertMaterial,\n\tMeshPhongMaterial,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSpotLight,\n\tTexture,\n\tTextureLoader,\n\tUint16BufferAttribute,\n\tVector3,\n\tVector4,\n\tVectorKeyframeTrack,\n\tsRGBEncoding\n} from 'three';\nimport * as fflate from '../libs/fflate.module.js';\nimport { NURBSCurve } from '../curves/NURBSCurve.js';\n\n/**\n * Loader loads FBX file and generates Group representing FBX scene.\n * Requires FBX file to be >= 7.0 and in ASCII or >= 6400 in Binary format\n * Versions lower than this may load but will probably have errors\n *\n * Needs Support:\n *  Morph normals / blend shape normals\n *\n * FBX format references:\n * \thttps://wiki.blender.org/index.php/User:Mont29/Foundation/FBX_File_Structure\n * \thttp://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_index_html (C++ SDK reference)\n *\n * \tBinary format specification:\n *\t\thttps://code.blender.org/2013/08/fbx-binary-file-format-specification/\n */\n\n\nlet fbxTree;\nlet connections;\nlet sceneGraph;\n\nclass FBXLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( scope.path === '' ) ? LoaderUtils.extractUrlBase( url ) : scope.path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( buffer, path ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( FBXBuffer, path ) {\n\n\t\tif ( isFbxFormatBinary( FBXBuffer ) ) {\n\n\t\t\tfbxTree = new BinaryParser().parse( FBXBuffer );\n\n\t\t} else {\n\n\t\t\tconst FBXText = convertArrayBufferToString( FBXBuffer );\n\n\t\t\tif ( ! isFbxFormatASCII( FBXText ) ) {\n\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown format.' );\n\n\t\t\t}\n\n\t\t\tif ( getFbxVersion( FBXText ) < 7000 ) {\n\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: FBX version not supported, FileVersion: ' + getFbxVersion( FBXText ) );\n\n\t\t\t}\n\n\t\t\tfbxTree = new TextParser().parse( FBXText );\n\n\t\t}\n\n\t\t// console.log( fbxTree );\n\n\t\tconst textureLoader = new TextureLoader( this.manager ).setPath( this.resourcePath || path ).setCrossOrigin( this.crossOrigin );\n\n\t\treturn new FBXTreeParser( textureLoader, this.manager ).parse( fbxTree );\n\n\t}\n\n}\n\n// Parse the FBXTree object returned by the BinaryParser or TextParser and return a Group\nclass FBXTreeParser {\n\n\tconstructor( textureLoader, manager ) {\n\n\t\tthis.textureLoader = textureLoader;\n\t\tthis.manager = manager;\n\n\t}\n\n\tparse() {\n\n\t\tconnections = this.parseConnections();\n\n\t\tconst images = this.parseImages();\n\t\tconst textures = this.parseTextures( images );\n\t\tconst materials = this.parseMaterials( textures );\n\t\tconst deformers = this.parseDeformers();\n\t\tconst geometryMap = new GeometryParser().parse( deformers );\n\n\t\tthis.parseScene( deformers, geometryMap, materials );\n\n\t\treturn sceneGraph;\n\n\t}\n\n\t// Parses FBXTree.Connections which holds parent-child connections between objects (e.g. material -> texture, model->geometry )\n\t// and details the connection type\n\tparseConnections() {\n\n\t\tconst connectionMap = new Map();\n\n\t\tif ( 'Connections' in fbxTree ) {\n\n\t\t\tconst rawConnections = fbxTree.Connections.connections;\n\n\t\t\trawConnections.forEach( function ( rawConnection ) {\n\n\t\t\t\tconst fromID = rawConnection[ 0 ];\n\t\t\t\tconst toID = rawConnection[ 1 ];\n\t\t\t\tconst relationship = rawConnection[ 2 ];\n\n\t\t\t\tif ( ! connectionMap.has( fromID ) ) {\n\n\t\t\t\t\tconnectionMap.set( fromID, {\n\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\tchildren: []\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\tconst parentRelationship = { ID: toID, relationship: relationship };\n\t\t\t\tconnectionMap.get( fromID ).parents.push( parentRelationship );\n\n\t\t\t\tif ( ! connectionMap.has( toID ) ) {\n\n\t\t\t\t\tconnectionMap.set( toID, {\n\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\tchildren: []\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\tconst childRelationship = { ID: fromID, relationship: relationship };\n\t\t\t\tconnectionMap.get( toID ).children.push( childRelationship );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn connectionMap;\n\n\t}\n\n\t// Parse FBXTree.Objects.Video for embedded image data\n\t// These images are connected to textures in FBXTree.Objects.Textures\n\t// via FBXTree.Connections.\n\tparseImages() {\n\n\t\tconst images = {};\n\t\tconst blobs = {};\n\n\t\tif ( 'Video' in fbxTree.Objects ) {\n\n\t\t\tconst videoNodes = fbxTree.Objects.Video;\n\n\t\t\tfor ( const nodeID in videoNodes ) {\n\n\t\t\t\tconst videoNode = videoNodes[ nodeID ];\n\n\t\t\t\tconst id = parseInt( nodeID );\n\n\t\t\t\timages[ id ] = videoNode.RelativeFilename || videoNode.Filename;\n\n\t\t\t\t// raw image data is in videoNode.Content\n\t\t\t\tif ( 'Content' in videoNode ) {\n\n\t\t\t\t\tconst arrayBufferContent = ( videoNode.Content instanceof ArrayBuffer ) && ( videoNode.Content.byteLength > 0 );\n\t\t\t\t\tconst base64Content = ( typeof videoNode.Content === 'string' ) && ( videoNode.Content !== '' );\n\n\t\t\t\t\tif ( arrayBufferContent || base64Content ) {\n\n\t\t\t\t\t\tconst image = this.parseImage( videoNodes[ nodeID ] );\n\n\t\t\t\t\t\tblobs[ videoNode.RelativeFilename || videoNode.Filename ] = image;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( const id in images ) {\n\n\t\t\tconst filename = images[ id ];\n\n\t\t\tif ( blobs[ filename ] !== undefined ) images[ id ] = blobs[ filename ];\n\t\t\telse images[ id ] = images[ id ].split( '\\\\' ).pop();\n\n\t\t}\n\n\t\treturn images;\n\n\t}\n\n\t// Parse embedded image data in FBXTree.Video.Content\n\tparseImage( videoNode ) {\n\n\t\tconst content = videoNode.Content;\n\t\tconst fileName = videoNode.RelativeFilename || videoNode.Filename;\n\t\tconst extension = fileName.slice( fileName.lastIndexOf( '.' ) + 1 ).toLowerCase();\n\n\t\tlet type;\n\n\t\tswitch ( extension ) {\n\n\t\t\tcase 'bmp':\n\n\t\t\t\ttype = 'image/bmp';\n\t\t\t\tbreak;\n\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\n\t\t\t\ttype = 'image/jpeg';\n\t\t\t\tbreak;\n\n\t\t\tcase 'png':\n\n\t\t\t\ttype = 'image/png';\n\t\t\t\tbreak;\n\n\t\t\tcase 'tif':\n\n\t\t\t\ttype = 'image/tiff';\n\t\t\t\tbreak;\n\n\t\t\tcase 'tga':\n\n\t\t\t\tif ( this.manager.getHandler( '.tga' ) === null ) {\n\n\t\t\t\t\tconsole.warn( 'FBXLoader: TGA loader not found, skipping ', fileName );\n\n\t\t\t\t}\n\n\t\t\t\ttype = 'image/tga';\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tconsole.warn( 'FBXLoader: Image type \"' + extension + '\" is not supported.' );\n\t\t\t\treturn;\n\n\t\t}\n\n\t\tif ( typeof content === 'string' ) { // ASCII format\n\n\t\t\treturn 'data:' + type + ';base64,' + content;\n\n\t\t} else { // Binary Format\n\n\t\t\tconst array = new Uint8Array( content );\n\t\t\treturn window.URL.createObjectURL( new Blob( [ array ], { type: type } ) );\n\n\t\t}\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Texture\n\t// These contain details such as UV scaling, cropping, rotation etc and are connected\n\t// to images in FBXTree.Objects.Video\n\tparseTextures( images ) {\n\n\t\tconst textureMap = new Map();\n\n\t\tif ( 'Texture' in fbxTree.Objects ) {\n\n\t\t\tconst textureNodes = fbxTree.Objects.Texture;\n\t\t\tfor ( const nodeID in textureNodes ) {\n\n\t\t\t\tconst texture = this.parseTexture( textureNodes[ nodeID ], images );\n\t\t\t\ttextureMap.set( parseInt( nodeID ), texture );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn textureMap;\n\n\t}\n\n\t// Parse individual node in FBXTree.Objects.Texture\n\tparseTexture( textureNode, images ) {\n\n\t\tconst texture = this.loadTexture( textureNode, images );\n\n\t\ttexture.ID = textureNode.id;\n\n\t\ttexture.name = textureNode.attrName;\n\n\t\tconst wrapModeU = textureNode.WrapModeU;\n\t\tconst wrapModeV = textureNode.WrapModeV;\n\n\t\tconst valueU = wrapModeU !== undefined ? wrapModeU.value : 0;\n\t\tconst valueV = wrapModeV !== undefined ? wrapModeV.value : 0;\n\n\t\t// http://download.autodesk.com/us/fbx/SDKdocs/FBX_SDK_Help/files/fbxsdkref/class_k_fbx_texture.html#889640e63e2e681259ea81061b85143a\n\t\t// 0: repeat(default), 1: clamp\n\n\t\ttexture.wrapS = valueU === 0 ? RepeatWrapping : ClampToEdgeWrapping;\n\t\ttexture.wrapT = valueV === 0 ? RepeatWrapping : ClampToEdgeWrapping;\n\n\t\tif ( 'Scaling' in textureNode ) {\n\n\t\t\tconst values = textureNode.Scaling.value;\n\n\t\t\ttexture.repeat.x = values[ 0 ];\n\t\t\ttexture.repeat.y = values[ 1 ];\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\t// load a texture specified as a blob or data URI, or via an external URL using TextureLoader\n\tloadTexture( textureNode, images ) {\n\n\t\tlet fileName;\n\n\t\tconst currentPath = this.textureLoader.path;\n\n\t\tconst children = connections.get( textureNode.id ).children;\n\n\t\tif ( children !== undefined && children.length > 0 && images[ children[ 0 ].ID ] !== undefined ) {\n\n\t\t\tfileName = images[ children[ 0 ].ID ];\n\n\t\t\tif ( fileName.indexOf( 'blob:' ) === 0 || fileName.indexOf( 'data:' ) === 0 ) {\n\n\t\t\t\tthis.textureLoader.setPath( undefined );\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet texture;\n\n\t\tconst extension = textureNode.FileName.slice( - 3 ).toLowerCase();\n\n\t\tif ( extension === 'tga' ) {\n\n\t\t\tconst loader = this.manager.getHandler( '.tga' );\n\n\t\t\tif ( loader === null ) {\n\n\t\t\t\tconsole.warn( 'FBXLoader: TGA loader not found, creating placeholder texture for', textureNode.RelativeFilename );\n\t\t\t\ttexture = new Texture();\n\n\t\t\t} else {\n\n\t\t\t\tloader.setPath( this.textureLoader.path );\n\t\t\t\ttexture = loader.load( fileName );\n\n\t\t\t}\n\n\t\t} else if ( extension === 'psd' ) {\n\n\t\t\tconsole.warn( 'FBXLoader: PSD textures are not supported, creating placeholder texture for', textureNode.RelativeFilename );\n\t\t\ttexture = new Texture();\n\n\t\t} else {\n\n\t\t\ttexture = this.textureLoader.load( fileName );\n\n\t\t}\n\n\t\tthis.textureLoader.setPath( currentPath );\n\n\t\treturn texture;\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Material\n\tparseMaterials( textureMap ) {\n\n\t\tconst materialMap = new Map();\n\n\t\tif ( 'Material' in fbxTree.Objects ) {\n\n\t\t\tconst materialNodes = fbxTree.Objects.Material;\n\n\t\t\tfor ( const nodeID in materialNodes ) {\n\n\t\t\t\tconst material = this.parseMaterial( materialNodes[ nodeID ], textureMap );\n\n\t\t\t\tif ( material !== null ) materialMap.set( parseInt( nodeID ), material );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn materialMap;\n\n\t}\n\n\t// Parse single node in FBXTree.Objects.Material\n\t// Materials are connected to texture maps in FBXTree.Objects.Textures\n\t// FBX format currently only supports Lambert and Phong shading models\n\tparseMaterial( materialNode, textureMap ) {\n\n\t\tconst ID = materialNode.id;\n\t\tconst name = materialNode.attrName;\n\t\tlet type = materialNode.ShadingModel;\n\n\t\t// Case where FBX wraps shading model in property object.\n\t\tif ( typeof type === 'object' ) {\n\n\t\t\ttype = type.value;\n\n\t\t}\n\n\t\t// Ignore unused materials which don't have any connections.\n\t\tif ( ! connections.has( ID ) ) return null;\n\n\t\tconst parameters = this.parseParameters( materialNode, textureMap, ID );\n\n\t\tlet material;\n\n\t\tswitch ( type.toLowerCase() ) {\n\n\t\t\tcase 'phong':\n\t\t\t\tmaterial = new MeshPhongMaterial();\n\t\t\t\tbreak;\n\t\t\tcase 'lambert':\n\t\t\t\tmaterial = new MeshLambertMaterial();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: unknown material type \"%s\". Defaulting to MeshPhongMaterial.', type );\n\t\t\t\tmaterial = new MeshPhongMaterial();\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tmaterial.setValues( parameters );\n\t\tmaterial.name = name;\n\n\t\treturn material;\n\n\t}\n\n\t// Parse FBX material and return parameters suitable for a three.js material\n\t// Also parse the texture map and return any textures associated with the material\n\tparseParameters( materialNode, textureMap, ID ) {\n\n\t\tconst parameters = {};\n\n\t\tif ( materialNode.BumpFactor ) {\n\n\t\t\tparameters.bumpScale = materialNode.BumpFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Diffuse ) {\n\n\t\t\tparameters.color = new Color().fromArray( materialNode.Diffuse.value );\n\n\t\t} else if ( materialNode.DiffuseColor && ( materialNode.DiffuseColor.type === 'Color' || materialNode.DiffuseColor.type === 'ColorRGB' ) ) {\n\n\t\t\t// The blender exporter exports diffuse here instead of in materialNode.Diffuse\n\t\t\tparameters.color = new Color().fromArray( materialNode.DiffuseColor.value );\n\n\t\t}\n\n\t\tif ( materialNode.DisplacementFactor ) {\n\n\t\t\tparameters.displacementScale = materialNode.DisplacementFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Emissive ) {\n\n\t\t\tparameters.emissive = new Color().fromArray( materialNode.Emissive.value );\n\n\t\t} else if ( materialNode.EmissiveColor && ( materialNode.EmissiveColor.type === 'Color' || materialNode.EmissiveColor.type === 'ColorRGB' ) ) {\n\n\t\t\t// The blender exporter exports emissive color here instead of in materialNode.Emissive\n\t\t\tparameters.emissive = new Color().fromArray( materialNode.EmissiveColor.value );\n\n\t\t}\n\n\t\tif ( materialNode.EmissiveFactor ) {\n\n\t\t\tparameters.emissiveIntensity = parseFloat( materialNode.EmissiveFactor.value );\n\n\t\t}\n\n\t\tif ( materialNode.Opacity ) {\n\n\t\t\tparameters.opacity = parseFloat( materialNode.Opacity.value );\n\n\t\t}\n\n\t\tif ( parameters.opacity < 1.0 ) {\n\n\t\t\tparameters.transparent = true;\n\n\t\t}\n\n\t\tif ( materialNode.ReflectionFactor ) {\n\n\t\t\tparameters.reflectivity = materialNode.ReflectionFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Shininess ) {\n\n\t\t\tparameters.shininess = materialNode.Shininess.value;\n\n\t\t}\n\n\t\tif ( materialNode.Specular ) {\n\n\t\t\tparameters.specular = new Color().fromArray( materialNode.Specular.value );\n\n\t\t} else if ( materialNode.SpecularColor && materialNode.SpecularColor.type === 'Color' ) {\n\n\t\t\t// The blender exporter exports specular color here instead of in materialNode.Specular\n\t\t\tparameters.specular = new Color().fromArray( materialNode.SpecularColor.value );\n\n\t\t}\n\n\t\tconst scope = this;\n\t\tconnections.get( ID ).children.forEach( function ( child ) {\n\n\t\t\tconst type = child.relationship;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'Bump':\n\t\t\t\t\tparameters.bumpMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'Maya|TEX_ao_map':\n\t\t\t\t\tparameters.aoMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'DiffuseColor':\n\t\t\t\tcase 'Maya|TEX_color_map':\n\t\t\t\t\tparameters.map = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.map !== undefined ) {\n\n\t\t\t\t\t\tparameters.map.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'DisplacementColor':\n\t\t\t\t\tparameters.displacementMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'EmissiveColor':\n\t\t\t\t\tparameters.emissiveMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.emissiveMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.emissiveMap.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'NormalMap':\n\t\t\t\tcase 'Maya|TEX_normal_map':\n\t\t\t\t\tparameters.normalMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'ReflectionColor':\n\t\t\t\t\tparameters.envMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.envMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.envMap.mapping = EquirectangularReflectionMapping;\n\t\t\t\t\t\tparameters.envMap.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'SpecularColor':\n\t\t\t\t\tparameters.specularMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.specularMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.specularMap.encoding = sRGBEncoding;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'TransparentColor':\n\t\t\t\tcase 'TransparencyFactor':\n\t\t\t\t\tparameters.alphaMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tparameters.transparent = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'AmbientColor':\n\t\t\t\tcase 'ShininessExponent': // AKA glossiness map\n\t\t\t\tcase 'SpecularFactor': // AKA specularLevel\n\t\t\t\tcase 'VectorDisplacementColor': // NOTE: Seems to be a copy of DisplacementColor\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: %s map is not supported in three.js, skipping texture.', type );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn parameters;\n\n\t}\n\n\t// get a texture from the textureMap for use by a material.\n\tgetTexture( textureMap, id ) {\n\n\t\t// if the texture is a layered texture, just use the first layer and issue a warning\n\t\tif ( 'LayeredTexture' in fbxTree.Objects && id in fbxTree.Objects.LayeredTexture ) {\n\n\t\t\tconsole.warn( 'THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer.' );\n\t\t\tid = connections.get( id ).children[ 0 ].ID;\n\n\t\t}\n\n\t\treturn textureMap.get( id );\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Deformer\n\t// Deformer node can contain skinning or Vertex Cache animation data, however only skinning is supported here\n\t// Generates map of Skeleton-like objects for use later when generating and binding skeletons.\n\tparseDeformers() {\n\n\t\tconst skeletons = {};\n\t\tconst morphTargets = {};\n\n\t\tif ( 'Deformer' in fbxTree.Objects ) {\n\n\t\t\tconst DeformerNodes = fbxTree.Objects.Deformer;\n\n\t\t\tfor ( const nodeID in DeformerNodes ) {\n\n\t\t\t\tconst deformerNode = DeformerNodes[ nodeID ];\n\n\t\t\t\tconst relationships = connections.get( parseInt( nodeID ) );\n\n\t\t\t\tif ( deformerNode.attrType === 'Skin' ) {\n\n\t\t\t\t\tconst skeleton = this.parseSkeleton( relationships, DeformerNodes );\n\t\t\t\t\tskeleton.ID = nodeID;\n\n\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: skeleton attached to more than one geometry is not supported.' );\n\t\t\t\t\tskeleton.geometryID = relationships.parents[ 0 ].ID;\n\n\t\t\t\t\tskeletons[ nodeID ] = skeleton;\n\n\t\t\t\t} else if ( deformerNode.attrType === 'BlendShape' ) {\n\n\t\t\t\t\tconst morphTarget = {\n\t\t\t\t\t\tid: nodeID,\n\t\t\t\t\t};\n\n\t\t\t\t\tmorphTarget.rawTargets = this.parseMorphTargets( relationships, DeformerNodes );\n\t\t\t\t\tmorphTarget.id = nodeID;\n\n\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: morph target attached to more than one geometry is not supported.' );\n\n\t\t\t\t\tmorphTargets[ nodeID ] = morphTarget;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\n\t\t\tskeletons: skeletons,\n\t\t\tmorphTargets: morphTargets,\n\n\t\t};\n\n\t}\n\n\t// Parse single nodes in FBXTree.Objects.Deformer\n\t// The top level skeleton node has type 'Skin' and sub nodes have type 'Cluster'\n\t// Each skin node represents a skeleton and each cluster node represents a bone\n\tparseSkeleton( relationships, deformerNodes ) {\n\n\t\tconst rawBones = [];\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst boneNode = deformerNodes[ child.ID ];\n\n\t\t\tif ( boneNode.attrType !== 'Cluster' ) return;\n\n\t\t\tconst rawBone = {\n\n\t\t\t\tID: child.ID,\n\t\t\t\tindices: [],\n\t\t\t\tweights: [],\n\t\t\t\ttransformLink: new Matrix4().fromArray( boneNode.TransformLink.a ),\n\t\t\t\t// transform: new Matrix4().fromArray( boneNode.Transform.a ),\n\t\t\t\t// linkMode: boneNode.Mode,\n\n\t\t\t};\n\n\t\t\tif ( 'Indexes' in boneNode ) {\n\n\t\t\t\trawBone.indices = boneNode.Indexes.a;\n\t\t\t\trawBone.weights = boneNode.Weights.a;\n\n\t\t\t}\n\n\t\t\trawBones.push( rawBone );\n\n\t\t} );\n\n\t\treturn {\n\n\t\t\trawBones: rawBones,\n\t\t\tbones: []\n\n\t\t};\n\n\t}\n\n\t// The top level morph deformer node has type \"BlendShape\" and sub nodes have type \"BlendShapeChannel\"\n\tparseMorphTargets( relationships, deformerNodes ) {\n\n\t\tconst rawMorphTargets = [];\n\n\t\tfor ( let i = 0; i < relationships.children.length; i ++ ) {\n\n\t\t\tconst child = relationships.children[ i ];\n\n\t\t\tconst morphTargetNode = deformerNodes[ child.ID ];\n\n\t\t\tconst rawMorphTarget = {\n\n\t\t\t\tname: morphTargetNode.attrName,\n\t\t\t\tinitialWeight: morphTargetNode.DeformPercent,\n\t\t\t\tid: morphTargetNode.id,\n\t\t\t\tfullWeights: morphTargetNode.FullWeights.a\n\n\t\t\t};\n\n\t\t\tif ( morphTargetNode.attrType !== 'BlendShapeChannel' ) return;\n\n\t\t\trawMorphTarget.geoID = connections.get( parseInt( child.ID ) ).children.filter( function ( child ) {\n\n\t\t\t\treturn child.relationship === undefined;\n\n\t\t\t} )[ 0 ].ID;\n\n\t\t\trawMorphTargets.push( rawMorphTarget );\n\n\t\t}\n\n\t\treturn rawMorphTargets;\n\n\t}\n\n\t// create the main Group() to be returned by the loader\n\tparseScene( deformers, geometryMap, materialMap ) {\n\n\t\tsceneGraph = new Group();\n\n\t\tconst modelMap = this.parseModels( deformers.skeletons, geometryMap, materialMap );\n\n\t\tconst modelNodes = fbxTree.Objects.Model;\n\n\t\tconst scope = this;\n\t\tmodelMap.forEach( function ( model ) {\n\n\t\t\tconst modelNode = modelNodes[ model.ID ];\n\t\t\tscope.setLookAtProperties( model, modelNode );\n\n\t\t\tconst parentConnections = connections.get( model.ID ).parents;\n\n\t\t\tparentConnections.forEach( function ( connection ) {\n\n\t\t\t\tconst parent = modelMap.get( connection.ID );\n\t\t\t\tif ( parent !== undefined ) parent.add( model );\n\n\t\t\t} );\n\n\t\t\tif ( model.parent === null ) {\n\n\t\t\t\tsceneGraph.add( model );\n\n\t\t\t}\n\n\n\t\t} );\n\n\t\tthis.bindSkeleton( deformers.skeletons, geometryMap, modelMap );\n\n\t\tthis.createAmbientLight();\n\n\t\tsceneGraph.traverse( function ( node ) {\n\n\t\t\tif ( node.userData.transformData ) {\n\n\t\t\t\tif ( node.parent ) {\n\n\t\t\t\t\tnode.userData.transformData.parentMatrix = node.parent.matrix;\n\t\t\t\t\tnode.userData.transformData.parentMatrixWorld = node.parent.matrixWorld;\n\n\t\t\t\t}\n\n\t\t\t\tconst transform = generateTransform( node.userData.transformData );\n\n\t\t\t\tnode.applyMatrix4( transform );\n\t\t\t\tnode.updateWorldMatrix();\n\n\t\t\t}\n\n\t\t} );\n\n\t\tconst animations = new AnimationParser().parse();\n\n\t\t// if all the models where already combined in a single group, just return that\n\t\tif ( sceneGraph.children.length === 1 && sceneGraph.children[ 0 ].isGroup ) {\n\n\t\t\tsceneGraph.children[ 0 ].animations = animations;\n\t\t\tsceneGraph = sceneGraph.children[ 0 ];\n\n\t\t}\n\n\t\tsceneGraph.animations = animations;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.Model\n\tparseModels( skeletons, geometryMap, materialMap ) {\n\n\t\tconst modelMap = new Map();\n\t\tconst modelNodes = fbxTree.Objects.Model;\n\n\t\tfor ( const nodeID in modelNodes ) {\n\n\t\t\tconst id = parseInt( nodeID );\n\t\t\tconst node = modelNodes[ nodeID ];\n\t\t\tconst relationships = connections.get( id );\n\n\t\t\tlet model = this.buildSkeleton( relationships, skeletons, id, node.attrName );\n\n\t\t\tif ( ! model ) {\n\n\t\t\t\tswitch ( node.attrType ) {\n\n\t\t\t\t\tcase 'Camera':\n\t\t\t\t\t\tmodel = this.createCamera( relationships );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Light':\n\t\t\t\t\t\tmodel = this.createLight( relationships );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Mesh':\n\t\t\t\t\t\tmodel = this.createMesh( relationships, geometryMap, materialMap );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'NurbsCurve':\n\t\t\t\t\t\tmodel = this.createCurve( relationships, geometryMap );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'LimbNode':\n\t\t\t\t\tcase 'Root':\n\t\t\t\t\t\tmodel = new Bone();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Null':\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tmodel = new Group();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tmodel.name = node.attrName ? PropertyBinding.sanitizeNodeName( node.attrName ) : '';\n\n\t\t\t\tmodel.ID = id;\n\n\t\t\t}\n\n\t\t\tthis.getTransformData( model, node );\n\t\t\tmodelMap.set( id, model );\n\n\t\t}\n\n\t\treturn modelMap;\n\n\t}\n\n\tbuildSkeleton( relationships, skeletons, id, name ) {\n\n\t\tlet bone = null;\n\n\t\trelationships.parents.forEach( function ( parent ) {\n\n\t\t\tfor ( const ID in skeletons ) {\n\n\t\t\t\tconst skeleton = skeletons[ ID ];\n\n\t\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t\tif ( rawBone.ID === parent.ID ) {\n\n\t\t\t\t\t\tconst subBone = bone;\n\t\t\t\t\t\tbone = new Bone();\n\n\t\t\t\t\t\tbone.matrixWorld.copy( rawBone.transformLink );\n\n\t\t\t\t\t\t// set name and id here - otherwise in cases where \"subBone\" is created it will not have a name / id\n\n\t\t\t\t\t\tbone.name = name ? PropertyBinding.sanitizeNodeName( name ) : '';\n\t\t\t\t\t\tbone.ID = id;\n\n\t\t\t\t\t\tskeleton.bones[ i ] = bone;\n\n\t\t\t\t\t\t// In cases where a bone is shared between multiple meshes\n\t\t\t\t\t\t// duplicate the bone here and and it as a child of the first bone\n\t\t\t\t\t\tif ( subBone !== null ) {\n\n\t\t\t\t\t\t\tbone.add( subBone );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn bone;\n\n\t}\n\n\t// create a PerspectiveCamera or OrthographicCamera\n\tcreateCamera( relationships ) {\n\n\t\tlet model;\n\t\tlet cameraAttribute;\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\tcameraAttribute = attr;\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( cameraAttribute === undefined ) {\n\n\t\t\tmodel = new Object3D();\n\n\t\t} else {\n\n\t\t\tlet type = 0;\n\t\t\tif ( cameraAttribute.CameraProjectionType !== undefined && cameraAttribute.CameraProjectionType.value === 1 ) {\n\n\t\t\t\ttype = 1;\n\n\t\t\t}\n\n\t\t\tlet nearClippingPlane = 1;\n\t\t\tif ( cameraAttribute.NearPlane !== undefined ) {\n\n\t\t\t\tnearClippingPlane = cameraAttribute.NearPlane.value / 1000;\n\n\t\t\t}\n\n\t\t\tlet farClippingPlane = 1000;\n\t\t\tif ( cameraAttribute.FarPlane !== undefined ) {\n\n\t\t\t\tfarClippingPlane = cameraAttribute.FarPlane.value / 1000;\n\n\t\t\t}\n\n\n\t\t\tlet width = window.innerWidth;\n\t\t\tlet height = window.innerHeight;\n\n\t\t\tif ( cameraAttribute.AspectWidth !== undefined && cameraAttribute.AspectHeight !== undefined ) {\n\n\t\t\t\twidth = cameraAttribute.AspectWidth.value;\n\t\t\t\theight = cameraAttribute.AspectHeight.value;\n\n\t\t\t}\n\n\t\t\tconst aspect = width / height;\n\n\t\t\tlet fov = 45;\n\t\t\tif ( cameraAttribute.FieldOfView !== undefined ) {\n\n\t\t\t\tfov = cameraAttribute.FieldOfView.value;\n\n\t\t\t}\n\n\t\t\tconst focalLength = cameraAttribute.FocalLength ? cameraAttribute.FocalLength.value : null;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 0: // Perspective\n\t\t\t\t\tmodel = new PerspectiveCamera( fov, aspect, nearClippingPlane, farClippingPlane );\n\t\t\t\t\tif ( focalLength !== null ) model.setFocalLength( focalLength );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1: // Orthographic\n\t\t\t\t\tmodel = new OrthographicCamera( - width / 2, width / 2, height / 2, - height / 2, nearClippingPlane, farClippingPlane );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown camera type ' + type + '.' );\n\t\t\t\t\tmodel = new Object3D();\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\t// Create a DirectionalLight, PointLight or SpotLight\n\tcreateLight( relationships ) {\n\n\t\tlet model;\n\t\tlet lightAttribute;\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\tlightAttribute = attr;\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( lightAttribute === undefined ) {\n\n\t\t\tmodel = new Object3D();\n\n\t\t} else {\n\n\t\t\tlet type;\n\n\t\t\t// LightType can be undefined for Point lights\n\t\t\tif ( lightAttribute.LightType === undefined ) {\n\n\t\t\t\ttype = 0;\n\n\t\t\t} else {\n\n\t\t\t\ttype = lightAttribute.LightType.value;\n\n\t\t\t}\n\n\t\t\tlet color = 0xffffff;\n\n\t\t\tif ( lightAttribute.Color !== undefined ) {\n\n\t\t\t\tcolor = new Color().fromArray( lightAttribute.Color.value );\n\n\t\t\t}\n\n\t\t\tlet intensity = ( lightAttribute.Intensity === undefined ) ? 1 : lightAttribute.Intensity.value / 100;\n\n\t\t\t// light disabled\n\t\t\tif ( lightAttribute.CastLightOnObject !== undefined && lightAttribute.CastLightOnObject.value === 0 ) {\n\n\t\t\t\tintensity = 0;\n\n\t\t\t}\n\n\t\t\tlet distance = 0;\n\t\t\tif ( lightAttribute.FarAttenuationEnd !== undefined ) {\n\n\t\t\t\tif ( lightAttribute.EnableFarAttenuation !== undefined && lightAttribute.EnableFarAttenuation.value === 0 ) {\n\n\t\t\t\t\tdistance = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdistance = lightAttribute.FarAttenuationEnd.value;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// TODO: could this be calculated linearly from FarAttenuationStart to FarAttenuationEnd?\n\t\t\tconst decay = 1;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 0: // Point\n\t\t\t\t\tmodel = new PointLight( color, intensity, distance, decay );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1: // Directional\n\t\t\t\t\tmodel = new DirectionalLight( color, intensity );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2: // Spot\n\t\t\t\t\tlet angle = Math.PI / 3;\n\n\t\t\t\t\tif ( lightAttribute.InnerAngle !== undefined ) {\n\n\t\t\t\t\t\tangle = MathUtils.degToRad( lightAttribute.InnerAngle.value );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlet penumbra = 0;\n\t\t\t\t\tif ( lightAttribute.OuterAngle !== undefined ) {\n\n\t\t\t\t\t\t// TODO: this is not correct - FBX calculates outer and inner angle in degrees\n\t\t\t\t\t\t// with OuterAngle > InnerAngle && OuterAngle <= Math.PI\n\t\t\t\t\t\t// while three.js uses a penumbra between (0, 1) to attenuate the inner angle\n\t\t\t\t\t\tpenumbra = MathUtils.degToRad( lightAttribute.OuterAngle.value );\n\t\t\t\t\t\tpenumbra = Math.max( penumbra, 1 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmodel = new SpotLight( color, intensity, distance, angle, penumbra, decay );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown light type ' + lightAttribute.LightType.value + ', defaulting to a PointLight.' );\n\t\t\t\t\tmodel = new PointLight( color, intensity );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( lightAttribute.CastShadows !== undefined && lightAttribute.CastShadows.value === 1 ) {\n\n\t\t\t\tmodel.castShadow = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\tcreateMesh( relationships, geometryMap, materialMap ) {\n\n\t\tlet model;\n\t\tlet geometry = null;\n\t\tlet material = null;\n\t\tconst materials = [];\n\n\t\t// get geometry and materials(s) from connections\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tif ( geometryMap.has( child.ID ) ) {\n\n\t\t\t\tgeometry = geometryMap.get( child.ID );\n\n\t\t\t}\n\n\t\t\tif ( materialMap.has( child.ID ) ) {\n\n\t\t\t\tmaterials.push( materialMap.get( child.ID ) );\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( materials.length > 1 ) {\n\n\t\t\tmaterial = materials;\n\n\t\t} else if ( materials.length > 0 ) {\n\n\t\t\tmaterial = materials[ 0 ];\n\n\t\t} else {\n\n\t\t\tmaterial = new MeshPhongMaterial( { color: 0xcccccc } );\n\t\t\tmaterials.push( material );\n\n\t\t}\n\n\t\tif ( 'color' in geometry.attributes ) {\n\n\t\t\tmaterials.forEach( function ( material ) {\n\n\t\t\t\tmaterial.vertexColors = true;\n\n\t\t\t} );\n\n\t\t}\n\n\t\tif ( geometry.FBX_Deformer ) {\n\n\t\t\tmodel = new SkinnedMesh( geometry, material );\n\t\t\tmodel.normalizeSkinWeights();\n\n\t\t} else {\n\n\t\t\tmodel = new Mesh( geometry, material );\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\tcreateCurve( relationships, geometryMap ) {\n\n\t\tconst geometry = relationships.children.reduce( function ( geo, child ) {\n\n\t\t\tif ( geometryMap.has( child.ID ) ) geo = geometryMap.get( child.ID );\n\n\t\t\treturn geo;\n\n\t\t}, null );\n\n\t\t// FBX does not list materials for Nurbs lines, so we'll just put our own in here.\n\t\tconst material = new LineBasicMaterial( { color: 0x3300ff, linewidth: 1 } );\n\t\treturn new Line( geometry, material );\n\n\t}\n\n\t// parse the model node for transform data\n\tgetTransformData( model, modelNode ) {\n\n\t\tconst transformData = {};\n\n\t\tif ( 'InheritType' in modelNode ) transformData.inheritType = parseInt( modelNode.InheritType.value );\n\n\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = getEulerOrder( modelNode.RotationOrder.value );\n\t\telse transformData.eulerOrder = 'ZYX';\n\n\t\tif ( 'Lcl_Translation' in modelNode ) transformData.translation = modelNode.Lcl_Translation.value;\n\n\t\tif ( 'PreRotation' in modelNode ) transformData.preRotation = modelNode.PreRotation.value;\n\t\tif ( 'Lcl_Rotation' in modelNode ) transformData.rotation = modelNode.Lcl_Rotation.value;\n\t\tif ( 'PostRotation' in modelNode ) transformData.postRotation = modelNode.PostRotation.value;\n\n\t\tif ( 'Lcl_Scaling' in modelNode ) transformData.scale = modelNode.Lcl_Scaling.value;\n\n\t\tif ( 'ScalingOffset' in modelNode ) transformData.scalingOffset = modelNode.ScalingOffset.value;\n\t\tif ( 'ScalingPivot' in modelNode ) transformData.scalingPivot = modelNode.ScalingPivot.value;\n\n\t\tif ( 'RotationOffset' in modelNode ) transformData.rotationOffset = modelNode.RotationOffset.value;\n\t\tif ( 'RotationPivot' in modelNode ) transformData.rotationPivot = modelNode.RotationPivot.value;\n\n\t\tmodel.userData.transformData = transformData;\n\n\t}\n\n\tsetLookAtProperties( model, modelNode ) {\n\n\t\tif ( 'LookAtProperty' in modelNode ) {\n\n\t\t\tconst children = connections.get( model.ID ).children;\n\n\t\t\tchildren.forEach( function ( child ) {\n\n\t\t\t\tif ( child.relationship === 'LookAtProperty' ) {\n\n\t\t\t\t\tconst lookAtTarget = fbxTree.Objects.Model[ child.ID ];\n\n\t\t\t\t\tif ( 'Lcl_Translation' in lookAtTarget ) {\n\n\t\t\t\t\t\tconst pos = lookAtTarget.Lcl_Translation.value;\n\n\t\t\t\t\t\t// DirectionalLight, SpotLight\n\t\t\t\t\t\tif ( model.target !== undefined ) {\n\n\t\t\t\t\t\t\tmodel.target.position.fromArray( pos );\n\t\t\t\t\t\t\tsceneGraph.add( model.target );\n\n\t\t\t\t\t\t} else { // Cameras and other Object3Ds\n\n\t\t\t\t\t\t\tmodel.lookAt( new Vector3().fromArray( pos ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tbindSkeleton( skeletons, geometryMap, modelMap ) {\n\n\t\tconst bindMatrices = this.parsePoseNodes();\n\n\t\tfor ( const ID in skeletons ) {\n\n\t\t\tconst skeleton = skeletons[ ID ];\n\n\t\t\tconst parents = connections.get( parseInt( skeleton.ID ) ).parents;\n\n\t\t\tparents.forEach( function ( parent ) {\n\n\t\t\t\tif ( geometryMap.has( parent.ID ) ) {\n\n\t\t\t\t\tconst geoID = parent.ID;\n\t\t\t\t\tconst geoRelationships = connections.get( geoID );\n\n\t\t\t\t\tgeoRelationships.parents.forEach( function ( geoConnParent ) {\n\n\t\t\t\t\t\tif ( modelMap.has( geoConnParent.ID ) ) {\n\n\t\t\t\t\t\t\tconst model = modelMap.get( geoConnParent.ID );\n\n\t\t\t\t\t\t\tmodel.bind( new Skeleton( skeleton.bones ), bindMatrices[ geoConnParent.ID ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tparsePoseNodes() {\n\n\t\tconst bindMatrices = {};\n\n\t\tif ( 'Pose' in fbxTree.Objects ) {\n\n\t\t\tconst BindPoseNode = fbxTree.Objects.Pose;\n\n\t\t\tfor ( const nodeID in BindPoseNode ) {\n\n\t\t\t\tif ( BindPoseNode[ nodeID ].attrType === 'BindPose' && BindPoseNode[ nodeID ].NbPoseNodes > 0 ) {\n\n\t\t\t\t\tconst poseNodes = BindPoseNode[ nodeID ].PoseNode;\n\n\t\t\t\t\tif ( Array.isArray( poseNodes ) ) {\n\n\t\t\t\t\t\tposeNodes.forEach( function ( poseNode ) {\n\n\t\t\t\t\t\t\tbindMatrices[ poseNode.Node ] = new Matrix4().fromArray( poseNode.Matrix.a );\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tbindMatrices[ poseNodes.Node ] = new Matrix4().fromArray( poseNodes.Matrix.a );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bindMatrices;\n\n\t}\n\n\t// Parse ambient color in FBXTree.GlobalSettings - if it's not set to black (default), create an ambient light\n\tcreateAmbientLight() {\n\n\t\tif ( 'GlobalSettings' in fbxTree && 'AmbientColor' in fbxTree.GlobalSettings ) {\n\n\t\t\tconst ambientColor = fbxTree.GlobalSettings.AmbientColor.value;\n\t\t\tconst r = ambientColor[ 0 ];\n\t\t\tconst g = ambientColor[ 1 ];\n\t\t\tconst b = ambientColor[ 2 ];\n\n\t\t\tif ( r !== 0 || g !== 0 || b !== 0 ) {\n\n\t\t\t\tconst color = new Color( r, g, b );\n\t\t\t\tsceneGraph.add( new AmbientLight( color, 1 ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\n// parse Geometry data from FBXTree and return map of BufferGeometries\nclass GeometryParser {\n\n\t// Parse nodes in FBXTree.Objects.Geometry\n\tparse( deformers ) {\n\n\t\tconst geometryMap = new Map();\n\n\t\tif ( 'Geometry' in fbxTree.Objects ) {\n\n\t\t\tconst geoNodes = fbxTree.Objects.Geometry;\n\n\t\t\tfor ( const nodeID in geoNodes ) {\n\n\t\t\t\tconst relationships = connections.get( parseInt( nodeID ) );\n\t\t\t\tconst geo = this.parseGeometry( relationships, geoNodes[ nodeID ], deformers );\n\n\t\t\t\tgeometryMap.set( parseInt( nodeID ), geo );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn geometryMap;\n\n\t}\n\n\t// Parse single node in FBXTree.Objects.Geometry\n\tparseGeometry( relationships, geoNode, deformers ) {\n\n\t\tswitch ( geoNode.attrType ) {\n\n\t\t\tcase 'Mesh':\n\t\t\t\treturn this.parseMeshGeometry( relationships, geoNode, deformers );\n\t\t\t\tbreak;\n\n\t\t\tcase 'NurbsCurve':\n\t\t\t\treturn this.parseNurbsGeometry( geoNode );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\t// Parse single node mesh geometry in FBXTree.Objects.Geometry\n\tparseMeshGeometry( relationships, geoNode, deformers ) {\n\n\t\tconst skeletons = deformers.skeletons;\n\t\tconst morphTargets = [];\n\n\t\tconst modelNodes = relationships.parents.map( function ( parent ) {\n\n\t\t\treturn fbxTree.Objects.Model[ parent.ID ];\n\n\t\t} );\n\n\t\t// don't create geometry if it is not associated with any models\n\t\tif ( modelNodes.length === 0 ) return;\n\n\t\tconst skeleton = relationships.children.reduce( function ( skeleton, child ) {\n\n\t\t\tif ( skeletons[ child.ID ] !== undefined ) skeleton = skeletons[ child.ID ];\n\n\t\t\treturn skeleton;\n\n\t\t}, null );\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tif ( deformers.morphTargets[ child.ID ] !== undefined ) {\n\n\t\t\t\tmorphTargets.push( deformers.morphTargets[ child.ID ] );\n\n\t\t\t}\n\n\t\t} );\n\n\t\t// Assume one model and get the preRotation from that\n\t\t// if there is more than one model associated with the geometry this may cause problems\n\t\tconst modelNode = modelNodes[ 0 ];\n\n\t\tconst transformData = {};\n\n\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = getEulerOrder( modelNode.RotationOrder.value );\n\t\tif ( 'InheritType' in modelNode ) transformData.inheritType = parseInt( modelNode.InheritType.value );\n\n\t\tif ( 'GeometricTranslation' in modelNode ) transformData.translation = modelNode.GeometricTranslation.value;\n\t\tif ( 'GeometricRotation' in modelNode ) transformData.rotation = modelNode.GeometricRotation.value;\n\t\tif ( 'GeometricScaling' in modelNode ) transformData.scale = modelNode.GeometricScaling.value;\n\n\t\tconst transform = generateTransform( transformData );\n\n\t\treturn this.genGeometry( geoNode, skeleton, morphTargets, transform );\n\n\t}\n\n\t// Generate a BufferGeometry from a node in FBXTree.Objects.Geometry\n\tgenGeometry( geoNode, skeleton, morphTargets, preTransform ) {\n\n\t\tconst geo = new BufferGeometry();\n\t\tif ( geoNode.attrName ) geo.name = geoNode.attrName;\n\n\t\tconst geoInfo = this.parseGeoNode( geoNode, skeleton );\n\t\tconst buffers = this.genBuffers( geoInfo );\n\n\t\tconst positionAttribute = new Float32BufferAttribute( buffers.vertex, 3 );\n\n\t\tpositionAttribute.applyMatrix4( preTransform );\n\n\t\tgeo.setAttribute( 'position', positionAttribute );\n\n\t\tif ( buffers.colors.length > 0 ) {\n\n\t\t\tgeo.setAttribute( 'color', new Float32BufferAttribute( buffers.colors, 3 ) );\n\n\t\t}\n\n\t\tif ( skeleton ) {\n\n\t\t\tgeo.setAttribute( 'skinIndex', new Uint16BufferAttribute( buffers.weightsIndices, 4 ) );\n\n\t\t\tgeo.setAttribute( 'skinWeight', new Float32BufferAttribute( buffers.vertexWeights, 4 ) );\n\n\t\t\t// used later to bind the skeleton to the model\n\t\t\tgeo.FBX_Deformer = skeleton;\n\n\t\t}\n\n\t\tif ( buffers.normal.length > 0 ) {\n\n\t\t\tconst normalMatrix = new Matrix3().getNormalMatrix( preTransform );\n\n\t\t\tconst normalAttribute = new Float32BufferAttribute( buffers.normal, 3 );\n\t\t\tnormalAttribute.applyNormalMatrix( normalMatrix );\n\n\t\t\tgeo.setAttribute( 'normal', normalAttribute );\n\n\t\t}\n\n\t\tbuffers.uvs.forEach( function ( uvBuffer, i ) {\n\n\t\t\t// subsequent uv buffers are called 'uv1', 'uv2', ...\n\t\t\tlet name = 'uv' + ( i + 1 ).toString();\n\n\t\t\t// the first uv buffer is just called 'uv'\n\t\t\tif ( i === 0 ) {\n\n\t\t\t\tname = 'uv';\n\n\t\t\t}\n\n\t\t\tgeo.setAttribute( name, new Float32BufferAttribute( buffers.uvs[ i ], 2 ) );\n\n\t\t} );\n\n\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t// Convert the material indices of each vertex into rendering groups on the geometry.\n\t\t\tlet prevMaterialIndex = buffers.materialIndex[ 0 ];\n\t\t\tlet startIndex = 0;\n\n\t\t\tbuffers.materialIndex.forEach( function ( currentIndex, i ) {\n\n\t\t\t\tif ( currentIndex !== prevMaterialIndex ) {\n\n\t\t\t\t\tgeo.addGroup( startIndex, i - startIndex, prevMaterialIndex );\n\n\t\t\t\t\tprevMaterialIndex = currentIndex;\n\t\t\t\t\tstartIndex = i;\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\t// the loop above doesn't add the last group, do that here.\n\t\t\tif ( geo.groups.length > 0 ) {\n\n\t\t\t\tconst lastGroup = geo.groups[ geo.groups.length - 1 ];\n\t\t\t\tconst lastIndex = lastGroup.start + lastGroup.count;\n\n\t\t\t\tif ( lastIndex !== buffers.materialIndex.length ) {\n\n\t\t\t\t\tgeo.addGroup( lastIndex, buffers.materialIndex.length - lastIndex, prevMaterialIndex );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// case where there are multiple materials but the whole geometry is only\n\t\t\t// using one of them\n\t\t\tif ( geo.groups.length === 0 ) {\n\n\t\t\t\tgeo.addGroup( 0, buffers.materialIndex.length, buffers.materialIndex[ 0 ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.addMorphTargets( geo, geoNode, morphTargets, preTransform );\n\n\t\treturn geo;\n\n\t}\n\n\tparseGeoNode( geoNode, skeleton ) {\n\n\t\tconst geoInfo = {};\n\n\t\tgeoInfo.vertexPositions = ( geoNode.Vertices !== undefined ) ? geoNode.Vertices.a : [];\n\t\tgeoInfo.vertexIndices = ( geoNode.PolygonVertexIndex !== undefined ) ? geoNode.PolygonVertexIndex.a : [];\n\n\t\tif ( geoNode.LayerElementColor ) {\n\n\t\t\tgeoInfo.color = this.parseVertexColors( geoNode.LayerElementColor[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementMaterial ) {\n\n\t\t\tgeoInfo.material = this.parseMaterialIndices( geoNode.LayerElementMaterial[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementNormal ) {\n\n\t\t\tgeoInfo.normal = this.parseNormals( geoNode.LayerElementNormal[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementUV ) {\n\n\t\t\tgeoInfo.uv = [];\n\n\t\t\tlet i = 0;\n\t\t\twhile ( geoNode.LayerElementUV[ i ] ) {\n\n\t\t\t\tif ( geoNode.LayerElementUV[ i ].UV ) {\n\n\t\t\t\t\tgeoInfo.uv.push( this.parseUVs( geoNode.LayerElementUV[ i ] ) );\n\n\t\t\t\t}\n\n\t\t\t\ti ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeoInfo.weightTable = {};\n\n\t\tif ( skeleton !== null ) {\n\n\t\t\tgeoInfo.skeleton = skeleton;\n\n\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t// loop over the bone's vertex indices and weights\n\t\t\t\trawBone.indices.forEach( function ( index, j ) {\n\n\t\t\t\t\tif ( geoInfo.weightTable[ index ] === undefined ) geoInfo.weightTable[ index ] = [];\n\n\t\t\t\t\tgeoInfo.weightTable[ index ].push( {\n\n\t\t\t\t\t\tid: i,\n\t\t\t\t\t\tweight: rawBone.weights[ j ],\n\n\t\t\t\t\t} );\n\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn geoInfo;\n\n\t}\n\n\tgenBuffers( geoInfo ) {\n\n\t\tconst buffers = {\n\t\t\tvertex: [],\n\t\t\tnormal: [],\n\t\t\tcolors: [],\n\t\t\tuvs: [],\n\t\t\tmaterialIndex: [],\n\t\t\tvertexWeights: [],\n\t\t\tweightsIndices: [],\n\t\t};\n\n\t\tlet polygonIndex = 0;\n\t\tlet faceLength = 0;\n\t\tlet displayedWeightsWarning = false;\n\n\t\t// these will hold data for a single face\n\t\tlet facePositionIndexes = [];\n\t\tlet faceNormals = [];\n\t\tlet faceColors = [];\n\t\tlet faceUVs = [];\n\t\tlet faceWeights = [];\n\t\tlet faceWeightIndices = [];\n\n\t\tconst scope = this;\n\t\tgeoInfo.vertexIndices.forEach( function ( vertexIndex, polygonVertexIndex ) {\n\n\t\t\tlet materialIndex;\n\t\t\tlet endOfFace = false;\n\n\t\t\t// Face index and vertex index arrays are combined in a single array\n\t\t\t// A cube with quad faces looks like this:\n\t\t\t// PolygonVertexIndex: *24 {\n\t\t\t//  a: 0, 1, 3, -3, 2, 3, 5, -5, 4, 5, 7, -7, 6, 7, 1, -1, 1, 7, 5, -4, 6, 0, 2, -5\n\t\t\t//  }\n\t\t\t// Negative numbers mark the end of a face - first face here is 0, 1, 3, -3\n\t\t\t// to find index of last vertex bit shift the index: ^ - 1\n\t\t\tif ( vertexIndex < 0 ) {\n\n\t\t\t\tvertexIndex = vertexIndex ^ - 1; // equivalent to ( x * -1 ) - 1\n\t\t\t\tendOfFace = true;\n\n\t\t\t}\n\n\t\t\tlet weightIndices = [];\n\t\t\tlet weights = [];\n\n\t\t\tfacePositionIndexes.push( vertexIndex * 3, vertexIndex * 3 + 1, vertexIndex * 3 + 2 );\n\n\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.color );\n\n\t\t\t\tfaceColors.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\tif ( geoInfo.weightTable[ vertexIndex ] !== undefined ) {\n\n\t\t\t\t\tgeoInfo.weightTable[ vertexIndex ].forEach( function ( wt ) {\n\n\t\t\t\t\t\tweights.push( wt.weight );\n\t\t\t\t\t\tweightIndices.push( wt.id );\n\n\t\t\t\t\t} );\n\n\n\t\t\t\t}\n\n\t\t\t\tif ( weights.length > 4 ) {\n\n\t\t\t\t\tif ( ! displayedWeightsWarning ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights.' );\n\t\t\t\t\t\tdisplayedWeightsWarning = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst wIndex = [ 0, 0, 0, 0 ];\n\t\t\t\t\tconst Weight = [ 0, 0, 0, 0 ];\n\n\t\t\t\t\tweights.forEach( function ( weight, weightIndex ) {\n\n\t\t\t\t\t\tlet currentWeight = weight;\n\t\t\t\t\t\tlet currentIndex = weightIndices[ weightIndex ];\n\n\t\t\t\t\t\tWeight.forEach( function ( comparedWeight, comparedWeightIndex, comparedWeightArray ) {\n\n\t\t\t\t\t\t\tif ( currentWeight > comparedWeight ) {\n\n\t\t\t\t\t\t\t\tcomparedWeightArray[ comparedWeightIndex ] = currentWeight;\n\t\t\t\t\t\t\t\tcurrentWeight = comparedWeight;\n\n\t\t\t\t\t\t\t\tconst tmp = wIndex[ comparedWeightIndex ];\n\t\t\t\t\t\t\t\twIndex[ comparedWeightIndex ] = currentIndex;\n\t\t\t\t\t\t\t\tcurrentIndex = tmp;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tweightIndices = wIndex;\n\t\t\t\t\tweights = Weight;\n\n\t\t\t\t}\n\n\t\t\t\t// if the weight array is shorter than 4 pad with 0s\n\t\t\t\twhile ( weights.length < 4 ) {\n\n\t\t\t\t\tweights.push( 0 );\n\t\t\t\t\tweightIndices.push( 0 );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0; i < 4; ++ i ) {\n\n\t\t\t\t\tfaceWeights.push( weights[ i ] );\n\t\t\t\t\tfaceWeightIndices.push( weightIndices[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.normal );\n\n\t\t\t\tfaceNormals.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\tmaterialIndex = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.material )[ 0 ];\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\tgeoInfo.uv.forEach( function ( uv, i ) {\n\n\t\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, uv );\n\n\t\t\t\t\tif ( faceUVs[ i ] === undefined ) {\n\n\t\t\t\t\t\tfaceUVs[ i ] = [];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfaceUVs[ i ].push( data[ 0 ] );\n\t\t\t\t\tfaceUVs[ i ].push( data[ 1 ] );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tfaceLength ++;\n\n\t\t\tif ( endOfFace ) {\n\n\t\t\t\tscope.genFace( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength );\n\n\t\t\t\tpolygonIndex ++;\n\t\t\t\tfaceLength = 0;\n\n\t\t\t\t// reset arrays for the next face\n\t\t\t\tfacePositionIndexes = [];\n\t\t\t\tfaceNormals = [];\n\t\t\t\tfaceColors = [];\n\t\t\t\tfaceUVs = [];\n\t\t\t\tfaceWeights = [];\n\t\t\t\tfaceWeightIndices = [];\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn buffers;\n\n\t}\n\n\t// Generate data for a single face in a geometry. If the face is a quad then split it into 2 tris\n\tgenFace( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength ) {\n\n\t\tfor ( let i = 2; i < faceLength; i ++ ) {\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 0 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ 2 ] ] );\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 + 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ ( i - 1 ) * 3 + 2 ] ] );\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 + 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i * 3 + 2 ] ] );\n\n\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 0 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ 3 ] );\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ ( i - 1 ) * 4 + 3 ] );\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i * 4 + 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 0 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ ( i - 1 ) * 4 + 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i * 4 + 3 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\tbuffers.colors.push( faceColors[ 0 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ 2 ] );\n\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 + 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ ( i - 1 ) * 3 + 2 ] );\n\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 + 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i * 3 + 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\tbuffers.normal.push( faceNormals[ 0 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ 2 ] );\n\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 + 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ ( i - 1 ) * 3 + 2 ] );\n\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 + 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i * 3 + 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\tgeoInfo.uv.forEach( function ( uv, j ) {\n\n\t\t\t\t\tif ( buffers.uvs[ j ] === undefined ) buffers.uvs[ j ] = [];\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ 0 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ 1 ] );\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ ( i - 1 ) * 2 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ ( i - 1 ) * 2 + 1 ] );\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i * 2 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i * 2 + 1 ] );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\taddMorphTargets( parentGeo, parentGeoNode, morphTargets, preTransform ) {\n\n\t\tif ( morphTargets.length === 0 ) return;\n\n\t\tparentGeo.morphTargetsRelative = true;\n\n\t\tparentGeo.morphAttributes.position = [];\n\t\t// parentGeo.morphAttributes.normal = []; // not implemented\n\n\t\tconst scope = this;\n\t\tmorphTargets.forEach( function ( morphTarget ) {\n\n\t\t\tmorphTarget.rawTargets.forEach( function ( rawTarget ) {\n\n\t\t\t\tconst morphGeoNode = fbxTree.Objects.Geometry[ rawTarget.geoID ];\n\n\t\t\t\tif ( morphGeoNode !== undefined ) {\n\n\t\t\t\t\tscope.genMorphGeometry( parentGeo, parentGeoNode, morphGeoNode, preTransform, rawTarget.name );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t// a morph geometry node is similar to a standard  node, and the node is also contained\n\t// in FBXTree.Objects.Geometry, however it can only have attributes for position, normal\n\t// and a special attribute Index defining which vertices of the original geometry are affected\n\t// Normal and position attributes only have data for the vertices that are affected by the morph\n\tgenMorphGeometry( parentGeo, parentGeoNode, morphGeoNode, preTransform, name ) {\n\n\t\tconst vertexIndices = ( parentGeoNode.PolygonVertexIndex !== undefined ) ? parentGeoNode.PolygonVertexIndex.a : [];\n\n\t\tconst morphPositionsSparse = ( morphGeoNode.Vertices !== undefined ) ? morphGeoNode.Vertices.a : [];\n\t\tconst indices = ( morphGeoNode.Indexes !== undefined ) ? morphGeoNode.Indexes.a : [];\n\n\t\tconst length = parentGeo.attributes.position.count * 3;\n\t\tconst morphPositions = new Float32Array( length );\n\n\t\tfor ( let i = 0; i < indices.length; i ++ ) {\n\n\t\t\tconst morphIndex = indices[ i ] * 3;\n\n\t\t\tmorphPositions[ morphIndex ] = morphPositionsSparse[ i * 3 ];\n\t\t\tmorphPositions[ morphIndex + 1 ] = morphPositionsSparse[ i * 3 + 1 ];\n\t\t\tmorphPositions[ morphIndex + 2 ] = morphPositionsSparse[ i * 3 + 2 ];\n\n\t\t}\n\n\t\t// TODO: add morph normal support\n\t\tconst morphGeoInfo = {\n\t\t\tvertexIndices: vertexIndices,\n\t\t\tvertexPositions: morphPositions,\n\n\t\t};\n\n\t\tconst morphBuffers = this.genBuffers( morphGeoInfo );\n\n\t\tconst positionAttribute = new Float32BufferAttribute( morphBuffers.vertex, 3 );\n\t\tpositionAttribute.name = name || morphGeoNode.attrName;\n\n\t\tpositionAttribute.applyMatrix4( preTransform );\n\n\t\tparentGeo.morphAttributes.position.push( positionAttribute );\n\n\t}\n\n\t// Parse normal from FBXTree.Objects.Geometry.LayerElementNormal if it exists\n\tparseNormals( NormalNode ) {\n\n\t\tconst mappingType = NormalNode.MappingInformationType;\n\t\tconst referenceType = NormalNode.ReferenceInformationType;\n\t\tconst buffer = NormalNode.Normals.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tif ( 'NormalIndex' in NormalNode ) {\n\n\t\t\t\tindexBuffer = NormalNode.NormalIndex.a;\n\n\t\t\t} else if ( 'NormalsIndex' in NormalNode ) {\n\n\t\t\t\tindexBuffer = NormalNode.NormalsIndex.a;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 3,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse UVs from FBXTree.Objects.Geometry.LayerElementUV if it exists\n\tparseUVs( UVNode ) {\n\n\t\tconst mappingType = UVNode.MappingInformationType;\n\t\tconst referenceType = UVNode.ReferenceInformationType;\n\t\tconst buffer = UVNode.UV.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tindexBuffer = UVNode.UVIndex.a;\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 2,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse Vertex Colors from FBXTree.Objects.Geometry.LayerElementColor if it exists\n\tparseVertexColors( ColorNode ) {\n\n\t\tconst mappingType = ColorNode.MappingInformationType;\n\t\tconst referenceType = ColorNode.ReferenceInformationType;\n\t\tconst buffer = ColorNode.Colors.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tindexBuffer = ColorNode.ColorIndex.a;\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 4,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse mapping and material data in FBXTree.Objects.Geometry.LayerElementMaterial if it exists\n\tparseMaterialIndices( MaterialNode ) {\n\n\t\tconst mappingType = MaterialNode.MappingInformationType;\n\t\tconst referenceType = MaterialNode.ReferenceInformationType;\n\n\t\tif ( mappingType === 'NoMappingInformation' ) {\n\n\t\t\treturn {\n\t\t\t\tdataSize: 1,\n\t\t\t\tbuffer: [ 0 ],\n\t\t\t\tindices: [ 0 ],\n\t\t\t\tmappingType: 'AllSame',\n\t\t\t\treferenceType: referenceType\n\t\t\t};\n\n\t\t}\n\n\t\tconst materialIndexBuffer = MaterialNode.Materials.a;\n\n\t\t// Since materials are stored as indices, there's a bit of a mismatch between FBX and what\n\t\t// we expect.So we create an intermediate buffer that points to the index in the buffer,\n\t\t// for conforming with the other functions we've written for other data.\n\t\tconst materialIndices = [];\n\n\t\tfor ( let i = 0; i < materialIndexBuffer.length; ++ i ) {\n\n\t\t\tmaterialIndices.push( i );\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 1,\n\t\t\tbuffer: materialIndexBuffer,\n\t\t\tindices: materialIndices,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Generate a NurbGeometry from a node in FBXTree.Objects.Geometry\n\tparseNurbsGeometry( geoNode ) {\n\n\t\tif ( NURBSCurve === undefined ) {\n\n\t\t\tconsole.error( 'THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry.' );\n\t\t\treturn new BufferGeometry();\n\n\t\t}\n\n\t\tconst order = parseInt( geoNode.Order );\n\n\t\tif ( isNaN( order ) ) {\n\n\t\t\tconsole.error( 'THREE.FBXLoader: Invalid Order %s given for geometry ID: %s', geoNode.Order, geoNode.id );\n\t\t\treturn new BufferGeometry();\n\n\t\t}\n\n\t\tconst degree = order - 1;\n\n\t\tconst knots = geoNode.KnotVector.a;\n\t\tconst controlPoints = [];\n\t\tconst pointsValues = geoNode.Points.a;\n\n\t\tfor ( let i = 0, l = pointsValues.length; i < l; i += 4 ) {\n\n\t\t\tcontrolPoints.push( new Vector4().fromArray( pointsValues, i ) );\n\n\t\t}\n\n\t\tlet startKnot, endKnot;\n\n\t\tif ( geoNode.Form === 'Closed' ) {\n\n\t\t\tcontrolPoints.push( controlPoints[ 0 ] );\n\n\t\t} else if ( geoNode.Form === 'Periodic' ) {\n\n\t\t\tstartKnot = degree;\n\t\t\tendKnot = knots.length - 1 - startKnot;\n\n\t\t\tfor ( let i = 0; i < degree; ++ i ) {\n\n\t\t\t\tcontrolPoints.push( controlPoints[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst curve = new NURBSCurve( degree, knots, controlPoints, startKnot, endKnot );\n\t\tconst points = curve.getPoints( controlPoints.length * 12 );\n\n\t\treturn new BufferGeometry().setFromPoints( points );\n\n\t}\n\n}\n\n// parse animation data from FBXTree\nclass AnimationParser {\n\n\t// take raw animation clips and turn them into three.js animation clips\n\tparse() {\n\n\t\tconst animationClips = [];\n\n\t\tconst rawClips = this.parseClips();\n\n\t\tif ( rawClips !== undefined ) {\n\n\t\t\tfor ( const key in rawClips ) {\n\n\t\t\t\tconst rawClip = rawClips[ key ];\n\n\t\t\t\tconst clip = this.addClip( rawClip );\n\n\t\t\t\tanimationClips.push( clip );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn animationClips;\n\n\t}\n\n\tparseClips() {\n\n\t\t// since the actual transformation data is stored in FBXTree.Objects.AnimationCurve,\n\t\t// if this is undefined we can safely assume there are no animations\n\t\tif ( fbxTree.Objects.AnimationCurve === undefined ) return undefined;\n\n\t\tconst curveNodesMap = this.parseAnimationCurveNodes();\n\n\t\tthis.parseAnimationCurves( curveNodesMap );\n\n\t\tconst layersMap = this.parseAnimationLayers( curveNodesMap );\n\t\tconst rawClips = this.parseAnimStacks( layersMap );\n\n\t\treturn rawClips;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationCurveNode\n\t// each AnimationCurveNode holds data for an animation transform for a model (e.g. left arm rotation )\n\t// and is referenced by an AnimationLayer\n\tparseAnimationCurveNodes() {\n\n\t\tconst rawCurveNodes = fbxTree.Objects.AnimationCurveNode;\n\n\t\tconst curveNodesMap = new Map();\n\n\t\tfor ( const nodeID in rawCurveNodes ) {\n\n\t\t\tconst rawCurveNode = rawCurveNodes[ nodeID ];\n\n\t\t\tif ( rawCurveNode.attrName.match( /S|R|T|DeformPercent/ ) !== null ) {\n\n\t\t\t\tconst curveNode = {\n\n\t\t\t\t\tid: rawCurveNode.id,\n\t\t\t\t\tattr: rawCurveNode.attrName,\n\t\t\t\t\tcurves: {},\n\n\t\t\t\t};\n\n\t\t\t\tcurveNodesMap.set( curveNode.id, curveNode );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn curveNodesMap;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationCurve and connect them up to\n\t// previously parsed AnimationCurveNodes. Each AnimationCurve holds data for a single animated\n\t// axis ( e.g. times and values of x rotation)\n\tparseAnimationCurves( curveNodesMap ) {\n\n\t\tconst rawCurves = fbxTree.Objects.AnimationCurve;\n\n\t\t// TODO: Many values are identical up to roundoff error, but won't be optimised\n\t\t// e.g. position times: [0, 0.4, 0. 8]\n\t\t// position values: [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.235384487103147e-7, 93.67520904541016, -0.9982695579528809]\n\t\t// clearly, this should be optimised to\n\t\t// times: [0], positions [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809]\n\t\t// this shows up in nearly every FBX file, and generally time array is length > 100\n\n\t\tfor ( const nodeID in rawCurves ) {\n\n\t\t\tconst animationCurve = {\n\n\t\t\t\tid: rawCurves[ nodeID ].id,\n\t\t\t\ttimes: rawCurves[ nodeID ].KeyTime.a.map( convertFBXTimeToSeconds ),\n\t\t\t\tvalues: rawCurves[ nodeID ].KeyValueFloat.a,\n\n\t\t\t};\n\n\t\t\tconst relationships = connections.get( animationCurve.id );\n\n\t\t\tif ( relationships !== undefined ) {\n\n\t\t\t\tconst animationCurveID = relationships.parents[ 0 ].ID;\n\t\t\t\tconst animationCurveRelationship = relationships.parents[ 0 ].relationship;\n\n\t\t\t\tif ( animationCurveRelationship.match( /X/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'x' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /Y/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'y' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /Z/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'z' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /d|DeformPercent/ ) && curveNodesMap.has( animationCurveID ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'morph' ] = animationCurve;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationLayer. Each layers holds references\n\t// to various AnimationCurveNodes and is referenced by an AnimationStack node\n\t// note: theoretically a stack can have multiple layers, however in practice there always seems to be one per stack\n\tparseAnimationLayers( curveNodesMap ) {\n\n\t\tconst rawLayers = fbxTree.Objects.AnimationLayer;\n\n\t\tconst layersMap = new Map();\n\n\t\tfor ( const nodeID in rawLayers ) {\n\n\t\t\tconst layerCurveNodes = [];\n\n\t\t\tconst connection = connections.get( parseInt( nodeID ) );\n\n\t\t\tif ( connection !== undefined ) {\n\n\t\t\t\t// all the animationCurveNodes used in the layer\n\t\t\t\tconst children = connection.children;\n\n\t\t\t\tchildren.forEach( function ( child, i ) {\n\n\t\t\t\t\tif ( curveNodesMap.has( child.ID ) ) {\n\n\t\t\t\t\t\tconst curveNode = curveNodesMap.get( child.ID );\n\n\t\t\t\t\t\t// check that the curves are defined for at least one axis, otherwise ignore the curveNode\n\t\t\t\t\t\tif ( curveNode.curves.x !== undefined || curveNode.curves.y !== undefined || curveNode.curves.z !== undefined ) {\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\tconst modelID = connections.get( child.ID ).parents.filter( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\treturn parent.relationship !== undefined;\n\n\t\t\t\t\t\t\t\t} )[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tif ( modelID !== undefined ) {\n\n\t\t\t\t\t\t\t\t\tconst rawModel = fbxTree.Objects.Model[ modelID.toString() ];\n\n\t\t\t\t\t\t\t\t\tif ( rawModel === undefined ) {\n\n\t\t\t\t\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Encountered a unused curve.', child );\n\t\t\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tconst node = {\n\n\t\t\t\t\t\t\t\t\t\tmodelName: rawModel.attrName ? PropertyBinding.sanitizeNodeName( rawModel.attrName ) : '',\n\t\t\t\t\t\t\t\t\t\tID: rawModel.id,\n\t\t\t\t\t\t\t\t\t\tinitialPosition: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialRotation: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialScale: [ 1, 1, 1 ],\n\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\tsceneGraph.traverse( function ( child ) {\n\n\t\t\t\t\t\t\t\t\t\tif ( child.ID === rawModel.id ) {\n\n\t\t\t\t\t\t\t\t\t\t\tnode.transform = child.matrix;\n\n\t\t\t\t\t\t\t\t\t\t\tif ( child.userData.transformData ) node.eulerOrder = child.userData.transformData.eulerOrder;\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t\t\tif ( ! node.transform ) node.transform = new Matrix4();\n\n\t\t\t\t\t\t\t\t\t// if the animated model is pre rotated, we'll have to apply the pre rotations to every\n\t\t\t\t\t\t\t\t\t// animation value as well\n\t\t\t\t\t\t\t\t\tif ( 'PreRotation' in rawModel ) node.preRotation = rawModel.PreRotation.value;\n\t\t\t\t\t\t\t\t\tif ( 'PostRotation' in rawModel ) node.postRotation = rawModel.PostRotation.value;\n\n\t\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] ) layerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t} else if ( curveNode.curves.morph !== undefined ) {\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\tconst deformerID = connections.get( child.ID ).parents.filter( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\treturn parent.relationship !== undefined;\n\n\t\t\t\t\t\t\t\t} )[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tconst morpherID = connections.get( deformerID ).parents[ 0 ].ID;\n\t\t\t\t\t\t\t\tconst geoID = connections.get( morpherID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\t// assuming geometry is not used in more than one model\n\t\t\t\t\t\t\t\tconst modelID = connections.get( geoID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tconst rawModel = fbxTree.Objects.Model[ modelID ];\n\n\t\t\t\t\t\t\t\tconst node = {\n\n\t\t\t\t\t\t\t\t\tmodelName: rawModel.attrName ? PropertyBinding.sanitizeNodeName( rawModel.attrName ) : '',\n\t\t\t\t\t\t\t\t\tmorphName: fbxTree.Objects.Deformer[ deformerID ].attrName,\n\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlayerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\tlayersMap.set( parseInt( nodeID ), layerCurveNodes );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn layersMap;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationStack. These are the top level node in the animation\n\t// hierarchy. Each Stack node will be used to create a AnimationClip\n\tparseAnimStacks( layersMap ) {\n\n\t\tconst rawStacks = fbxTree.Objects.AnimationStack;\n\n\t\t// connect the stacks (clips) up to the layers\n\t\tconst rawClips = {};\n\n\t\tfor ( const nodeID in rawStacks ) {\n\n\t\t\tconst children = connections.get( parseInt( nodeID ) ).children;\n\n\t\t\tif ( children.length > 1 ) {\n\n\t\t\t\t// it seems like stacks will always be associated with a single layer. But just in case there are files\n\t\t\t\t// where there are multiple layers per stack, we'll display a warning\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.' );\n\n\t\t\t}\n\n\t\t\tconst layer = layersMap.get( children[ 0 ].ID );\n\n\t\t\trawClips[ nodeID ] = {\n\n\t\t\t\tname: rawStacks[ nodeID ].attrName,\n\t\t\t\tlayer: layer,\n\n\t\t\t};\n\n\t\t}\n\n\t\treturn rawClips;\n\n\t}\n\n\taddClip( rawClip ) {\n\n\t\tlet tracks = [];\n\n\t\tconst scope = this;\n\t\trawClip.layer.forEach( function ( rawTracks ) {\n\n\t\t\ttracks = tracks.concat( scope.generateTracks( rawTracks ) );\n\n\t\t} );\n\n\t\treturn new AnimationClip( rawClip.name, - 1, tracks );\n\n\t}\n\n\tgenerateTracks( rawTracks ) {\n\n\t\tconst tracks = [];\n\n\t\tlet initialPosition = new Vector3();\n\t\tlet initialRotation = new Quaternion();\n\t\tlet initialScale = new Vector3();\n\n\t\tif ( rawTracks.transform ) rawTracks.transform.decompose( initialPosition, initialRotation, initialScale );\n\n\t\tinitialPosition = initialPosition.toArray();\n\t\tinitialRotation = new Euler().setFromQuaternion( initialRotation, rawTracks.eulerOrder ).toArray();\n\t\tinitialScale = initialScale.toArray();\n\n\t\tif ( rawTracks.T !== undefined && Object.keys( rawTracks.T.curves ).length > 0 ) {\n\n\t\t\tconst positionTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.T.curves, initialPosition, 'position' );\n\t\t\tif ( positionTrack !== undefined ) tracks.push( positionTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.R !== undefined && Object.keys( rawTracks.R.curves ).length > 0 ) {\n\n\t\t\tconst rotationTrack = this.generateRotationTrack( rawTracks.modelName, rawTracks.R.curves, initialRotation, rawTracks.preRotation, rawTracks.postRotation, rawTracks.eulerOrder );\n\t\t\tif ( rotationTrack !== undefined ) tracks.push( rotationTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.S !== undefined && Object.keys( rawTracks.S.curves ).length > 0 ) {\n\n\t\t\tconst scaleTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.S.curves, initialScale, 'scale' );\n\t\t\tif ( scaleTrack !== undefined ) tracks.push( scaleTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.DeformPercent !== undefined ) {\n\n\t\t\tconst morphTrack = this.generateMorphTrack( rawTracks );\n\t\t\tif ( morphTrack !== undefined ) tracks.push( morphTrack );\n\n\t\t}\n\n\t\treturn tracks;\n\n\t}\n\n\tgenerateVectorTrack( modelName, curves, initialValue, type ) {\n\n\t\tconst times = this.getTimesForAllAxes( curves );\n\t\tconst values = this.getKeyframeTrackValues( times, curves, initialValue );\n\n\t\treturn new VectorKeyframeTrack( modelName + '.' + type, times, values );\n\n\t}\n\n\tgenerateRotationTrack( modelName, curves, initialValue, preRotation, postRotation, eulerOrder ) {\n\n\t\tif ( curves.x !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.x );\n\t\t\tcurves.x.values = curves.x.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tif ( curves.y !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.y );\n\t\t\tcurves.y.values = curves.y.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tif ( curves.z !== undefined ) {\n\n\t\t\tthis.interpolateRotations( curves.z );\n\t\t\tcurves.z.values = curves.z.values.map( MathUtils.degToRad );\n\n\t\t}\n\n\t\tconst times = this.getTimesForAllAxes( curves );\n\t\tconst values = this.getKeyframeTrackValues( times, curves, initialValue );\n\n\t\tif ( preRotation !== undefined ) {\n\n\t\t\tpreRotation = preRotation.map( MathUtils.degToRad );\n\t\t\tpreRotation.push( eulerOrder );\n\n\t\t\tpreRotation = new Euler().fromArray( preRotation );\n\t\t\tpreRotation = new Quaternion().setFromEuler( preRotation );\n\n\t\t}\n\n\t\tif ( postRotation !== undefined ) {\n\n\t\t\tpostRotation = postRotation.map( MathUtils.degToRad );\n\t\t\tpostRotation.push( eulerOrder );\n\n\t\t\tpostRotation = new Euler().fromArray( postRotation );\n\t\t\tpostRotation = new Quaternion().setFromEuler( postRotation ).invert();\n\n\t\t}\n\n\t\tconst quaternion = new Quaternion();\n\t\tconst euler = new Euler();\n\n\t\tconst quaternionValues = [];\n\n\t\tfor ( let i = 0; i < values.length; i += 3 ) {\n\n\t\t\teuler.set( values[ i ], values[ i + 1 ], values[ i + 2 ], eulerOrder );\n\n\t\t\tquaternion.setFromEuler( euler );\n\n\t\t\tif ( preRotation !== undefined ) quaternion.premultiply( preRotation );\n\t\t\tif ( postRotation !== undefined ) quaternion.multiply( postRotation );\n\n\t\t\tquaternion.toArray( quaternionValues, ( i / 3 ) * 4 );\n\n\t\t}\n\n\t\treturn new QuaternionKeyframeTrack( modelName + '.quaternion', times, quaternionValues );\n\n\t}\n\n\tgenerateMorphTrack( rawTracks ) {\n\n\t\tconst curves = rawTracks.DeformPercent.curves.morph;\n\t\tconst values = curves.values.map( function ( val ) {\n\n\t\t\treturn val / 100;\n\n\t\t} );\n\n\t\tconst morphNum = sceneGraph.getObjectByName( rawTracks.modelName ).morphTargetDictionary[ rawTracks.morphName ];\n\n\t\treturn new NumberKeyframeTrack( rawTracks.modelName + '.morphTargetInfluences[' + morphNum + ']', curves.times, values );\n\n\t}\n\n\t// For all animated objects, times are defined separately for each axis\n\t// Here we'll combine the times into one sorted array without duplicates\n\tgetTimesForAllAxes( curves ) {\n\n\t\tlet times = [];\n\n\t\t// first join together the times for each axis, if defined\n\t\tif ( curves.x !== undefined ) times = times.concat( curves.x.times );\n\t\tif ( curves.y !== undefined ) times = times.concat( curves.y.times );\n\t\tif ( curves.z !== undefined ) times = times.concat( curves.z.times );\n\n\t\t// then sort them\n\t\ttimes = times.sort( function ( a, b ) {\n\n\t\t\treturn a - b;\n\n\t\t} );\n\n\t\t// and remove duplicates\n\t\tif ( times.length > 1 ) {\n\n\t\t\tlet targetIndex = 1;\n\t\t\tlet lastValue = times[ 0 ];\n\t\t\tfor ( let i = 1; i < times.length; i ++ ) {\n\n\t\t\t\tconst currentValue = times[ i ];\n\t\t\t\tif ( currentValue !== lastValue ) {\n\n\t\t\t\t\ttimes[ targetIndex ] = currentValue;\n\t\t\t\t\tlastValue = currentValue;\n\t\t\t\t\ttargetIndex ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttimes = times.slice( 0, targetIndex );\n\n\t\t}\n\n\t\treturn times;\n\n\t}\n\n\tgetKeyframeTrackValues( times, curves, initialValue ) {\n\n\t\tconst prevValue = initialValue;\n\n\t\tconst values = [];\n\n\t\tlet xIndex = - 1;\n\t\tlet yIndex = - 1;\n\t\tlet zIndex = - 1;\n\n\t\ttimes.forEach( function ( time ) {\n\n\t\t\tif ( curves.x ) xIndex = curves.x.times.indexOf( time );\n\t\t\tif ( curves.y ) yIndex = curves.y.times.indexOf( time );\n\t\t\tif ( curves.z ) zIndex = curves.z.times.indexOf( time );\n\n\t\t\t// if there is an x value defined for this frame, use that\n\t\t\tif ( xIndex !== - 1 ) {\n\n\t\t\t\tconst xValue = curves.x.values[ xIndex ];\n\t\t\t\tvalues.push( xValue );\n\t\t\t\tprevValue[ 0 ] = xValue;\n\n\t\t\t} else {\n\n\t\t\t\t// otherwise use the x value from the previous frame\n\t\t\t\tvalues.push( prevValue[ 0 ] );\n\n\t\t\t}\n\n\t\t\tif ( yIndex !== - 1 ) {\n\n\t\t\t\tconst yValue = curves.y.values[ yIndex ];\n\t\t\t\tvalues.push( yValue );\n\t\t\t\tprevValue[ 1 ] = yValue;\n\n\t\t\t} else {\n\n\t\t\t\tvalues.push( prevValue[ 1 ] );\n\n\t\t\t}\n\n\t\t\tif ( zIndex !== - 1 ) {\n\n\t\t\t\tconst zValue = curves.z.values[ zIndex ];\n\t\t\t\tvalues.push( zValue );\n\t\t\t\tprevValue[ 2 ] = zValue;\n\n\t\t\t} else {\n\n\t\t\t\tvalues.push( prevValue[ 2 ] );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn values;\n\n\t}\n\n\t// Rotations are defined as Euler angles which can have values  of any size\n\t// These will be converted to quaternions which don't support values greater than\n\t// PI, so we'll interpolate large rotations\n\tinterpolateRotations( curve ) {\n\n\t\tfor ( let i = 1; i < curve.values.length; i ++ ) {\n\n\t\t\tconst initialValue = curve.values[ i - 1 ];\n\t\t\tconst valuesSpan = curve.values[ i ] - initialValue;\n\n\t\t\tconst absoluteSpan = Math.abs( valuesSpan );\n\n\t\t\tif ( absoluteSpan >= 180 ) {\n\n\t\t\t\tconst numSubIntervals = absoluteSpan / 180;\n\n\t\t\t\tconst step = valuesSpan / numSubIntervals;\n\t\t\t\tlet nextValue = initialValue + step;\n\n\t\t\t\tconst initialTime = curve.times[ i - 1 ];\n\t\t\t\tconst timeSpan = curve.times[ i ] - initialTime;\n\t\t\t\tconst interval = timeSpan / numSubIntervals;\n\t\t\t\tlet nextTime = initialTime + interval;\n\n\t\t\t\tconst interpolatedTimes = [];\n\t\t\t\tconst interpolatedValues = [];\n\n\t\t\t\twhile ( nextTime < curve.times[ i ] ) {\n\n\t\t\t\t\tinterpolatedTimes.push( nextTime );\n\t\t\t\t\tnextTime += interval;\n\n\t\t\t\t\tinterpolatedValues.push( nextValue );\n\t\t\t\t\tnextValue += step;\n\n\t\t\t\t}\n\n\t\t\t\tcurve.times = inject( curve.times, i, interpolatedTimes );\n\t\t\t\tcurve.values = inject( curve.values, i, interpolatedValues );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\n// parse an FBX file in ASCII format\nclass TextParser {\n\n\tgetPrevNode() {\n\n\t\treturn this.nodeStack[ this.currentIndent - 2 ];\n\n\t}\n\n\tgetCurrentNode() {\n\n\t\treturn this.nodeStack[ this.currentIndent - 1 ];\n\n\t}\n\n\tgetCurrentProp() {\n\n\t\treturn this.currentProp;\n\n\t}\n\n\tpushStack( node ) {\n\n\t\tthis.nodeStack.push( node );\n\t\tthis.currentIndent += 1;\n\n\t}\n\n\tpopStack() {\n\n\t\tthis.nodeStack.pop();\n\t\tthis.currentIndent -= 1;\n\n\t}\n\n\tsetCurrentProp( val, name ) {\n\n\t\tthis.currentProp = val;\n\t\tthis.currentPropName = name;\n\n\t}\n\n\tparse( text ) {\n\n\t\tthis.currentIndent = 0;\n\n\t\tthis.allNodes = new FBXTree();\n\t\tthis.nodeStack = [];\n\t\tthis.currentProp = [];\n\t\tthis.currentPropName = '';\n\n\t\tconst scope = this;\n\n\t\tconst split = text.split( /[\\r\\n]+/ );\n\n\t\tsplit.forEach( function ( line, i ) {\n\n\t\t\tconst matchComment = line.match( /^[\\s\\t]*;/ );\n\t\t\tconst matchEmpty = line.match( /^[\\s\\t]*$/ );\n\n\t\t\tif ( matchComment || matchEmpty ) return;\n\n\t\t\tconst matchBeginning = line.match( '^\\\\t{' + scope.currentIndent + '}(\\\\w+):(.*){', '' );\n\t\t\tconst matchProperty = line.match( '^\\\\t{' + ( scope.currentIndent ) + '}(\\\\w+):[\\\\s\\\\t\\\\r\\\\n](.*)' );\n\t\t\tconst matchEnd = line.match( '^\\\\t{' + ( scope.currentIndent - 1 ) + '}}' );\n\n\t\t\tif ( matchBeginning ) {\n\n\t\t\t\tscope.parseNodeBegin( line, matchBeginning );\n\n\t\t\t} else if ( matchProperty ) {\n\n\t\t\t\tscope.parseNodeProperty( line, matchProperty, split[ ++ i ] );\n\n\t\t\t} else if ( matchEnd ) {\n\n\t\t\t\tscope.popStack();\n\n\t\t\t} else if ( line.match( /^[^\\s\\t}]/ ) ) {\n\n\t\t\t\t// large arrays are split over multiple lines terminated with a ',' character\n\t\t\t\t// if this is encountered the line needs to be joined to the previous line\n\t\t\t\tscope.parseNodePropertyContinued( line );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn this.allNodes;\n\n\t}\n\n\tparseNodeBegin( line, property ) {\n\n\t\tconst nodeName = property[ 1 ].trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\tconst nodeAttrs = property[ 2 ].split( ',' ).map( function ( attr ) {\n\n\t\t\treturn attr.trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\t} );\n\n\t\tconst node = { name: nodeName };\n\t\tconst attrs = this.parseNodeAttr( nodeAttrs );\n\n\t\tconst currentNode = this.getCurrentNode();\n\n\t\t// a top node\n\t\tif ( this.currentIndent === 0 ) {\n\n\t\t\tthis.allNodes.add( nodeName, node );\n\n\t\t} else { // a subnode\n\n\t\t\t// if the subnode already exists, append it\n\t\t\tif ( nodeName in currentNode ) {\n\n\t\t\t\t// special case Pose needs PoseNodes as an array\n\t\t\t\tif ( nodeName === 'PoseNode' ) {\n\n\t\t\t\t\tcurrentNode.PoseNode.push( node );\n\n\t\t\t\t} else if ( currentNode[ nodeName ].id !== undefined ) {\n\n\t\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\t\tcurrentNode[ nodeName ][ currentNode[ nodeName ].id ] = currentNode[ nodeName ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( attrs.id !== '' ) currentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t} else if ( typeof attrs.id === 'number' ) {\n\n\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\tcurrentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t} else if ( nodeName !== 'Properties70' ) {\n\n\t\t\t\tif ( nodeName === 'PoseNode' )\tcurrentNode[ nodeName ] = [ node ];\n\t\t\t\telse currentNode[ nodeName ] = node;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( typeof attrs.id === 'number' ) node.id = attrs.id;\n\t\tif ( attrs.name !== '' ) node.attrName = attrs.name;\n\t\tif ( attrs.type !== '' ) node.attrType = attrs.type;\n\n\t\tthis.pushStack( node );\n\n\t}\n\n\tparseNodeAttr( attrs ) {\n\n\t\tlet id = attrs[ 0 ];\n\n\t\tif ( attrs[ 0 ] !== '' ) {\n\n\t\t\tid = parseInt( attrs[ 0 ] );\n\n\t\t\tif ( isNaN( id ) ) {\n\n\t\t\t\tid = attrs[ 0 ];\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet name = '', type = '';\n\n\t\tif ( attrs.length > 1 ) {\n\n\t\t\tname = attrs[ 1 ].replace( /^(\\w+)::/, '' );\n\t\t\ttype = attrs[ 2 ];\n\n\t\t}\n\n\t\treturn { id: id, name: name, type: type };\n\n\t}\n\n\tparseNodeProperty( line, property, contentLine ) {\n\n\t\tlet propName = property[ 1 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\t\tlet propValue = property[ 2 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\n\t\t// for special case: base64 image data follows \"Content: ,\" line\n\t\t//\tContent: ,\n\t\t//\t \"/9j/4RDaRXhpZgAATU0A...\"\n\t\tif ( propName === 'Content' && propValue === ',' ) {\n\n\t\t\tpropValue = contentLine.replace( /\"/g, '' ).replace( /,$/, '' ).trim();\n\n\t\t}\n\n\t\tconst currentNode = this.getCurrentNode();\n\t\tconst parentName = currentNode.name;\n\n\t\tif ( parentName === 'Properties70' ) {\n\n\t\t\tthis.parseNodeSpecialProperty( line, propName, propValue );\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Connections\n\t\tif ( propName === 'C' ) {\n\n\t\t\tconst connProps = propValue.split( ',' ).slice( 1 );\n\t\t\tconst from = parseInt( connProps[ 0 ] );\n\t\t\tconst to = parseInt( connProps[ 1 ] );\n\n\t\t\tlet rest = propValue.split( ',' ).slice( 3 );\n\n\t\t\trest = rest.map( function ( elem ) {\n\n\t\t\t\treturn elem.trim().replace( /^\"/, '' );\n\n\t\t\t} );\n\n\t\t\tpropName = 'connections';\n\t\t\tpropValue = [ from, to ];\n\t\t\tappend( propValue, rest );\n\n\t\t\tif ( currentNode[ propName ] === undefined ) {\n\n\t\t\t\tcurrentNode[ propName ] = [];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Node\n\t\tif ( propName === 'Node' ) currentNode.id = propValue;\n\n\t\t// connections\n\t\tif ( propName in currentNode && Array.isArray( currentNode[ propName ] ) ) {\n\n\t\t\tcurrentNode[ propName ].push( propValue );\n\n\t\t} else {\n\n\t\t\tif ( propName !== 'a' ) currentNode[ propName ] = propValue;\n\t\t\telse currentNode.a = propValue;\n\n\t\t}\n\n\t\tthis.setCurrentProp( currentNode, propName );\n\n\t\t// convert string to array, unless it ends in ',' in which case more will be added to it\n\t\tif ( propName === 'a' && propValue.slice( - 1 ) !== ',' ) {\n\n\t\t\tcurrentNode.a = parseNumberArray( propValue );\n\n\t\t}\n\n\t}\n\n\tparseNodePropertyContinued( line ) {\n\n\t\tconst currentNode = this.getCurrentNode();\n\n\t\tcurrentNode.a += line;\n\n\t\t// if the line doesn't end in ',' we have reached the end of the property value\n\t\t// so convert the string to an array\n\t\tif ( line.slice( - 1 ) !== ',' ) {\n\n\t\t\tcurrentNode.a = parseNumberArray( currentNode.a );\n\n\t\t}\n\n\t}\n\n\t// parse \"Property70\"\n\tparseNodeSpecialProperty( line, propName, propValue ) {\n\n\t\t// split this\n\t\t// P: \"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\",1,1,1\n\t\t// into array like below\n\t\t// [\"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\", \"1,1,1\" ]\n\t\tconst props = propValue.split( '\",' ).map( function ( prop ) {\n\n\t\t\treturn prop.trim().replace( /^\\\"/, '' ).replace( /\\s/, '_' );\n\n\t\t} );\n\n\t\tconst innerPropName = props[ 0 ];\n\t\tconst innerPropType1 = props[ 1 ];\n\t\tconst innerPropType2 = props[ 2 ];\n\t\tconst innerPropFlag = props[ 3 ];\n\t\tlet innerPropValue = props[ 4 ];\n\n\t\t// cast values where needed, otherwise leave as strings\n\t\tswitch ( innerPropType1 ) {\n\n\t\t\tcase 'int':\n\t\t\tcase 'enum':\n\t\t\tcase 'bool':\n\t\t\tcase 'ULongLong':\n\t\t\tcase 'double':\n\t\t\tcase 'Number':\n\t\t\tcase 'FieldOfView':\n\t\t\t\tinnerPropValue = parseFloat( innerPropValue );\n\t\t\t\tbreak;\n\n\t\t\tcase 'Color':\n\t\t\tcase 'ColorRGB':\n\t\t\tcase 'Vector3D':\n\t\t\tcase 'Lcl_Translation':\n\t\t\tcase 'Lcl_Rotation':\n\t\t\tcase 'Lcl_Scaling':\n\t\t\t\tinnerPropValue = parseNumberArray( innerPropValue );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t// CAUTION: these props must append to parent's parent\n\t\tthis.getPrevNode()[ innerPropName ] = {\n\n\t\t\t'type': innerPropType1,\n\t\t\t'type2': innerPropType2,\n\t\t\t'flag': innerPropFlag,\n\t\t\t'value': innerPropValue\n\n\t\t};\n\n\t\tthis.setCurrentProp( this.getPrevNode(), innerPropName );\n\n\t}\n\n}\n\n// Parse an FBX file in Binary format\nclass BinaryParser {\n\n\tparse( buffer ) {\n\n\t\tconst reader = new BinaryReader( buffer );\n\t\treader.skip( 23 ); // skip magic 23 bytes\n\n\t\tconst version = reader.getUint32();\n\n\t\tif ( version < 6400 ) {\n\n\t\t\tthrow new Error( 'THREE.FBXLoader: FBX version not supported, FileVersion: ' + version );\n\n\t\t}\n\n\t\tconst allNodes = new FBXTree();\n\n\t\twhile ( ! this.endOfContent( reader ) ) {\n\n\t\t\tconst node = this.parseNode( reader, version );\n\t\t\tif ( node !== null ) allNodes.add( node.name, node );\n\n\t\t}\n\n\t\treturn allNodes;\n\n\t}\n\n\t// Check if reader has reached the end of content.\n\tendOfContent( reader ) {\n\n\t\t// footer size: 160bytes + 16-byte alignment padding\n\t\t// - 16bytes: magic\n\t\t// - padding til 16-byte alignment (at least 1byte?)\n\t\t//\t(seems like some exporters embed fixed 15 or 16bytes?)\n\t\t// - 4bytes: magic\n\t\t// - 4bytes: version\n\t\t// - 120bytes: zero\n\t\t// - 16bytes: magic\n\t\tif ( reader.size() % 16 === 0 ) {\n\n\t\t\treturn ( ( reader.getOffset() + 160 + 16 ) & ~ 0xf ) >= reader.size();\n\n\t\t} else {\n\n\t\t\treturn reader.getOffset() + 160 + 16 >= reader.size();\n\n\t\t}\n\n\t}\n\n\t// recursively parse nodes until the end of the file is reached\n\tparseNode( reader, version ) {\n\n\t\tconst node = {};\n\n\t\t// The first three data sizes depends on version.\n\t\tconst endOffset = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\t\tconst numProperties = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\n\t\t( version >= 7500 ) ? reader.getUint64() : reader.getUint32(); // the returned propertyListLen is not used\n\n\t\tconst nameLen = reader.getUint8();\n\t\tconst name = reader.getString( nameLen );\n\n\t\t// Regards this node as NULL-record if endOffset is zero\n\t\tif ( endOffset === 0 ) return null;\n\n\t\tconst propertyList = [];\n\n\t\tfor ( let i = 0; i < numProperties; i ++ ) {\n\n\t\t\tpropertyList.push( this.parseProperty( reader ) );\n\n\t\t}\n\n\t\t// Regards the first three elements in propertyList as id, attrName, and attrType\n\t\tconst id = propertyList.length > 0 ? propertyList[ 0 ] : '';\n\t\tconst attrName = propertyList.length > 1 ? propertyList[ 1 ] : '';\n\t\tconst attrType = propertyList.length > 2 ? propertyList[ 2 ] : '';\n\n\t\t// check if this node represents just a single property\n\t\t// like (name, 0) set or (name2, [0, 1, 2]) set of {name: 0, name2: [0, 1, 2]}\n\t\tnode.singleProperty = ( numProperties === 1 && reader.getOffset() === endOffset ) ? true : false;\n\n\t\twhile ( endOffset > reader.getOffset() ) {\n\n\t\t\tconst subNode = this.parseNode( reader, version );\n\n\t\t\tif ( subNode !== null ) this.parseSubNode( name, node, subNode );\n\n\t\t}\n\n\t\tnode.propertyList = propertyList; // raw property list used by parent\n\n\t\tif ( typeof id === 'number' ) node.id = id;\n\t\tif ( attrName !== '' ) node.attrName = attrName;\n\t\tif ( attrType !== '' ) node.attrType = attrType;\n\t\tif ( name !== '' ) node.name = name;\n\n\t\treturn node;\n\n\t}\n\n\tparseSubNode( name, node, subNode ) {\n\n\t\t// special case: child node is single property\n\t\tif ( subNode.singleProperty === true ) {\n\n\t\t\tconst value = subNode.propertyList[ 0 ];\n\n\t\t\tif ( Array.isArray( value ) ) {\n\n\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t\tsubNode.a = value;\n\n\t\t\t} else {\n\n\t\t\t\tnode[ subNode.name ] = value;\n\n\t\t\t}\n\n\t\t} else if ( name === 'Connections' && subNode.name === 'C' ) {\n\n\t\t\tconst array = [];\n\n\t\t\tsubNode.propertyList.forEach( function ( property, i ) {\n\n\t\t\t\t// first Connection is FBX type (OO, OP, etc.). We'll discard these\n\t\t\t\tif ( i !== 0 ) array.push( property );\n\n\t\t\t} );\n\n\t\t\tif ( node.connections === undefined ) {\n\n\t\t\t\tnode.connections = [];\n\n\t\t\t}\n\n\t\t\tnode.connections.push( array );\n\n\t\t} else if ( subNode.name === 'Properties70' ) {\n\n\t\t\tconst keys = Object.keys( subNode );\n\n\t\t\tkeys.forEach( function ( key ) {\n\n\t\t\t\tnode[ key ] = subNode[ key ];\n\n\t\t\t} );\n\n\t\t} else if ( name === 'Properties70' && subNode.name === 'P' ) {\n\n\t\t\tlet innerPropName = subNode.propertyList[ 0 ];\n\t\t\tlet innerPropType1 = subNode.propertyList[ 1 ];\n\t\t\tconst innerPropType2 = subNode.propertyList[ 2 ];\n\t\t\tconst innerPropFlag = subNode.propertyList[ 3 ];\n\t\t\tlet innerPropValue;\n\n\t\t\tif ( innerPropName.indexOf( 'Lcl ' ) === 0 ) innerPropName = innerPropName.replace( 'Lcl ', 'Lcl_' );\n\t\t\tif ( innerPropType1.indexOf( 'Lcl ' ) === 0 ) innerPropType1 = innerPropType1.replace( 'Lcl ', 'Lcl_' );\n\n\t\t\tif ( innerPropType1 === 'Color' || innerPropType1 === 'ColorRGB' || innerPropType1 === 'Vector' || innerPropType1 === 'Vector3D' || innerPropType1.indexOf( 'Lcl_' ) === 0 ) {\n\n\t\t\t\tinnerPropValue = [\n\t\t\t\t\tsubNode.propertyList[ 4 ],\n\t\t\t\t\tsubNode.propertyList[ 5 ],\n\t\t\t\t\tsubNode.propertyList[ 6 ]\n\t\t\t\t];\n\n\t\t\t} else {\n\n\t\t\t\tinnerPropValue = subNode.propertyList[ 4 ];\n\n\t\t\t}\n\n\t\t\t// this will be copied to parent, see above\n\t\t\tnode[ innerPropName ] = {\n\n\t\t\t\t'type': innerPropType1,\n\t\t\t\t'type2': innerPropType2,\n\t\t\t\t'flag': innerPropFlag,\n\t\t\t\t'value': innerPropValue\n\n\t\t\t};\n\n\t\t} else if ( node[ subNode.name ] === undefined ) {\n\n\t\t\tif ( typeof subNode.id === 'number' ) {\n\n\t\t\t\tnode[ subNode.name ] = {};\n\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t} else {\n\n\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( subNode.name === 'PoseNode' ) {\n\n\t\t\t\tif ( ! Array.isArray( node[ subNode.name ] ) ) {\n\n\t\t\t\t\tnode[ subNode.name ] = [ node[ subNode.name ] ];\n\n\t\t\t\t}\n\n\t\t\t\tnode[ subNode.name ].push( subNode );\n\n\t\t\t} else if ( node[ subNode.name ][ subNode.id ] === undefined ) {\n\n\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tparseProperty( reader ) {\n\n\t\tconst type = reader.getString( 1 );\n\t\tlet length;\n\n\t\tswitch ( type ) {\n\n\t\t\tcase 'C':\n\t\t\t\treturn reader.getBoolean();\n\n\t\t\tcase 'D':\n\t\t\t\treturn reader.getFloat64();\n\n\t\t\tcase 'F':\n\t\t\t\treturn reader.getFloat32();\n\n\t\t\tcase 'I':\n\t\t\t\treturn reader.getInt32();\n\n\t\t\tcase 'L':\n\t\t\t\treturn reader.getInt64();\n\n\t\t\tcase 'R':\n\t\t\t\tlength = reader.getUint32();\n\t\t\t\treturn reader.getArrayBuffer( length );\n\n\t\t\tcase 'S':\n\t\t\t\tlength = reader.getUint32();\n\t\t\t\treturn reader.getString( length );\n\n\t\t\tcase 'Y':\n\t\t\t\treturn reader.getInt16();\n\n\t\t\tcase 'b':\n\t\t\tcase 'c':\n\t\t\tcase 'd':\n\t\t\tcase 'f':\n\t\t\tcase 'i':\n\t\t\tcase 'l':\n\n\t\t\t\tconst arrayLength = reader.getUint32();\n\t\t\t\tconst encoding = reader.getUint32(); // 0: non-compressed, 1: compressed\n\t\t\t\tconst compressedLength = reader.getUint32();\n\n\t\t\t\tif ( encoding === 0 ) {\n\n\t\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\t\tcase 'b':\n\t\t\t\t\t\tcase 'c':\n\t\t\t\t\t\t\treturn reader.getBooleanArray( arrayLength );\n\n\t\t\t\t\t\tcase 'd':\n\t\t\t\t\t\t\treturn reader.getFloat64Array( arrayLength );\n\n\t\t\t\t\t\tcase 'f':\n\t\t\t\t\t\t\treturn reader.getFloat32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'i':\n\t\t\t\t\t\t\treturn reader.getInt32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'l':\n\t\t\t\t\t\t\treturn reader.getInt64Array( arrayLength );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( typeof fflate === 'undefined' ) {\n\n\t\t\t\t\tconsole.error( 'THREE.FBXLoader: External library fflate.min.js required.' );\n\n\t\t\t\t}\n\n\t\t\t\tconst data = fflate.unzlibSync( new Uint8Array( reader.getArrayBuffer( compressedLength ) ) ); // eslint-disable-line no-undef\n\t\t\t\tconst reader2 = new BinaryReader( data.buffer );\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase 'b':\n\t\t\t\t\tcase 'c':\n\t\t\t\t\t\treturn reader2.getBooleanArray( arrayLength );\n\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\treturn reader2.getFloat64Array( arrayLength );\n\n\t\t\t\t\tcase 'f':\n\t\t\t\t\t\treturn reader2.getFloat32Array( arrayLength );\n\n\t\t\t\t\tcase 'i':\n\t\t\t\t\t\treturn reader2.getInt32Array( arrayLength );\n\n\t\t\t\t\tcase 'l':\n\t\t\t\t\t\treturn reader2.getInt64Array( arrayLength );\n\n\t\t\t\t}\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown property type ' + type );\n\n\t\t}\n\n\t}\n\n}\n\nclass BinaryReader {\n\n\tconstructor( buffer, littleEndian ) {\n\n\t\tthis.dv = new DataView( buffer );\n\t\tthis.offset = 0;\n\t\tthis.littleEndian = ( littleEndian !== undefined ) ? littleEndian : true;\n\n\t}\n\n\tgetOffset() {\n\n\t\treturn this.offset;\n\n\t}\n\n\tsize() {\n\n\t\treturn this.dv.buffer.byteLength;\n\n\t}\n\n\tskip( length ) {\n\n\t\tthis.offset += length;\n\n\t}\n\n\t// seems like true/false representation depends on exporter.\n\t// true: 1 or 'Y'(=0x59), false: 0 or 'T'(=0x54)\n\t// then sees LSB.\n\tgetBoolean() {\n\n\t\treturn ( this.getUint8() & 1 ) === 1;\n\n\t}\n\n\tgetBooleanArray( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getBoolean() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetUint8() {\n\n\t\tconst value = this.dv.getUint8( this.offset );\n\t\tthis.offset += 1;\n\t\treturn value;\n\n\t}\n\n\tgetInt16() {\n\n\t\tconst value = this.dv.getInt16( this.offset, this.littleEndian );\n\t\tthis.offset += 2;\n\t\treturn value;\n\n\t}\n\n\tgetInt32() {\n\n\t\tconst value = this.dv.getInt32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\tgetInt32Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getInt32() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetUint32() {\n\n\t\tconst value = this.dv.getUint32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\t// JavaScript doesn't support 64-bit integer so calculate this here\n\t// 1 << 32 will return 1 so using multiply operation instead here.\n\t// There's a possibility that this method returns wrong value if the value\n\t// is out of the range between Number.MAX_SAFE_INTEGER and Number.MIN_SAFE_INTEGER.\n\t// TODO: safely handle 64-bit integer\n\tgetInt64() {\n\n\t\tlet low, high;\n\n\t\tif ( this.littleEndian ) {\n\n\t\t\tlow = this.getUint32();\n\t\t\thigh = this.getUint32();\n\n\t\t} else {\n\n\t\t\thigh = this.getUint32();\n\t\t\tlow = this.getUint32();\n\n\t\t}\n\n\t\t// calculate negative value\n\t\tif ( high & 0x80000000 ) {\n\n\t\t\thigh = ~ high & 0xFFFFFFFF;\n\t\t\tlow = ~ low & 0xFFFFFFFF;\n\n\t\t\tif ( low === 0xFFFFFFFF ) high = ( high + 1 ) & 0xFFFFFFFF;\n\n\t\t\tlow = ( low + 1 ) & 0xFFFFFFFF;\n\n\t\t\treturn - ( high * 0x100000000 + low );\n\n\t\t}\n\n\t\treturn high * 0x100000000 + low;\n\n\t}\n\n\tgetInt64Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getInt64() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\t// Note: see getInt64() comment\n\tgetUint64() {\n\n\t\tlet low, high;\n\n\t\tif ( this.littleEndian ) {\n\n\t\t\tlow = this.getUint32();\n\t\t\thigh = this.getUint32();\n\n\t\t} else {\n\n\t\t\thigh = this.getUint32();\n\t\t\tlow = this.getUint32();\n\n\t\t}\n\n\t\treturn high * 0x100000000 + low;\n\n\t}\n\n\tgetFloat32() {\n\n\t\tconst value = this.dv.getFloat32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\tgetFloat32Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getFloat32() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetFloat64() {\n\n\t\tconst value = this.dv.getFloat64( this.offset, this.littleEndian );\n\t\tthis.offset += 8;\n\t\treturn value;\n\n\t}\n\n\tgetFloat64Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getFloat64() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetArrayBuffer( size ) {\n\n\t\tconst value = this.dv.buffer.slice( this.offset, this.offset + size );\n\t\tthis.offset += size;\n\t\treturn value;\n\n\t}\n\n\tgetString( size ) {\n\n\t\t// note: safari 9 doesn't support Uint8Array.indexOf; create intermediate array instead\n\t\tlet a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta[ i ] = this.getUint8();\n\n\t\t}\n\n\t\tconst nullByte = a.indexOf( 0 );\n\t\tif ( nullByte >= 0 ) a = a.slice( 0, nullByte );\n\n\t\treturn LoaderUtils.decodeText( new Uint8Array( a ) );\n\n\t}\n\n}\n\n// FBXTree holds a representation of the FBX data, returned by the TextParser ( FBX ASCII format)\n// and BinaryParser( FBX Binary format)\nclass FBXTree {\n\n\tadd( key, val ) {\n\n\t\tthis[ key ] = val;\n\n\t}\n\n}\n\n// ************** UTILITY FUNCTIONS **************\n\nfunction isFbxFormatBinary( buffer ) {\n\n\tconst CORRECT = 'Kaydara\\u0020FBX\\u0020Binary\\u0020\\u0020\\0';\n\n\treturn buffer.byteLength >= CORRECT.length && CORRECT === convertArrayBufferToString( buffer, 0, CORRECT.length );\n\n}\n\nfunction isFbxFormatASCII( text ) {\n\n\tconst CORRECT = [ 'K', 'a', 'y', 'd', 'a', 'r', 'a', '\\\\', 'F', 'B', 'X', '\\\\', 'B', 'i', 'n', 'a', 'r', 'y', '\\\\', '\\\\' ];\n\n\tlet cursor = 0;\n\n\tfunction read( offset ) {\n\n\t\tconst result = text[ offset - 1 ];\n\t\ttext = text.slice( cursor + offset );\n\t\tcursor ++;\n\t\treturn result;\n\n\t}\n\n\tfor ( let i = 0; i < CORRECT.length; ++ i ) {\n\n\t\tconst num = read( 1 );\n\t\tif ( num === CORRECT[ i ] ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t}\n\n\treturn true;\n\n}\n\nfunction getFbxVersion( text ) {\n\n\tconst versionRegExp = /FBXVersion: (\\d+)/;\n\tconst match = text.match( versionRegExp );\n\n\tif ( match ) {\n\n\t\tconst version = parseInt( match[ 1 ] );\n\t\treturn version;\n\n\t}\n\n\tthrow new Error( 'THREE.FBXLoader: Cannot find the version number for the file given.' );\n\n}\n\n// Converts FBX ticks into real time seconds.\nfunction convertFBXTimeToSeconds( time ) {\n\n\treturn time / 46186158000;\n\n}\n\nconst dataArray = [];\n\n// extracts the data from the correct position in the FBX array based on indexing type\nfunction getData( polygonVertexIndex, polygonIndex, vertexIndex, infoObject ) {\n\n\tlet index;\n\n\tswitch ( infoObject.mappingType ) {\n\n\t\tcase 'ByPolygonVertex' :\n\t\t\tindex = polygonVertexIndex;\n\t\t\tbreak;\n\t\tcase 'ByPolygon' :\n\t\t\tindex = polygonIndex;\n\t\t\tbreak;\n\t\tcase 'ByVertice' :\n\t\t\tindex = vertexIndex;\n\t\t\tbreak;\n\t\tcase 'AllSame' :\n\t\t\tindex = infoObject.indices[ 0 ];\n\t\t\tbreak;\n\t\tdefault :\n\t\t\tconsole.warn( 'THREE.FBXLoader: unknown attribute mapping type ' + infoObject.mappingType );\n\n\t}\n\n\tif ( infoObject.referenceType === 'IndexToDirect' ) index = infoObject.indices[ index ];\n\n\tconst from = index * infoObject.dataSize;\n\tconst to = from + infoObject.dataSize;\n\n\treturn slice( dataArray, infoObject.buffer, from, to );\n\n}\n\nconst tempEuler = new Euler();\nconst tempVec = new Vector3();\n\n// generate transformation from FBX transform data\n// ref: https://help.autodesk.com/view/FBX/2017/ENU/?guid=__files_GUID_10CDD63C_79C1_4F2D_BB28_AD2BE65A02ED_htm\n// ref: http://docs.autodesk.com/FBX/2014/ENU/FBX-SDK-Documentation/index.html?url=cpp_ref/_transformations_2main_8cxx-example.html,topicNumber=cpp_ref__transformations_2main_8cxx_example_htmlfc10a1e1-b18d-4e72-9dc0-70d0f1959f5e\nfunction generateTransform( transformData ) {\n\n\tconst lTranslationM = new Matrix4();\n\tconst lPreRotationM = new Matrix4();\n\tconst lRotationM = new Matrix4();\n\tconst lPostRotationM = new Matrix4();\n\n\tconst lScalingM = new Matrix4();\n\tconst lScalingPivotM = new Matrix4();\n\tconst lScalingOffsetM = new Matrix4();\n\tconst lRotationOffsetM = new Matrix4();\n\tconst lRotationPivotM = new Matrix4();\n\n\tconst lParentGX = new Matrix4();\n\tconst lParentLX = new Matrix4();\n\tconst lGlobalT = new Matrix4();\n\n\tconst inheritType = ( transformData.inheritType ) ? transformData.inheritType : 0;\n\n\tif ( transformData.translation ) lTranslationM.setPosition( tempVec.fromArray( transformData.translation ) );\n\n\tif ( transformData.preRotation ) {\n\n\t\tconst array = transformData.preRotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlPreRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t}\n\n\tif ( transformData.rotation ) {\n\n\t\tconst array = transformData.rotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t}\n\n\tif ( transformData.postRotation ) {\n\n\t\tconst array = transformData.postRotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder );\n\t\tlPostRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\t\tlPostRotationM.invert();\n\n\t}\n\n\tif ( transformData.scale ) lScalingM.scale( tempVec.fromArray( transformData.scale ) );\n\n\t// Pivots and offsets\n\tif ( transformData.scalingOffset ) lScalingOffsetM.setPosition( tempVec.fromArray( transformData.scalingOffset ) );\n\tif ( transformData.scalingPivot ) lScalingPivotM.setPosition( tempVec.fromArray( transformData.scalingPivot ) );\n\tif ( transformData.rotationOffset ) lRotationOffsetM.setPosition( tempVec.fromArray( transformData.rotationOffset ) );\n\tif ( transformData.rotationPivot ) lRotationPivotM.setPosition( tempVec.fromArray( transformData.rotationPivot ) );\n\n\t// parent transform\n\tif ( transformData.parentMatrixWorld ) {\n\n\t\tlParentLX.copy( transformData.parentMatrix );\n\t\tlParentGX.copy( transformData.parentMatrixWorld );\n\n\t}\n\n\tconst lLRM = lPreRotationM.clone().multiply( lRotationM ).multiply( lPostRotationM );\n\t// Global Rotation\n\tconst lParentGRM = new Matrix4();\n\tlParentGRM.extractRotation( lParentGX );\n\n\t// Global Shear*Scaling\n\tconst lParentTM = new Matrix4();\n\tlParentTM.copyPosition( lParentGX );\n\n\tconst lParentGRSM = lParentTM.clone().invert().multiply( lParentGX );\n\tconst lParentGSM = lParentGRM.clone().invert().multiply( lParentGRSM );\n\tconst lLSM = lScalingM;\n\n\tconst lGlobalRS = new Matrix4();\n\n\tif ( inheritType === 0 ) {\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lLRM ).multiply( lParentGSM ).multiply( lLSM );\n\n\t} else if ( inheritType === 1 ) {\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lParentGSM ).multiply( lLRM ).multiply( lLSM );\n\n\t} else {\n\n\t\tconst lParentLSM = new Matrix4().scale( new Vector3().setFromMatrixScale( lParentLX ) );\n\t\tconst lParentLSM_inv = lParentLSM.clone().invert();\n\t\tconst lParentGSM_noLocal = lParentGSM.clone().multiply( lParentLSM_inv );\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lLRM ).multiply( lParentGSM_noLocal ).multiply( lLSM );\n\n\t}\n\n\tconst lRotationPivotM_inv = lRotationPivotM.clone().invert();\n\tconst lScalingPivotM_inv = lScalingPivotM.clone().invert();\n\t// Calculate the local transform matrix\n\tlet lTransform = lTranslationM.clone().multiply( lRotationOffsetM ).multiply( lRotationPivotM ).multiply( lPreRotationM ).multiply( lRotationM ).multiply( lPostRotationM ).multiply( lRotationPivotM_inv ).multiply( lScalingOffsetM ).multiply( lScalingPivotM ).multiply( lScalingM ).multiply( lScalingPivotM_inv );\n\n\tconst lLocalTWithAllPivotAndOffsetInfo = new Matrix4().copyPosition( lTransform );\n\n\tconst lGlobalTranslation = lParentGX.clone().multiply( lLocalTWithAllPivotAndOffsetInfo );\n\tlGlobalT.copyPosition( lGlobalTranslation );\n\n\tlTransform = lGlobalT.clone().multiply( lGlobalRS );\n\n\t// from global to local\n\tlTransform.premultiply( lParentGX.invert() );\n\n\treturn lTransform;\n\n}\n\n// Returns the three.js intrinsic Euler order corresponding to FBX extrinsic Euler order\n// ref: http://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_class_fbx_euler_html\nfunction getEulerOrder( order ) {\n\n\torder = order || 0;\n\n\tconst enums = [\n\t\t'ZYX', // -> XYZ extrinsic\n\t\t'YZX', // -> XZY extrinsic\n\t\t'XZY', // -> YZX extrinsic\n\t\t'ZXY', // -> YXZ extrinsic\n\t\t'YXZ', // -> ZXY extrinsic\n\t\t'XYZ', // -> ZYX extrinsic\n\t\t//'SphericXYZ', // not possible to support\n\t];\n\n\tif ( order === 6 ) {\n\n\t\tconsole.warn( 'THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.' );\n\t\treturn enums[ 0 ];\n\n\t}\n\n\treturn enums[ order ];\n\n}\n\n// Parses comma separated list of numbers and returns them an array.\n// Used internally by the TextParser\nfunction parseNumberArray( value ) {\n\n\tconst array = value.split( ',' ).map( function ( val ) {\n\n\t\treturn parseFloat( val );\n\n\t} );\n\n\treturn array;\n\n}\n\nfunction convertArrayBufferToString( buffer, from, to ) {\n\n\tif ( from === undefined ) from = 0;\n\tif ( to === undefined ) to = buffer.byteLength;\n\n\treturn LoaderUtils.decodeText( new Uint8Array( buffer, from, to ) );\n\n}\n\nfunction append( a, b ) {\n\n\tfor ( let i = 0, j = a.length, l = b.length; i < l; i ++, j ++ ) {\n\n\t\ta[ j ] = b[ i ];\n\n\t}\n\n}\n\nfunction slice( a, b, from, to ) {\n\n\tfor ( let i = from, j = 0; i < to; i ++, j ++ ) {\n\n\t\ta[ j ] = b[ i ];\n\n\t}\n\n\treturn a;\n\n}\n\n// inject array a2 into array a1 at index\nfunction inject( a1, index, a2 ) {\n\n\treturn a1.slice( 0, index ).concat( a2 ).concat( a1.slice( index ) );\n\n}\n\nexport { FBXLoader };\n","import * as THREE from 'three';\nimport { FBXLoader } from '@three/loaders/FBXLoader';\n\ntype MusicState = 'play' | 'pause';\n\nconst CYCLE_TIME = 3215;\n\nexport default class MusicNoteParticleSystem {\n  parent: THREE.Object3D;\n  n: number;\n  animation: boolean;\n  particles: MusicNoteParticle[];\n  timeouts: NodeJS.Timeout[];\n\n  constructor(parent: THREE.Object3D, n: number) {\n    this.parent = parent;\n    this.n = n;\n    this.animation = true;\n    this.timeouts = [];\n  }\n\n  async load() {\n    const [key1, key2] = await this.#loadModels();\n\n    this.particles = Array.from(Array(this.n).keys()).map((idx) => {\n      const model = Math.random() > 0.5 ? key1.clone() : key2.clone();\n      model.position.set(0.3 * (idx - 4), 0, 0);\n      this.parent.add(model);\n      return new MusicNoteParticle(model);\n    });\n  }\n\n  /**\n   * Loads two music notes from the models/keys.obj file\n   * @returns {Promise<THREE.Group[]>} both notes\n   */\n  async #loadModels(): Promise<THREE.Group[]> {\n    const loader = new FBXLoader();\n    const keys = await loader.loadAsync('models/keys.fbx');\n\n    const key1 = keys.children[0];\n    key1.scale.set(0.1, 0.1, 0.1);\n    key1.position.set(0, 0.15, 0);\n    key1.rotateX(Math.PI / 2);\n    const key1Group = new THREE.Group();\n    key1Group.add(key1);\n\n    const key2 = keys.children[0];\n    key2.scale.set(0.1, 0.1, 0.1);\n    key2.position.set(0.1, 0.1, 0);\n    key2.rotateX(Math.PI / 2);\n    const key2Group = new THREE.Group();\n    key2Group.add(key2);\n\n    return [key1Group, key2Group];\n  }\n\n  playAnimation() {\n    this.timeouts = this.particles\n      .map((particle) => ({ particle, sort: Math.random() }))\n      .sort((a, b) => a.sort - b.sort)\n      .map(({ particle }, idx) =>\n        setTimeout(() => {\n          particle.startAnimation();\n          if (idx + 1 === this.n) {\n            this.timeouts = [];\n          }\n        }, (idx * CYCLE_TIME) / this.n),\n      );\n  }\n\n  pauseAnimation() {\n    if (this.timeouts.length > 0) {\n      this.timeouts.forEach((timeout) => clearTimeout(timeout));\n      this.timeouts = [];\n    }\n    this.particles.forEach((part) => part.stopNextAnimation());\n  }\n\n  update(deltat: number) {\n    this.particles.forEach((p) => p.update(deltat));\n  }\n}\n\nclass MusicNoteParticle {\n  model: THREE.Object3D;\n  state: number;\n  scale: number;\n  delta: number;\n\n  currMusicState: MusicState;\n  nextMusicState: MusicState;\n  axis: THREE.Vector3;\n\n  constructor(model: THREE.Group) {\n    this.model = model.children[0];\n    this.#reset();\n    this.scale = 0;\n    this.model.scale.setScalar(this.scale);\n\n    this.currMusicState = 'pause';\n    this.nextMusicState = 'pause';\n    this.axis = new THREE.Vector3(0, 0, 0.5);\n  }\n\n  startAnimation() {\n    this.currMusicState = 'play';\n    this.nextMusicState = 'play';\n  }\n\n  stopNextAnimation() {\n    this.nextMusicState = 'pause';\n  }\n\n  update(deltat: number) {\n    if (this.scale <= 0) {\n      this.#reset();\n      this.currMusicState = this.nextMusicState;\n    }\n    if (this.currMusicState === 'play') {\n      this.#updateScale(deltat);\n      this.model.scale.setScalar(this.scale);\n      this.#updatePosition(deltat);\n    }\n  }\n\n  #reset() {\n    this.delta = 0;\n    this.state = 1;\n    this.model.position.set(0, 0, 0);\n  }\n\n  #updateScale(deltat: number) {\n    if (this.state === 1) {\n      this.delta += deltat;\n      const x = 0.21 + this.delta / 1000;\n      this.scale = 0.5 - Math.cos(5 * x) / (7 * x);\n      this.scale *= 0.1;\n      if (x >= 2.9) {\n        this.state = 0;\n      }\n    }\n    if (this.state === 0) {\n      this.scale -= deltat / 10000;\n    }\n  }\n\n  #updatePosition(deltat: number) {\n    this.model.translateOnAxis(this.axis, deltat / 800);\n  }\n}\n","import * as THREE from 'three';\nimport { GLTFLoader } from '@three/loaders/GLTFLoader';\nimport AlbumCoverManager from './albumcovers';\nimport AudioPlayer from './audio';\nimport MusicNoteParticleSystem from './particles';\nimport { SpotifyTrack } from './spotify';\n\nconst RECORD_PLAYER_MODEL_URL = 'models/record_player/scene.gltf';\nconst RECORD_PLAYER_X_ROTATION = -0.4 * Math.PI;\n\nexport default class RecordPlayer {\n  root: THREE.Group;\n  light: THREE.SpotLight;\n  model: THREE.Object3D;\n  album: THREE.Mesh;\n  playingTrackId: string | null;\n  particlesGroup: THREE.Group;\n  particles: MusicNoteParticleSystem;\n\n  camera: THREE.Camera;\n  coversManager: AlbumCoverManager;\n\n  constructor(\n    camera: THREE.Camera,\n    parent: THREE.Object3D,\n    coversManager: AlbumCoverManager,\n    audioPlayer: AudioPlayer,\n  ) {\n    // Initial setup\n    this.camera = camera;\n    this.root = new THREE.Group();\n    this.root.scale.setScalar(0.3);\n    parent.add(this.root);\n    this.coversManager = coversManager;\n    audioPlayer.setOnSongEnd(() => this.changeTrack());\n\n    // Add light above the record player\n    this.light = new THREE.SpotLight(0xffffff, 1, 10, 0.8, 0.2, 2);\n    this.light.translateY(4);\n    this.root.add(this.light);\n\n    /// Create the album model\n    const albumGeometry = new THREE.RingGeometry(0.1, 0.75, 32, 2);\n    this.album = new THREE.Mesh(albumGeometry, new THREE.MeshNormalMaterial());\n    this.album.rotateX(RECORD_PLAYER_X_ROTATION);\n    this.album.translateX(-0.2);\n    this.album.translateZ(0.47);\n    this.playingTrackId = null;\n\n    // Create the music note particles\n    this.particlesGroup = new THREE.Group();\n    this.particles = new MusicNoteParticleSystem(this.particlesGroup, 9);\n    this.particlesGroup.translateY(0.7);\n    this.particlesGroup.scale.setScalar(0.6);\n    this.root.add(this.particlesGroup);\n  }\n\n  async load() {\n    const loader = new GLTFLoader();\n    const gltf = await loader.loadAsync(RECORD_PLAYER_MODEL_URL);\n\n    this.model = gltf.scene.children[0].children[0].children[0];\n    this.model.rotateX(RECORD_PLAYER_X_ROTATION);\n    this.model.translateX(0.2);\n    const bodyMesh = this.model.children[1].children[0] as THREE.Mesh;\n    bodyMesh.material = new THREE.MeshNormalMaterial();\n\n    this.root.add(this.model);\n    this.light.target = this.model;\n\n    await this.particles.load();\n  }\n\n  async changeTrack(track?: SpotifyTrack) {\n    if (!this.playingTrackId && !track) {\n      return;\n    }\n\n    if (!track || this.playingTrackId === track.id) {\n      this.playingTrackId = null;\n      this.particles.pauseAnimation();\n      this.root.remove(this.album);\n      return;\n    }\n\n    const firstTimePlaying = !this.playingTrackId && track;\n    this.playingTrackId = track.id;\n    const albumUrl = track.album.images[0].url;\n    const coverMaterial = await this.coversManager.fetchAlbums([albumUrl]);\n    this.album.material = coverMaterial[0];\n    if (firstTimePlaying) {\n      this.particles.playAnimation();\n      this.root.add(this.album);\n    }\n  }\n\n  update(deltat: number) {\n    this.root.position.copy(this.camera.position);\n    this.root.rotation.copy(this.camera.rotation);\n    this.root.updateMatrix();\n    this.root.translateY(-0.5);\n    this.root.translateZ(-1.5);\n\n    if (this.album?.parent !== null) {\n      this.album.rotateZ(-0.0005 * deltat);\n    }\n\n    this.particles.update(deltat);\n  }\n}\n","const URL_PERSONAL_TOP = 'me/top/tracks?limit=10&time_range=long_term';\nconst URL_GLOBAL_TOP = 'playlists/37i9dQZEVXbMDoHDwVN2tF/tracks?limit=10';\nconst URL_MEXICO_TOP = 'playlists/37i9dQZEVXbO3qyFxbkOE1/tracks?limit=10';\n\ninterface SpotifyArtist {\n  name: string;\n}\n\ninterface SpotifyAlbum {\n  name: string;\n  images: {\n    url: string;\n    height: number;\n    width: number;\n  }[];\n}\n\nexport interface SpotifyTrack {\n  name: string;\n  id: string;\n  preview_url?: string;\n  duration_ms: number;\n  popularity: number;\n  artists: SpotifyArtist[];\n  album: SpotifyAlbum;\n}\n\ninterface SpotifyData {\n  globalTracks: SpotifyTrack[];\n  mexicoTracks: SpotifyTrack[];\n  personalTracks?: SpotifyTrack[];\n}\n\nconst getAccessToken = (): string | null => {\n  const params = new URLSearchParams(window.location.hash.substr(1));\n  if (params.has('access_token') && params.get('token_type') === 'Bearer')\n    return params.get('access_token');\n  return null;\n};\n\nconst spotifyFetch = (accessToken: string, urlPath: string): Promise<any> =>\n  fetch(`https://api.spotify.com/v1/${urlPath}`, {\n    headers: { Authorization: `Bearer ${accessToken}` },\n  }).then((response) => response.json());\n\nexport const loadSpotifyData = async (): Promise<SpotifyData> => {\n  const token = getAccessToken();\n  if (token) {\n    const [globalTracks, mexicoTracks, personalTracks] = await Promise.all([\n      spotifyFetch(token, URL_GLOBAL_TOP).then((res) =>\n        res.items.map((i: any) => i.track),\n      ),\n      spotifyFetch(token, URL_MEXICO_TOP).then((res) =>\n        res.items.map((i: any) => i.track),\n      ),\n      spotifyFetch(token, URL_PERSONAL_TOP).then((res) => res.items),\n    ]);\n    return { globalTracks, mexicoTracks, personalTracks };\n  }\n\n  const resGlobal = await fetch('global.json');\n  const resMexico = await fetch('mexico.json');\n  return {\n    globalTracks: await resGlobal.json(),\n    mexicoTracks: await resMexico.json(),\n  };\n};\n\nexport const redirectToSpotifyLogin = (): void => {\n  const spotifyAuthParams = new URLSearchParams();\n  spotifyAuthParams.set('client_id', '78d27efbc5e84665b852ca8dd63ea33f');\n  spotifyAuthParams.set('response_type', 'token');\n  spotifyAuthParams.set(\n    'redirect_uri',\n    window.location.origin + window.location.pathname,\n  );\n  spotifyAuthParams.set('scope', ['user-top-read'].join(' '));\n\n  const params = spotifyAuthParams.toString();\n  window.location.replace(`https://accounts.spotify.com/authorize?${params}`);\n};\n","import { Curve } from '../core/Curve.js';\nimport { Vector2 } from '../../math/Vector2.js';\n\nclass EllipseCurve extends Curve {\n\n\tconstructor( aX = 0, aY = 0, xRadius = 1, yRadius = 1, aStartAngle = 0, aEndAngle = Math.PI * 2, aClockwise = false, aRotation = 0 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'EllipseCurve';\n\n\t\tthis.aX = aX;\n\t\tthis.aY = aY;\n\n\t\tthis.xRadius = xRadius;\n\t\tthis.yRadius = yRadius;\n\n\t\tthis.aStartAngle = aStartAngle;\n\t\tthis.aEndAngle = aEndAngle;\n\n\t\tthis.aClockwise = aClockwise;\n\n\t\tthis.aRotation = aRotation;\n\n\t}\n\n\tgetPoint( t, optionalTarget ) {\n\n\t\tconst point = optionalTarget || new Vector2();\n\n\t\tconst twoPi = Math.PI * 2;\n\t\tlet deltaAngle = this.aEndAngle - this.aStartAngle;\n\t\tconst samePoints = Math.abs( deltaAngle ) < Number.EPSILON;\n\n\t\t// ensures that deltaAngle is 0 .. 2 PI\n\t\twhile ( deltaAngle < 0 ) deltaAngle += twoPi;\n\t\twhile ( deltaAngle > twoPi ) deltaAngle -= twoPi;\n\n\t\tif ( deltaAngle < Number.EPSILON ) {\n\n\t\t\tif ( samePoints ) {\n\n\t\t\t\tdeltaAngle = 0;\n\n\t\t\t} else {\n\n\t\t\t\tdeltaAngle = twoPi;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.aClockwise === true && ! samePoints ) {\n\n\t\t\tif ( deltaAngle === twoPi ) {\n\n\t\t\t\tdeltaAngle = - twoPi;\n\n\t\t\t} else {\n\n\t\t\t\tdeltaAngle = deltaAngle - twoPi;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst angle = this.aStartAngle + t * deltaAngle;\n\t\tlet x = this.aX + this.xRadius * Math.cos( angle );\n\t\tlet y = this.aY + this.yRadius * Math.sin( angle );\n\n\t\tif ( this.aRotation !== 0 ) {\n\n\t\t\tconst cos = Math.cos( this.aRotation );\n\t\t\tconst sin = Math.sin( this.aRotation );\n\n\t\t\tconst tx = x - this.aX;\n\t\t\tconst ty = y - this.aY;\n\n\t\t\t// Rotate the point about the center of the ellipse.\n\t\t\tx = tx * cos - ty * sin + this.aX;\n\t\t\ty = tx * sin + ty * cos + this.aY;\n\n\t\t}\n\n\t\treturn point.set( x, y );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.aX = source.aX;\n\t\tthis.aY = source.aY;\n\n\t\tthis.xRadius = source.xRadius;\n\t\tthis.yRadius = source.yRadius;\n\n\t\tthis.aStartAngle = source.aStartAngle;\n\t\tthis.aEndAngle = source.aEndAngle;\n\n\t\tthis.aClockwise = source.aClockwise;\n\n\t\tthis.aRotation = source.aRotation;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.aX = this.aX;\n\t\tdata.aY = this.aY;\n\n\t\tdata.xRadius = this.xRadius;\n\t\tdata.yRadius = this.yRadius;\n\n\t\tdata.aStartAngle = this.aStartAngle;\n\t\tdata.aEndAngle = this.aEndAngle;\n\n\t\tdata.aClockwise = this.aClockwise;\n\n\t\tdata.aRotation = this.aRotation;\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.aX = json.aX;\n\t\tthis.aY = json.aY;\n\n\t\tthis.xRadius = json.xRadius;\n\t\tthis.yRadius = json.yRadius;\n\n\t\tthis.aStartAngle = json.aStartAngle;\n\t\tthis.aEndAngle = json.aEndAngle;\n\n\t\tthis.aClockwise = json.aClockwise;\n\n\t\tthis.aRotation = json.aRotation;\n\n\t\treturn this;\n\n\t}\n\n}\n\nEllipseCurve.prototype.isEllipseCurve = true;\n\nexport { EllipseCurve };\n","import { EllipseCurve } from './EllipseCurve.js';\n\nclass ArcCurve extends EllipseCurve {\n\n\tconstructor( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tsuper( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\n\n\t\tthis.type = 'ArcCurve';\n\n\t}\n\n}\n\nArcCurve.prototype.isArcCurve = true;\n\nexport { ArcCurve };\n","import { Vector3 } from '../../math/Vector3.js';\nimport { Curve } from '../core/Curve.js';\n\n/**\n * Centripetal CatmullRom Curve - which is useful for avoiding\n * cusps and self-intersections in non-uniform catmull rom curves.\n * http://www.cemyuksel.com/research/catmullrom_param/catmullrom.pdf\n *\n * curve.type accepts centripetal(default), chordal and catmullrom\n * curve.tension is used for catmullrom which defaults to 0.5\n */\n\n\n/*\nBased on an optimized c++ solution in\n - http://stackoverflow.com/questions/9489736/catmull-rom-curve-with-no-cusps-and-no-self-intersections/\n - http://ideone.com/NoEbVM\n\nThis CubicPoly class could be used for reusing some variables and calculations,\nbut for three.js curve use, it could be possible inlined and flatten into a single function call\nwhich can be placed in CurveUtils.\n*/\n\nfunction CubicPoly() {\n\n\tlet c0 = 0, c1 = 0, c2 = 0, c3 = 0;\n\n\t/*\n\t * Compute coefficients for a cubic polynomial\n\t *   p(s) = c0 + c1*s + c2*s^2 + c3*s^3\n\t * such that\n\t *   p(0) = x0, p(1) = x1\n\t *  and\n\t *   p'(0) = t0, p'(1) = t1.\n\t */\n\tfunction init( x0, x1, t0, t1 ) {\n\n\t\tc0 = x0;\n\t\tc1 = t0;\n\t\tc2 = - 3 * x0 + 3 * x1 - 2 * t0 - t1;\n\t\tc3 = 2 * x0 - 2 * x1 + t0 + t1;\n\n\t}\n\n\treturn {\n\n\t\tinitCatmullRom: function ( x0, x1, x2, x3, tension ) {\n\n\t\t\tinit( x1, x2, tension * ( x2 - x0 ), tension * ( x3 - x1 ) );\n\n\t\t},\n\n\t\tinitNonuniformCatmullRom: function ( x0, x1, x2, x3, dt0, dt1, dt2 ) {\n\n\t\t\t// compute tangents when parameterized in [t1,t2]\n\t\t\tlet t1 = ( x1 - x0 ) / dt0 - ( x2 - x0 ) / ( dt0 + dt1 ) + ( x2 - x1 ) / dt1;\n\t\t\tlet t2 = ( x2 - x1 ) / dt1 - ( x3 - x1 ) / ( dt1 + dt2 ) + ( x3 - x2 ) / dt2;\n\n\t\t\t// rescale tangents for parametrization in [0,1]\n\t\t\tt1 *= dt1;\n\t\t\tt2 *= dt1;\n\n\t\t\tinit( x1, x2, t1, t2 );\n\n\t\t},\n\n\t\tcalc: function ( t ) {\n\n\t\t\tconst t2 = t * t;\n\t\t\tconst t3 = t2 * t;\n\t\t\treturn c0 + c1 * t + c2 * t2 + c3 * t3;\n\n\t\t}\n\n\t};\n\n}\n\n//\n\nconst tmp = new Vector3();\nconst px = new CubicPoly(), py = new CubicPoly(), pz = new CubicPoly();\n\nclass CatmullRomCurve3 extends Curve {\n\n\tconstructor( points = [], closed = false, curveType = 'centripetal', tension = 0.5 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CatmullRomCurve3';\n\n\t\tthis.points = points;\n\t\tthis.closed = closed;\n\t\tthis.curveType = curveType;\n\t\tthis.tension = tension;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst points = this.points;\n\t\tconst l = points.length;\n\n\t\tconst p = ( l - ( this.closed ? 0 : 1 ) ) * t;\n\t\tlet intPoint = Math.floor( p );\n\t\tlet weight = p - intPoint;\n\n\t\tif ( this.closed ) {\n\n\t\t\tintPoint += intPoint > 0 ? 0 : ( Math.floor( Math.abs( intPoint ) / l ) + 1 ) * l;\n\n\t\t} else if ( weight === 0 && intPoint === l - 1 ) {\n\n\t\t\tintPoint = l - 2;\n\t\t\tweight = 1;\n\n\t\t}\n\n\t\tlet p0, p3; // 4 points (p1 & p2 defined below)\n\n\t\tif ( this.closed || intPoint > 0 ) {\n\n\t\t\tp0 = points[ ( intPoint - 1 ) % l ];\n\n\t\t} else {\n\n\t\t\t// extrapolate first point\n\t\t\ttmp.subVectors( points[ 0 ], points[ 1 ] ).add( points[ 0 ] );\n\t\t\tp0 = tmp;\n\n\t\t}\n\n\t\tconst p1 = points[ intPoint % l ];\n\t\tconst p2 = points[ ( intPoint + 1 ) % l ];\n\n\t\tif ( this.closed || intPoint + 2 < l ) {\n\n\t\t\tp3 = points[ ( intPoint + 2 ) % l ];\n\n\t\t} else {\n\n\t\t\t// extrapolate last point\n\t\t\ttmp.subVectors( points[ l - 1 ], points[ l - 2 ] ).add( points[ l - 1 ] );\n\t\t\tp3 = tmp;\n\n\t\t}\n\n\t\tif ( this.curveType === 'centripetal' || this.curveType === 'chordal' ) {\n\n\t\t\t// init Centripetal / Chordal Catmull-Rom\n\t\t\tconst pow = this.curveType === 'chordal' ? 0.5 : 0.25;\n\t\t\tlet dt0 = Math.pow( p0.distanceToSquared( p1 ), pow );\n\t\t\tlet dt1 = Math.pow( p1.distanceToSquared( p2 ), pow );\n\t\t\tlet dt2 = Math.pow( p2.distanceToSquared( p3 ), pow );\n\n\t\t\t// safety check for repeated points\n\t\t\tif ( dt1 < 1e-4 ) dt1 = 1.0;\n\t\t\tif ( dt0 < 1e-4 ) dt0 = dt1;\n\t\t\tif ( dt2 < 1e-4 ) dt2 = dt1;\n\n\t\t\tpx.initNonuniformCatmullRom( p0.x, p1.x, p2.x, p3.x, dt0, dt1, dt2 );\n\t\t\tpy.initNonuniformCatmullRom( p0.y, p1.y, p2.y, p3.y, dt0, dt1, dt2 );\n\t\t\tpz.initNonuniformCatmullRom( p0.z, p1.z, p2.z, p3.z, dt0, dt1, dt2 );\n\n\t\t} else if ( this.curveType === 'catmullrom' ) {\n\n\t\t\tpx.initCatmullRom( p0.x, p1.x, p2.x, p3.x, this.tension );\n\t\t\tpy.initCatmullRom( p0.y, p1.y, p2.y, p3.y, this.tension );\n\t\t\tpz.initCatmullRom( p0.z, p1.z, p2.z, p3.z, this.tension );\n\n\t\t}\n\n\t\tpoint.set(\n\t\t\tpx.calc( weight ),\n\t\t\tpy.calc( weight ),\n\t\t\tpz.calc( weight )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = source.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = source.points[ i ];\n\n\t\t\tthis.points.push( point.clone() );\n\n\t\t}\n\n\t\tthis.closed = source.closed;\n\t\tthis.curveType = source.curveType;\n\t\tthis.tension = source.tension;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.points = [];\n\n\t\tfor ( let i = 0, l = this.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = this.points[ i ];\n\t\t\tdata.points.push( point.toArray() );\n\n\t\t}\n\n\t\tdata.closed = this.closed;\n\t\tdata.curveType = this.curveType;\n\t\tdata.tension = this.tension;\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = json.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = json.points[ i ];\n\t\t\tthis.points.push( new Vector3().fromArray( point ) );\n\n\t\t}\n\n\t\tthis.closed = json.closed;\n\t\tthis.curveType = json.curveType;\n\t\tthis.tension = json.tension;\n\n\t\treturn this;\n\n\t}\n\n}\n\nCatmullRomCurve3.prototype.isCatmullRomCurve3 = true;\n\nexport { CatmullRomCurve3 };\n","/**\n * Bezier Curves formulas obtained from\n * http://en.wikipedia.org/wiki/Bézier_curve\n */\n\nfunction CatmullRom( t, p0, p1, p2, p3 ) {\n\n\tconst v0 = ( p2 - p0 ) * 0.5;\n\tconst v1 = ( p3 - p1 ) * 0.5;\n\tconst t2 = t * t;\n\tconst t3 = t * t2;\n\treturn ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\n\n}\n\n//\n\nfunction QuadraticBezierP0( t, p ) {\n\n\tconst k = 1 - t;\n\treturn k * k * p;\n\n}\n\nfunction QuadraticBezierP1( t, p ) {\n\n\treturn 2 * ( 1 - t ) * t * p;\n\n}\n\nfunction QuadraticBezierP2( t, p ) {\n\n\treturn t * t * p;\n\n}\n\nfunction QuadraticBezier( t, p0, p1, p2 ) {\n\n\treturn QuadraticBezierP0( t, p0 ) + QuadraticBezierP1( t, p1 ) +\n\t\tQuadraticBezierP2( t, p2 );\n\n}\n\n//\n\nfunction CubicBezierP0( t, p ) {\n\n\tconst k = 1 - t;\n\treturn k * k * k * p;\n\n}\n\nfunction CubicBezierP1( t, p ) {\n\n\tconst k = 1 - t;\n\treturn 3 * k * k * t * p;\n\n}\n\nfunction CubicBezierP2( t, p ) {\n\n\treturn 3 * ( 1 - t ) * t * t * p;\n\n}\n\nfunction CubicBezierP3( t, p ) {\n\n\treturn t * t * t * p;\n\n}\n\nfunction CubicBezier( t, p0, p1, p2, p3 ) {\n\n\treturn CubicBezierP0( t, p0 ) + CubicBezierP1( t, p1 ) + CubicBezierP2( t, p2 ) +\n\t\tCubicBezierP3( t, p3 );\n\n}\n\nexport { CatmullRom, QuadraticBezier, CubicBezier };\n","import { Curve } from '../core/Curve.js';\nimport { CubicBezier } from '../core/Interpolations.js';\nimport { Vector2 } from '../../math/Vector2.js';\n\nclass CubicBezierCurve extends Curve {\n\n\tconstructor( v0 = new Vector2(), v1 = new Vector2(), v2 = new Vector2(), v3 = new Vector2() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CubicBezierCurve';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\t\tthis.v3 = v3;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\n\n\t\tpoint.set(\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\t\tthis.v3.copy( source.v3 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\t\tdata.v3 = this.v3.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\t\tthis.v3.fromArray( json.v3 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nCubicBezierCurve.prototype.isCubicBezierCurve = true;\n\nexport { CubicBezierCurve };\n","import { Curve } from '../core/Curve.js';\nimport { CubicBezier } from '../core/Interpolations.js';\nimport { Vector3 } from '../../math/Vector3.js';\n\nclass CubicBezierCurve3 extends Curve {\n\n\tconstructor( v0 = new Vector3(), v1 = new Vector3(), v2 = new Vector3(), v3 = new Vector3() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CubicBezierCurve3';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\t\tthis.v3 = v3;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\n\n\t\tpoint.set(\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y ),\n\t\t\tCubicBezier( t, v0.z, v1.z, v2.z, v3.z )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\t\tthis.v3.copy( source.v3 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\t\tdata.v3 = this.v3.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\t\tthis.v3.fromArray( json.v3 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nCubicBezierCurve3.prototype.isCubicBezierCurve3 = true;\n\nexport { CubicBezierCurve3 };\n","import { Vector2 } from '../../math/Vector2.js';\nimport { Curve } from '../core/Curve.js';\n\nclass LineCurve extends Curve {\n\n\tconstructor( v1 = new Vector2(), v2 = new Vector2() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'LineCurve';\n\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tif ( t === 1 ) {\n\n\t\t\tpoint.copy( this.v2 );\n\n\t\t} else {\n\n\t\t\tpoint.copy( this.v2 ).sub( this.v1 );\n\t\t\tpoint.multiplyScalar( t ).add( this.v1 );\n\n\t\t}\n\n\t\treturn point;\n\n\t}\n\n\t// Line curve is linear, so we can overwrite default getPointAt\n\tgetPointAt( u, optionalTarget ) {\n\n\t\treturn this.getPoint( u, optionalTarget );\n\n\t}\n\n\tgetTangent( t, optionalTarget ) {\n\n\t\tconst tangent = optionalTarget || new Vector2();\n\n\t\ttangent.copy( this.v2 ).sub( this.v1 ).normalize();\n\n\t\treturn tangent;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nLineCurve.prototype.isLineCurve = true;\n\nexport { LineCurve };\n","import { Vector3 } from '../../math/Vector3.js';\nimport { Curve } from '../core/Curve.js';\n\nclass LineCurve3 extends Curve {\n\n\tconstructor( v1 = new Vector3(), v2 = new Vector3() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'LineCurve3';\n\t\tthis.isLineCurve3 = true;\n\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tif ( t === 1 ) {\n\n\t\t\tpoint.copy( this.v2 );\n\n\t\t} else {\n\n\t\t\tpoint.copy( this.v2 ).sub( this.v1 );\n\t\t\tpoint.multiplyScalar( t ).add( this.v1 );\n\n\t\t}\n\n\t\treturn point;\n\n\t}\n\t// Line curve is linear, so we can overwrite default getPointAt\n\tgetPointAt( u, optionalTarget ) {\n\n\t\treturn this.getPoint( u, optionalTarget );\n\n\t}\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nexport { LineCurve3 };\n","import { Curve } from '../core/Curve.js';\nimport { QuadraticBezier } from '../core/Interpolations.js';\nimport { Vector2 } from '../../math/Vector2.js';\n\nclass QuadraticBezierCurve extends Curve {\n\n\tconstructor( v0 = new Vector2(), v1 = new Vector2(), v2 = new Vector2() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'QuadraticBezierCurve';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2;\n\n\t\tpoint.set(\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nQuadraticBezierCurve.prototype.isQuadraticBezierCurve = true;\n\nexport { QuadraticBezierCurve };\n","import { Curve } from '../core/Curve.js';\nimport { QuadraticBezier } from '../core/Interpolations.js';\nimport { Vector3 } from '../../math/Vector3.js';\n\nclass QuadraticBezierCurve3 extends Curve {\n\n\tconstructor( v0 = new Vector3(), v1 = new Vector3(), v2 = new Vector3() ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'QuadraticBezierCurve3';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2;\n\n\t\tpoint.set(\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y ),\n\t\t\tQuadraticBezier( t, v0.z, v1.z, v2.z )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nQuadraticBezierCurve3.prototype.isQuadraticBezierCurve3 = true;\n\nexport { QuadraticBezierCurve3 };\n","import { Curve } from '../core/Curve.js';\nimport { CatmullRom } from '../core/Interpolations.js';\nimport { Vector2 } from '../../math/Vector2.js';\n\nclass SplineCurve extends Curve {\n\n\tconstructor( points = [] ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'SplineCurve';\n\n\t\tthis.points = points;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst points = this.points;\n\t\tconst p = ( points.length - 1 ) * t;\n\n\t\tconst intPoint = Math.floor( p );\n\t\tconst weight = p - intPoint;\n\n\t\tconst p0 = points[ intPoint === 0 ? intPoint : intPoint - 1 ];\n\t\tconst p1 = points[ intPoint ];\n\t\tconst p2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\n\t\tconst p3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\n\n\t\tpoint.set(\n\t\t\tCatmullRom( weight, p0.x, p1.x, p2.x, p3.x ),\n\t\t\tCatmullRom( weight, p0.y, p1.y, p2.y, p3.y )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = source.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = source.points[ i ];\n\n\t\t\tthis.points.push( point.clone() );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.points = [];\n\n\t\tfor ( let i = 0, l = this.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = this.points[ i ];\n\t\t\tdata.points.push( point.toArray() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = json.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = json.points[ i ];\n\t\t\tthis.points.push( new Vector2().fromArray( point ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nSplineCurve.prototype.isSplineCurve = true;\n\nexport { SplineCurve };\n","import { Curve } from './Curve.js';\nimport * as Curves from '../curves/Curves.js';\n\n/**************************************************************\n *\tCurved Path - a curve path is simply a array of connected\n *  curves, but retains the api of a curve\n **************************************************************/\n\nclass CurvePath extends Curve {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'CurvePath';\n\n\t\tthis.curves = [];\n\t\tthis.autoClose = false; // Automatically closes the path\n\n\t}\n\n\tadd( curve ) {\n\n\t\tthis.curves.push( curve );\n\n\t}\n\n\tclosePath() {\n\n\t\t// Add a line curve if start and end of lines are not connected\n\t\tconst startPoint = this.curves[ 0 ].getPoint( 0 );\n\t\tconst endPoint = this.curves[ this.curves.length - 1 ].getPoint( 1 );\n\n\t\tif ( ! startPoint.equals( endPoint ) ) {\n\n\t\t\tthis.curves.push( new Curves[ 'LineCurve' ]( endPoint, startPoint ) );\n\n\t\t}\n\n\t}\n\n\t// To get accurate point with reference to\n\t// entire path distance at time t,\n\t// following has to be done:\n\n\t// 1. Length of each sub path have to be known\n\t// 2. Locate and identify type of curve\n\t// 3. Get t for the curve\n\t// 4. Return curve.getPointAt(t')\n\n\tgetPoint( t, optionalTarget ) {\n\n\t\tconst d = t * this.getLength();\n\t\tconst curveLengths = this.getCurveLengths();\n\t\tlet i = 0;\n\n\t\t// To think about boundaries points.\n\n\t\twhile ( i < curveLengths.length ) {\n\n\t\t\tif ( curveLengths[ i ] >= d ) {\n\n\t\t\t\tconst diff = curveLengths[ i ] - d;\n\t\t\t\tconst curve = this.curves[ i ];\n\n\t\t\t\tconst segmentLength = curve.getLength();\n\t\t\t\tconst u = segmentLength === 0 ? 0 : 1 - diff / segmentLength;\n\n\t\t\t\treturn curve.getPointAt( u, optionalTarget );\n\n\t\t\t}\n\n\t\t\ti ++;\n\n\t\t}\n\n\t\treturn null;\n\n\t\t// loop where sum != 0, sum > d , sum+1 <d\n\n\t}\n\n\t// We cannot use the default THREE.Curve getPoint() with getLength() because in\n\t// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\n\t// getPoint() depends on getLength\n\n\tgetLength() {\n\n\t\tconst lens = this.getCurveLengths();\n\t\treturn lens[ lens.length - 1 ];\n\n\t}\n\n\t// cacheLengths must be recalculated.\n\tupdateArcLengths() {\n\n\t\tthis.needsUpdate = true;\n\t\tthis.cacheLengths = null;\n\t\tthis.getCurveLengths();\n\n\t}\n\n\t// Compute lengths and cache them\n\t// We cannot overwrite getLengths() because UtoT mapping uses it.\n\n\tgetCurveLengths() {\n\n\t\t// We use cache values if curves and cache array are same length\n\n\t\tif ( this.cacheLengths && this.cacheLengths.length === this.curves.length ) {\n\n\t\t\treturn this.cacheLengths;\n\n\t\t}\n\n\t\t// Get length of sub-curve\n\t\t// Push sums into cached array\n\n\t\tconst lengths = [];\n\t\tlet sums = 0;\n\n\t\tfor ( let i = 0, l = this.curves.length; i < l; i ++ ) {\n\n\t\t\tsums += this.curves[ i ].getLength();\n\t\t\tlengths.push( sums );\n\n\t\t}\n\n\t\tthis.cacheLengths = lengths;\n\n\t\treturn lengths;\n\n\t}\n\n\tgetSpacedPoints( divisions = 40 ) {\n\n\t\tconst points = [];\n\n\t\tfor ( let i = 0; i <= divisions; i ++ ) {\n\n\t\t\tpoints.push( this.getPoint( i / divisions ) );\n\n\t\t}\n\n\t\tif ( this.autoClose ) {\n\n\t\t\tpoints.push( points[ 0 ] );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\tgetPoints( divisions = 12 ) {\n\n\t\tconst points = [];\n\t\tlet last;\n\n\t\tfor ( let i = 0, curves = this.curves; i < curves.length; i ++ ) {\n\n\t\t\tconst curve = curves[ i ];\n\t\t\tconst resolution = ( curve && curve.isEllipseCurve ) ? divisions * 2\n\t\t\t\t: ( curve && ( curve.isLineCurve || curve.isLineCurve3 ) ) ? 1\n\t\t\t\t\t: ( curve && curve.isSplineCurve ) ? divisions * curve.points.length\n\t\t\t\t\t\t: divisions;\n\n\t\t\tconst pts = curve.getPoints( resolution );\n\n\t\t\tfor ( let j = 0; j < pts.length; j ++ ) {\n\n\t\t\t\tconst point = pts[ j ];\n\n\t\t\t\tif ( last && last.equals( point ) ) continue; // ensures no consecutive points are duplicates\n\n\t\t\t\tpoints.push( point );\n\t\t\t\tlast = point;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.autoClose && points.length > 1 && ! points[ points.length - 1 ].equals( points[ 0 ] ) ) {\n\n\t\t\tpoints.push( points[ 0 ] );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.curves = [];\n\n\t\tfor ( let i = 0, l = source.curves.length; i < l; i ++ ) {\n\n\t\t\tconst curve = source.curves[ i ];\n\n\t\t\tthis.curves.push( curve.clone() );\n\n\t\t}\n\n\t\tthis.autoClose = source.autoClose;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.autoClose = this.autoClose;\n\t\tdata.curves = [];\n\n\t\tfor ( let i = 0, l = this.curves.length; i < l; i ++ ) {\n\n\t\t\tconst curve = this.curves[ i ];\n\t\t\tdata.curves.push( curve.toJSON() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.autoClose = json.autoClose;\n\t\tthis.curves = [];\n\n\t\tfor ( let i = 0, l = json.curves.length; i < l; i ++ ) {\n\n\t\t\tconst curve = json.curves[ i ];\n\t\t\tthis.curves.push( new Curves[ curve.type ]().fromJSON( curve ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\n\nexport { CurvePath };\n","import { Vector2 } from '../../math/Vector2.js';\nimport { CurvePath } from './CurvePath.js';\nimport { EllipseCurve } from '../curves/EllipseCurve.js';\nimport { SplineCurve } from '../curves/SplineCurve.js';\nimport { CubicBezierCurve } from '../curves/CubicBezierCurve.js';\nimport { QuadraticBezierCurve } from '../curves/QuadraticBezierCurve.js';\nimport { LineCurve } from '../curves/LineCurve.js';\n\nclass Path extends CurvePath {\n\n\tconstructor( points ) {\n\n\t\tsuper();\n\t\tthis.type = 'Path';\n\n\t\tthis.currentPoint = new Vector2();\n\n\t\tif ( points ) {\n\n\t\t\tthis.setFromPoints( points );\n\n\t\t}\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.moveTo( points[ 0 ].x, points[ 0 ].y );\n\n\t\tfor ( let i = 1, l = points.length; i < l; i ++ ) {\n\n\t\t\tthis.lineTo( points[ i ].x, points[ i ].y );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tmoveTo( x, y ) {\n\n\t\tthis.currentPoint.set( x, y ); // TODO consider referencing vectors instead of copying?\n\n\t\treturn this;\n\n\t}\n\n\tlineTo( x, y ) {\n\n\t\tconst curve = new LineCurve( this.currentPoint.clone(), new Vector2( x, y ) );\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.set( x, y );\n\n\t\treturn this;\n\n\t}\n\n\tquadraticCurveTo( aCPx, aCPy, aX, aY ) {\n\n\t\tconst curve = new QuadraticBezierCurve(\n\t\t\tthis.currentPoint.clone(),\n\t\t\tnew Vector2( aCPx, aCPy ),\n\t\t\tnew Vector2( aX, aY )\n\t\t);\n\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.set( aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tbezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\n\n\t\tconst curve = new CubicBezierCurve(\n\t\t\tthis.currentPoint.clone(),\n\t\t\tnew Vector2( aCP1x, aCP1y ),\n\t\t\tnew Vector2( aCP2x, aCP2y ),\n\t\t\tnew Vector2( aX, aY )\n\t\t);\n\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.set( aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tsplineThru( pts /*Array of Vector*/ ) {\n\n\t\tconst npts = [ this.currentPoint.clone() ].concat( pts );\n\n\t\tconst curve = new SplineCurve( npts );\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.copy( pts[ pts.length - 1 ] );\n\n\t\treturn this;\n\n\t}\n\n\tarc( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tconst x0 = this.currentPoint.x;\n\t\tconst y0 = this.currentPoint.y;\n\n\t\tthis.absarc( aX + x0, aY + y0, aRadius,\n\t\t\taStartAngle, aEndAngle, aClockwise );\n\n\t\treturn this;\n\n\t}\n\n\tabsarc( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tthis.absellipse( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\n\n\t\treturn this;\n\n\t}\n\n\tellipse( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\t\tconst x0 = this.currentPoint.x;\n\t\tconst y0 = this.currentPoint.y;\n\n\t\tthis.absellipse( aX + x0, aY + y0, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\n\n\t\treturn this;\n\n\t}\n\n\tabsellipse( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\t\tconst curve = new EllipseCurve( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\n\n\t\tif ( this.curves.length > 0 ) {\n\n\t\t\t// if a previous curve is present, attempt to join\n\t\t\tconst firstPoint = curve.getPoint( 0 );\n\n\t\t\tif ( ! firstPoint.equals( this.currentPoint ) ) {\n\n\t\t\t\tthis.lineTo( firstPoint.x, firstPoint.y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.curves.push( curve );\n\n\t\tconst lastPoint = curve.getPoint( 1 );\n\t\tthis.currentPoint.copy( lastPoint );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.currentPoint.copy( source.currentPoint );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.currentPoint = this.currentPoint.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.currentPoint.fromArray( json.currentPoint );\n\n\t\treturn this;\n\n\t}\n\n}\n\n\nexport { Path };\n","import { Path } from './Path.js';\nimport * as MathUtils from '../../math/MathUtils.js';\n\nclass Shape extends Path {\n\n\tconstructor( points ) {\n\n\t\tsuper( points );\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.type = 'Shape';\n\n\t\tthis.holes = [];\n\n\t}\n\n\tgetPointsHoles( divisions ) {\n\n\t\tconst holesPts = [];\n\n\t\tfor ( let i = 0, l = this.holes.length; i < l; i ++ ) {\n\n\t\t\tholesPts[ i ] = this.holes[ i ].getPoints( divisions );\n\n\t\t}\n\n\t\treturn holesPts;\n\n\t}\n\n\t// get points of shape and holes (keypoints based on segments parameter)\n\n\textractPoints( divisions ) {\n\n\t\treturn {\n\n\t\t\tshape: this.getPoints( divisions ),\n\t\t\tholes: this.getPointsHoles( divisions )\n\n\t\t};\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.holes = [];\n\n\t\tfor ( let i = 0, l = source.holes.length; i < l; i ++ ) {\n\n\t\t\tconst hole = source.holes[ i ];\n\n\t\t\tthis.holes.push( hole.clone() );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.uuid = this.uuid;\n\t\tdata.holes = [];\n\n\t\tfor ( let i = 0, l = this.holes.length; i < l; i ++ ) {\n\n\t\t\tconst hole = this.holes[ i ];\n\t\t\tdata.holes.push( hole.toJSON() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.uuid = json.uuid;\n\t\tthis.holes = [];\n\n\t\tfor ( let i = 0, l = json.holes.length; i < l; i ++ ) {\n\n\t\t\tconst hole = json.holes[ i ];\n\t\t\tthis.holes.push( new Path().fromJSON( hole ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\n\nexport { Shape };\n","/**\n * Port from https://github.com/mapbox/earcut (v2.2.2)\n */\n\nconst Earcut = {\n\n\ttriangulate: function ( data, holeIndices, dim = 2 ) {\n\n\t\tconst hasHoles = holeIndices && holeIndices.length;\n\t\tconst outerLen = hasHoles ? holeIndices[ 0 ] * dim : data.length;\n\t\tlet outerNode = linkedList( data, 0, outerLen, dim, true );\n\t\tconst triangles = [];\n\n\t\tif ( ! outerNode || outerNode.next === outerNode.prev ) return triangles;\n\n\t\tlet minX, minY, maxX, maxY, x, y, invSize;\n\n\t\tif ( hasHoles ) outerNode = eliminateHoles( data, holeIndices, outerNode, dim );\n\n\t\t// if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n\t\tif ( data.length > 80 * dim ) {\n\n\t\t\tminX = maxX = data[ 0 ];\n\t\t\tminY = maxY = data[ 1 ];\n\n\t\t\tfor ( let i = dim; i < outerLen; i += dim ) {\n\n\t\t\t\tx = data[ i ];\n\t\t\t\ty = data[ i + 1 ];\n\t\t\t\tif ( x < minX ) minX = x;\n\t\t\t\tif ( y < minY ) minY = y;\n\t\t\t\tif ( x > maxX ) maxX = x;\n\t\t\t\tif ( y > maxY ) maxY = y;\n\n\t\t\t}\n\n\t\t\t// minX, minY and invSize are later used to transform coords into integers for z-order calculation\n\t\t\tinvSize = Math.max( maxX - minX, maxY - minY );\n\t\t\tinvSize = invSize !== 0 ? 1 / invSize : 0;\n\n\t\t}\n\n\t\tearcutLinked( outerNode, triangles, dim, minX, minY, invSize );\n\n\t\treturn triangles;\n\n\t}\n\n};\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList( data, start, end, dim, clockwise ) {\n\n\tlet i, last;\n\n\tif ( clockwise === ( signedArea( data, start, end, dim ) > 0 ) ) {\n\n\t\tfor ( i = start; i < end; i += dim ) last = insertNode( i, data[ i ], data[ i + 1 ], last );\n\n\t} else {\n\n\t\tfor ( i = end - dim; i >= start; i -= dim ) last = insertNode( i, data[ i ], data[ i + 1 ], last );\n\n\t}\n\n\tif ( last && equals( last, last.next ) ) {\n\n\t\tremoveNode( last );\n\t\tlast = last.next;\n\n\t}\n\n\treturn last;\n\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints( start, end ) {\n\n\tif ( ! start ) return start;\n\tif ( ! end ) end = start;\n\n\tlet p = start,\n\t\tagain;\n\tdo {\n\n\t\tagain = false;\n\n\t\tif ( ! p.steiner && ( equals( p, p.next ) || area( p.prev, p, p.next ) === 0 ) ) {\n\n\t\t\tremoveNode( p );\n\t\t\tp = end = p.prev;\n\t\t\tif ( p === p.next ) break;\n\t\t\tagain = true;\n\n\t\t} else {\n\n\t\t\tp = p.next;\n\n\t\t}\n\n\t} while ( again || p !== end );\n\n\treturn end;\n\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked( ear, triangles, dim, minX, minY, invSize, pass ) {\n\n\tif ( ! ear ) return;\n\n\t// interlink polygon nodes in z-order\n\tif ( ! pass && invSize ) indexCurve( ear, minX, minY, invSize );\n\n\tlet stop = ear,\n\t\tprev, next;\n\n\t// iterate through ears, slicing them one by one\n\twhile ( ear.prev !== ear.next ) {\n\n\t\tprev = ear.prev;\n\t\tnext = ear.next;\n\n\t\tif ( invSize ? isEarHashed( ear, minX, minY, invSize ) : isEar( ear ) ) {\n\n\t\t\t// cut off the triangle\n\t\t\ttriangles.push( prev.i / dim );\n\t\t\ttriangles.push( ear.i / dim );\n\t\t\ttriangles.push( next.i / dim );\n\n\t\t\tremoveNode( ear );\n\n\t\t\t// skipping the next vertex leads to less sliver triangles\n\t\t\tear = next.next;\n\t\t\tstop = next.next;\n\n\t\t\tcontinue;\n\n\t\t}\n\n\t\tear = next;\n\n\t\t// if we looped through the whole remaining polygon and can't find any more ears\n\t\tif ( ear === stop ) {\n\n\t\t\t// try filtering points and slicing again\n\t\t\tif ( ! pass ) {\n\n\t\t\t\tearcutLinked( filterPoints( ear ), triangles, dim, minX, minY, invSize, 1 );\n\n\t\t\t\t// if this didn't work, try curing all small self-intersections locally\n\n\t\t\t} else if ( pass === 1 ) {\n\n\t\t\t\tear = cureLocalIntersections( filterPoints( ear ), triangles, dim );\n\t\t\t\tearcutLinked( ear, triangles, dim, minX, minY, invSize, 2 );\n\n\t\t\t\t// as a last resort, try splitting the remaining polygon into two\n\n\t\t\t} else if ( pass === 2 ) {\n\n\t\t\t\tsplitEarcut( ear, triangles, dim, minX, minY, invSize );\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar( ear ) {\n\n\tconst a = ear.prev,\n\t\tb = ear,\n\t\tc = ear.next;\n\n\tif ( area( a, b, c ) >= 0 ) return false; // reflex, can't be an ear\n\n\t// now make sure we don't have other points inside the potential ear\n\tlet p = ear.next.next;\n\n\twhile ( p !== ear.prev ) {\n\n\t\tif ( pointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y ) &&\n\t\t\tarea( p.prev, p, p.next ) >= 0 ) return false;\n\t\tp = p.next;\n\n\t}\n\n\treturn true;\n\n}\n\nfunction isEarHashed( ear, minX, minY, invSize ) {\n\n\tconst a = ear.prev,\n\t\tb = ear,\n\t\tc = ear.next;\n\n\tif ( area( a, b, c ) >= 0 ) return false; // reflex, can't be an ear\n\n\t// triangle bbox; min & max are calculated like this for speed\n\tconst minTX = a.x < b.x ? ( a.x < c.x ? a.x : c.x ) : ( b.x < c.x ? b.x : c.x ),\n\t\tminTY = a.y < b.y ? ( a.y < c.y ? a.y : c.y ) : ( b.y < c.y ? b.y : c.y ),\n\t\tmaxTX = a.x > b.x ? ( a.x > c.x ? a.x : c.x ) : ( b.x > c.x ? b.x : c.x ),\n\t\tmaxTY = a.y > b.y ? ( a.y > c.y ? a.y : c.y ) : ( b.y > c.y ? b.y : c.y );\n\n\t// z-order range for the current triangle bbox;\n\tconst minZ = zOrder( minTX, minTY, minX, minY, invSize ),\n\t\tmaxZ = zOrder( maxTX, maxTY, minX, minY, invSize );\n\n\tlet p = ear.prevZ,\n\t\tn = ear.nextZ;\n\n\t// look for points inside the triangle in both directions\n\twhile ( p && p.z >= minZ && n && n.z <= maxZ ) {\n\n\t\tif ( p !== ear.prev && p !== ear.next &&\n\t\t\tpointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y ) &&\n\t\t\tarea( p.prev, p, p.next ) >= 0 ) return false;\n\t\tp = p.prevZ;\n\n\t\tif ( n !== ear.prev && n !== ear.next &&\n\t\t\tpointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y ) &&\n\t\t\tarea( n.prev, n, n.next ) >= 0 ) return false;\n\t\tn = n.nextZ;\n\n\t}\n\n\t// look for remaining points in decreasing z-order\n\twhile ( p && p.z >= minZ ) {\n\n\t\tif ( p !== ear.prev && p !== ear.next &&\n\t\t\tpointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y ) &&\n\t\t\tarea( p.prev, p, p.next ) >= 0 ) return false;\n\t\tp = p.prevZ;\n\n\t}\n\n\t// look for remaining points in increasing z-order\n\twhile ( n && n.z <= maxZ ) {\n\n\t\tif ( n !== ear.prev && n !== ear.next &&\n\t\t\tpointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y ) &&\n\t\t\tarea( n.prev, n, n.next ) >= 0 ) return false;\n\t\tn = n.nextZ;\n\n\t}\n\n\treturn true;\n\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections( start, triangles, dim ) {\n\n\tlet p = start;\n\tdo {\n\n\t\tconst a = p.prev,\n\t\t\tb = p.next.next;\n\n\t\tif ( ! equals( a, b ) && intersects( a, p, p.next, b ) && locallyInside( a, b ) && locallyInside( b, a ) ) {\n\n\t\t\ttriangles.push( a.i / dim );\n\t\t\ttriangles.push( p.i / dim );\n\t\t\ttriangles.push( b.i / dim );\n\n\t\t\t// remove two nodes involved\n\t\t\tremoveNode( p );\n\t\t\tremoveNode( p.next );\n\n\t\t\tp = start = b;\n\n\t\t}\n\n\t\tp = p.next;\n\n\t} while ( p !== start );\n\n\treturn filterPoints( p );\n\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut( start, triangles, dim, minX, minY, invSize ) {\n\n\t// look for a valid diagonal that divides the polygon into two\n\tlet a = start;\n\tdo {\n\n\t\tlet b = a.next.next;\n\t\twhile ( b !== a.prev ) {\n\n\t\t\tif ( a.i !== b.i && isValidDiagonal( a, b ) ) {\n\n\t\t\t\t// split the polygon in two by the diagonal\n\t\t\t\tlet c = splitPolygon( a, b );\n\n\t\t\t\t// filter colinear points around the cuts\n\t\t\t\ta = filterPoints( a, a.next );\n\t\t\t\tc = filterPoints( c, c.next );\n\n\t\t\t\t// run earcut on each half\n\t\t\t\tearcutLinked( a, triangles, dim, minX, minY, invSize );\n\t\t\t\tearcutLinked( c, triangles, dim, minX, minY, invSize );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tb = b.next;\n\n\t\t}\n\n\t\ta = a.next;\n\n\t} while ( a !== start );\n\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles( data, holeIndices, outerNode, dim ) {\n\n\tconst queue = [];\n\tlet i, len, start, end, list;\n\n\tfor ( i = 0, len = holeIndices.length; i < len; i ++ ) {\n\n\t\tstart = holeIndices[ i ] * dim;\n\t\tend = i < len - 1 ? holeIndices[ i + 1 ] * dim : data.length;\n\t\tlist = linkedList( data, start, end, dim, false );\n\t\tif ( list === list.next ) list.steiner = true;\n\t\tqueue.push( getLeftmost( list ) );\n\n\t}\n\n\tqueue.sort( compareX );\n\n\t// process holes from left to right\n\tfor ( i = 0; i < queue.length; i ++ ) {\n\n\t\teliminateHole( queue[ i ], outerNode );\n\t\touterNode = filterPoints( outerNode, outerNode.next );\n\n\t}\n\n\treturn outerNode;\n\n}\n\nfunction compareX( a, b ) {\n\n\treturn a.x - b.x;\n\n}\n\n// find a bridge between vertices that connects hole with an outer ring and and link it\nfunction eliminateHole( hole, outerNode ) {\n\n\touterNode = findHoleBridge( hole, outerNode );\n\tif ( outerNode ) {\n\n\t\tconst b = splitPolygon( outerNode, hole );\n\n\t\t// filter collinear points around the cuts\n\t\tfilterPoints( outerNode, outerNode.next );\n\t\tfilterPoints( b, b.next );\n\n\t}\n\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge( hole, outerNode ) {\n\n\tlet p = outerNode;\n\tconst hx = hole.x;\n\tconst hy = hole.y;\n\tlet qx = - Infinity, m;\n\n\t// find a segment intersected by a ray from the hole's leftmost point to the left;\n\t// segment's endpoint with lesser x will be potential connection point\n\tdo {\n\n\t\tif ( hy <= p.y && hy >= p.next.y && p.next.y !== p.y ) {\n\n\t\t\tconst x = p.x + ( hy - p.y ) * ( p.next.x - p.x ) / ( p.next.y - p.y );\n\t\t\tif ( x <= hx && x > qx ) {\n\n\t\t\t\tqx = x;\n\t\t\t\tif ( x === hx ) {\n\n\t\t\t\t\tif ( hy === p.y ) return p;\n\t\t\t\t\tif ( hy === p.next.y ) return p.next;\n\n\t\t\t\t}\n\n\t\t\t\tm = p.x < p.next.x ? p : p.next;\n\n\t\t\t}\n\n\t\t}\n\n\t\tp = p.next;\n\n\t} while ( p !== outerNode );\n\n\tif ( ! m ) return null;\n\n\tif ( hx === qx ) return m; // hole touches outer segment; pick leftmost endpoint\n\n\t// look for points inside the triangle of hole point, segment intersection and endpoint;\n\t// if there are no points found, we have a valid connection;\n\t// otherwise choose the point of the minimum angle with the ray as connection point\n\n\tconst stop = m,\n\t\tmx = m.x,\n\t\tmy = m.y;\n\tlet tanMin = Infinity, tan;\n\n\tp = m;\n\n\tdo {\n\n\t\tif ( hx >= p.x && p.x >= mx && hx !== p.x &&\n\t\t\t\tpointInTriangle( hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y ) ) {\n\n\t\t\ttan = Math.abs( hy - p.y ) / ( hx - p.x ); // tangential\n\n\t\t\tif ( locallyInside( p, hole ) && ( tan < tanMin || ( tan === tanMin && ( p.x > m.x || ( p.x === m.x && sectorContainsSector( m, p ) ) ) ) ) ) {\n\n\t\t\t\tm = p;\n\t\t\t\ttanMin = tan;\n\n\t\t\t}\n\n\t\t}\n\n\t\tp = p.next;\n\n\t} while ( p !== stop );\n\n\treturn m;\n\n}\n\n// whether sector in vertex m contains sector in vertex p in the same coordinates\nfunction sectorContainsSector( m, p ) {\n\n\treturn area( m.prev, m, p.prev ) < 0 && area( p.next, m, m.next ) < 0;\n\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve( start, minX, minY, invSize ) {\n\n\tlet p = start;\n\tdo {\n\n\t\tif ( p.z === null ) p.z = zOrder( p.x, p.y, minX, minY, invSize );\n\t\tp.prevZ = p.prev;\n\t\tp.nextZ = p.next;\n\t\tp = p.next;\n\n\t} while ( p !== start );\n\n\tp.prevZ.nextZ = null;\n\tp.prevZ = null;\n\n\tsortLinked( p );\n\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked( list ) {\n\n\tlet i, p, q, e, tail, numMerges, pSize, qSize,\n\t\tinSize = 1;\n\n\tdo {\n\n\t\tp = list;\n\t\tlist = null;\n\t\ttail = null;\n\t\tnumMerges = 0;\n\n\t\twhile ( p ) {\n\n\t\t\tnumMerges ++;\n\t\t\tq = p;\n\t\t\tpSize = 0;\n\t\t\tfor ( i = 0; i < inSize; i ++ ) {\n\n\t\t\t\tpSize ++;\n\t\t\t\tq = q.nextZ;\n\t\t\t\tif ( ! q ) break;\n\n\t\t\t}\n\n\t\t\tqSize = inSize;\n\n\t\t\twhile ( pSize > 0 || ( qSize > 0 && q ) ) {\n\n\t\t\t\tif ( pSize !== 0 && ( qSize === 0 || ! q || p.z <= q.z ) ) {\n\n\t\t\t\t\te = p;\n\t\t\t\t\tp = p.nextZ;\n\t\t\t\t\tpSize --;\n\n\t\t\t\t} else {\n\n\t\t\t\t\te = q;\n\t\t\t\t\tq = q.nextZ;\n\t\t\t\t\tqSize --;\n\n\t\t\t\t}\n\n\t\t\t\tif ( tail ) tail.nextZ = e;\n\t\t\t\telse list = e;\n\n\t\t\t\te.prevZ = tail;\n\t\t\t\ttail = e;\n\n\t\t\t}\n\n\t\t\tp = q;\n\n\t\t}\n\n\t\ttail.nextZ = null;\n\t\tinSize *= 2;\n\n\t} while ( numMerges > 1 );\n\n\treturn list;\n\n}\n\n// z-order of a point given coords and inverse of the longer side of data bbox\nfunction zOrder( x, y, minX, minY, invSize ) {\n\n\t// coords are transformed into non-negative 15-bit integer range\n\tx = 32767 * ( x - minX ) * invSize;\n\ty = 32767 * ( y - minY ) * invSize;\n\n\tx = ( x | ( x << 8 ) ) & 0x00FF00FF;\n\tx = ( x | ( x << 4 ) ) & 0x0F0F0F0F;\n\tx = ( x | ( x << 2 ) ) & 0x33333333;\n\tx = ( x | ( x << 1 ) ) & 0x55555555;\n\n\ty = ( y | ( y << 8 ) ) & 0x00FF00FF;\n\ty = ( y | ( y << 4 ) ) & 0x0F0F0F0F;\n\ty = ( y | ( y << 2 ) ) & 0x33333333;\n\ty = ( y | ( y << 1 ) ) & 0x55555555;\n\n\treturn x | ( y << 1 );\n\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost( start ) {\n\n\tlet p = start,\n\t\tleftmost = start;\n\tdo {\n\n\t\tif ( p.x < leftmost.x || ( p.x === leftmost.x && p.y < leftmost.y ) ) leftmost = p;\n\t\tp = p.next;\n\n\t} while ( p !== start );\n\n\treturn leftmost;\n\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle( ax, ay, bx, by, cx, cy, px, py ) {\n\n\treturn ( cx - px ) * ( ay - py ) - ( ax - px ) * ( cy - py ) >= 0 &&\n\t\t\t( ax - px ) * ( by - py ) - ( bx - px ) * ( ay - py ) >= 0 &&\n\t\t\t( bx - px ) * ( cy - py ) - ( cx - px ) * ( by - py ) >= 0;\n\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal( a, b ) {\n\n\treturn a.next.i !== b.i && a.prev.i !== b.i && ! intersectsPolygon( a, b ) && // dones't intersect other edges\n\t\t( locallyInside( a, b ) && locallyInside( b, a ) && middleInside( a, b ) && // locally visible\n\t\t( area( a.prev, a, b.prev ) || area( a, b.prev, b ) ) || // does not create opposite-facing sectors\n\t\tequals( a, b ) && area( a.prev, a, a.next ) > 0 && area( b.prev, b, b.next ) > 0 ); // special zero-length case\n\n}\n\n// signed area of a triangle\nfunction area( p, q, r ) {\n\n\treturn ( q.y - p.y ) * ( r.x - q.x ) - ( q.x - p.x ) * ( r.y - q.y );\n\n}\n\n// check if two points are equal\nfunction equals( p1, p2 ) {\n\n\treturn p1.x === p2.x && p1.y === p2.y;\n\n}\n\n// check if two segments intersect\nfunction intersects( p1, q1, p2, q2 ) {\n\n\tconst o1 = sign( area( p1, q1, p2 ) );\n\tconst o2 = sign( area( p1, q1, q2 ) );\n\tconst o3 = sign( area( p2, q2, p1 ) );\n\tconst o4 = sign( area( p2, q2, q1 ) );\n\n\tif ( o1 !== o2 && o3 !== o4 ) return true; // general case\n\n\tif ( o1 === 0 && onSegment( p1, p2, q1 ) ) return true; // p1, q1 and p2 are collinear and p2 lies on p1q1\n\tif ( o2 === 0 && onSegment( p1, q2, q1 ) ) return true; // p1, q1 and q2 are collinear and q2 lies on p1q1\n\tif ( o3 === 0 && onSegment( p2, p1, q2 ) ) return true; // p2, q2 and p1 are collinear and p1 lies on p2q2\n\tif ( o4 === 0 && onSegment( p2, q1, q2 ) ) return true; // p2, q2 and q1 are collinear and q1 lies on p2q2\n\n\treturn false;\n\n}\n\n// for collinear points p, q, r, check if point q lies on segment pr\nfunction onSegment( p, q, r ) {\n\n\treturn q.x <= Math.max( p.x, r.x ) && q.x >= Math.min( p.x, r.x ) && q.y <= Math.max( p.y, r.y ) && q.y >= Math.min( p.y, r.y );\n\n}\n\nfunction sign( num ) {\n\n\treturn num > 0 ? 1 : num < 0 ? - 1 : 0;\n\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon( a, b ) {\n\n\tlet p = a;\n\tdo {\n\n\t\tif ( p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n\t\t\t\tintersects( p, p.next, a, b ) ) return true;\n\t\tp = p.next;\n\n\t} while ( p !== a );\n\n\treturn false;\n\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside( a, b ) {\n\n\treturn area( a.prev, a, a.next ) < 0 ?\n\t\tarea( a, b, a.next ) >= 0 && area( a, a.prev, b ) >= 0 :\n\t\tarea( a, b, a.prev ) < 0 || area( a, a.next, b ) < 0;\n\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside( a, b ) {\n\n\tlet p = a,\n\t\tinside = false;\n\tconst px = ( a.x + b.x ) / 2,\n\t\tpy = ( a.y + b.y ) / 2;\n\tdo {\n\n\t\tif ( ( ( p.y > py ) !== ( p.next.y > py ) ) && p.next.y !== p.y &&\n\t\t\t\t( px < ( p.next.x - p.x ) * ( py - p.y ) / ( p.next.y - p.y ) + p.x ) )\n\t\t\tinside = ! inside;\n\t\tp = p.next;\n\n\t} while ( p !== a );\n\n\treturn inside;\n\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon( a, b ) {\n\n\tconst a2 = new Node( a.i, a.x, a.y ),\n\t\tb2 = new Node( b.i, b.x, b.y ),\n\t\tan = a.next,\n\t\tbp = b.prev;\n\n\ta.next = b;\n\tb.prev = a;\n\n\ta2.next = an;\n\tan.prev = a2;\n\n\tb2.next = a2;\n\ta2.prev = b2;\n\n\tbp.next = b2;\n\tb2.prev = bp;\n\n\treturn b2;\n\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode( i, x, y, last ) {\n\n\tconst p = new Node( i, x, y );\n\n\tif ( ! last ) {\n\n\t\tp.prev = p;\n\t\tp.next = p;\n\n\t} else {\n\n\t\tp.next = last.next;\n\t\tp.prev = last;\n\t\tlast.next.prev = p;\n\t\tlast.next = p;\n\n\t}\n\n\treturn p;\n\n}\n\nfunction removeNode( p ) {\n\n\tp.next.prev = p.prev;\n\tp.prev.next = p.next;\n\n\tif ( p.prevZ ) p.prevZ.nextZ = p.nextZ;\n\tif ( p.nextZ ) p.nextZ.prevZ = p.prevZ;\n\n}\n\nfunction Node( i, x, y ) {\n\n\t// vertex index in coordinates array\n\tthis.i = i;\n\n\t// vertex coordinates\n\tthis.x = x;\n\tthis.y = y;\n\n\t// previous and next vertex nodes in a polygon ring\n\tthis.prev = null;\n\tthis.next = null;\n\n\t// z-order curve value\n\tthis.z = null;\n\n\t// previous and next nodes in z-order\n\tthis.prevZ = null;\n\tthis.nextZ = null;\n\n\t// indicates whether this is a steiner point\n\tthis.steiner = false;\n\n}\n\nfunction signedArea( data, start, end, dim ) {\n\n\tlet sum = 0;\n\tfor ( let i = start, j = end - dim; i < end; i += dim ) {\n\n\t\tsum += ( data[ j ] - data[ i ] ) * ( data[ i + 1 ] + data[ j + 1 ] );\n\t\tj = i;\n\n\t}\n\n\treturn sum;\n\n}\n\nexport { Earcut };\n","import { Earcut } from './Earcut.js';\n\nclass ShapeUtils {\n\n\t// calculate area of the contour polygon\n\n\tstatic area( contour ) {\n\n\t\tconst n = contour.length;\n\t\tlet a = 0.0;\n\n\t\tfor ( let p = n - 1, q = 0; q < n; p = q ++ ) {\n\n\t\t\ta += contour[ p ].x * contour[ q ].y - contour[ q ].x * contour[ p ].y;\n\n\t\t}\n\n\t\treturn a * 0.5;\n\n\t}\n\n\tstatic isClockWise( pts ) {\n\n\t\treturn ShapeUtils.area( pts ) < 0;\n\n\t}\n\n\tstatic triangulateShape( contour, holes ) {\n\n\t\tconst vertices = []; // flat array of vertices like [ x0,y0, x1,y1, x2,y2, ... ]\n\t\tconst holeIndices = []; // array of hole indices\n\t\tconst faces = []; // final array of vertex indices like [ [ a,b,d ], [ b,c,d ] ]\n\n\t\tremoveDupEndPts( contour );\n\t\taddContour( vertices, contour );\n\n\t\t//\n\n\t\tlet holeIndex = contour.length;\n\n\t\tholes.forEach( removeDupEndPts );\n\n\t\tfor ( let i = 0; i < holes.length; i ++ ) {\n\n\t\t\tholeIndices.push( holeIndex );\n\t\t\tholeIndex += holes[ i ].length;\n\t\t\taddContour( vertices, holes[ i ] );\n\n\t\t}\n\n\t\t//\n\n\t\tconst triangles = Earcut.triangulate( vertices, holeIndices );\n\n\t\t//\n\n\t\tfor ( let i = 0; i < triangles.length; i += 3 ) {\n\n\t\t\tfaces.push( triangles.slice( i, i + 3 ) );\n\n\t\t}\n\n\t\treturn faces;\n\n\t}\n\n}\n\nfunction removeDupEndPts( points ) {\n\n\tconst l = points.length;\n\n\tif ( l > 2 && points[ l - 1 ].equals( points[ 0 ] ) ) {\n\n\t\tpoints.pop();\n\n\t}\n\n}\n\nfunction addContour( vertices, contour ) {\n\n\tfor ( let i = 0; i < contour.length; i ++ ) {\n\n\t\tvertices.push( contour[ i ].x );\n\t\tvertices.push( contour[ i ].y );\n\n\t}\n\n}\n\nexport { ShapeUtils };\n","import { Color } from '../../math/Color.js';\nimport { Path } from './Path.js';\nimport { Shape } from './Shape.js';\nimport { ShapeUtils } from '../ShapeUtils.js';\n\nclass ShapePath {\n\n\tconstructor() {\n\n\t\tthis.type = 'ShapePath';\n\n\t\tthis.color = new Color();\n\n\t\tthis.subPaths = [];\n\t\tthis.currentPath = null;\n\n\t}\n\n\tmoveTo( x, y ) {\n\n\t\tthis.currentPath = new Path();\n\t\tthis.subPaths.push( this.currentPath );\n\t\tthis.currentPath.moveTo( x, y );\n\n\t\treturn this;\n\n\t}\n\n\tlineTo( x, y ) {\n\n\t\tthis.currentPath.lineTo( x, y );\n\n\t\treturn this;\n\n\t}\n\n\tquadraticCurveTo( aCPx, aCPy, aX, aY ) {\n\n\t\tthis.currentPath.quadraticCurveTo( aCPx, aCPy, aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tbezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\n\n\t\tthis.currentPath.bezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tsplineThru( pts ) {\n\n\t\tthis.currentPath.splineThru( pts );\n\n\t\treturn this;\n\n\t}\n\n\ttoShapes( isCCW, noHoles ) {\n\n\t\tfunction toShapesNoHoles( inSubpaths ) {\n\n\t\t\tconst shapes = [];\n\n\t\t\tfor ( let i = 0, l = inSubpaths.length; i < l; i ++ ) {\n\n\t\t\t\tconst tmpPath = inSubpaths[ i ];\n\n\t\t\t\tconst tmpShape = new Shape();\n\t\t\t\ttmpShape.curves = tmpPath.curves;\n\n\t\t\t\tshapes.push( tmpShape );\n\n\t\t\t}\n\n\t\t\treturn shapes;\n\n\t\t}\n\n\t\tfunction isPointInsidePolygon( inPt, inPolygon ) {\n\n\t\t\tconst polyLen = inPolygon.length;\n\n\t\t\t// inPt on polygon contour => immediate success    or\n\t\t\t// toggling of inside/outside at every single! intersection point of an edge\n\t\t\t//  with the horizontal line through inPt, left of inPt\n\t\t\t//  not counting lowerY endpoints of edges and whole edges on that line\n\t\t\tlet inside = false;\n\t\t\tfor ( let p = polyLen - 1, q = 0; q < polyLen; p = q ++ ) {\n\n\t\t\t\tlet edgeLowPt = inPolygon[ p ];\n\t\t\t\tlet edgeHighPt = inPolygon[ q ];\n\n\t\t\t\tlet edgeDx = edgeHighPt.x - edgeLowPt.x;\n\t\t\t\tlet edgeDy = edgeHighPt.y - edgeLowPt.y;\n\n\t\t\t\tif ( Math.abs( edgeDy ) > Number.EPSILON ) {\n\n\t\t\t\t\t// not parallel\n\t\t\t\t\tif ( edgeDy < 0 ) {\n\n\t\t\t\t\t\tedgeLowPt = inPolygon[ q ]; edgeDx = - edgeDx;\n\t\t\t\t\t\tedgeHighPt = inPolygon[ p ]; edgeDy = - edgeDy;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ( inPt.y < edgeLowPt.y ) || ( inPt.y > edgeHighPt.y ) ) \t\tcontinue;\n\n\t\t\t\t\tif ( inPt.y === edgeLowPt.y ) {\n\n\t\t\t\t\t\tif ( inPt.x === edgeLowPt.x )\t\treturn\ttrue;\t\t// inPt is on contour ?\n\t\t\t\t\t\t// continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconst perpEdge = edgeDy * ( inPt.x - edgeLowPt.x ) - edgeDx * ( inPt.y - edgeLowPt.y );\n\t\t\t\t\t\tif ( perpEdge === 0 )\t\t\t\treturn\ttrue;\t\t// inPt is on contour ?\n\t\t\t\t\t\tif ( perpEdge < 0 ) \t\t\t\tcontinue;\n\t\t\t\t\t\tinside = ! inside;\t\t// true intersection left of inPt\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// parallel or collinear\n\t\t\t\t\tif ( inPt.y !== edgeLowPt.y ) \t\tcontinue;\t\t\t// parallel\n\t\t\t\t\t// edge lies on the same horizontal line as inPt\n\t\t\t\t\tif ( ( ( edgeHighPt.x <= inPt.x ) && ( inPt.x <= edgeLowPt.x ) ) ||\n\t\t\t\t\t\t ( ( edgeLowPt.x <= inPt.x ) && ( inPt.x <= edgeHighPt.x ) ) )\t\treturn\ttrue;\t// inPt: Point on contour !\n\t\t\t\t\t// continue;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn\tinside;\n\n\t\t}\n\n\t\tconst isClockWise = ShapeUtils.isClockWise;\n\n\t\tconst subPaths = this.subPaths;\n\t\tif ( subPaths.length === 0 ) return [];\n\n\t\tif ( noHoles === true )\treturn\ttoShapesNoHoles( subPaths );\n\n\n\t\tlet solid, tmpPath, tmpShape;\n\t\tconst shapes = [];\n\n\t\tif ( subPaths.length === 1 ) {\n\n\t\t\ttmpPath = subPaths[ 0 ];\n\t\t\ttmpShape = new Shape();\n\t\t\ttmpShape.curves = tmpPath.curves;\n\t\t\tshapes.push( tmpShape );\n\t\t\treturn shapes;\n\n\t\t}\n\n\t\tlet holesFirst = ! isClockWise( subPaths[ 0 ].getPoints() );\n\t\tholesFirst = isCCW ? ! holesFirst : holesFirst;\n\n\t\t// console.log(\"Holes first\", holesFirst);\n\n\t\tconst betterShapeHoles = [];\n\t\tconst newShapes = [];\n\t\tlet newShapeHoles = [];\n\t\tlet mainIdx = 0;\n\t\tlet tmpPoints;\n\n\t\tnewShapes[ mainIdx ] = undefined;\n\t\tnewShapeHoles[ mainIdx ] = [];\n\n\t\tfor ( let i = 0, l = subPaths.length; i < l; i ++ ) {\n\n\t\t\ttmpPath = subPaths[ i ];\n\t\t\ttmpPoints = tmpPath.getPoints();\n\t\t\tsolid = isClockWise( tmpPoints );\n\t\t\tsolid = isCCW ? ! solid : solid;\n\n\t\t\tif ( solid ) {\n\n\t\t\t\tif ( ( ! holesFirst ) && ( newShapes[ mainIdx ] ) )\tmainIdx ++;\n\n\t\t\t\tnewShapes[ mainIdx ] = { s: new Shape(), p: tmpPoints };\n\t\t\t\tnewShapes[ mainIdx ].s.curves = tmpPath.curves;\n\n\t\t\t\tif ( holesFirst )\tmainIdx ++;\n\t\t\t\tnewShapeHoles[ mainIdx ] = [];\n\n\t\t\t\t//console.log('cw', i);\n\n\t\t\t} else {\n\n\t\t\t\tnewShapeHoles[ mainIdx ].push( { h: tmpPath, p: tmpPoints[ 0 ] } );\n\n\t\t\t\t//console.log('ccw', i);\n\n\t\t\t}\n\n\t\t}\n\n\t\t// only Holes? -> probably all Shapes with wrong orientation\n\t\tif ( ! newShapes[ 0 ] )\treturn\ttoShapesNoHoles( subPaths );\n\n\n\t\tif ( newShapes.length > 1 ) {\n\n\t\t\tlet ambiguous = false;\n\t\t\tconst toChange = [];\n\n\t\t\tfor ( let sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\n\n\t\t\t\tbetterShapeHoles[ sIdx ] = [];\n\n\t\t\t}\n\n\t\t\tfor ( let sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\n\n\t\t\t\tconst sho = newShapeHoles[ sIdx ];\n\n\t\t\t\tfor ( let hIdx = 0; hIdx < sho.length; hIdx ++ ) {\n\n\t\t\t\t\tconst ho = sho[ hIdx ];\n\t\t\t\t\tlet hole_unassigned = true;\n\n\t\t\t\t\tfor ( let s2Idx = 0; s2Idx < newShapes.length; s2Idx ++ ) {\n\n\t\t\t\t\t\tif ( isPointInsidePolygon( ho.p, newShapes[ s2Idx ].p ) ) {\n\n\t\t\t\t\t\t\tif ( sIdx !== s2Idx )\ttoChange.push( { froms: sIdx, tos: s2Idx, hole: hIdx } );\n\t\t\t\t\t\t\tif ( hole_unassigned ) {\n\n\t\t\t\t\t\t\t\thole_unassigned = false;\n\t\t\t\t\t\t\t\tbetterShapeHoles[ s2Idx ].push( ho );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tambiguous = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( hole_unassigned ) {\n\n\t\t\t\t\t\tbetterShapeHoles[ sIdx ].push( ho );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t\t// console.log(\"ambiguous: \", ambiguous);\n\n\t\t\tif ( toChange.length > 0 ) {\n\n\t\t\t\t// console.log(\"to change: \", toChange);\n\t\t\t\tif ( ! ambiguous )\tnewShapeHoles = betterShapeHoles;\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet tmpHoles;\n\n\t\tfor ( let i = 0, il = newShapes.length; i < il; i ++ ) {\n\n\t\t\ttmpShape = newShapes[ i ].s;\n\t\t\tshapes.push( tmpShape );\n\t\t\ttmpHoles = newShapeHoles[ i ];\n\n\t\t\tfor ( let j = 0, jl = tmpHoles.length; j < jl; j ++ ) {\n\n\t\t\t\ttmpShape.holes.push( tmpHoles[ j ].h );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//console.log(\"shape\", shapes);\n\n\t\treturn shapes;\n\n\t}\n\n}\n\n\nexport { ShapePath };\n","import {\n\tFileLoader,\n\tLoader,\n\tShapePath\n} from 'three';\n\nclass FontLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\tlet json;\n\n\t\t\ttry {\n\n\t\t\t\tjson = JSON.parse( text );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tconsole.warn( 'THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead.' );\n\t\t\t\tjson = JSON.parse( text.substring( 65, text.length - 2 ) );\n\n\t\t\t}\n\n\t\t\tconst font = scope.parse( json );\n\n\t\t\tif ( onLoad ) onLoad( font );\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( json ) {\n\n\t\treturn new Font( json );\n\n\t}\n\n}\n\n//\n\nclass Font {\n\n\tconstructor( data ) {\n\n\t\tthis.type = 'Font';\n\n\t\tthis.data = data;\n\n\t}\n\n\tgenerateShapes( text, size = 100 ) {\n\n\t\tconst shapes = [];\n\t\tconst paths = createPaths( text, size, this.data );\n\n\t\tfor ( let p = 0, pl = paths.length; p < pl; p ++ ) {\n\n\t\t\tArray.prototype.push.apply( shapes, paths[ p ].toShapes() );\n\n\t\t}\n\n\t\treturn shapes;\n\n\t}\n\n}\n\nfunction createPaths( text, size, data ) {\n\n\tconst chars = Array.from( text );\n\tconst scale = size / data.resolution;\n\tconst line_height = ( data.boundingBox.yMax - data.boundingBox.yMin + data.underlineThickness ) * scale;\n\n\tconst paths = [];\n\n\tlet offsetX = 0, offsetY = 0;\n\n\tfor ( let i = 0; i < chars.length; i ++ ) {\n\n\t\tconst char = chars[ i ];\n\n\t\tif ( char === '\\n' ) {\n\n\t\t\toffsetX = 0;\n\t\t\toffsetY -= line_height;\n\n\t\t} else {\n\n\t\t\tconst ret = createPath( char, scale, offsetX, offsetY, data );\n\t\t\toffsetX += ret.offsetX;\n\t\t\tpaths.push( ret.path );\n\n\t\t}\n\n\t}\n\n\treturn paths;\n\n}\n\nfunction createPath( char, scale, offsetX, offsetY, data ) {\n\n\tconst glyph = data.glyphs[ char ] || data.glyphs[ '?' ];\n\n\tif ( ! glyph ) {\n\n\t\tconsole.error( 'THREE.Font: character \"' + char + '\" does not exists in font family ' + data.familyName + '.' );\n\n\t\treturn;\n\n\t}\n\n\tconst path = new ShapePath();\n\n\tlet x, y, cpx, cpy, cpx1, cpy1, cpx2, cpy2;\n\n\tif ( glyph.o ) {\n\n\t\tconst outline = glyph._cachedOutline || ( glyph._cachedOutline = glyph.o.split( ' ' ) );\n\n\t\tfor ( let i = 0, l = outline.length; i < l; ) {\n\n\t\t\tconst action = outline[ i ++ ];\n\n\t\t\tswitch ( action ) {\n\n\t\t\t\tcase 'm': // moveTo\n\n\t\t\t\t\tx = outline[ i ++ ] * scale + offsetX;\n\t\t\t\t\ty = outline[ i ++ ] * scale + offsetY;\n\n\t\t\t\t\tpath.moveTo( x, y );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'l': // lineTo\n\n\t\t\t\t\tx = outline[ i ++ ] * scale + offsetX;\n\t\t\t\t\ty = outline[ i ++ ] * scale + offsetY;\n\n\t\t\t\t\tpath.lineTo( x, y );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'q': // quadraticCurveTo\n\n\t\t\t\t\tcpx = outline[ i ++ ] * scale + offsetX;\n\t\t\t\t\tcpy = outline[ i ++ ] * scale + offsetY;\n\t\t\t\t\tcpx1 = outline[ i ++ ] * scale + offsetX;\n\t\t\t\t\tcpy1 = outline[ i ++ ] * scale + offsetY;\n\n\t\t\t\t\tpath.quadraticCurveTo( cpx1, cpy1, cpx, cpy );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'b': // bezierCurveTo\n\n\t\t\t\t\tcpx = outline[ i ++ ] * scale + offsetX;\n\t\t\t\t\tcpy = outline[ i ++ ] * scale + offsetY;\n\t\t\t\t\tcpx1 = outline[ i ++ ] * scale + offsetX;\n\t\t\t\t\tcpy1 = outline[ i ++ ] * scale + offsetY;\n\t\t\t\t\tcpx2 = outline[ i ++ ] * scale + offsetX;\n\t\t\t\t\tcpy2 = outline[ i ++ ] * scale + offsetY;\n\n\t\t\t\t\tpath.bezierCurveTo( cpx1, cpy1, cpx2, cpy2, cpx, cpy );\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn { offsetX: glyph.ha * scale, path: path };\n\n}\n\nFont.prototype.isFont = true;\n\nexport { FontLoader, Font };\n","/**\n * Creates extruded geometry from a path shape.\n *\n * parameters = {\n *\n *  curveSegments: <int>, // number of points on the curves\n *  steps: <int>, // number of points for z-side extrusions / used for subdividing segments of extrude spline too\n *  depth: <float>, // Depth to extrude the shape\n *\n *  bevelEnabled: <bool>, // turn on bevel\n *  bevelThickness: <float>, // how deep into the original shape bevel goes\n *  bevelSize: <float>, // how far from shape outline (including bevelOffset) is bevel\n *  bevelOffset: <float>, // how far from shape outline does bevel start\n *  bevelSegments: <int>, // number of bevel layers\n *\n *  extrudePath: <THREE.Curve> // curve to extrude shape along\n *\n *  UVGenerator: <Object> // object that provides UV generator functions\n *\n * }\n */\n\nimport { BufferGeometry } from '../core/BufferGeometry.js';\nimport { Float32BufferAttribute } from '../core/BufferAttribute.js';\nimport * as Curves from '../extras/curves/Curves.js';\nimport { Vector2 } from '../math/Vector2.js';\nimport { Vector3 } from '../math/Vector3.js';\nimport { Shape } from '../extras/core/Shape.js';\nimport { ShapeUtils } from '../extras/ShapeUtils.js';\n\nclass ExtrudeGeometry extends BufferGeometry {\n\n\tconstructor( shapes = new Shape( [ new Vector2( 0.5, 0.5 ), new Vector2( - 0.5, 0.5 ), new Vector2( - 0.5, - 0.5 ), new Vector2( 0.5, - 0.5 ) ] ), options = {} ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ExtrudeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tshapes: shapes,\n\t\t\toptions: options\n\t\t};\n\n\t\tshapes = Array.isArray( shapes ) ? shapes : [ shapes ];\n\n\t\tconst scope = this;\n\n\t\tconst verticesArray = [];\n\t\tconst uvArray = [];\n\n\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\tconst shape = shapes[ i ];\n\t\t\taddShape( shape );\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( verticesArray, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvArray, 2 ) );\n\n\t\tthis.computeVertexNormals();\n\n\t\t// functions\n\n\t\tfunction addShape( shape ) {\n\n\t\t\tconst placeholder = [];\n\n\t\t\t// options\n\n\t\t\tconst curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\n\t\t\tconst steps = options.steps !== undefined ? options.steps : 1;\n\t\t\tlet depth = options.depth !== undefined ? options.depth : 1;\n\n\t\t\tlet bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true;\n\t\t\tlet bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 0.2;\n\t\t\tlet bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 0.1;\n\t\t\tlet bevelOffset = options.bevelOffset !== undefined ? options.bevelOffset : 0;\n\t\t\tlet bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\n\n\t\t\tconst extrudePath = options.extrudePath;\n\n\t\t\tconst uvgen = options.UVGenerator !== undefined ? options.UVGenerator : WorldUVGenerator;\n\n\t\t\t// deprecated options\n\n\t\t\tif ( options.amount !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.ExtrudeBufferGeometry: amount has been renamed to depth.' );\n\t\t\t\tdepth = options.amount;\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tlet extrudePts, extrudeByPath = false;\n\t\t\tlet splineTube, binormal, normal, position2;\n\n\t\t\tif ( extrudePath ) {\n\n\t\t\t\textrudePts = extrudePath.getSpacedPoints( steps );\n\n\t\t\t\textrudeByPath = true;\n\t\t\t\tbevelEnabled = false; // bevels not supported for path extrusion\n\n\t\t\t\t// SETUP TNB variables\n\n\t\t\t\t// TODO1 - have a .isClosed in spline?\n\n\t\t\t\tsplineTube = extrudePath.computeFrenetFrames( steps, false );\n\n\t\t\t\t// console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\n\n\t\t\t\tbinormal = new Vector3();\n\t\t\t\tnormal = new Vector3();\n\t\t\t\tposition2 = new Vector3();\n\n\t\t\t}\n\n\t\t\t// Safeguards if bevels are not enabled\n\n\t\t\tif ( ! bevelEnabled ) {\n\n\t\t\t\tbevelSegments = 0;\n\t\t\t\tbevelThickness = 0;\n\t\t\t\tbevelSize = 0;\n\t\t\t\tbevelOffset = 0;\n\n\t\t\t}\n\n\t\t\t// Variables initialization\n\n\t\t\tconst shapePoints = shape.extractPoints( curveSegments );\n\n\t\t\tlet vertices = shapePoints.shape;\n\t\t\tconst holes = shapePoints.holes;\n\n\t\t\tconst reverse = ! ShapeUtils.isClockWise( vertices );\n\n\t\t\tif ( reverse ) {\n\n\t\t\t\tvertices = vertices.reverse();\n\n\t\t\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe ...\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\n\t\t\t\t\tif ( ShapeUtils.isClockWise( ahole ) ) {\n\n\t\t\t\t\t\tholes[ h ] = ahole.reverse();\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\tconst faces = ShapeUtils.triangulateShape( vertices, holes );\n\n\t\t\t/* Vertices */\n\n\t\t\tconst contour = vertices; // vertices has all points but contour has only points of circumference\n\n\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tconst ahole = holes[ h ];\n\n\t\t\t\tvertices = vertices.concat( ahole );\n\n\t\t\t}\n\n\n\t\t\tfunction scalePt2( pt, vec, size ) {\n\n\t\t\t\tif ( ! vec ) console.error( 'THREE.ExtrudeGeometry: vec does not exist' );\n\n\t\t\t\treturn vec.clone().multiplyScalar( size ).add( pt );\n\n\t\t\t}\n\n\t\t\tconst vlen = vertices.length, flen = faces.length;\n\n\n\t\t\t// Find directions for point movement\n\n\n\t\t\tfunction getBevelVec( inPt, inPrev, inNext ) {\n\n\t\t\t\t// computes for inPt the corresponding point inPt' on a new contour\n\t\t\t\t//   shifted by 1 unit (length of normalized vector) to the left\n\t\t\t\t// if we walk along contour clockwise, this new contour is outside the old one\n\t\t\t\t//\n\t\t\t\t// inPt' is the intersection of the two lines parallel to the two\n\t\t\t\t//  adjacent edges of inPt at a distance of 1 unit on the left side.\n\n\t\t\t\tlet v_trans_x, v_trans_y, shrink_by; // resulting translation vector for inPt\n\n\t\t\t\t// good reading for geometry algorithms (here: line-line intersection)\n\t\t\t\t// http://geomalgorithms.com/a05-_intersect-1.html\n\n\t\t\t\tconst v_prev_x = inPt.x - inPrev.x,\n\t\t\t\t\tv_prev_y = inPt.y - inPrev.y;\n\t\t\t\tconst v_next_x = inNext.x - inPt.x,\n\t\t\t\t\tv_next_y = inNext.y - inPt.y;\n\n\t\t\t\tconst v_prev_lensq = ( v_prev_x * v_prev_x + v_prev_y * v_prev_y );\n\n\t\t\t\t// check for collinear edges\n\t\t\t\tconst collinear0 = ( v_prev_x * v_next_y - v_prev_y * v_next_x );\n\n\t\t\t\tif ( Math.abs( collinear0 ) > Number.EPSILON ) {\n\n\t\t\t\t\t// not collinear\n\n\t\t\t\t\t// length of vectors for normalizing\n\n\t\t\t\t\tconst v_prev_len = Math.sqrt( v_prev_lensq );\n\t\t\t\t\tconst v_next_len = Math.sqrt( v_next_x * v_next_x + v_next_y * v_next_y );\n\n\t\t\t\t\t// shift adjacent points by unit vectors to the left\n\n\t\t\t\t\tconst ptPrevShift_x = ( inPrev.x - v_prev_y / v_prev_len );\n\t\t\t\t\tconst ptPrevShift_y = ( inPrev.y + v_prev_x / v_prev_len );\n\n\t\t\t\t\tconst ptNextShift_x = ( inNext.x - v_next_y / v_next_len );\n\t\t\t\t\tconst ptNextShift_y = ( inNext.y + v_next_x / v_next_len );\n\n\t\t\t\t\t// scaling factor for v_prev to intersection point\n\n\t\t\t\t\tconst sf = ( ( ptNextShift_x - ptPrevShift_x ) * v_next_y -\n\t\t\t\t\t\t\t( ptNextShift_y - ptPrevShift_y ) * v_next_x ) /\n\t\t\t\t\t\t( v_prev_x * v_next_y - v_prev_y * v_next_x );\n\n\t\t\t\t\t// vector from inPt to intersection point\n\n\t\t\t\t\tv_trans_x = ( ptPrevShift_x + v_prev_x * sf - inPt.x );\n\t\t\t\t\tv_trans_y = ( ptPrevShift_y + v_prev_y * sf - inPt.y );\n\n\t\t\t\t\t// Don't normalize!, otherwise sharp corners become ugly\n\t\t\t\t\t//  but prevent crazy spikes\n\t\t\t\t\tconst v_trans_lensq = ( v_trans_x * v_trans_x + v_trans_y * v_trans_y );\n\t\t\t\t\tif ( v_trans_lensq <= 2 ) {\n\n\t\t\t\t\t\treturn new Vector2( v_trans_x, v_trans_y );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_trans_lensq / 2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// handle special case of collinear edges\n\n\t\t\t\t\tlet direction_eq = false; // assumes: opposite\n\n\t\t\t\t\tif ( v_prev_x > Number.EPSILON ) {\n\n\t\t\t\t\t\tif ( v_next_x > Number.EPSILON ) {\n\n\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( v_prev_x < - Number.EPSILON ) {\n\n\t\t\t\t\t\t\tif ( v_next_x < - Number.EPSILON ) {\n\n\t\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tif ( Math.sign( v_prev_y ) === Math.sign( v_next_y ) ) {\n\n\t\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( direction_eq ) {\n\n\t\t\t\t\t\t// console.log(\"Warning: lines are a straight sequence\");\n\t\t\t\t\t\tv_trans_x = - v_prev_y;\n\t\t\t\t\t\tv_trans_y = v_prev_x;\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// console.log(\"Warning: lines are a straight spike\");\n\t\t\t\t\t\tv_trans_x = v_prev_x;\n\t\t\t\t\t\tv_trans_y = v_prev_y;\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq / 2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn new Vector2( v_trans_x / shrink_by, v_trans_y / shrink_by );\n\n\t\t\t}\n\n\n\t\t\tconst contourMovements = [];\n\n\t\t\tfor ( let i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\n\n\t\t\t\tif ( j === il ) j = 0;\n\t\t\t\tif ( k === il ) k = 0;\n\n\t\t\t\t//  (j)---(i)---(k)\n\t\t\t\t// console.log('i,j,k', i, j , k)\n\n\t\t\t\tcontourMovements[ i ] = getBevelVec( contour[ i ], contour[ j ], contour[ k ] );\n\n\t\t\t}\n\n\t\t\tconst holesMovements = [];\n\t\t\tlet oneHoleMovements, verticesMovements = contourMovements.concat();\n\n\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tconst ahole = holes[ h ];\n\n\t\t\t\toneHoleMovements = [];\n\n\t\t\t\tfor ( let i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\n\n\t\t\t\t\tif ( j === il ) j = 0;\n\t\t\t\t\tif ( k === il ) k = 0;\n\n\t\t\t\t\t//  (j)---(i)---(k)\n\t\t\t\t\toneHoleMovements[ i ] = getBevelVec( ahole[ i ], ahole[ j ], ahole[ k ] );\n\n\t\t\t\t}\n\n\t\t\t\tholesMovements.push( oneHoleMovements );\n\t\t\t\tverticesMovements = verticesMovements.concat( oneHoleMovements );\n\n\t\t\t}\n\n\n\t\t\t// Loop bevelSegments, 1 for the front, 1 for the back\n\n\t\t\tfor ( let b = 0; b < bevelSegments; b ++ ) {\n\n\t\t\t\t//for ( b = bevelSegments; b > 0; b -- ) {\n\n\t\t\t\tconst t = b / bevelSegments;\n\t\t\t\tconst z = bevelThickness * Math.cos( t * Math.PI / 2 );\n\t\t\t\tconst bs = bevelSize * Math.sin( t * Math.PI / 2 ) + bevelOffset;\n\n\t\t\t\t// contract shape\n\n\t\t\t\tfor ( let i = 0, il = contour.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst vert = scalePt2( contour[ i ], contourMovements[ i ], bs );\n\n\t\t\t\t\tv( vert.x, vert.y, - z );\n\n\t\t\t\t}\n\n\t\t\t\t// expand holes\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\t\t\t\t\toneHoleMovements = holesMovements[ h ];\n\n\t\t\t\t\tfor ( let i = 0, il = ahole.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst vert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\n\n\t\t\t\t\t\tv( vert.x, vert.y, - z );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst bs = bevelSize + bevelOffset;\n\n\t\t\t// Back facing vertices\n\n\t\t\tfor ( let i = 0; i < vlen; i ++ ) {\n\n\t\t\t\tconst vert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\n\n\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\tv( vert.x, vert.y, 0 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\n\n\t\t\t\t\tnormal.copy( splineTube.normals[ 0 ] ).multiplyScalar( vert.x );\n\t\t\t\t\tbinormal.copy( splineTube.binormals[ 0 ] ).multiplyScalar( vert.y );\n\n\t\t\t\t\tposition2.copy( extrudePts[ 0 ] ).add( normal ).add( binormal );\n\n\t\t\t\t\tv( position2.x, position2.y, position2.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Add stepped vertices...\n\t\t\t// Including front facing vertices\n\n\t\t\tfor ( let s = 1; s <= steps; s ++ ) {\n\n\t\t\t\tfor ( let i = 0; i < vlen; i ++ ) {\n\n\t\t\t\t\tconst vert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\n\n\t\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\t\tv( vert.x, vert.y, depth / steps * s );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\n\n\t\t\t\t\t\tnormal.copy( splineTube.normals[ s ] ).multiplyScalar( vert.x );\n\t\t\t\t\t\tbinormal.copy( splineTube.binormals[ s ] ).multiplyScalar( vert.y );\n\n\t\t\t\t\t\tposition2.copy( extrudePts[ s ] ).add( normal ).add( binormal );\n\n\t\t\t\t\t\tv( position2.x, position2.y, position2.z );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\t// Add bevel segments planes\n\n\t\t\t//for ( b = 1; b <= bevelSegments; b ++ ) {\n\t\t\tfor ( let b = bevelSegments - 1; b >= 0; b -- ) {\n\n\t\t\t\tconst t = b / bevelSegments;\n\t\t\t\tconst z = bevelThickness * Math.cos( t * Math.PI / 2 );\n\t\t\t\tconst bs = bevelSize * Math.sin( t * Math.PI / 2 ) + bevelOffset;\n\n\t\t\t\t// contract shape\n\n\t\t\t\tfor ( let i = 0, il = contour.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst vert = scalePt2( contour[ i ], contourMovements[ i ], bs );\n\t\t\t\t\tv( vert.x, vert.y, depth + z );\n\n\t\t\t\t}\n\n\t\t\t\t// expand holes\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\t\t\t\t\toneHoleMovements = holesMovements[ h ];\n\n\t\t\t\t\tfor ( let i = 0, il = ahole.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst vert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\n\n\t\t\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\t\t\tv( vert.x, vert.y, depth + z );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tv( vert.x, vert.y + extrudePts[ steps - 1 ].y, extrudePts[ steps - 1 ].x + z );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t/* Faces */\n\n\t\t\t// Top and bottom faces\n\n\t\t\tbuildLidFaces();\n\n\t\t\t// Sides faces\n\n\t\t\tbuildSideFaces();\n\n\n\t\t\t/////  Internal functions\n\n\t\t\tfunction buildLidFaces() {\n\n\t\t\t\tconst start = verticesArray.length / 3;\n\n\t\t\t\tif ( bevelEnabled ) {\n\n\t\t\t\t\tlet layer = 0; // steps + 1\n\t\t\t\t\tlet offset = vlen * layer;\n\n\t\t\t\t\t// Bottom faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 2 ] + offset, face[ 1 ] + offset, face[ 0 ] + offset );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlayer = steps + bevelSegments * 2;\n\t\t\t\t\toffset = vlen * layer;\n\n\t\t\t\t\t// Top faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 0 ] + offset, face[ 1 ] + offset, face[ 2 ] + offset );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Bottom faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 2 ], face[ 1 ], face[ 0 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Top faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 0 ] + vlen * steps, face[ 1 ] + vlen * steps, face[ 2 ] + vlen * steps );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tscope.addGroup( start, verticesArray.length / 3 - start, 0 );\n\n\t\t\t}\n\n\t\t\t// Create faces for the z-sides of the shape\n\n\t\t\tfunction buildSideFaces() {\n\n\t\t\t\tconst start = verticesArray.length / 3;\n\t\t\t\tlet layeroffset = 0;\n\t\t\t\tsidewalls( contour, layeroffset );\n\t\t\t\tlayeroffset += contour.length;\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\t\t\t\t\tsidewalls( ahole, layeroffset );\n\n\t\t\t\t\t//, true\n\t\t\t\t\tlayeroffset += ahole.length;\n\n\t\t\t\t}\n\n\n\t\t\t\tscope.addGroup( start, verticesArray.length / 3 - start, 1 );\n\n\n\t\t\t}\n\n\t\t\tfunction sidewalls( contour, layeroffset ) {\n\n\t\t\t\tlet i = contour.length;\n\n\t\t\t\twhile ( -- i >= 0 ) {\n\n\t\t\t\t\tconst j = i;\n\t\t\t\t\tlet k = i - 1;\n\t\t\t\t\tif ( k < 0 ) k = contour.length - 1;\n\n\t\t\t\t\t//console.log('b', i,j, i-1, k,vertices.length);\n\n\t\t\t\t\tfor ( let s = 0, sl = ( steps + bevelSegments * 2 ); s < sl; s ++ ) {\n\n\t\t\t\t\t\tconst slen1 = vlen * s;\n\t\t\t\t\t\tconst slen2 = vlen * ( s + 1 );\n\n\t\t\t\t\t\tconst a = layeroffset + j + slen1,\n\t\t\t\t\t\t\tb = layeroffset + k + slen1,\n\t\t\t\t\t\t\tc = layeroffset + k + slen2,\n\t\t\t\t\t\t\td = layeroffset + j + slen2;\n\n\t\t\t\t\t\tf4( a, b, c, d );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfunction v( x, y, z ) {\n\n\t\t\t\tplaceholder.push( x );\n\t\t\t\tplaceholder.push( y );\n\t\t\t\tplaceholder.push( z );\n\n\t\t\t}\n\n\n\t\t\tfunction f3( a, b, c ) {\n\n\t\t\t\taddVertex( a );\n\t\t\t\taddVertex( b );\n\t\t\t\taddVertex( c );\n\n\t\t\t\tconst nextIndex = verticesArray.length / 3;\n\t\t\t\tconst uvs = uvgen.generateTopUV( scope, verticesArray, nextIndex - 3, nextIndex - 2, nextIndex - 1 );\n\n\t\t\t\taddUV( uvs[ 0 ] );\n\t\t\t\taddUV( uvs[ 1 ] );\n\t\t\t\taddUV( uvs[ 2 ] );\n\n\t\t\t}\n\n\t\t\tfunction f4( a, b, c, d ) {\n\n\t\t\t\taddVertex( a );\n\t\t\t\taddVertex( b );\n\t\t\t\taddVertex( d );\n\n\t\t\t\taddVertex( b );\n\t\t\t\taddVertex( c );\n\t\t\t\taddVertex( d );\n\n\n\t\t\t\tconst nextIndex = verticesArray.length / 3;\n\t\t\t\tconst uvs = uvgen.generateSideWallUV( scope, verticesArray, nextIndex - 6, nextIndex - 3, nextIndex - 2, nextIndex - 1 );\n\n\t\t\t\taddUV( uvs[ 0 ] );\n\t\t\t\taddUV( uvs[ 1 ] );\n\t\t\t\taddUV( uvs[ 3 ] );\n\n\t\t\t\taddUV( uvs[ 1 ] );\n\t\t\t\taddUV( uvs[ 2 ] );\n\t\t\t\taddUV( uvs[ 3 ] );\n\n\t\t\t}\n\n\t\t\tfunction addVertex( index ) {\n\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 0 ] );\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 1 ] );\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 2 ] );\n\n\t\t\t}\n\n\n\t\t\tfunction addUV( vector2 ) {\n\n\t\t\t\tuvArray.push( vector2.x );\n\t\t\t\tuvArray.push( vector2.y );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tconst shapes = this.parameters.shapes;\n\t\tconst options = this.parameters.options;\n\n\t\treturn toJSON( shapes, options, data );\n\n\t}\n\n\tstatic fromJSON( data, shapes ) {\n\n\t\tconst geometryShapes = [];\n\n\t\tfor ( let j = 0, jl = data.shapes.length; j < jl; j ++ ) {\n\n\t\t\tconst shape = shapes[ data.shapes[ j ] ];\n\n\t\t\tgeometryShapes.push( shape );\n\n\t\t}\n\n\t\tconst extrudePath = data.options.extrudePath;\n\n\t\tif ( extrudePath !== undefined ) {\n\n\t\t\tdata.options.extrudePath = new Curves[ extrudePath.type ]().fromJSON( extrudePath );\n\n\t\t}\n\n\t\treturn new ExtrudeGeometry( geometryShapes, data.options );\n\n\t}\n\n}\n\nconst WorldUVGenerator = {\n\n\tgenerateTopUV: function ( geometry, vertices, indexA, indexB, indexC ) {\n\n\t\tconst a_x = vertices[ indexA * 3 ];\n\t\tconst a_y = vertices[ indexA * 3 + 1 ];\n\t\tconst b_x = vertices[ indexB * 3 ];\n\t\tconst b_y = vertices[ indexB * 3 + 1 ];\n\t\tconst c_x = vertices[ indexC * 3 ];\n\t\tconst c_y = vertices[ indexC * 3 + 1 ];\n\n\t\treturn [\n\t\t\tnew Vector2( a_x, a_y ),\n\t\t\tnew Vector2( b_x, b_y ),\n\t\t\tnew Vector2( c_x, c_y )\n\t\t];\n\n\t},\n\n\tgenerateSideWallUV: function ( geometry, vertices, indexA, indexB, indexC, indexD ) {\n\n\t\tconst a_x = vertices[ indexA * 3 ];\n\t\tconst a_y = vertices[ indexA * 3 + 1 ];\n\t\tconst a_z = vertices[ indexA * 3 + 2 ];\n\t\tconst b_x = vertices[ indexB * 3 ];\n\t\tconst b_y = vertices[ indexB * 3 + 1 ];\n\t\tconst b_z = vertices[ indexB * 3 + 2 ];\n\t\tconst c_x = vertices[ indexC * 3 ];\n\t\tconst c_y = vertices[ indexC * 3 + 1 ];\n\t\tconst c_z = vertices[ indexC * 3 + 2 ];\n\t\tconst d_x = vertices[ indexD * 3 ];\n\t\tconst d_y = vertices[ indexD * 3 + 1 ];\n\t\tconst d_z = vertices[ indexD * 3 + 2 ];\n\n\t\tif ( Math.abs( a_y - b_y ) < Math.abs( a_x - b_x ) ) {\n\n\t\t\treturn [\n\t\t\t\tnew Vector2( a_x, 1 - a_z ),\n\t\t\t\tnew Vector2( b_x, 1 - b_z ),\n\t\t\t\tnew Vector2( c_x, 1 - c_z ),\n\t\t\t\tnew Vector2( d_x, 1 - d_z )\n\t\t\t];\n\n\t\t} else {\n\n\t\t\treturn [\n\t\t\t\tnew Vector2( a_y, 1 - a_z ),\n\t\t\t\tnew Vector2( b_y, 1 - b_z ),\n\t\t\t\tnew Vector2( c_y, 1 - c_z ),\n\t\t\t\tnew Vector2( d_y, 1 - d_z )\n\t\t\t];\n\n\t\t}\n\n\t}\n\n};\n\nfunction toJSON( shapes, options, data ) {\n\n\tdata.shapes = [];\n\n\tif ( Array.isArray( shapes ) ) {\n\n\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\tconst shape = shapes[ i ];\n\n\t\t\tdata.shapes.push( shape.uuid );\n\n\t\t}\n\n\t} else {\n\n\t\tdata.shapes.push( shapes.uuid );\n\n\t}\n\n\tif ( options.extrudePath !== undefined ) data.options.extrudePath = options.extrudePath.toJSON();\n\n\treturn data;\n\n}\n\n\nexport { ExtrudeGeometry, ExtrudeGeometry as ExtrudeBufferGeometry };\n","/**\n * Text = 3D Text\n *\n * parameters = {\n *  font: <THREE.Font>, // font\n *\n *  size: <float>, // size of the text\n *  height: <float>, // thickness to extrude text\n *  curveSegments: <int>, // number of points on the curves\n *\n *  bevelEnabled: <bool>, // turn on bevel\n *  bevelThickness: <float>, // how deep into text bevel goes\n *  bevelSize: <float>, // how far from text outline (including bevelOffset) is bevel\n *  bevelOffset: <float> // how far from text outline does bevel start\n * }\n */\n\nimport {\n\tBufferGeometry,\n\tExtrudeGeometry\n} from 'three';\n\nclass TextGeometry extends ExtrudeGeometry {\n\n\tconstructor( text, parameters = {} ) {\n\n\t\tconst font = parameters.font;\n\n\t\tif ( ! ( font && font.isFont ) ) {\n\n\t\t\tconsole.error( 'THREE.TextGeometry: font parameter is not an instance of THREE.Font.' );\n\t\t\treturn new BufferGeometry();\n\n\t\t}\n\n\t\tconst shapes = font.generateShapes( text, parameters.size );\n\n\t\t// translate parameters to ExtrudeGeometry API\n\n\t\tparameters.depth = parameters.height !== undefined ? parameters.height : 50;\n\n\t\t// defaults\n\n\t\tif ( parameters.bevelThickness === undefined ) parameters.bevelThickness = 10;\n\t\tif ( parameters.bevelSize === undefined ) parameters.bevelSize = 8;\n\t\tif ( parameters.bevelEnabled === undefined ) parameters.bevelEnabled = false;\n\n\t\tsuper( shapes, parameters );\n\n\t\tthis.type = 'TextGeometry';\n\n\t}\n\n}\n\n\nexport { TextGeometry };\n","import * as THREE from 'three';\nimport { FontLoader, Font } from '@three/loaders/FontLoader';\nimport { TextGeometry } from '@three/geometries/TextGeometry';\n\nconst REGULAR_FONT_URL = 'Poppins_Regular.json';\nconst SEMIBOLD_FONT_URL = 'Poppins_SemiBold_Regular.json';\n\ntype MaterialType = 'normal' | 'white';\ntype Anchor = 'left' | 'center' | 'right';\ntype Axis = 'x' | 'y' | 'z';\n\ninterface TextParams {\n  size: number;\n  materialType: MaterialType;\n  horizAnchor: Anchor;\n  maxWidth: number;\n}\n\nexport default class TextGenerator {\n  regularFont: Font;\n  semiboldFont: Font;\n  normalMaterial: THREE.MeshNormalMaterial;\n  whiteMaterial: THREE.MeshPhongMaterial;\n\n  constructor() {\n    this.normalMaterial = new THREE.MeshNormalMaterial();\n    this.whiteMaterial = new THREE.MeshPhongMaterial({ color: 0xffffff });\n  }\n\n  async load() {\n    const fontLoader = new FontLoader();\n    const [regularFont, semiboldFont] = await Promise.all([\n      fontLoader.loadAsync(REGULAR_FONT_URL),\n      fontLoader.loadAsync(SEMIBOLD_FONT_URL),\n    ]);\n\n    this.regularFont = regularFont;\n    this.semiboldFont = semiboldFont;\n  }\n\n  newRegular(text: string, params: Partial<TextParams>): THREE.Group {\n    const size = params.size || 0.1;\n    const materialType = params.materialType || 'white';\n    const horizAnchor = params.horizAnchor || 'left';\n    const maxWidth = params.maxWidth || Infinity;\n\n    return this.#renderText(\n      text,\n      this.regularFont,\n      size,\n      this.#getMaterialForType(materialType),\n      horizAnchor,\n      maxWidth,\n    );\n  }\n\n  newBold(text: string, params: Partial<TextParams>): THREE.Group {\n    const size = params.size || 0.1;\n    const materialType = params.materialType || 'white';\n    const horizAnchor = params.horizAnchor || 'left';\n    const maxWidth = params.maxWidth || Infinity;\n\n    return this.#renderText(\n      text,\n      this.semiboldFont,\n      size,\n      this.#getMaterialForType(materialType),\n      horizAnchor,\n      maxWidth,\n    );\n  }\n\n  #renderText(\n    text: string,\n    font: Font,\n    size: number,\n    material: THREE.Material,\n    horizAnchor: Anchor,\n    maxWidth: number,\n  ): THREE.Group {\n    const params = {\n      font,\n      size,\n      height: 0.01,\n      curveSegments: 4,\n    };\n\n    const geometries = [];\n\n    while (true) {\n      const textGeometry = new TextGeometry(text, params);\n      textGeometry.computeBoundingBox();\n      const bBox = textGeometry.boundingBox;\n      if (bBox.max.x - bBox.min.x > maxWidth) {\n        const words = text.split(' ');\n        let current = words[0];\n\n        let nextIdx = 1;\n        let next = current + ' ' + words[nextIdx];\n        let nextGeom = new TextGeometry(next, params);\n        nextGeom.computeBoundingBox();\n        let bBox = nextGeom.boundingBox;\n\n        while (bBox.max.x - bBox.min.x <= maxWidth) {\n          current = next;\n          ++nextIdx;\n          next += ' ' + words[nextIdx];\n          nextGeom = new TextGeometry(next, params);\n          nextGeom.computeBoundingBox();\n          bBox = nextGeom.boundingBox;\n        }\n\n        text = words.slice(nextIdx).join(' ');\n        const currentTextGeom = new TextGeometry(current, params);\n        currentTextGeom.computeBoundingBox();\n        geometries.push(currentTextGeom);\n      } else {\n        geometries.push(textGeometry);\n        break;\n      }\n    }\n\n    const group = new THREE.Group();\n\n    geometries.forEach((geometry, idx) => {\n      const mesh = new THREE.Mesh(geometry, material);\n      const bBox = geometry.boundingBox;\n      mesh.position.setX(this.#getPosForAnchor(horizAnchor, bBox, 'x'));\n      mesh.position.setY(-1.3 * idx * size);\n      mesh.rotateY(Math.PI * 2);\n      group.add(mesh);\n    });\n\n    return group;\n  }\n\n  #getMaterialForType(type: MaterialType): THREE.Material {\n    if (type === 'normal') {\n      return this.normalMaterial;\n    } else if (type === 'white') {\n      return this.whiteMaterial;\n    }\n  }\n\n  #getPosForAnchor(anchor: Anchor, bBox: THREE.Box3, axis: Axis): number {\n    const { max, min } = bBox;\n    if (anchor === 'left') {\n      return -min[axis];\n    } else if (anchor === 'center') {\n      return -0.5 * (max[axis] + min[axis]);\n    } else if (anchor === 'right') {\n      return -max[axis];\n    }\n  }\n}\n","import * as THREE from 'three';\n\ninterface WallpaperData {\n  url: string;\n  width: number;\n  height: number;\n  scale: number;\n}\n\ninterface Wallpaper {\n  sides: THREE.MeshPhongMaterial;\n  end: THREE.MeshPhongMaterial;\n}\n\nexport default class WallpaperManager {\n  loader: THREE.TextureLoader;\n  hallFloorMaterial: THREE.MeshPhongMaterial;\n  centerFloorMaterial: THREE.MeshPhongMaterial;\n  wallpapers: Wallpaper[];\n  wallpaperData: WallpaperData[];\n\n  constructor() {\n    this.loader = new THREE.TextureLoader();\n    this.hallFloorMaterial = null;\n    this.centerFloorMaterial = null;\n    this.wallpapers = [null, null, null];\n    this.wallpaperData = [\n      {\n        url: './images/wall1.png',\n        width: 300,\n        height: 325,\n        scale: 2,\n      },\n      {\n        url: './images/wall2.png',\n        width: 240,\n        height: 458,\n        scale: 2,\n      },\n      {\n        url: './images/wall3.png',\n        width: 400,\n        height: 400,\n        scale: 1,\n      },\n    ];\n  }\n\n  async getHallFloorMaterial(): Promise<THREE.MeshPhongMaterial> {\n    if (this.hallFloorMaterial === null) {\n      const texture = await this.loader.loadAsync('./images/floor.jpg');\n      texture.wrapS = THREE.RepeatWrapping;\n      texture.wrapT = THREE.RepeatWrapping;\n      texture.repeat.set(1, 5);\n\n      this.hallFloorMaterial = new THREE.MeshPhongMaterial({\n        map: texture,\n        side: THREE.DoubleSide,\n      });\n    }\n    return this.hallFloorMaterial;\n  }\n\n  async getCenterFloorMaterial(): Promise<THREE.MeshPhongMaterial> {\n    if (this.centerFloorMaterial === null) {\n      const texture = await this.loader.loadAsync('./images/center_floor.png');\n      this.centerFloorMaterial = new THREE.MeshPhongMaterial({\n        map: texture,\n        side: THREE.DoubleSide,\n        transparent: true,\n      });\n    }\n    return this.centerFloorMaterial;\n  }\n\n  async getWallpaper(\n    idx: 0 | 1 | 2,\n    hallWidth: number,\n    hallHeight: number,\n    hallDepth: number,\n  ): Promise<Wallpaper> {\n    const { url, width, height, scale } = this.wallpaperData[idx];\n\n    if (this.wallpapers[idx] === null) {\n      const texture = await this.loader.loadAsync(url);\n      texture.wrapS = THREE.RepeatWrapping;\n      texture.wrapT = THREE.RepeatWrapping;\n\n      const textureSides = texture.clone();\n      textureSides.needsUpdate = true;\n      textureSides.repeat.set(\n        scale * hallDepth,\n        scale * ((hallHeight * width) / height),\n      );\n      const sides = new THREE.MeshPhongMaterial({\n        map: textureSides,\n        side: THREE.DoubleSide,\n      });\n\n      const textureEnd = texture;\n      textureEnd.repeat.set(\n        scale * hallWidth,\n        scale * ((hallHeight * width) / height),\n      );\n      const end = new THREE.MeshPhongMaterial({\n        map: textureEnd,\n        side: THREE.DoubleSide,\n      });\n\n      this.wallpapers[idx] = { sides, end };\n    }\n\n    return this.wallpapers[idx];\n  }\n}\n","import AlbumCoverManager from './albumcovers';\nimport AudioPlayer from './audio';\nimport { animate, createScene } from './environment';\nimport Hall from './hall';\nimport MovementControls from './movement';\nimport MousePointerControls from './pointer';\nimport RecordPlayer from './recordplayer';\nimport { loadSpotifyData, redirectToSpotifyLogin } from './spotify';\nimport TextGenerator from './text';\nimport WallpaperManager from './wallpaper';\n\n(async () => {\n  const canvas = document.getElementById('webglcanvas') as HTMLCanvasElement;\n  const environment = createScene(canvas);\n  const { scene, camera } = environment;\n\n  const audioPlayer = new AudioPlayer();\n  const coversManager = new AlbumCoverManager();\n  const pointerControls = new MousePointerControls(camera);\n  const textGenerator = new TextGenerator();\n  const wallpaperMgr = new WallpaperManager();\n\n  const movementControls = new MovementControls(camera, scene, pointerControls);\n  const recordPlayer = new RecordPlayer(\n    camera,\n    scene,\n    coversManager,\n    audioPlayer,\n  );\n  const halls = ['México', 'Global', 'Personal'].map(\n    (title, idx) =>\n      new Hall(\n        (2 * idx * Math.PI) / 3,\n        title,\n        scene,\n        coversManager,\n        textGenerator,\n        wallpaperMgr,\n      ),\n  );\n\n  movementControls.addWalls(halls.map((hall) => hall.getWalls()).flat());\n\n  // Load fonts\n  await textGenerator.load();\n\n  // Load models and halls\n  await Promise.all([\n    recordPlayer.load(),\n    ...halls.map((hall) => hall.loadFloor()),\n    ...halls.map((hall) => hall.setWallpaper(1)),\n    ...halls.map((hall) => hall.drawEndWall()),\n  ]);\n\n  // Load Spotify data\n  const { globalTracks, mexicoTracks, personalTracks } =\n    await loadSpotifyData();\n\n  // Set Spotify data in halls\n  await Promise.all(\n    [mexicoTracks, globalTracks, personalTracks].map(async (tracks, idx) => {\n      if (tracks) {\n        const albums = await halls[idx].setTracks(tracks, scene);\n        albums.forEach((album, idx) =>\n          pointerControls.addObjectAndHandler(album, () => {\n            if (tracks[idx].preview_url) {\n              recordPlayer.changeTrack(tracks[idx]);\n              audioPlayer.playPauseTrack(tracks[idx]);\n            } else {\n              console.error(\n                `Preview url not available for ${tracks[idx].name}`,\n              );\n            }\n          }),\n        );\n      } else {\n        const loginButton = halls[idx].setLoginButton();\n        pointerControls.addObjectAndHandler(loginButton, () =>\n          redirectToSpotifyLogin(),\n        );\n      }\n    }),\n  );\n\n  // Render the scene and animate it\n  animate(environment, [movementControls, recordPlayer]);\n})();\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","Cache","enabled","files","add","file","this","remove","clear","DefaultLoadingManager","constructor","onLoad","onProgress","onError","scope","urlModifier","isLoading","itemsLoaded","itemsTotal","handlers","onStart","undefined","itemStart","url","itemEnd","itemError","resolveURL","setURLModifier","transform","addHandler","regex","loader","push","removeHandler","index","indexOf","splice","getHandler","i","l","length","global","lastIndex","test","Loader","manager","crossOrigin","withCredentials","path","resourcePath","requestHeader","load","loadAsync","Promise","resolve","reject","parse","setCrossOrigin","setWithCredentials","setPath","setResourcePath","setRequestHeader","arrayMax","array","max","createElementNS","name","document","hashString","str","seed","h1","h2","ch","charCodeAt","Math","imul","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","ImageLoader","super","cached","setTimeout","image","onImageLoad","removeEventListeners","onImageError","event","removeEventListener","addEventListener","substr","src","EventDispatcher","type","listener","_listeners","listeners","hasEventListener","listenerArray","dispatchEvent","target","slice","AddEquation","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","CubeUVReflectionMapping","RepeatWrapping","ClampToEdgeWrapping","MirroredRepeatWrapping","NearestFilter","NearestMipmapNearestFilter","NearestMipmapLinearFilter","LinearFilter","LinearMipmapLinearFilter","UnsignedByteType","UnsignedShortType","UnsignedIntType","FloatType","HalfFloatType","UnsignedInt248Type","RGBFormat","RGBAFormat","DepthFormat","DepthStencilFormat","InterpolateDiscrete","InterpolateLinear","InterpolateSmooth","LinearEncoding","sRGBEncoding","GammaEncoding","RGBEEncoding","KeepStencilOp","StaticDrawUsage","GLSL3","DEG2RAD","PI","RAD2DEG","_lut","toString","hasRandomUUID","crypto","generateUUID","randomUUID","toUpperCase","d0","random","d1","d2","d3","clamp","min","lerp","x","y","t","degToRad","degrees","floorPowerOfTwo","pow","floor","log","LN2","Vector2","width","height","set","setScalar","scalar","setX","setY","setComponent","Error","getComponent","clone","copy","v","w","console","warn","addVectors","addScalar","s","a","b","addScaledVector","sub","subVectors","subScalar","multiply","multiplyScalar","divide","divideScalar","applyMatrix3","m","e","elements","clampScalar","minVal","maxVal","clampLength","ceil","round","roundToZero","negate","dot","cross","lengthSq","sqrt","manhattanLength","abs","normalize","angle","atan2","distanceTo","distanceToSquared","dx","dy","manhattanDistanceTo","setLength","alpha","lerpVectors","v1","v2","equals","fromArray","offset","toArray","fromBufferAttribute","attribute","getX","getY","rotateAround","center","c","cos","sin","iterator","isVector2","Matrix3","arguments","error","n11","n12","n13","n21","n22","n23","n31","n32","n33","te","identity","me","extractBasis","xAxis","yAxis","zAxis","setFromMatrix3Column","setFromMatrix4","multiplyMatrices","premultiply","ae","be","a11","a12","a13","a21","a22","a23","a31","a32","a33","b11","b12","b13","b21","b22","b23","b31","b32","b33","determinant","d","f","g","h","invert","t11","t12","t13","det","detInv","transpose","tmp","getNormalMatrix","matrix4","transposeIntoArray","r","setUvTransform","tx","ty","sx","sy","rotation","cx","cy","scale","rotate","theta","translate","matrix","_canvas","isMatrix3","textureId","Texture","DEFAULT_IMAGE","mapping","DEFAULT_MAPPING","wrapS","wrapT","magFilter","minFilter","format","anisotropy","encoding","uuid","mipmaps","internalFormat","repeat","matrixAutoUpdate","generateMipmaps","premultiplyAlpha","flipY","unpackAlignment","userData","version","onUpdate","isRenderTargetTexture","updateMatrix","source","JSON","stringify","toJSON","meta","isRootObject","textures","output","metadata","generator","wrap","images","Array","isArray","isDataTexture","serializeImage","dispose","transformUv","uv","needsUpdate","HTMLImageElement","HTMLCanvasElement","ImageBitmap","static","canvas","context","getContext","ImageData","putImageData","drawImage","toDataURL","getDataURL","data","isTexture","TextureLoader","texture","materialId","Material","fog","blending","side","vertexColors","opacity","transparent","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","depthFunc","depthTest","depthWrite","stencilWriteMask","stencilFunc","stencilRef","stencilFuncMask","stencilFail","stencilZFail","stencilZPass","stencilWrite","clippingPlanes","clipIntersection","clipShadows","shadowSide","colorWrite","precision","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","dithering","alphaToCoverage","premultipliedAlpha","visible","toneMapped","_alphaTest","alphaTest","onBuild","onBeforeRender","onBeforeCompile","customProgramCacheKey","setValues","values","newValue","flatShading","currentValue","isColor","isVector3","isRoot","extractFromCache","cache","color","getHex","roughness","metalness","sheen","sheenColor","sheenRoughness","emissive","emissiveIntensity","specular","specularIntensity","specularColor","shininess","clearcoat","clearcoatRoughness","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","clearcoatNormalScale","map","matcap","alphaMap","lightMap","lightMapIntensity","aoMap","aoMapIntensity","bumpMap","bumpScale","normalMap","normalMapType","normalScale","displacementMap","displacementScale","displacementBias","roughnessMap","metalnessMap","emissiveMap","specularMap","specularIntensityMap","specularColorMap","envMap","combine","envMapIntensity","reflectivity","refractionRatio","gradientMap","transmission","transmissionMap","thickness","thicknessMap","attenuationDistance","attenuationColor","size","sizeAttenuation","linewidth","dashSize","gapSize","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","srcPlanes","dstPlanes","n","isMaterial","_colorKeywords","_hslA","_hslB","hue2rgb","p","q","SRGBToLinear","LinearToSRGB","Color","setRGB","setHex","setStyle","hex","setHSL","style","handleAlpha","string","parseFloat","exec","components","parseInt","charAt","setColorName","toLowerCase","copyGammaToLinear","gammaFactor","copyLinearToGamma","safeInverse","convertGammaToLinear","convertLinearToGamma","copySRGBToLinear","copyLinearToSRGB","convertSRGBToLinear","convertLinearToSRGB","getHexString","getHSL","hue","saturation","lightness","delta","getStyle","offsetHSL","addColors","color1","color2","lerpColors","lerpHSL","getZ","normalized","NAMES","MeshPhongMaterial","parameters","isMeshPhongMaterial","AlbumCoverManager","materials","fetchAlbums","imageUrls","promises","forEach","all","entries","prom","AudioPlayer","state","status","onSongEnd","setOnSongEnd","callback","playPauseTrack","track","preview_url","player","pause","play","Audio","volume","autoplay","catch","Quaternion","z","_x","_y","_z","_w","qa","qb","qm","slerpQuaternions","dst","dstOffset","src0","srcOffset0","src1","srcOffset1","x0","y0","z0","w0","x1","y1","z1","w1","dir","sqrSin","Number","EPSILON","len","tDir","_onChangeCallback","quaternion","setFromEuler","euler","update","isEuler","order","_order","c1","c2","c3","s1","s2","s3","setFromAxisAngle","axis","halfAngle","setFromRotationMatrix","m11","m12","m13","m21","m22","m23","m31","m32","m33","trace","setFromUnitVectors","vFrom","vTo","angleTo","acos","rotateTowards","step","slerp","conjugate","multiplyQuaternions","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","cosHalfTheta","sqrSinHalfTheta","sinHalfTheta","halfTheta","ratioA","ratioB","u1","sqrt1u1","sqrtu1","u2","u3","getW","_onChange","isQuaternion","Vector3","setZ","multiplyVectors","applyEuler","applyQuaternion","_quaternion","applyAxisAngle","applyNormalMatrix","applyMatrix4","qx","qy","qz","qw","ix","iy","iz","iw","project","camera","matrixWorldInverse","projectionMatrix","unproject","projectionMatrixInverse","matrixWorld","transformDirection","crossVectors","ax","ay","az","bx","by","bz","projectOnVector","denominator","projectOnPlane","planeNormal","_vector","reflect","normal","dz","setFromSpherical","setFromSphericalCoords","radius","phi","sinPhiRadius","setFromCylindrical","setFromCylindricalCoords","setFromMatrixPosition","setFromMatrixScale","setFromMatrixColumn","sz","randomDirection","u","Box3","setFromArray","minX","minY","minZ","maxX","maxY","maxZ","setFromBufferAttribute","count","setFromPoints","points","makeEmpty","il","expandByPoint","setFromCenterAndSize","halfSize","setFromObject","object","expandByObject","box","isEmpty","getCenter","getSize","point","expandByVector","vector","expandByScalar","updateWorldMatrix","geometry","boundingBox","computeBoundingBox","_box","union","children","containsPoint","containsBox","getParameter","intersectsBox","intersectsSphere","sphere","clampPoint","intersectsPlane","plane","constant","intersectsTriangle","triangle","_center","_extents","_v0","_v1","_v2","_f0","_f1","_f2","axes","satForAxes","_triangleNormal","distanceToPoint","getBoundingSphere","intersect","_points","isBox3","_testAxis","v0","extents","j","p0","p1","p2","_toFarthestPoint","_toPoint","Sphere","optionalCenter","maxRadiusSq","radiusSum","deltaLengthSq","getBoundingBox","getMaxScaleOnAxis","missingRadiusHalf","_vector1","_vector2","_normalMatrix","Plane","setComponents","setFromNormalAndCoplanarPoint","setFromCoplanarPoints","inverseNormalLength","distanceToSphere","projectPoint","intersectLine","line","direction","start","intersectsLine","startSign","endSign","end","coplanarPoint","optionalNormalMatrix","normalMatrix","referencePoint","isPlane","_sphere","Frustum","p3","p4","p5","planes","frustum","setFromProjectionMatrix","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","intersectsObject","boundingSphere","computeBoundingSphere","intersectsSprite","sprite","negRadius","Matrix4","n14","n24","n34","n41","n42","n43","n44","copyPosition","setFromMatrix3","makeBasis","extractRotation","scaleX","scaleY","scaleZ","makeRotationFromEuler","af","bf","ce","cf","de","df","ac","ad","bc","bd","makeRotationFromQuaternion","compose","_zero","_one","lookAt","eye","up","a14","a24","a34","a41","a42","a43","a44","b14","b24","b34","b41","b42","b43","b44","setPosition","t14","scaleXSq","scaleYSq","scaleZSq","makeTranslation","makeRotationX","makeRotationY","makeRotationZ","makeRotationAxis","makeScale","makeShear","xy","xz","yx","yz","zx","zy","position","x2","y2","z2","xx","yy","zz","wx","wy","wz","decompose","_m1","invSX","invSY","invSZ","makePerspective","left","right","top","bottom","near","far","makeOrthographic","isMatrix4","setW","setAxisAngleFromQuaternion","setAxisAngleFromRotationMatrix","epsilon","epsilon2","WebGLAnimation","isAnimating","animationLoop","requestId","onAnimationFrame","time","frame","requestAnimationFrame","stop","cancelAnimationFrame","setAnimationLoop","setContext","WebGLAttributes","gl","capabilities","isWebGL2","buffers","WeakMap","isInterleavedBufferAttribute","deleteBuffer","buffer","delete","bufferType","isGLBufferAttribute","bytesPerElement","elementSize","usage","createBuffer","bindBuffer","bufferData","onUploadCallback","FLOAT","isFloat16BufferAttribute","HALF_FLOAT","UNSIGNED_SHORT","SHORT","UNSIGNED_INT","INT","BYTE","UNSIGNED_BYTE","BYTES_PER_ELEMENT","updateRange","bufferSubData","subarray","updateBuffer","isVector4","BufferAttribute","itemSize","TypeError","setUsage","copyAt","index1","index2","copyArray","copyColorsArray","colors","copyVector2sArray","vectors","copyVector3sArray","copyVector4sArray","setXY","setXYZ","setXYZW","onUpload","isBufferAttribute","Uint16BufferAttribute","Uint32BufferAttribute","Float32BufferAttribute","_matrix","Euler","DefaultOrder","asin","setFromQuaternion","setFromVector3","reorder","newOrder","toVector3","optionalResult","RotationOrders","Layers","mask","channel","enable","enableAll","toggle","disable","disableAll","layers","_object3DId","_q1","_target","_position","_scale","_xAxis","_yAxis","_zAxis","_addedEvent","_removedEvent","Object3D","parent","DefaultUp","defineProperties","configurable","modelViewMatrix","DefaultMatrixAutoUpdate","matrixWorldNeedsUpdate","castShadow","receiveShadow","frustumCulled","renderOrder","animations","onAfterRender","setRotationFromAxisAngle","setRotationFromEuler","setRotationFromMatrix","setRotationFromQuaternion","rotateOnAxis","rotateOnWorldAxis","rotateX","rotateY","rotateZ","translateOnAxis","distance","translateX","translateY","translateZ","localToWorld","worldToLocal","isCamera","isLight","isObject3D","removeFromParent","attach","getObjectById","id","getObjectByProperty","getObjectByName","getWorldPosition","getWorldQuaternion","getWorldScale","getWorldDirection","raycast","traverse","traverseVisible","traverseAncestors","updateMatrixWorld","force","updateParents","updateChildren","geometries","shapes","skeletons","serialize","library","element","isInstancedMesh","instanceMatrix","instanceColor","isScene","background","environment","isMesh","isLine","isPoints","shape","isSkinnedMesh","bindMode","bindMatrix","skeleton","material","uuids","animation","recursive","child","_id","_obj","_offset","_boxMorphTargets","BufferGeometry","attributes","morphAttributes","morphTargetsRelative","groups","drawRange","Infinity","getIndex","setIndex","getAttribute","setAttribute","deleteAttribute","hasAttribute","addGroup","materialIndex","clearGroups","setDrawRange","tangent","morphAttributesPosition","morphAttribute","isNaN","jl","computeTangents","indices","positions","normals","uvs","nVertices","tangents","tan1","tan2","vA","vB","vC","uvA","uvB","uvC","sdir","tdir","handleTriangle","isFinite","group","tmp2","n2","handleVertex","computeVertexNormals","positionAttribute","normalAttribute","pA","pB","pC","nA","nB","nC","cb","ab","normalizeNormals","merge","isBufferGeometry","attributeArray1","attribute2","attributeArray2","attributeOffset","toNonIndexed","convertBufferAttribute","array2","stride","geometry2","newAttribute","morphArray","keys","hasMorphAttributes","attributeArray","assign","BoxGeometry","depth","widthSegments","heightSegments","depthSegments","vertices","numberOfVertices","groupStart","buildPlane","udir","vdir","gridX","gridY","segmentWidth","segmentHeight","widthHalf","heightHalf","depthHalf","gridX1","gridY1","vertexCounter","groupCount","PlaneGeometry","width_half","height_half","segment_width","segment_height","cloneUniforms","property","mergeUniforms","uniforms","merged","UniformsUtils","ShaderMaterial","defines","vertexShader","fragmentShader","lights","clipping","extensions","derivatives","fragDepth","drawBuffers","shaderTextureLOD","defaultAttributeValues","index0AttributeName","uniformsNeedUpdate","glslVersion","isShaderMaterial","_segCenter","_segDir","_diff","_edge1","_edge2","_normal","Ray","origin","ray","at","recast","closestPointToPoint","directionDistance","distanceSqToPoint","distanceSqToSegment","optionalPointOnRay","optionalPointOnSegment","segExtent","a01","b0","b1","s0","sqrDist","extDet","invDet","intersectSphere","tca","radius2","thc","t0","t1","distanceToPlane","intersectPlane","distToPoint","intersectBox","tmin","tmax","tymin","tymax","tzmin","tzmax","invdirx","invdiry","invdirz","intersectTriangle","backfaceCulling","sign","DdN","DdQxE2","DdE1xQ","QdN","_v3","_vab","_vac","_vbc","_vap","_vbp","_vcp","Triangle","targetLengthSq","dot00","dot01","dot02","dot11","dot12","denom","invDenom","getBarycoord","uv1","uv2","uv3","setFromPointsAndIndices","i0","i1","i2","setFromAttributeAndIndices","getArea","getMidpoint","getNormal","getPlane","getUV","isFrontFacing","d4","vc","d5","d6","vb","va","MeshBasicMaterial","isMeshBasicMaterial","_inverseMatrix","_ray","_vA","_vB","_vC","_tempA","_tempB","_tempC","_morphA","_morphB","_morphC","_uvA","_uvB","_uvC","_intersectionPoint","_intersectionPointWorld","Mesh","updateMorphTargets","morphTargetInfluences","morphTargetDictionary","ml","String","morphTargets","raycaster","intersects","intersection","morphPosition","groupMaterial","checkBufferGeometryIntersection","faceIndex","face","isGeometry","morphInfluences","influence","boneTransform","checkIntersection","ShaderChunk","alphamap_fragment","alphamap_pars_fragment","alphatest_fragment","alphatest_pars_fragment","aomap_fragment","aomap_pars_fragment","begin_vertex","beginnormal_vertex","bsdfs","bumpmap_pars_fragment","clipping_planes_fragment","clipping_planes_pars_fragment","clipping_planes_pars_vertex","clipping_planes_vertex","color_fragment","color_pars_fragment","color_pars_vertex","color_vertex","common","cube_uv_reflection_fragment","defaultnormal_vertex","displacementmap_pars_vertex","displacementmap_vertex","emissivemap_fragment","emissivemap_pars_fragment","encodings_fragment","encodings_pars_fragment","envmap_fragment","envmap_common_pars_fragment","envmap_pars_fragment","envmap_pars_vertex","envmap_physical_pars_fragment","envmap_vertex","fog_vertex","fog_pars_vertex","fog_fragment","fog_pars_fragment","gradientmap_pars_fragment","lightmap_fragment","lightmap_pars_fragment","lights_lambert_vertex","lights_pars_begin","lights_toon_fragment","lights_toon_pars_fragment","lights_phong_fragment","lights_phong_pars_fragment","lights_physical_fragment","lights_physical_pars_fragment","lights_fragment_begin","lights_fragment_maps","lights_fragment_end","logdepthbuf_fragment","logdepthbuf_pars_fragment","logdepthbuf_pars_vertex","logdepthbuf_vertex","map_fragment","map_pars_fragment","map_particle_fragment","map_particle_pars_fragment","metalnessmap_fragment","metalnessmap_pars_fragment","morphnormal_vertex","morphtarget_pars_vertex","morphtarget_vertex","normal_fragment_begin","normal_fragment_maps","normal_pars_fragment","normal_pars_vertex","normal_vertex","normalmap_pars_fragment","clearcoat_normal_fragment_begin","clearcoat_normal_fragment_maps","clearcoat_pars_fragment","output_fragment","packing","premultiplied_alpha_fragment","project_vertex","dithering_fragment","dithering_pars_fragment","roughnessmap_fragment","roughnessmap_pars_fragment","shadowmap_pars_fragment","shadowmap_pars_vertex","shadowmap_vertex","shadowmask_pars_fragment","skinbase_vertex","skinning_pars_vertex","skinning_vertex","skinnormal_vertex","specularmap_fragment","specularmap_pars_fragment","tonemapping_fragment","tonemapping_pars_fragment","transmission_fragment","transmission_pars_fragment","uv_pars_fragment","uv_pars_vertex","uv_vertex","uv2_pars_fragment","uv2_pars_vertex","uv2_vertex","worldpos_vertex","background_vert","background_frag","cube_vert","cube_frag","depth_vert","depth_frag","distanceRGBA_vert","distanceRGBA_frag","equirect_vert","equirect_frag","linedashed_vert","linedashed_frag","meshbasic_vert","meshbasic_frag","meshlambert_vert","meshlambert_frag","meshmatcap_vert","meshmatcap_frag","meshnormal_vert","meshnormal_frag","meshphong_vert","meshphong_frag","meshphysical_vert","meshphysical_frag","meshtoon_vert","meshtoon_frag","points_vert","points_frag","shadow_vert","shadow_frag","sprite_vert","sprite_frag","UniformsLib","diffuse","uvTransform","uv2Transform","specularmap","envmap","flipEnvMap","ior","maxMipLevel","aomap","lightmap","emissivemap","bumpmap","normalmap","displacementmap","roughnessmap","metalnessmap","gradientmap","fogDensity","fogNear","fogFar","fogColor","ambientLightColor","lightProbe","directionalLights","properties","directionalLightShadows","shadowBias","shadowNormalBias","shadowRadius","shadowMapSize","directionalShadowMap","directionalShadowMatrix","spotLights","coneCos","penumbraCos","decay","spotLightShadows","spotShadowMap","spotShadowMatrix","pointLights","pointLightShadows","shadowCameraNear","shadowCameraFar","pointShadowMap","pointShadowMatrix","hemisphereLights","skyColor","groundColor","rectAreaLights","ltc_1","ltc_2","ShaderLib","basic","lambert","phong","standard","toon","dashed","totalSize","t2D","cube","equirect","tEquirect","distanceRGBA","referencePosition","nearDistance","farDistance","shadow","WebGLBackground","renderer","cubemaps","objects","clearColor","planeMesh","boxMesh","clearAlpha","currentBackground","currentBackgroundVersion","currentTonemapping","setClear","getClearColor","setClearColor","getClearAlpha","setClearAlpha","render","renderList","scene","forceClear","xr","session","getSession","environmentBlendMode","autoClear","autoClearColor","autoClearDepth","autoClearStencil","isCubeTexture","toneMapping","unshift","WebGLBindingStates","maxVertexAttributes","MAX_VERTEX_ATTRIBS","extension","vaoAvailable","bindingStates","defaultState","createBindingState","currentState","bindVertexArrayObject","vao","bindVertexArray","bindVertexArrayOES","deleteVertexArrayObject","deleteVertexArray","deleteVertexArrayOES","newAttributes","enabledAttributes","attributeDivisors","program","initAttributes","enableAttribute","enableAttributeAndDivisor","meshPerAttribute","enableVertexAttribArray","disableUnusedAttributes","disableVertexAttribArray","vertexAttribPointer","vertexAttribIPointer","reset","resetDefaultState","setup","updateBuffers","programMap","stateMap","createVertexArray","createVertexArrayOES","getBindingState","cachedAttributes","geometryAttributes","attributesNum","cachedAttribute","geometryAttribute","saveCache","ELEMENT_ARRAY_BUFFER","isInstancedBufferGeometry","programAttributes","getAttributes","materialDefaultAttributeValues","programAttribute","location","isInstancedInterleavedBuffer","locationSize","_maxInstanceCount","ARRAY_BUFFER","isInstancedBufferAttribute","vertexAttrib2fv","vertexAttrib3fv","vertexAttrib4fv","vertexAttrib1fv","setupVertexAttributes","geometryId","programId","releaseStatesOfGeometry","releaseStatesOfProgram","WebGLBufferRenderer","info","mode","setMode","drawArrays","renderInstances","primcount","methodName","WebGLCapabilities","maxAnisotropy","getMaxPrecision","getShaderPrecisionFormat","VERTEX_SHADER","HIGH_FLOAT","FRAGMENT_SHADER","MEDIUM_FLOAT","WebGL2RenderingContext","WebGL2ComputeRenderingContext","maxPrecision","has","logarithmicDepthBuffer","maxTextures","MAX_TEXTURE_IMAGE_UNITS","maxVertexTextures","MAX_VERTEX_TEXTURE_IMAGE_UNITS","maxTextureSize","MAX_TEXTURE_SIZE","maxCubemapSize","MAX_CUBE_MAP_TEXTURE_SIZE","maxAttributes","maxVertexUniforms","MAX_VERTEX_UNIFORM_VECTORS","maxVaryings","MAX_VARYING_VECTORS","maxFragmentUniforms","MAX_FRAGMENT_UNIFORM_VECTORS","vertexTextures","floatFragmentTextures","getMaxAnisotropy","MAX_TEXTURE_MAX_ANISOTROPY_EXT","floatVertexTextures","maxSamples","MAX_SAMPLES","WebGLClipping","globalState","numGlobalPlanes","localClippingEnabled","renderingShadows","viewNormalMatrix","uniform","resetGlobalState","numPlanes","numIntersection","projectPlanes","skipTransform","nPlanes","dstArray","flatSize","viewMatrix","i4","init","enableLocalClipping","beginShadows","endShadows","setState","useCache","materialProperties","nGlobal","lGlobal","clippingState","physical","sheenColorMap","sheenRoughnessMap","transmissionSamplerSize","transmissionSamplerMap","WebGLRenderTarget","options","scissor","scissorTest","viewport","depthBuffer","stencilBuffer","depthTexture","setTexture","setSize","isWebGLRenderTarget","Camera","PerspectiveCamera","fov","aspect","zoom","focus","view","filmGauge","filmOffset","updateProjectionMatrix","setFocalLength","focalLength","vExtentSlope","getFilmHeight","atan","getFocalLength","tan","getEffectiveFOV","getFilmWidth","setViewOffset","fullWidth","fullHeight","offsetX","offsetY","clearViewOffset","skew","isPerspectiveCamera","CubeCamera","renderTarget","isWebGLCubeRenderTarget","cameraPX","cameraNX","cameraPY","cameraNY","cameraPZ","cameraNZ","currentXrEnabled","currentRenderTarget","getRenderTarget","setRenderTarget","CubeTexture","WebGLCubeRenderTarget","dummy","isInteger","_needsFlipEnvMap","fromEquirectangularTexture","shader","mesh","currentMinFilter","stencil","WebGLCubeMaps","mapTextureMapping","onTextureDispose","cubemap","OrthographicCamera","scaleW","scaleH","isOrthographicCamera","RawShaderMaterial","isRawShaderMaterial","SIZE_MAX","EXTRA_LOD_SIGMA","TOTAL_LODS","LOD_MAX","ENCODINGS","_flatCamera","_lodPlanes","_sizeLods","_sigmas","_createPlanes","_clearColor","_oldTarget","PHI","INV_PHI","_axisDirections","PMREMGenerator","_renderer","_pingPongRenderTarget","_blurMaterial","weights","poleAxis","_getBlurShader","_equirectShader","_cubemapShader","_compileMaterial","fromScene","sigma","cubeUVRenderTarget","_allocateTargets","_sceneToCubeUV","_blur","_applyPMREM","_cleanup","fromEquirectangular","equirectangular","_fromTexture","fromCubemap","compileCubemapShader","_getCubemapShader","compileEquirectangularShader","_getEquirectShader","outputTarget","_setViewport","_textureToCubeUV","params","_isLDR","_createRenderTarget","tmpMesh","compile","cubeCamera","upSign","forwardSign","originalAutoClear","outputEncoding","backgroundMaterial","backgroundBox","useSolidColor","col","_setEncoding","lodIn","lodOut","pingPongRenderTarget","_halfBlur","targetIn","targetOut","sigmaRadians","blurMaterial","blurMesh","blurUniforms","pixels","radiansPerPixel","sigmaPixels","samples","sum","weight","exp","outputSize","lod","sizeLod","texelSize","cubeFaces","positionSize","uvSize","faceIndexSize","coordinates","fill","WebGLCubeUVMaps","cubeUVmaps","pmremGenerator","cubemapUV","isEquirectMap","isCubeMap","isCubeTextureComplete","WebGLExtensions","getExtension","WebGLGeometries","wireframeAttributes","onGeometryDispose","memory","updateWireframeAttribute","geometryIndex","geometryPosition","previousAttribute","getWireframeAttribute","currentAttribute","WebGLIndexedBufferRenderer","drawElements","WebGLInfo","calls","triangles","lines","programs","autoReset","instanceCount","TRIANGLES","LINES","LINE_STRIP","LINE_LOOP","POINTS","DataTexture2DArray","wrapR","numericalSort","absNumericalSort","denormalize","morph","WebGLMorphtargets","influencesList","morphTextures","workInfluences","objectInfluences","numberOfMorphTargets","entry","hasMorphNormals","morphNormals","numberOfVertexData","vertexDataStride","morphTarget","morphNormal","morphInfluencesSum","morphBaseInfluence","getUniforms","setValue","influences","sort","MAX_SAFE_INTEGER","isDataTexture2DArray","WebGLMultisampleRenderTarget","WebGLObjects","updateMap","onInstancedMeshDispose","instancedMesh","buffergeometry","isWebGLMultisampleRenderTarget","DataTexture3D","isDataTexture3D","emptyTexture","emptyTexture2dArray","emptyTexture3d","emptyCubeTexture","arrayCacheF32","arrayCacheI32","mat4array","mat3array","mat2array","flatten","nBlocks","blockSize","firstElem","arraysEqual","allocTexUnits","allocateTextureUnit","setValueV1f","uniform1f","addr","setValueV2f","uniform2f","uniform2fv","setValueV3f","uniform3f","uniform3fv","setValueV4f","uniform4f","uniform4fv","setValueM2","uniformMatrix2fv","setValueM3","uniformMatrix3fv","setValueM4","uniformMatrix4fv","setValueV1i","uniform1i","setValueV2i","uniform2iv","setValueV3i","uniform3iv","setValueV4i","uniform4iv","setValueV1ui","uniform1ui","setValueV2ui","uniform2uiv","setValueV3ui","uniform3uiv","setValueV4ui","uniform4uiv","setValueT1","unit","safeSetTexture2D","setValueT3D1","setTexture3D","setValueT6","safeSetTextureCube","setValueT2DArray1","setTexture2DArray","setValueV1fArray","uniform1fv","setValueV2fArray","setValueV3fArray","setValueV4fArray","setValueM2Array","setValueM3Array","setValueM4Array","setValueV1iArray","uniform1iv","setValueV2iArray","setValueV3iArray","setValueV4iArray","setValueV1uiArray","uniform1uiv","setValueV2uiArray","setValueV3uiArray","setValueV4uiArray","setValueT1Array","units","setValueT6Array","SingleUniform","activeInfo","getSingularSetter","PureArrayUniform","getPureArraySetter","StructuredUniform","seq","updateCache","RePathPart","addUniform","container","uniformObject","parseUniform","pathLength","match","matchEnd","idIsIndex","subscript","next","WebGLUniforms","getProgramParameter","ACTIVE_UNIFORMS","getActiveUniform","getUniformLocation","WebGLShader","createShader","shaderSource","compileShader","setOptional","upload","seqWithValue","programIdCount","getEncodingComponents","getShaderErrors","getShaderParameter","COMPILE_STATUS","errors","getShaderInfoLog","trim","split","join","addLineNumbers","getShaderSource","getTexelDecodingFunction","functionName","getTexelEncodingFunction","getToneMappingFunction","toneMappingName","filterEmptyLine","replaceLightNums","replace","numDirLights","numSpotLights","numRectAreaLights","numPointLights","numHemiLights","numDirLightShadows","numSpotLightShadows","numPointLightShadows","replaceClippingPlaneNums","numClippingPlanes","numClipIntersection","includePattern","resolveIncludes","includeReplacer","include","deprecatedUnrollLoopPattern","unrollLoopPattern","unrollLoops","loopReplacer","deprecatedLoopReplacer","snippet","generatePrecision","precisionstring","WebGLProgram","cacheKey","shadowMapTypeDefine","shadowMapType","generateShadowMapTypeDefine","envMapTypeDefine","envMapMode","generateEnvMapTypeDefine","envMapModeDefine","generateEnvMapModeDefine","envMapBlendingDefine","generateEnvMapBlendingDefine","gammaFactorDefine","customExtensions","extensionDerivatives","envMapCubeUV","tangentSpaceNormalMap","shaderID","extensionFragDepth","rendererExtensionFragDepth","extensionDrawBuffers","rendererExtensionDrawBuffers","extensionShaderTextureLOD","rendererExtensionShaderTextureLod","filter","generateExtensions","customDefines","chunks","generateDefines","createProgram","prefixVertex","prefixFragment","versionString","shaderName","instancing","instancingColor","supportsVertexTextures","maxBones","useFog","fogExp2","objectSpaceNormalMap","vertexTangents","vertexAlphas","vertexUvs","uvsVertexOnly","skinning","useVertexTexture","morphTargetsCount","doubleSided","flipSided","shadowMapEnabled","physicallyCorrectLights","mapEncoding","matcapEncoding","envMapEncoding","emissiveMapEncoding","specularColorMapEncoding","sheenColorMapEncoding","lightMapEncoding","depthPacking","vertexGlsl","fragmentGlsl","glVertexShader","glFragmentShader","attachShader","bindAttribLocation","linkProgram","debug","checkShaderErrors","programLog","getProgramInfoLog","vertexLog","fragmentLog","runnable","haveDiagnostics","LINK_STATUS","vertexErrors","fragmentErrors","getError","VALIDATE_STATUS","diagnostics","prefix","cachedUniforms","deleteShader","ACTIVE_ATTRIBUTES","getActiveAttrib","FLOAT_MAT2","FLOAT_MAT3","FLOAT_MAT4","getAttribLocation","fetchAttributeLocations","destroy","deleteProgram","usedTimes","WebGLPrograms","cubeuvmaps","shaderIDs","MeshDepthMaterial","MeshDistanceMaterial","MeshNormalMaterial","MeshLambertMaterial","MeshToonMaterial","MeshStandardMaterial","MeshPhysicalMaterial","MeshMatcapMaterial","LineBasicMaterial","LineDashedMaterial","PointsMaterial","ShadowMaterial","SpriteMaterial","parameterNames","getTextureEncodingFromMap","getParameters","shadows","isMeshStandardMaterial","bones","nVertexUniforms","nVertexMatrices","getMaxBones","useAlphaTest","useClearcoat","isFogExp2","directional","spot","rectArea","hemi","shadowMap","getProgramCacheKey","acquireProgram","pl","preexistingProgram","releaseProgram","pop","WebGLProperties","painterSortStable","groupOrder","reversePainterSortStable","WebGLRenderList","renderItems","renderItemsIndex","opaque","transmissive","defaultProgram","getNextRenderItem","renderItem","finish","customOpaqueSort","customTransparentSort","WebGLRenderLists","lists","renderCallDepth","list","UniformsCache","light","halfWidth","halfHeight","nextVersion","shadowCastingLightsFirst","lightA","lightB","WebGLLights","shadowCache","ShadowUniformsCache","hash","directionalLength","pointLength","spotLength","rectAreaLength","hemiLength","numDirectionalShadows","numPointShadows","numSpotShadows","ambient","probe","directionalShadow","spotShadow","rectAreaLTC1","rectAreaLTC2","pointShadow","vector3","matrix42","scaleFactor","intensity","isAmbientLight","isLightProbe","sh","coefficients","isDirectionalLight","shadowUniforms","bias","normalBias","mapSize","isSpotLight","penumbra","isRectAreaLight","isPointLight","isHemisphereLight","LTC_FLOAT_1","LTC_FLOAT_2","LTC_HALF_1","LTC_HALF_2","setupView","WebGLRenderState","lightsArray","shadowsArray","setupLights","setupLightsView","pushLight","pushShadow","shadowLight","WebGLRenderStates","renderStates","renderState","isMeshDepthMaterial","WebGLShadowMap","_objects","_capabilities","_frustum","_shadowMapSize","_viewportSize","_viewport","_depthMaterial","_distanceMaterial","_materialCache","_maxTextureSize","shadowMaterialVertical","VSM_SAMPLES","shadow_pass","resolution","shadowMaterialHorizontal","HORIZONTAL_PASS","fullScreenTri","fullScreenMesh","VSMPass","blurSamples","mapPass","renderBufferDirect","getDepthMaterial","result","customMaterial","customDistanceMaterial","customDepthMaterial","keyA","keyB","materialsForVariant","cachedMaterial","isMeshDistanceMaterial","renderObject","shadowCamera","k","kl","depthMaterial","autoUpdate","activeCubeFace","getActiveCubeFace","activeMipmapLevel","getActiveMipmapLevel","_state","setBlending","setTest","setScissorTest","shadowFrameExtents","getFrameExtents","isPointLightShadow","pars","viewportCount","getViewportCount","vp","getViewport","updateMatrices","getFrustum","WebGLState","colorBuffer","locked","currentColorMask","currentColorClear","setMask","colorMask","setLocked","lock","currentDepthMask","currentDepthFunc","currentDepthClear","DEPTH_TEST","depthMask","setFunc","NEVER","ALWAYS","LESS","LEQUAL","EQUAL","GEQUAL","GREATER","NOTEQUAL","clearDepth","currentStencilMask","currentStencilFunc","currentStencilRef","currentStencilFuncMask","currentStencilFail","currentStencilZFail","currentStencilZPass","currentStencilClear","stencilTest","STENCIL_TEST","stencilMask","setOp","stencilOp","clearStencil","enabledCapabilities","xrFramebuffer","currentBoundFramebuffers","currentProgram","currentBlendingEnabled","currentBlending","currentBlendEquation","currentBlendSrc","currentBlendDst","currentBlendEquationAlpha","currentBlendSrcAlpha","currentBlendDstAlpha","currentPremultipledAlpha","currentFlipSided","currentCullFace","currentLineWidth","currentPolygonOffsetFactor","currentPolygonOffsetUnits","MAX_COMBINED_TEXTURE_IMAGE_UNITS","lineWidthAvailable","glVersion","VERSION","currentTextureSlot","currentBoundTextures","scissorParam","SCISSOR_BOX","viewportParam","VIEWPORT","currentScissor","currentViewport","createTexture","bindTexture","texParameteri","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","texImage2D","RGBA","emptyTextures","TEXTURE_2D","TEXTURE_CUBE_MAP","TEXTURE_CUBE_MAP_POSITIVE_X","setFlipSided","setCullFace","CULL_FACE","equationToGL","FUNC_ADD","FUNC_SUBTRACT","FUNC_REVERSE_SUBTRACT","MIN","MAX","MIN_EXT","MAX_EXT","factorToGL","ZERO","ONE","SRC_COLOR","SRC_ALPHA","SRC_ALPHA_SATURATE","DST_COLOR","DST_ALPHA","ONE_MINUS_SRC_COLOR","ONE_MINUS_SRC_ALPHA","ONE_MINUS_DST_COLOR","ONE_MINUS_DST_ALPHA","BLEND","blendEquationSeparate","blendFuncSeparate","blendFunc","frontFace","CW","CCW","cullFace","BACK","FRONT","FRONT_AND_BACK","setPolygonOffset","factor","POLYGON_OFFSET_FILL","activeTexture","webglSlot","TEXTURE0","bindFramebuffer","framebuffer","DRAW_FRAMEBUFFER","FRAMEBUFFER","bindXRFramebuffer","useProgram","setMaterial","frontFaceCW","SAMPLE_ALPHA_TO_COVERAGE","setLineWidth","lineWidth","SCISSOR_TEST","webglType","webglTexture","boundTexture","unbindTexture","compressedTexImage2D","apply","texImage3D","KEEP","READ_FRAMEBUFFER","WebGLTextures","_gl","utils","_videoTextures","useOffscreenCanvas","OffscreenCanvas","err","createCanvas","resizeImage","needsPowerOfTwo","needsNewCanvas","maxSize","isPowerOfTwo","textureNeedsGenerateMipmaps","supportsMips","generateMipmap","__maxMipLevel","log2","getInternalFormat","internalFormatName","glFormat","glType","RED","R32F","R16F","R8","RGB","RGB32F","RGB16F","RGB8","RGBA32F","RGBA16F","SRGB8_ALPHA8","RGBA8","filterFallback","LINEAR","textureProperties","__webglInit","deleteTexture","__webglTexture","deallocateTexture","isVideoTexture","onRenderTargetDispose","renderTargetProperties","deleteFramebuffer","__webglFramebuffer","__webglDepthbuffer","deleteRenderbuffer","__webglMultisampledFramebuffer","__webglColorRenderbuffer","__webglDepthRenderbuffer","isWebGLMultipleRenderTargets","attachmentProperties","deallocateRenderTarget","textureUnits","setTexture2D","slot","updateVideoTexture","__version","complete","uploadTexture","setTextureCube","initTexture","pixelStorei","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK_ALIGNMENT","UNPACK_COLORSPACE_CONVERSION_WEBGL","NONE","isCompressed","isCompressedTexture","cubeImage","convert","glInternalFormat","setTextureParameters","mipmap","mipmapImage","uploadCubeTexture","wrappingToGL","REPEAT","CLAMP_TO_EDGE","MIRRORED_REPEAT","filterToGL","NEAREST_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR","textureType","TEXTURE_WRAP_S","TEXTURE_WRAP_T","TEXTURE_3D","TEXTURE_2D_ARRAY","TEXTURE_WRAP_R","__currentAnisotropy","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","textureNeedsPowerOfTwo","isDepthTexture","DEPTH_COMPONENT","DEPTH_COMPONENT32F","DEPTH_COMPONENT24","DEPTH24_STENCIL8","DEPTH_COMPONENT16","DEPTH_STENCIL","setupFrameBufferTexture","attachment","textureTarget","framebufferTexture2D","setupRenderBufferStorage","renderbuffer","isMultisample","bindRenderbuffer","RENDERBUFFER","getRenderTargetSamples","renderbufferStorageMultisample","renderbufferStorage","framebufferRenderbuffer","DEPTH_ATTACHMENT","DEPTH_STENCIL_ATTACHMENT","warnedTexture2D","warnedTextureCube","textureUnit","resetTextureUnits","setupRenderTarget","isCube","isMultipleRenderTargets","isRenderTarget3D","createFramebuffer","createRenderbuffer","COLOR_ATTACHMENT0","glTextureType","webglDepthTexture","setupDepthTexture","setupDepthRenderbuffer","updateRenderTargetMipmap","updateMultisampleRenderTarget","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","blitFramebuffer","WebGLUtils","UNSIGNED_SHORT_4_4_4_4","UNSIGNED_SHORT_5_5_5_1","UNSIGNED_SHORT_5_6_5","HALF_FLOAT_OES","ALPHA","LUMINANCE","LUMINANCE_ALPHA","RED_INTEGER","RG","RG_INTEGER","RGB_INTEGER","RGBA_INTEGER","COMPRESSED_RGB_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","COMPRESSED_RGB_PVRTC_4BPPV1_IMG","COMPRESSED_RGB_PVRTC_2BPPV1_IMG","COMPRESSED_RGBA_PVRTC_4BPPV1_IMG","COMPRESSED_RGBA_PVRTC_2BPPV1_IMG","COMPRESSED_RGB_ETC1_WEBGL","COMPRESSED_RGB8_ETC2","COMPRESSED_RGBA8_ETC2_EAC","UNSIGNED_INT_24_8","UNSIGNED_INT_24_8_WEBGL","ArrayCamera","cameras","isArrayCamera","Group","isGroup","_moveEvent","WebXRController","_targetRay","_grip","_hand","getHandSpace","joints","inputState","pinching","getTargetRaySpace","hasLinearVelocity","linearVelocity","hasAngularVelocity","angularVelocity","getGripSpace","disconnect","inputSource","referenceSpace","inputPose","gripPose","handPose","targetRay","grip","hand","visibilityState","getPose","targetRaySpace","inputjoint","jointPose","getJointPose","jointName","joint","jointRadius","indexTip","thumbTip","distanceToPinch","threshold","handedness","gripSpace","WebXRManager","framebufferScaleFactor","referenceSpaceType","pose","glBinding","glFramebuffer","glProjLayer","glBaseLayer","glMultisampledFramebuffer","glColorRenderbuffer","glDepthRenderbuffer","xrFrame","depthStyle","clearStyle","controllers","inputSourcesMap","Map","cameraL","cameraR","cameraVR","_currentDepthNear","_currentDepthFar","onSessionEvent","controller","onSessionEnd","isPresenting","onInputSourcesChange","inputSources","removed","added","cameraAutoUpdate","getController","getControllerGrip","getHand","setFramebufferScaleFactor","setReferenceSpaceType","getReferenceSpace","getBaseLayer","getBinding","getFrame","setSession","async","getContextAttributes","xrCompatible","makeXRCompatible","layerInit","antialias","XRWebGLLayer","updateRenderState","baseLayer","WebGLRenderingContext","depthFormat","projectionlayerInit","colorFormat","XRWebGLBinding","createProjectionLayer","textureWidth","textureHeight","requestReferenceSpace","cameraLPos","cameraRPos","updateCamera","depthNear","depthFar","ipd","projL","projR","topFov","bottomFov","leftFov","rightFov","zOffset","xOffset","near2","far2","left2","right2","top2","bottom2","setProjectionFromUnion","getCamera","getFoveation","fixedFoveation","setFoveation","foveation","onAnimationFrameCallback","getViewerPose","views","cameraVRNeedsUpdate","glSubImage","getViewSubImage","depthStencilTexture","colorTexture","invalidateFramebuffer","WebGLMaterials","refreshUniformsCommon","uvScaleMap","uv2ScaleMap","refreshUniformsStandard","refreshFogUniforms","isFog","density","refreshMaterialUniforms","pixelRatio","transmissionRenderTarget","isMeshLambertMaterial","refreshUniformsLambert","isMeshToonMaterial","refreshUniformsToon","refreshUniformsPhong","isMeshPhysicalMaterial","refreshUniformsPhysical","isMeshMatcapMaterial","refreshUniformsMatcap","refreshUniformsDepth","refreshUniformsDistance","isMeshNormalMaterial","refreshUniformsNormal","isLineBasicMaterial","refreshUniformsLine","isLineDashedMaterial","refreshUniformsDash","isPointsMaterial","refreshUniformsPoints","isSpriteMaterial","refreshUniformsSprites","isShadowMaterial","WebGLRenderer","display","createCanvasElement","_context","_alpha","_depth","_stencil","_antialias","_premultipliedAlpha","_preserveDrawingBuffer","preserveDrawingBuffer","_powerPreference","powerPreference","_failIfMajorPerformanceCaveat","failIfMajorPerformanceCaveat","currentRenderList","currentRenderState","renderListStack","renderStateStack","domElement","sortObjects","toneMappingExposure","_this","_isContextLost","_currentActiveCubeFace","_currentActiveMipmapLevel","_currentRenderTarget","_currentMaterialId","_currentCamera","_currentViewport","_currentScissor","_currentScissorTest","_width","_height","_pixelRatio","_opaqueSort","_transparentSort","_scissor","_scissorTest","_currentDrawBuffers","_clippingEnabled","_localClippingEnabled","_transmissionRenderTarget","_projScreenMatrix","_vector3","_emptyScene","overrideMaterial","getTargetPixelRatio","programCache","renderLists","morphtargets","bufferRenderer","indexedBufferRenderer","contextNames","contextAttributes","contextName","onContextLost","onContextRestore","isWebGL1Renderer","shift","message","initGLContext","preventDefault","infoAutoReset","shadowMapAutoUpdate","shadowMapNeedsUpdate","onMaterialDispose","releaseMaterialProgramReferences","deallocateMaterial","forceContextLoss","loseContext","forceContextRestore","restoreContext","getPixelRatio","setPixelRatio","updateStyle","setViewport","getDrawingBufferSize","setDrawingBufferSize","getCurrentViewport","getScissor","setScissor","getScissorTest","boolean","setOpaqueSort","method","setTransparentSort","bits","onXRSessionStart","onXRSessionEnd","needsProgramChange","needsLights","lightsStateVersion","getProgram","refreshProgram","refreshMaterial","refreshLights","p_uniforms","m_uniforms","uCamPos","cameraPosition","boneTexture","computeBoneTexture","boneTextureSize","uniformsList","setProgram","rangeFactor","dataCount","rangeStart","rangeCount","drawStart","drawEnd","drawCount","isLineSegments","isLineLoop","isSprite","projectObject","isLOD","renderScene","opaqueObjects","transmissiveObjects","transparentObjects","needsAntialias","currentToneMapping","renderObjects","renderTransmissionPass","programCacheKey","updateCommonMaterialProperties","materialNeedsLights","progUniforms","window","camera2","drawBuffersWEBGL","layer","framebufferTextureLayer","readRenderTargetPixels","activeCubeFaceIndex","textureFormat","IMPLEMENTATION_COLOR_READ_FORMAT","halfFloatSupportedByExt","IMPLEMENTATION_COLOR_READ_TYPE","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","readPixels","copyFramebufferToTexture","level","levelScale","copyTexImage2D","copyTextureToTexture","srcTexture","dstTexture","texSubImage2D","compressedTexSubImage2D","copyTextureToTexture3D","sourceBox","glTarget","unpackRowLen","UNPACK_ROW_LENGTH","unpackImageHeight","UNPACK_IMAGE_HEIGHT","unpackSkipPixels","UNPACK_SKIP_PIXELS","unpackSkipRows","UNPACK_SKIP_ROWS","unpackSkipImages","UNPACK_SKIP_IMAGES","texSubImage3D","compressedTexSubImage3D","resetState","__THREE_DEVTOOLS__","CustomEvent","detail","isWebGLRenderer","Scene","Light","AmbientLight","currentTime","Date","now","animate","devicePixelRatio","clientWidth","clientHeight","resizeRendererToDisplaySize","deltat","_lightPositionWorld","_lookTarget","LightShadow","_frameExtents","_viewportCount","_viewports","shadowMatrix","viewportIndex","SpotLightShadow","isSpotLightShadow","SpotLight","power","HALL_WIDTH","HALL_LENGTH","CENTER_APOTHEM","HALL_WALL_LENGTH","ALBUM_COVER_SIZE","Hall","title","coversManager","textGenerator","wallpaperMgr","root","tempMaterial","floorGeometry","centerFloorGeometry","centerFloor","sideWallGeometry","leftWall","HALL_HEIGHT","normalFromLeftWall","rightWall","normalFromRightWall","trackGroups","from","idx","trackGroup","endGroup","endTitles","endWallGeometry","endWall","normalFromEndWall","endWallSpotlight","endWallPosition","getWalls","loadFloor","getHallFloorMaterial","getCenterFloorMaterial","setWallpaper","wallpaperIdx","sides","getWallpaper","drawEndWall","endWallTop10Text","newRegular","horizAnchor","maxWidth","endWallTitleText","newBold","materialType","setLoginButton","loginButton","loginButtonBodyGeom","loginButtonBody","loginButtonText","setTracks","tracks","textureUrls","album","albumCoverMaterials","albumCoverGeometry","albumCoverMaterial","albumCover","albumSpotlight","idxText","songNameText","songTextBBox","artistNameText","artists","SphereGeometry","phiStart","phiLength","thetaStart","thetaLength","thetaEnd","grid","vertex","verticesRow","uOffset","Raycaster","Line","LOD","Points","Sprite","setFromCamera","coords","intersectObject","ascSort","intersectObjects","_euler","_changeEvent","_lockEvent","_unlockEvent","_PI_2","PointerLockControls","body","isLocked","minPolarAngle","maxPolarAngle","onMouseMove","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","onPointerlockChange","ownerDocument","pointerLockElement","onPointerlockError","connect","getObject","getDirection","moveForward","moveRight","requestPointerLock","unlock","exitPointerLock","MovementControls","pointerControls","pointerLockControls","pointerGeometry","pointerMaterial","pointer","instructionsDiv","getElementById","onClick","movement","down","collisionRaycaster","walls","rotationAxis","addWalls","frontWall","backWall","rightMov","forwardMov","MousePointerControls","mouse","objectsMap","handlersMap","addObjectAndHandler","handler","firstIntersection","objIntersected","RingGeometry","innerRadius","outerRadius","thetaSegments","phiSegments","radiusStep","segment","thetaSegmentLevel","LoaderUtils","TextDecoder","decode","fromCharCode","decodeURIComponent","escape","lastIndexOf","loading","FileLoader","req","Request","headers","Headers","credentials","fetch","then","response","callbacks","reader","getReader","contentLength","total","lengthComputable","loaded","ReadableStream","readData","read","done","close","byteLength","ProgressEvent","enqueue","statusText","stream","Response","responseType","arrayBuffer","blob","text","DOMParser","parseFromString","mimeType","json","setResponseType","setMimeType","DirectionalLightShadow","isDirectionalLightShadow","DirectionalLight","PointLightShadow","_cubeDirections","_cubeUps","PointLight","_sheen","_clearcoat","_transmission","Interpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","_cachedIndex","valueSize","settings","DefaultSettings_","evaluate","pp","validate_interval","seek","linear_scan","forward_scan","giveUpAt","afterEnd_","t1global","beforeStart_","mid","intervalChanged_","interpolate_","getSettings_","copySampleValue_","ImageBitmapLoader","createImageBitmap","setOptions","fetchOptions","res","colorSpaceConversion","imageBitmap","isImageBitmapLoader","InterleavedBuffer","arrayBuffers","_uuid","ib","isInterleavedBuffer","InterleavedBufferAttribute","interleavedBuffer","interleavedBuffers","linecap","linejoin","_reservedRe","RegExp","_wordChar","_wordCharOrDot","_directoryRe","_nodeRe","_objectRe","_propertyRe","_trackRe","_supportedObjectNames","PropertyBinding","rootNode","parsedPath","parseTrackName","node","findNode","nodeName","getValue","_getValue_unbound","_setValue_unbound","isAnimationObjectGroup","Composite","trackName","matches","results","objectName","objectIndex","propertyName","propertyIndex","lastDot","substring","bone","getBoneByName","searchNodeSubtree","childNode","subTreeNode","_getValue_unavailable","_setValue_unavailable","_getValue_direct","targetObject","_getValue_array","resolvedProperty","_getValue_arrayElement","_getValue_toArray","_setValue_direct","_setValue_direct_setNeedsUpdate","_setValue_direct_setMatrixWorldNeedsUpdate","_setValue_array","dest","_setValue_array_setNeedsUpdate","_setValue_array_setMatrixWorldNeedsUpdate","_setValue_arrayElement","_setValue_arrayElement_setNeedsUpdate","_setValue_arrayElement_setMatrixWorldNeedsUpdate","_setValue_fromArray","_setValue_fromArray_setNeedsUpdate","_setValue_fromArray_setMatrixWorldNeedsUpdate","targetArray","bind","sourceArray","nodeProperty","versioning","Versioning","None","NeedsUpdate","MatrixWorldNeedsUpdate","bindingType","BindingType","Direct","ArrayElement","HasFromToArray","EntireArray","GetterByBindingType","SetterByBindingTypeAndVersioning","unbind","targetGroup","optionalParsedPath","_targetGroup","_bindings","subscribe_","firstValidIndex","nCachedObjects_","binding","bindings","_basePosition","_skinIndex","_skinWeight","SkinnedMesh","bindMatrixInverse","calculateInverses","normalizeSkinWeights","skinWeight","skinIndex","boneIndex","boneInverses","_start","_end","computeLineDistances","lineDistances","localThreshold","localThresholdSq","vStart","vEnd","interSegment","interRay","LineSegments","LineLoop","testPoint","rayPointDistanceSq","intersectPoint","distanceToRay","CubicInterpolant","_weightPrev","_offsetPrev","_weightNext","_offsetNext","endingStart","endingEnd","iPrev","iNext","tPrev","tNext","halfDt","o1","o0","oP","oN","wP","wN","ppp","sP","sN","LinearInterpolant","offset1","offset0","weight1","weight0","DiscreteInterpolant","AnimationUtils","arraySlice","to","isTypedArray","convertArray","forceClone","ArrayBuffer","isView","DataView","getKeyframeOrder","times","sortedArray","nValues","srcOffset","flattenJSON","jsonKeys","valuePropertyName","subclip","sourceClip","startFrame","endFrame","fps","clip","getValueSize","minStartTime","resetDuration","makeClipAdditive","targetClip","referenceFrame","referenceClip","numTracks","referenceTime","referenceTrack","referenceTrackType","ValueTypeName","targetTrack","find","referenceOffset","referenceValueSize","createInterpolant","isInterpolantFactoryMethodGLTFCubicSpline","targetOffset","targetValueSize","referenceValue","startIndex","endIndex","interpolant","numTimes","valueStart","multiplyQuaternionsFlat","valueEnd","blendMode","KeyframeTrack","interpolation","TimeBufferType","ValueBufferType","setInterpolation","DefaultInterpolation","trackType","getInterpolation","InterpolantFactoryMethodDiscrete","InterpolantFactoryMethodLinear","InterpolantFactoryMethodSmooth","factoryMethod","timeOffset","timeScale","startTime","endTime","nKeys","validate","valid","prevTime","currTime","optimize","smoothInterpolation","writeIndex","keep","offsetP","offsetN","readOffset","writeOffset","TypedKeyframeTrack","NumberKeyframeTrack","QuaternionLinearInterpolant","slerpFlat","QuaternionKeyframeTrack","VectorKeyframeTrack","BooleanKeyframeTrack","ColorKeyframeTrack","StringKeyframeTrack","AnimationClip","duration","jsonTracks","frameTime","parseKeyframeTrack","clipTracks","morphTargetSequence","noLoop","numMorphTargets","objectOrClipArray","clipArray","animationToMorphTargets","pattern","parts","animationMorphTargets","clips","CreateFromMorphTargetSequence","addNonemptyTrack","animationKeys","destTracks","clipName","hierarchyTracks","hierarchy","morphTargetNames","morphTargetName","animationKey","boneName","typeName","getTrackTypeForValueTypeName","Bone","isBone","DataTexture","_offsetMatrix","_identityMatrix","Skeleton","boneMatrices","inverse","fromJSON","boneInverse","GLTFLoader","dracoLoader","ktx2Loader","meshoptDecoder","pluginCallbacks","register","parser","GLTFMaterialsClearcoatExtension","GLTFTextureBasisUExtension","GLTFTextureWebPExtension","GLTFMaterialsSheenExtension","GLTFMaterialsTransmissionExtension","GLTFMaterialsVolumeExtension","GLTFMaterialsIorExtension","GLTFMaterialsSpecularExtension","GLTFLightsExtension","GLTFMeshoptCompression","extractUrlBase","_onError","gltf","setDRACOLoader","setDDSLoader","setKTX2Loader","setMeshoptDecoder","unregister","content","plugins","decodeText","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","GLTFBinaryExtension","asset","GLTFParser","fileLoader","plugin","extensionsUsed","extensionName","extensionsRequired","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","KHR_MESH_QUANTIZATION","GLTFMeshQuantizationExtension","setExtensions","setPlugins","GLTFRegistry","removeAll","KHR_LIGHTS_PUNCTUAL","KHR_MATERIALS_CLEARCOAT","KHR_MATERIALS_IOR","KHR_MATERIALS_SHEEN","KHR_MATERIALS_SPECULAR","KHR_MATERIALS_TRANSMISSION","KHR_MATERIALS_VOLUME","KHR_TEXTURE_BASISU","EXT_TEXTURE_WEBP","EXT_MESHOPT_COMPRESSION","refs","uses","_markDefs","nodeDefs","nodes","nodeIndex","nodeLength","nodeDef","_addNodeRef","_loadLight","lightIndex","dependency","lightDef","lightNode","range","innerConeAngle","outerConeAngle","createUniqueName","createNodeAttachment","self","_getNodeRef","getMaterialType","extendParams","materialParams","materialDef","pending","metallicRoughness","pbrMetallicRoughness","baseColorFactor","baseColorTexture","assignTexture","extendMaterialParams","clearcoatFactor","clearcoatTexture","clearcoatRoughnessFactor","clearcoatRoughnessTexture","clearcoatNormalTexture","sheenColorFactor","sheenRoughnessFactor","sheenColorTexture","sheenRoughnessTexture","transmissionFactor","transmissionTexture","thicknessFactor","thicknessTexture","colorArray","specularFactor","specularTexture","specularColorFactor","specularColorTexture","loadTexture","textureIndex","textureDef","loadTextureImage","isSupported","textureLoader","uri","detectSupport","Image","onload","onerror","loadBufferView","bufferView","bufferViews","extensionDef","getDependency","decoder","supported","ready","byteOffset","byteStride","decodeGltfBuffer","headerView","header","magic","getUint32","chunkContentsLength","chunkView","chunkIndex","chunkLength","chunkType","contentArray","preload","decodePrimitive","primitive","bufferViewIndex","gltfAttributeMap","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","attributeName","threeAttributeName","ATTRIBUTES","accessorDef","accessors","componentType","WEBGL_COMPONENT_TYPES","decodeDracoFile","extendTexture","texCoord","GLTFMeshStandardSGMaterial","isGLTFSpecularGlossinessMaterial","specularMapParsFragmentChunk","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","glossiness","glossinessMap","_extraUniforms","uniformName","USE_SPECULARMAP","USE_GLOSSINESSMAP","USE_UV","specularGlossinessParams","pbrSpecularGlossiness","diffuseFactor","diffuseTexture","glossinessFactor","specularGlossinessTexture","specGlossMapDef","createMaterial","GLTFCubicSplineInterpolant","stride2","stride3","td","m0","m1","_q","GLTFCubicSplineQuaternionInterpolant","WEBGL_FILTERS","WEBGL_WRAPPINGS","WEBGL_TYPE_SIZES","POSITION","NORMAL","TANGENT","TEXCOORD_0","TEXCOORD_1","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","translation","INTERPOLATION","CUBICSPLINE","STEP","addUnknownExtensionsToUserData","knownExtensions","objectDef","gltfExtensions","assignExtrasToUserData","gltfDef","extras","meshDef","targetNames","createPrimitiveKey","primitiveDef","dracoExtension","geometryKey","createAttributesKey","attributesKey","getNormalizedComponentScale","associations","primitiveCache","meshCache","cameraCache","lightCache","textureCache","nodeNamesUsed","navigator","userAgent","_invokeAll","ext","beforeRoot","getDependencies","dependencies","scenes","afterRoot","skinDefs","skins","meshDefs","meshes","skinLength","skin","ref","updateMappings","original","mappings","_invokeOne","func","loadScene","loadNode","loadMesh","loadAccessor","loadBuffer","loadMaterial","loadSkin","loadAnimation","loadCamera","defs","def","bufferIndex","bufferDef","bufferViewDef","accessorIndex","sparse","pendingBufferViews","TypedArray","elementBytes","itemBytes","bufferAttribute","ibSlice","ibCacheKey","itemSizeIndices","SCALAR","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","sampler","URL","webkitURL","sourceURI","isObjectURL","Blob","createObjectURL","promise","revokeObjectURL","samplers","mapName","mapDef","gltfReference","assignFinalMaterial","useDerivativeTangents","useVertexColors","useFlatShading","pointsMaterial","lineMaterial","materialExtensions","sgExtension","kmuExtension","metallicFactor","roughnessFactor","metallicRoughnessTexture","alphaMode","alphaCutoff","normalTexture","occlusionTexture","strength","emissiveFactor","emissiveTexture","originalName","sanitizedName","sanitizeNodeName","loadGeometries","primitives","createDracoPrimitive","addPrimitiveAttributes","geometryPromise","meshIndex","toTrianglesDrawMode","cameraIndex","cameraDef","yfov","aspectRatio","znear","zfar","xmag","ymag","skinDef","skinEntry","inverseBindMatrices","accessor","animationIndex","animationDef","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","channels","input","inputAccessors","outputAccessors","targets","inputAccessor","outputAccessor","targetName","outputArray","scaled","createNodeMesh","meshPromise","sceneIndex","sceneDef","nodeIds","buildNodeHierarchy","reducedAssociations","reduceAssociations","nodeId","parentObject","pendingJoints","jointNodes","jointNode","mat","assignAttributeAccessor","gltfAttributeName","boxScale","maxDisplacement","computeBounds","hasMorphPosition","hasMorphNormal","pendingPositionAccessors","pendingNormalAccessors","pendingAccessor","morphPositions","addMorphTargets","drawMode","numberOfTriangles","newIndices","newGeometry","ch2","durl","cwk","Worker","encodeURI","u8","u16","u32","fleb","fdeb","clim","freb","eb","_a","fl","revfl","_b","fd","revfd","rev","hMap","cd","mb","co","le","rvb","sv","r_1","flt","fdt","flm","flrm","fdm","fdrm","bits16","shft","slc","inflt","dat","buf","st","sl","noBuf","noSt","cbuf","bl","nbuf","final","pos","bt","lm","dm","lbt","dbt","tbts","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","dt","lms","dms","lpos","sym","dsym","wbits","wbits16","hTree","t2","et","maxSym","tr","mbt","ln","lft","cst","i2_1","i2_2","i2_3","lc","cl","cli","cln","cls","clen","wfblk","out","wblk","syms","lf","li","bs","dlt","mlb","ddt","mdb","_c","lclt","nlc","_d","lcdt","ndc","lcfreq","_e","lct","mlcb","nlcc","ll","dl","flen","ftlen","dtlen","llm","lcts","it","clct","deo","dflt","lvl","plvl","pre","post","lst","opt","msk_1","prev","head","bs1_1","bs2_1","hsh","lc_1","wi","hv","imod","pimod","rem","ch_1","dif","maxn","maxd","nl","mmd","md","ti","lin","din","crct","crc","cr","adler","dopt","mem","mrg","wcln","fn","fnStr","ks","st_1","spInd","wrkr","fns","td_1","msg","transfer","onmessage","postMessage","wk","cbfs","bInflt","inflateSync","pbf","gu8","bDflt","deflateSync","gze","gzh","gzhl","wbytes","guze","gzs","gzl","zle","zlh","zule","zlv","cbify","opts","terminate","consume","astrm","strm","ondata","ev","astrmify","b2","b4","b8","filename","mtime","flg","zs","lv","AsyncCmpStrm","Deflate","chunk","AsyncDeflate","deflate","Inflate","bts","AsyncInflate","inflate","Gzip","raw","AsyncGzip","gzip","gzipSync","Gunzip","AsyncGunzip","gunzip","gunzipSync","Zlib","AsyncZlib","zlib","zlibSync","Unzlib","AsyncUnzlib","unzlib","unzlibSync","Decompress","G","I","Z","_this_1","AsyncDecompress","decompress","decompressSync","fltn","val","TextEncoder","tds","dutf8","DecodeUTF8","np","EncodeUTF8","strToU8","latin1","ar_1","encode","ar","ai","strFromU8","dbf","slzh","zh","fnl","es","z64e","sc","su","off","exfl","ex","wzh","extra","exl","os","flag","compression","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","attrs","exf","wzf","ZipPassThrough","process","ZipDeflate","AsyncZipDeflate","Zip","com","comment","hl","chks","pAll","_i","chks_1","chk","ind","uf","nxt","dd","zip","tot","slft","term","tAll","cbf","oe","cdl","badd","loc","_loop_1","ms","cbl","zipSync","UnzipPassThrough","UnzipInflate","AsyncUnzipInflate","_","Unzip","onfile","toAdd","is","oc","_loop_2","sig","this_1","cmp_1","chks_2","d_1","sc_1","su_1","fn_1","file_1","ctr","chks_3","originalSize","unzip","_loop_3","c_1","no","infl","unzipSync","c_2","Curve","arcLengthDivisions","getPoint","getPointAt","optionalTarget","getUtoTmapping","getPoints","divisions","getSpacedPoints","getLength","lengths","getLengths","cacheArcLengths","current","last","updateArcLengths","arcLengths","targetArcLength","comparison","low","high","lengthBefore","getTangent","pt1","pt2","getTangentAt","computeFrenetFrames","segments","closed","binormals","vec","MAX_VALUE","tz","findSpan","U","calcKoverI","nom","NURBSCurve","degree","knots","controlPoints","startKnot","endKnot","hpoint","P","span","N","saved","rv","temp","calcBasisFunctions","C","Nj","wNj","ders","nd","Pders","du","CK","nders","zeroArr","ndu","rk","pk","j2","calcBasisFunctionDerivatives","Pw","calcBSplineDerivatives","Aders","wders","calcRationalCurveDerivatives","fbxTree","connections","sceneGraph","FBXLoader","FBXBuffer","CORRECT","convertArrayBufferToString","isFbxFormatBinary","BinaryParser","FBXText","cursor","isFbxFormatASCII","getFbxVersion","TextParser","FBXTreeParser","parseConnections","parseImages","parseTextures","parseMaterials","deformers","parseDeformers","geometryMap","GeometryParser","parseScene","connectionMap","Connections","rawConnection","fromID","toID","relationship","parents","parentRelationship","ID","childRelationship","blobs","Objects","videoNodes","Video","nodeID","videoNode","RelativeFilename","Filename","arrayBufferContent","Content","base64Content","parseImage","fileName","textureMap","textureNodes","parseTexture","textureNode","attrName","wrapModeU","WrapModeU","wrapModeV","WrapModeV","valueU","valueV","Scaling","currentPath","FileName","materialMap","materialNodes","parseMaterial","materialNode","ShadingModel","parseParameters","BumpFactor","Diffuse","DiffuseColor","DisplacementFactor","Emissive","EmissiveColor","EmissiveFactor","Opacity","ReflectionFactor","Shininess","Specular","SpecularColor","getTexture","LayeredTexture","DeformerNodes","Deformer","deformerNode","relationships","attrType","parseSkeleton","geometryID","rawTargets","parseMorphTargets","deformerNodes","rawBones","boneNode","rawBone","transformLink","TransformLink","Indexes","Weights","rawMorphTargets","morphTargetNode","rawMorphTarget","initialWeight","DeformPercent","fullWeights","FullWeights","geoID","modelMap","parseModels","modelNodes","Model","model","modelNode","setLookAtProperties","connection","bindSkeleton","createAmbientLight","transformData","parentMatrix","parentMatrixWorld","generateTransform","AnimationParser","buildSkeleton","createCamera","createLight","createMesh","createCurve","getTransformData","subBone","cameraAttribute","attr","NodeAttribute","CameraProjectionType","nearClippingPlane","NearPlane","farClippingPlane","FarPlane","innerWidth","innerHeight","AspectWidth","AspectHeight","FieldOfView","FocalLength","lightAttribute","LightType","Intensity","CastLightOnObject","FarAttenuationEnd","EnableFarAttenuation","InnerAngle","OuterAngle","CastShadows","FBX_Deformer","reduce","geo","inheritType","InheritType","eulerOrder","getEulerOrder","RotationOrder","Lcl_Translation","preRotation","PreRotation","Lcl_Rotation","postRotation","PostRotation","Lcl_Scaling","scalingOffset","ScalingOffset","scalingPivot","ScalingPivot","rotationOffset","RotationOffset","rotationPivot","RotationPivot","lookAtTarget","bindMatrices","parsePoseNodes","geoConnParent","BindPoseNode","Pose","NbPoseNodes","poseNodes","PoseNode","poseNode","Node","Matrix","GlobalSettings","ambientColor","AmbientColor","geoNodes","Geometry","parseGeometry","geoNode","parseMeshGeometry","parseNurbsGeometry","GeometricTranslation","GeometricRotation","GeometricScaling","genGeometry","preTransform","geoInfo","parseGeoNode","genBuffers","weightsIndices","vertexWeights","uvBuffer","mappingType","prevMaterialIndex","currentIndex","lastGroup","vertexPositions","Vertices","vertexIndices","PolygonVertexIndex","LayerElementColor","parseVertexColors","LayerElementMaterial","parseMaterialIndices","LayerElementNormal","parseNormals","LayerElementUV","UV","parseUVs","weightTable","polygonIndex","faceLength","displayedWeightsWarning","facePositionIndexes","faceNormals","faceColors","faceUVs","faceWeights","faceWeightIndices","vertexIndex","polygonVertexIndex","endOfFace","weightIndices","getData","wt","wIndex","Weight","weightIndex","currentWeight","comparedWeight","comparedWeightIndex","comparedWeightArray","genFace","parentGeo","parentGeoNode","rawTarget","morphGeoNode","genMorphGeometry","morphPositionsSparse","morphIndex","morphGeoInfo","morphBuffers","NormalNode","MappingInformationType","referenceType","ReferenceInformationType","Normals","indexBuffer","NormalIndex","NormalsIndex","dataSize","UVNode","UVIndex","ColorNode","Colors","ColorIndex","MaterialNode","materialIndexBuffer","Materials","materialIndices","Order","KnotVector","pointsValues","Form","animationClips","rawClips","parseClips","rawClip","addClip","AnimationCurve","curveNodesMap","parseAnimationCurveNodes","parseAnimationCurves","layersMap","parseAnimationLayers","parseAnimStacks","rawCurveNodes","AnimationCurveNode","rawCurveNode","curveNode","curves","rawCurves","animationCurve","KeyTime","convertFBXTimeToSeconds","KeyValueFloat","animationCurveID","animationCurveRelationship","rawLayers","AnimationLayer","layerCurveNodes","modelID","rawModel","modelName","initialPosition","initialRotation","initialScale","deformerID","morpherID","morphName","rawStacks","AnimationStack","rawTracks","concat","generateTracks","T","positionTrack","generateVectorTrack","R","rotationTrack","generateRotationTrack","S","scaleTrack","morphTrack","generateMorphTrack","initialValue","getTimesForAllAxes","getKeyframeTrackValues","interpolateRotations","quaternionValues","morphNum","targetIndex","lastValue","prevValue","xIndex","yIndex","zIndex","xValue","yValue","zValue","curve","valuesSpan","absoluteSpan","numSubIntervals","nextValue","initialTime","interval","nextTime","interpolatedTimes","interpolatedValues","inject","getPrevNode","nodeStack","currentIndent","getCurrentNode","getCurrentProp","currentProp","pushStack","popStack","setCurrentProp","currentPropName","allNodes","FBXTree","matchComment","matchEmpty","matchBeginning","matchProperty","parseNodeBegin","parseNodeProperty","parseNodePropertyContinued","nodeAttrs","parseNodeAttr","currentNode","contentLine","propName","propValue","connProps","rest","elem","append","parseNumberArray","parseNodeSpecialProperty","props","innerPropName","innerPropType1","innerPropType2","innerPropFlag","innerPropValue","BinaryReader","skip","endOfContent","parseNode","getOffset","endOffset","getUint64","numProperties","nameLen","getUint8","getString","propertyList","parseProperty","singleProperty","subNode","parseSubNode","getBoolean","getFloat64","getFloat32","getInt32","getInt64","getArrayBuffer","getInt16","arrayLength","compressedLength","getBooleanArray","getFloat64Array","getFloat32Array","getInt32Array","getInt64Array","reader2","littleEndian","dv","nullByte","dataArray","infoObject","tempEuler","tempVec","lTranslationM","lPreRotationM","lRotationM","lPostRotationM","lScalingM","lScalingPivotM","lScalingOffsetM","lRotationOffsetM","lRotationPivotM","lParentGX","lParentLX","lGlobalT","lLRM","lParentGRM","lParentTM","lParentGRSM","lParentGSM","lLSM","lGlobalRS","lParentLSM_inv","lParentGSM_noLocal","lRotationPivotM_inv","lScalingPivotM_inv","lTransform","lLocalTWithAllPivotAndOffsetInfo","lGlobalTranslation","enums","a1","a2","MusicNoteParticleSystem","timeouts","key1","key2","particles","MusicNoteParticle","playAnimation","particle","startAnimation","pauseAnimation","timeout","clearTimeout","part","stopNextAnimation","key1Group","key2Group","currMusicState","nextMusicState","RECORD_PLAYER_X_ROTATION","RecordPlayer","audioPlayer","changeTrack","albumGeometry","playingTrackId","particlesGroup","firstTimePlaying","albumUrl","coverMaterial","spotifyFetch","accessToken","urlPath","Authorization","loadSpotifyData","token","URLSearchParams","getAccessToken","globalTracks","mexicoTracks","personalTracks","items","resGlobal","resMexico","EllipseCurve","aX","aY","xRadius","yRadius","aStartAngle","aEndAngle","aClockwise","aRotation","twoPi","deltaAngle","samePoints","isEllipseCurve","ArcCurve","aRadius","CubicPoly","c0","initCatmullRom","x3","tension","initNonuniformCatmullRom","dt0","dt1","dt2","calc","isArcCurve","px","py","pz","CatmullRomCurve3","curveType","intPoint","CatmullRom","QuadraticBezier","QuadraticBezierP0","QuadraticBezierP1","QuadraticBezierP2","CubicBezier","CubicBezierP0","CubicBezierP1","CubicBezierP2","CubicBezierP3","isCatmullRomCurve3","CubicBezierCurve","v3","isCubicBezierCurve","CubicBezierCurve3","isCubicBezierCurve3","LineCurve","isLineCurve","LineCurve3","isLineCurve3","QuadraticBezierCurve","isQuadraticBezierCurve","QuadraticBezierCurve3","isQuadraticBezierCurve3","SplineCurve","isSplineCurve","CurvePath","autoClose","closePath","startPoint","endPoint","curveLengths","getCurveLengths","diff","segmentLength","lens","cacheLengths","sums","pts","Path","currentPoint","moveTo","lineTo","quadraticCurveTo","aCPx","aCPy","bezierCurveTo","aCP1x","aCP1y","aCP2x","aCP2y","splineThru","npts","arc","absarc","absellipse","ellipse","firstPoint","lastPoint","Shape","holes","getPointsHoles","holesPts","extractPoints","hole","linkedList","dim","clockwise","signedArea","insertNode","removeNode","filterPoints","again","steiner","earcutLinked","ear","invSize","pass","zOrder","prevZ","nextZ","tail","numMerges","pSize","qSize","inSize","sortLinked","indexCurve","isEarHashed","isEar","cureLocalIntersections","splitEarcut","pointInTriangle","minTX","minTY","maxTX","maxTY","locallyInside","isValidDiagonal","splitPolygon","compareX","eliminateHole","outerNode","hx","hy","mx","my","tanMin","sectorContainsSector","findHoleBridge","getLeftmost","leftmost","intersectsPolygon","inside","middleInside","q1","q2","o2","o3","o4","onSegment","num","an","bp","ShapeUtils","contour","area","holeIndices","faces","removeDupEndPts","addContour","holeIndex","hasHoles","outerLen","queue","eliminateHoles","Earcut","ShapePath","subPaths","toShapes","isCCW","noHoles","toShapesNoHoles","inSubpaths","tmpPath","tmpShape","isPointInsidePolygon","inPt","inPolygon","polyLen","edgeLowPt","edgeHighPt","edgeDx","edgeDy","perpEdge","isClockWise","solid","holesFirst","betterShapeHoles","newShapes","tmpPoints","tmpHoles","newShapeHoles","mainIdx","ambiguous","toChange","sIdx","sLen","sho","hIdx","ho","hole_unassigned","s2Idx","froms","tos","FontLoader","font","Font","generateShapes","paths","chars","line_height","yMax","yMin","underlineThickness","char","ret","createPath","createPaths","glyph","glyphs","familyName","cpx","cpy","cpx1","cpy1","cpx2","cpy2","outline","_cachedOutline","ha","isFont","ExtrudeGeometry","verticesArray","uvArray","addShape","placeholder","curveSegments","steps","bevelEnabled","bevelThickness","bevelSize","bevelOffset","bevelSegments","extrudePath","uvgen","UVGenerator","WorldUVGenerator","amount","extrudePts","splineTube","binormal","position2","extrudeByPath","shapePoints","reverse","ahole","triangulateShape","scalePt2","pt","vlen","getBevelVec","inPrev","inNext","v_trans_x","v_trans_y","shrink_by","v_prev_x","v_prev_y","v_next_x","v_next_y","v_prev_lensq","collinear0","v_prev_len","v_next_len","ptPrevShift_x","ptPrevShift_y","sf","v_trans_lensq","direction_eq","contourMovements","holesMovements","oneHoleMovements","verticesMovements","vert","sidewalls","layeroffset","slen1","slen2","f4","f3","addVertex","nextIndex","generateTopUV","addUV","generateSideWallUV","vector2","buildLidFaces","buildSideFaces","geometryShapes","indexA","indexB","indexC","a_x","a_y","b_x","b_y","c_x","c_y","indexD","a_z","b_z","c_z","d_x","d_y","d_z","TextGeometry","TextGenerator","normalMaterial","whiteMaterial","fontLoader","regularFont","semiboldFont","textGeometry","bBox","words","nextIdx","nextGeom","currentTextGeom","anchor","WallpaperManager","hallFloorMaterial","centerFloorMaterial","wallpapers","wallpaperData","hallWidth","hallHeight","hallDepth","textureSides","textureEnd","ambientLight","createScene","movementControls","recordPlayer","halls","hall","flat","spotifyAuthParams","pathname","redirectToSpotifyLogin"],"sourceRoot":""}